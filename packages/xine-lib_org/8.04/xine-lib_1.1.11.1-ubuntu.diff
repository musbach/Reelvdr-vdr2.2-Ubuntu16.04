diff -Nur xine-lib-1.1.11.1/aclocal.m4 xine-lib-1.1.11.1-ubuntu/aclocal.m4
--- xine-lib-1.1.11.1/aclocal.m4	2008-03-30 16:02:19.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/aclocal.m4	2009-10-02 15:28:05.000000000 +0200
@@ -1,7 +1,7 @@
-# generated automatically by aclocal 1.10.1 -*- Autoconf -*-
+# generated automatically by aclocal 1.10 -*- Autoconf -*-
 
 # Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
-# 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2005, 2006  Free Software Foundation, Inc.
 # This file is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -11,15 +11,12 @@
 # even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 # PARTICULAR PURPOSE.
 
-m4_ifndef([AC_AUTOCONF_VERSION],
-  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
-m4_if(AC_AUTOCONF_VERSION, [2.61],,
-[m4_warning([this file was generated for autoconf 2.61.
-You have another version of autoconf.  It may work, but is not guaranteed to.
-If you have problems, you may need to regenerate the build system entirely.
-To do so, use the procedure documented by the package, typically `autoreconf'.])])
+m4_if(m4_PACKAGE_VERSION, [2.61],,
+[m4_fatal([this file was generated for autoconf 2.61.
+You have another version of autoconf.  If you want to use that,
+you should regenerate the build system entirely.], [63])])
 
-# Copyright (C) 2002, 2003, 2005, 2006, 2007  Free Software Foundation, Inc.
+# Copyright (C) 2002, 2003, 2005, 2006  Free Software Foundation, Inc.
 #
 # This file is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
@@ -34,7 +31,7 @@
 [am__api_version='1.10'
 dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to
 dnl require some minimum version.  Point them to the right macro.
-m4_if([$1], [1.10.1], [],
+m4_if([$1], [1.10], [],
       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl
 ])
 
@@ -50,10 +47,8 @@
 # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.
 # This function is AC_REQUIREd by AC_INIT_AUTOMAKE.
 AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-[AM_AUTOMAKE_VERSION([1.10.1])dnl
-m4_ifndef([AC_AUTOCONF_VERSION],
-  [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl
-_AM_AUTOCONF_VERSION(AC_AUTOCONF_VERSION)])
+[AM_AUTOMAKE_VERSION([1.10])dnl
+_AM_AUTOCONF_VERSION(m4_PACKAGE_VERSION)])
 
 # Figure out how to run the assembler.                      -*- Autoconf -*-
 
@@ -347,7 +342,7 @@
   # each Makefile.in and add a new line on top of each file to say so.
   # Grep'ing the whole file is not good either: AIX grep has a line
   # limit of 2048, but all sed's we know have understand at least 4000.
-  if sed -n 's,^#.*generated by automake.*,X,p' "$mf" | grep X >/dev/null 2>&1; then
+  if sed 10q "$mf" | grep '^#.*generated by automake' > /dev/null 2>&1; then
     dirpart=`AS_DIRNAME("$mf")`
   else
     continue
@@ -395,13 +390,13 @@
 # Do all the work for Automake.                             -*- Autoconf -*-
 
 # Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,
-# 2005, 2006, 2008 Free Software Foundation, Inc.
+# 2005, 2006 Free Software Foundation, Inc.
 #
 # This file is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
 
-# serial 13
+# serial 12
 
 # This macro actually does too much.  Some checks are only needed if
 # your package does certain things.  But this isn't really a big deal.
@@ -506,17 +501,16 @@
 # our stamp files there.
 AC_DEFUN([_AC_AM_CONFIG_HEADER_HOOK],
 [# Compute $1's index in $config_headers.
-_am_arg=$1
 _am_stamp_count=1
 for _am_header in $config_headers :; do
   case $_am_header in
-    $_am_arg | $_am_arg:* )
+    $1 | $1:* )
       break ;;
     * )
       _am_stamp_count=`expr $_am_stamp_count + 1` ;;
   esac
 done
-echo "timestamp for $_am_arg" >`AS_DIRNAME(["$_am_arg"])`/stamp-h[]$_am_stamp_count])
+echo "timestamp for $1" >`AS_DIRNAME([$1])`/stamp-h[]$_am_stamp_count])
 
 # Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.
 #
@@ -788,7 +782,7 @@
 
 # _AM_SUBST_NOTMAKE(VARIABLE)
 # ---------------------------
-# Prevent Automake from outputting VARIABLE = @VARIABLE@ in Makefile.in.
+# Prevent Automake from outputing VARIABLE = @VARIABLE@ in Makefile.in.
 # This macro is traced by Automake.
 AC_DEFUN([_AM_SUBST_NOTMAKE])
 
diff -Nur xine-lib-1.1.11.1/configure xine-lib-1.1.11.1-ubuntu/configure
--- xine-lib-1.1.11.1/configure	2008-03-30 16:02:44.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/configure	2009-10-02 15:28:05.000000000 +0200
@@ -53439,22 +53439,21 @@
   fi
   rm -f "$tmp/out12"
 # Compute $ac_file's index in $config_headers.
-_am_arg=$ac_file
 _am_stamp_count=1
 for _am_header in $config_headers :; do
   case $_am_header in
-    $_am_arg | $_am_arg:* )
+    $ac_file | $ac_file:* )
       break ;;
     * )
       _am_stamp_count=`expr $_am_stamp_count + 1` ;;
   esac
 done
-echo "timestamp for $_am_arg" >`$as_dirname -- "$_am_arg" ||
-$as_expr X"$_am_arg" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$_am_arg" : 'X\(//\)[^/]' \| \
-	 X"$_am_arg" : 'X\(//\)$' \| \
-	 X"$_am_arg" : 'X\(/\)' \| . 2>/dev/null ||
-echo X"$_am_arg" |
+echo "timestamp for $ac_file" >`$as_dirname -- $ac_file ||
+$as_expr X$ac_file : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X$ac_file : 'X\(//\)[^/]' \| \
+	 X$ac_file : 'X\(//\)$' \| \
+	 X$ac_file : 'X\(/\)' \| . 2>/dev/null ||
+echo X$ac_file |
     sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
 	    s//\1/
 	    q
@@ -53491,7 +53490,7 @@
   # each Makefile.in and add a new line on top of each file to say so.
   # Grep'ing the whole file is not good either: AIX grep has a line
   # limit of 2048, but all sed's we know have understand at least 4000.
-  if sed -n 's,^#.*generated by automake.*,X,p' "$mf" | grep X >/dev/null 2>&1; then
+  if sed 10q "$mf" | grep '^#.*generated by automake' > /dev/null 2>&1; then
     dirpart=`$as_dirname -- "$mf" ||
 $as_expr X"$mf" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
 	 X"$mf" : 'X\(//\)[^/]' \| \
diff -Nur xine-lib-1.1.11.1/debian/changelog xine-lib-1.1.11.1-ubuntu/debian/changelog
--- xine-lib-1.1.11.1/debian/changelog	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/changelog	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,1644 @@
+xine-lib (1.1.11.1-1ubuntu3.4) hardy-security; urgency=low
+
+  * SECURITY UPDATE: Integer overflow in the 4xm demuxer
+    - src/demuxers/demux_4xm.c: Fix additional integer overflow, as
+      previous fix was incomplete.
+    - http://hg.debian.org/hg/xine-lib/xine-lib/rev/7799748cc0f2
+    - CVE-2009-0698
+  * SECURITY UPDATE: Integer overflow in the QT demuxer via large count
+    value in an STTS atom
+    - src/demuxers/demux_qt.c: validate atom size
+    - http://hg.debian.org/hg/xine-lib/xine-lib/rev/d21a4564db03
+    - CVE-2009-1274
+
+ -- Marc Deslauriers <marc.deslauriers@ubuntu.com>  Fri, 17 Apr 2009 13:17:25 -0400
+
+xine-lib (1.1.11.1-1ubuntu3.3) hardy-security; urgency=low
+
+  * REGRESSION: Broken size checks in CVE-2008-5239 input plugins patch
+    (LP: #322834)
+    - src/input/input_*.c: fix the size checks broken by the previous
+      security update.
+    - http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=b11cc37934629a2965859163db6095fbbe2b44be;style=gitweb
+    - CVE-2008-5239
+  * SECURITY UPDATE: Integer overflow in the 4xm demuxer
+    - src/demuxers/demux_4xm.c: Make sure we don't overflow
+      fourxm->track_count.
+    - http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=ba872682eba8a10217c48b7fe21f0fa763ef4af3;style=gitweb
+    - CVE-2009-0698
+
+ -- Marc Deslauriers <marc.deslauriers@ubuntu.com>  Tue, 24 Mar 2009 09:31:38 -0400
+
+xine-lib (1.1.11.1-1ubuntu3.2) hardy-security; urgency=low
+
+  * SECURITY UPDATE: backported security fixes from upstream xine-lib hg repo:
+    - src/demuxers/demux_matroska.c: avoid segfault on invalid track type in
+      Matroska files.
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=7b472fa486db;style=gitweb
+    - src/combined/ffmpeg/ff_video_decoder.c: fix heap buffer overflow in the
+      ffmpeg video decoder.
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=ffb2e82d7bb77e87492734f72c2e5d21fb9ad2c0;style=gitweb
+    - misc/cdda_server.c: fix integer overflow in the the CDDA server.
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=30eb014e9b320035de309ee442ebbff6d405987b;style=gitweb
+    - src/demuxers/demux_{ogg,avi,asf}.c: fix crashes with fuzzed media files.
+      (CVE-2008-3231)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=967a8e515380c0c9b9858125a054082145002d00;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=67bfec7af3472674ba7396bd468b7607339fe102;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=4519eeeda3b3a20489b3699693d801c3696221da;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=18059453374c49ebfc9660dcc34acc28afa57d17;style=gitweb
+    - src/demuxers/demux_{mng,mod}.c: add some checks for memory allocation
+      failures. (CVE-2008-5233)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=35f09930323e46c92e521846b9ccdfd5e277ad16;style=gitweb
+    - src/demuxers/demux_qt.c: fix heap overflow in Quicktime atom parsing.
+      (CVE-2008-5234, CVE-2008-5242)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=6e81eec36701;style=gitweb
+    - src/demuxers/demux_matroska.c: fix buffer overflows in Matroska demuxer.
+      (CVE-2008-5236)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=e38bb4b22431123997a16a186fe8beb4edcfef87;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=8e125da9ecbe;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=b01a02595343;style=gitweb
+    - src/demuxers/demux_{mng,qt}.c: fix integer overflows in MNG and QT
+      demuxers. (CVE-2008-5237)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=9c97a9a9ba17a487116a198d80a74ec7879aa801;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=65f524e14623;style=gitweb
+    - src/demuxers/{demux_matroska.c,demux_mod.c,id3.h}: use size_t for data
+      length variables where there may be int overflows. (CVE-2008-5238)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=a0830dddbd35625069506a9c49321317cbab8a2d;style=gitweb
+    - src/{input,demuxers}/*.c: fix out-of-bounds reads and heap-based buffer
+      overflows from unchecked or incompletely-checked read function results.
+      (CVE-2008-5239)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=7fb21abb15e5a7311a2c157721ddfab0a47090ab;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=5df277a7eec3;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=f775929597b1c10142e51674ee02e041b1b87df4;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib/?cmd=changeset;node=e6efc6d566961ab231686c1ee18044f2d45a2b4a;style=gitweb
+    - src/demuxers/demux_real.c: fix unchecked malloc using untrusted values.
+      (CVE-2008-5240)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=01753933e6647ed29226f18e4489ce034b569d65;style=gitweb
+      * http://hg.debian.org/hg/xine-lib/xine-lib/?cmd=changeset;node=071dc93156e6940a7f1b8bb38762d521dd5731e8;style=gitweb
+    - src/demuxers/demux_qt.c: fix integer underflow in qt compressed atom
+      handling. (CVE-2008-5241)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=a57d5ef86b65bcc195a5358125fdb34e10a37bb4;style=gitweb
+    - src/demuxers/demux_real.c: fix buffer indexing using untrusted or
+      unchecked values. (CVE-2008-5243)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=4982c9920f42657d0797145bf197127f18d8972c;style=gitweb
+    - src/libfaad/*: updated to libfaad 2.6.1 to fix crashes with corrupted
+      AAC files. (CVE-2008-5244)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=18c0264660b951b8e5672f1a66d1bcecdfeb6ea8;style=gitweb
+    - src/demuxers/id3.c: fix an exploitable ID3 heap buffer overflow.
+      (CVE-2008-5246)
+      * http://hg.debian.org/hg/xine-lib/xine-lib?cmd=changeset;node=268c1c1639d766d92b7e7bb11de7b38482ebe8e9;style=gitweb
+    - src/xine-engine/info_helper.c: fix crashes with MP3 files with metadata
+      consisting only of separators. (CVE-2008-5248)
+      * http://hg.debian.org/hg/xine-lib/xine-lib/?cmd=changeset;node=60ab5d2bdd82f00b10205f816a545337c9363134;style=gitweb
+
+ -- Marc Deslauriers <marc.deslauriers@ubuntu.com>  Wed, 21 Jan 2009 09:17:17 -0500 
+
+xine-lib (1.1.11.1-1ubuntu3.1) hardy-security; urgency=low
+
+  * SECURITY UPDATE: array index vulnerability
+  * fix for src/libxineadec/xine_speex_decoder.c to properly validate its
+    input
+  * SECURITY UPDATE: buffer overflow in the NSF demuxer
+  * fix for src/demuxers/demux_nsf.c to use strndup() instead of strdup()
+  * References
+    CVE-2008-1686
+    CVE-2008-1878
+
+ -- Jamie Strandboge <jamie@ubuntu.com>  Wed, 30 Jul 2008 15:52:50 -0400
+
+xine-lib (1.1.11.1-1ubuntu3) hardy; urgency=low
+
+  [ Darren Salt ]
+  * Fixes from upstream hg:
+    - Matroska demuxer regression. (Closes: #474316)
+    - PulseAudio plugin backported & re-enabled.
+      This takes precedence over ALSA, but falls back cleanly.
+
+  [ Reinhard Tartler ]
+  * Cherrypick the above changes to the ubuntu package (LP: #176332, #131914)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sat, 12 Apr 2008 23:13:24 +0200
+
+xine-lib (1.1.11.1-1ubuntu2) hardy; urgency=low
+
+  [ Darren Salt ]
+  * Fixes from upstream hg:
+    - Quicktime demuxer regression. (Closes: #473499, #473631)
+    - Wavpack MIME type information.
+
+  [ Reinhard Tartler ]
+    - merge changes from debian packaging hg to fetch fix for
+      LP: #210510
+
+ -- Reinhard Tartler <siretart@tauware.de>  Wed, 02 Apr 2008 11:07:04 +0200
+
+xine-lib (1.1.11.1-1ubuntu1) hardy; urgency=low
+
+  * New upstream Version, merge from debian/unstable.
+    - Freeze exception Granted in LP: #204557
+    - Inclused Security fixes: LP: #195700
+  * Remaining Changes:
+     - add Replaces: libxine-main1 (<< 1.1.2+repacked1-0ubuntu1)
+       in libxine1-bin to make dapper->hardy upgrades work (LP #203605)
+     - Modify Maintainer value to match the DebianMaintainerField
+       specification.
+
+ -- Reinhard Tartler <siretart@tauware.de>  Tue, 01 Apr 2008 09:33:39 +0200
+
+xine-lib (1.1.11.1-1) unstable; urgency=high
+
+  * New upstream release.
+    - CVE-2008-1482: integer overflows in FLV, Qt, Real, WC3Movie, Matroska
+      and FILM demuxers, allowing remote attackers to trigger heap overflows
+      and possibly execute arbitrary code. (Closes: #472639)
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Sun, 30 Mar 2008 15:15:04 +0100
+
+xine-lib (1.1.11-1) unstable; urgency=high
+
+  * New upstream release.
+    - CVE-2008-0073: Array index vulnerability which may allow remote
+      attackers to execute arbitrary code via a crafted SDP parameter in an
+      RTSP stream.
+    - DVD reader code no longer uses UDF-provided file sizes as
+      authoritative. (Closes: #463177)
+
+  [Darren Salt]
+  * Remove the versioning from the libmagick9-dev build-dep.
+  * Disable the pulseaudio plugin (don't build, don't install) and remove
+    the build-dep on libpulse-dev for now due to instability: xine-lib has
+    been observed closing the stream due to audio problems.
+    (Closes: #471676)
+
+  [ Reinhard Tartler ]
+  * add support for 'parallel' keyword in DEB_BUILD_OPTIONS
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Thu, 20 Mar 2008 22:39:24 +0000
+
+xine-lib (1.1.10.1-2ubuntu1) hardy; urgency=low
+
+  * debian/control:
+    - add Replaces: libxine-main1 (<< 1.1.2+repacked1-0ubuntu1)
+      in libxine1-bin to make dapper->hardy upgrades work (LP: #203605)
+  * Modify Maintainer value to match the DebianMaintainerField
+    specification.
+
+ -- Michael Vogt <michael.vogt@ubuntu.com>  Tue, 18 Mar 2008 17:22:33 +0100
+
+xine-lib (1.1.10.1-2) unstable; urgency=low
+
+  [Darren Salt]
+  * libxine-dev: backport an m4 version-parsing fix from hg.
+  * Fixed an off-by-one (introduced in the security fix) which breaks
+    playback of some FLAC files. (Closes: #466746)
+  * Versioned build-dep on libmagick9-dev (for libmagick10). (Closes: #466681)
+    Add libmagick-dev as an alternative, with the same version requirement.
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Wed, 20 Feb 2008 23:43:05 +0000
+
+xine-lib (1.1.10.1-1) unstable; urgency=high
+
+  * New upstream release.
+    - CVE-2008-0486: Array index vulnerability which may allow remote
+      attackers to execute arbitrary code via a crafted FLAC tag, which
+      triggers a buffer overflow. (Closes: #464696)
+    - Real codec detection was looking in the wrong places. (Closes: #462964)
+
+  [Darren Salt]
+  * Add pkg-config dependency to libxine-dev, fixing xine-plugin FTBFS.
+    (Closes: #464178, #464321)
+  * Put libxine1-doc back into section doc until somewhere better is created
+    for it. (Closes: #462710)
+  * No longer build-conflict with libxine-dev from xine-lib-1.2. This is no
+    longer needed due to link order changes.
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Fri, 08 Feb 2008 17:25:21 +0000
+
+xine-lib (1.1.10-1) unstable; urgency=high
+
+  * New upstream release (Closes: #459836)...
+  * ... fixing some security bugs:
+    - CVE-2008-0225: Heap-based buffer overflow in rmff_dump_cont function
+      which allows remote attacker to execute arbitrary code via a crafted
+      SDP Abstract attribute (Closes: #460551).
+      This also acks 1.1.8-3+lenny1 (NMU by the security team).
+    - Related to CVE-2006-1664: Buffer overflow which allows a remote
+      attacker to execute arbitrary code or crash the client program via a
+      crafted ASF header.
+  * ... and fixing some other bugs, including:
+    - Disappearing audio. (Closes: #461970)
+
+  [ Darren Salt ]
+  * Build-depend on gs-gpl | gs. Avoids FTBFS where recommended packages
+    aren't automatically installed.
+  * Put libxine1-doc in section libdevel.
+  * Move libxine1-doc | libxine-doc to Suggests: in libxine1. (Closes: #458103)
+  * Add postinst scripts to ensure that the documentation symlinks are
+    properly created. (This is really dpkg bugginess.) (Closes: #458865)
+  * Standards version 3.7.3; no changes needed.
+
+  [ Reinhard Tartler ]
+  * Actually install xineplug_decode_w32dll.so and xineplug_decode_qt.so
+    on i386. debian/rules accidentally used $< where it should have been
+    $^. Thanks to Gert Kulyk for reporting!                  LP: #182400
+  * Fix XS-Hg-VCS headers in debian/control                  LP: #183886
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Sat, 26 Jan 2008 22:16:28 +0000
+
+xine-lib (1.1.9-1) unstable; urgency=low
+
+  * New upstream release.
+
+  [Darren Salt]
+  * Re-enable the pulseaudio plugin.
+
+  [Reinhard Tartler]
+  * Remove really unnecessary versioned build depends on binutils. Even
+    oldstable (sarge) has a newer version available.
+  * Bug fix: "unable to handle ipv6 MRLs", thanks to Mau (Closes:
+    #448801).
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Thu, 10 Jan 2008 21:57:10 +0000
+
+xine-lib (1.1.8-5) unstable; urgency=low
+
+  [Darren Salt]
+  * Build fix: avoid lots of "make install" invocations (introduced in -4).
+  * Fix dependency issues with respect to documentation symlinks.
+    The problem was an incorrect debian/shlibs.local.	(Closes: #457328)
+  * Use a symlink for libxine1-dbg's documentation (this got missed in -4).
+  * libxine1-bin (-4) should have contained AUTHORS. This is fixed.
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Sat, 22 Dec 2007 17:49:54 +0000
+
+xine-lib (1.1.8-4) unstable; urgency=low
+
+  [Darren Salt]
+  * libxine1-dbg was missing some debug symbols. Fixed by building it after
+    xine-lib's other arch:any packages.
+  * Introduce a new package, libxine1-bin, which contains the binaries
+    formerly in libxine1. Dependencies are moved and updated accordingly.
+    thanks to Bill Allombert.  (Closes: #454267)
+  * Except for libxine1-doc, libxine1-bin and libxine-dev, symlink to
+    libxine1-bin's documentation. (AUTHORS is now in libxine1-bin.)
+  * Backported patches from upstream 1.1 branch:
+    - Fix compilation of DXR3 support with external ffmpeg.
+      This is currently only needed for compilation against libavcodeccvs-dev
+      (from debian-multimedia). Untested with actual DXR3 hardware since I
+      have none.                                           (cset e55bc398cc7c)
+    - Fix a problem with non-seekable Flash video          (cset de8c671a419c)
+    - Fix "missing" channels.conf with ATSC                (cset fd875c4a15bc)
+    - Fix a possible crash when changing channels (DVB)    (cset bf1ec833d87a)
+    - Don't stop reading Ogg streams early                 (cset e4c8ac4a6b49)
+    - Fix a possible crash when a video output is closed   (cset 06494c094761)
+    - Fix a possible crash when video playback is finished (cset 293845e465cc)
+
+  [ Reinhard Tartler ]
+  * Bug fix: "FTBFS with GCC 4.3: missing #includes", thanks to Martin
+    Michlmayr and Daniel Schepler (Closes: #455438, #455322).
+  * Bug fix: "libxine1-plugins: should not depend on libxine1-gnome",
+    thanks to Hermogenes Hebert Pereira Oliveira. (Closes: #454162).
+    Instead, a new package is introduced: libxine1-all-plugins, which
+    additionally depends on the gnome plugin.
+  * remove the jack plugin. According to upstream it is unfinished and of
+    poor quality. A rewrite is available in the 1.2 branch.
+  * adjust dependencies on libxine1-dev and libxine1-dbg
+  * add XS-DM-Upload-Allowed: yes field to debian/control
+  * Bug fix: "xine-lib: FTBFS on GNU/kFreeBSD (debian specific part)",
+    thanks to Petr Salinger (Closes: #449531). Patch applied with some
+    (minor) modifications.
+  * Bug fix: "libxine1: FTBFS on GNU/kFreeBSD", thanks to Uwe Hermann
+    (Closes: #438849). Patch taken from upstream hg repo, cset
+    1db8870cd7c9
+  * Bug fix: "typo "A various plugins" in package description",
+    thanks to Philippe Cloutier (Closes: #455067).
+
+ -- Reinhard Tartler <siretart@tauware.de>  Mon, 17 Dec 2007 17:07:48 +0100
+
+xine-lib (1.1.8-3+lenny1) testing-security; urgency=high
+
+  * Non-maintainer upload by security team.
+  * This update addresses the following security issue:
+    - CVE-2008-0225: Heap-based buffer overflow in rmff_dump_cont function
+    which allows remote attacker to execute arbitrary code via a crafted
+    SDP Abstract attribute (Closes: #460551).
+
+ -- Nico Golde <nion@debian.org>  Sun, 13 Jan 2008 16:12:48 +0100
+
+xine-lib (1.1.8-3) unstable; urgency=low
+
+  [Darren Salt]
+  * Patches from the 1.1.9 dev tree:
+    - Silence "lacing: N" messages from the matroska demuxer.
+    - Extra identifier for MPEG video (in AVIs etc.).
+  * Tighten the dependencies of libxine1 and libxine1-plugins on libxine1-*
+    packages.
+  * Move deps on libxine1-{x,console} from libxine1-plugins to libxine1 to
+    avoid further problems such as bug 448077.
+
+  [ Reinhard Tartler ]
+  * remove gs from build-deps
+  * don't build the pulseaudio plugin. (Closes: #452211, #427991)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sun, 25 Nov 2007 23:20:54 +0100
+
+xine-lib (1.1.8-2) unstable; urgency=low
+
+  [Reinhard Tartler]
+  * use dh_listpackages instead of hardcoded list for determining the
+    provided binary packages.
+  * Bug fix: "Depends->Recommends dependency change breaking other
+    packages", thanks to Christoph Pfister and Sune Vuorela
+    (Closes: #439389)
+    - introduce new package libxine1-misc-plugins, which contains
+      (nearly) all plugins formerly found in the package libxine1.
+    - promote all dependencies of libxine1-misc-plugins to Depends.
+    - Make libxine1 depend on libxine1-plugins | libxine1-misc-plugins.
+      Apt will prefer the first alternative, which results many
+      plugins installed by default. Caveat: If one plugin package has
+      unsatisfiable dependencies, the user will end up with only
+      libxine1-misc-plugins installed.
+    - Make libxine1-plugins depend on libxine1-misc-plugins.
+    - Make libxine1-plugins not depend on libxine1-console.
+    - NB: From now on, frontends need to explicitly depend on either
+      libxine1-x or libxine1-console, depending on whether they are
+      console based (like cacaxine or fbxine) or X11 based (like gxine).
+      libxine1-plugins will not depend on libxine1-x or libxine1-console.
+  * Make libxine1-dev Arch:any. Being arch:all makes a lot of trouble
+    building frontends on architectures that are out of sync.
+  * Remove alternative depends on libz-dev (not found even in oldstable)
+    and slang1-dev (not found in stable, only oldstable) from libxine1-dev.
+  * Add Homepage field to debian/control
+
+  [Darren Salt]
+  * Add patches from upstream:
+    - DVD MRL title.chapter fix
+  * Move libxine1-doc into section "doc".
+  * Improve package descriptions a bit; in particular, a grammatical
+    correction for libxine1-console, and an extra sentence describing common
+    uses of libxine1-ffmpeg.
+  * New package libxine1-x, which contains the X-based video output plugins.
+    These were previously in libxine1.
+  * Move the fb video output plugin into libxine1-console.
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Sat, 20 Oct 2007 18:01:27 +0100
+
+xine-lib (1.1.8-1) unstable; urgency=low
+
+  * New upstream release. (Closes: #440248)
+
+  [Darren Salt]
+  * Remove config.log when cleaning the build tree.
+
+  [Reinhard Tartler]
+  * Bug fix: "libxine1: copyright file references non-existent AUTHORS
+    file", thanks to Felipe Sateler (Closes: #438677).
+
+ -- Darren Salt <linux@youmustbejoking.demon.co.uk>  Mon, 27 Aug 2007 20:59:37 +0100
+
+xine-lib (1.1.7-3) unstable; urgency=low
+
+  * promote dependencies of xineplug_dmx_audio.so from Suggests to
+    Recommends. This is necesarry for e.g. mp3 files or streams
+    (Closes: #437906, #437693),  thanks to François Valenduc and
+    Paulo Marcel Coelho Aragão.
+
+ -- Reinhard Tartler <siretart@tauware.de>  Wed, 15 Aug 2007 09:51:53 +0200
+
+xine-lib (1.1.7-2) unstable; urgency=low
+
+  [Darren Salt]
+  * Enable the wavpack plugin. (Closes: #437331)
+  * Correct the description of libxine-doc. (Closes: #432919, #435590)
+  * Build-depend on libjack-dev.
+  * Enable freetype support. (Closes: #416077)
+  * Add patches from upstream:
+    - allow using ffmpegvideo w/o direct rendering to play mpeg2 ts;
+    - handle escaped characters in DVD MRLs;
+    - fix attempted free of static data, e.g. when using "dvd:/";
+    - rename mrl_unescape & export it (needed by the previous fix).
+    These are csets acc7197f7cca, 2e301bc2cce8, 09e652c8188f & 82bc4a5c2b4c.
+
+  [ Reinhard Tartler ]
+  * libxine1: demote all dependencies of the plugins to Recommends.
+    This includes the directfb plugin and therefore Closes: #427982.
+  * introduce debian/shlibs.local.libxine1 to avoid self-dependency of
+    libxine1. Fixes a lintian warning.
+  * some small changes to package descriptions.
+  * debian/rules: Don't ignore potential failiures in clean when running
+    $(MAKE) distclean. Check for presence instead (thanks lintian).
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sun, 12 Aug 2007 00:38:45 +0200
+
+xine-lib (1.1.7-1) unstable; urgency=low
+
+  * New upstream release.
+    - Built against new FLAC. (Closes: #426677)
+    - The arts plugin is no longer built by default.
+      (Closes: #257368, #354437, #396219)
+    - RealPlayer codec detection works properly now. (Closes: #416245)
+    - vcd playback has been fixed upstream (Closes: #364837)
+
+  [Darren Salt]
+  * Added libxine1-doc. This will be needed once 1.2 is released to avoid
+    problems with xine(5), and is useful now for development purposes.
+  * Made libxine-dev conflict with & replace libxine2-dev for similar reasons.
+  * Since the arts plugin is no longer built:
+    - removed libxine1-kde and the associated build-dep on libartsc0-dev;
+    - made libxine-plugins conflict with and replace libxine1-kde.
+  * Minor package description fixes.
+
+  [Reinhard Tartler]
+  * move the gdk plugin to the libxine-gnome package
+  * make watch file using the qa.debian.org sf redirector
+  * add -lpthread to PTHREAD_LIBS on mipsen
+
+ -- Reinhard Tartler <siretart@tauware.de>  Thu, 07 Jun 2007 16:05:20 +0200
+
+xine-lib (1.1.6-2) unstable; urgency=low
+
+  * upload to unstable since we finally have now all needed dependencies
+    available.
+  * restore a lot of the lost changelogs from
+    http://changelog.debian.net/xine-lib
+
+ -- Reinhard Tartler <siretart@tauware.de>  Thu, 31 May 2007 10:47:34 +0200
+
+xine-lib (1.1.6-1) experimental; urgency=low
+
+  [ Reinhard Tartler]
+  * add libxcb-xv0-dev, libxcb-shm0-dev, libxcb-shape0-dev to build
+    dependencies and enable xcb support
+  * make libxine1 an arch: all package, no architecture dependent part
+    inside there.
+  * make xine-lib binNMU safe
+  * fetch po/de.po from upstream hg repo, which was updated shortly after
+    the 1.1.6 release
+  * Darren added himself as comaintainer
+
+  [ Darren Salt]
+  * New upstream release.
+    - Patches dropped, since they all came from upstream.
+    - More debug compilation failures fixed. (Closes: #339523)
+  * Patches imported from upstream since 1.1.6 release:
+    - limit common-case buffer copying optimisation to i386 & amd64
+
+ -- Reinhard Tartler <siretart@tauware.de>  Thu, 19 Apr 2007 16:47:23 +0200
+
+xine-lib (1.1.5-2) experimental; urgency=low
+
+  * add libjack0.100.0-dev to build depends, fixes FTBFS
+
+ -- Reinhard Tartler <siretart@tauware.de>  Thu, 12 Apr 2007 14:40:33 +0200
+
+xine-lib (1.1.5-1) experimental; urgency=low
+
+  * new upstream release!
+  * whitespace-cleanup in debian/control
+  * Builds again on sparc (Closes: #410538)
+  * build again against externel ffmpeg found in experimental
+  * cleanup/clarify the package descriptions, mentioning the included plugins
+    (Closes: #410426)
+  * remove xineplug_decode_real_audio.so from debian/libxine1.install;
+    it has been dropped upstream.
+  * add libdirectfb-dev to build depends, enabling directfb support
+  * use external musepack libs
+  * import manpage fix from upstream
+  * add XS-Vcs headers pointing to alioth
+
+  [Darren Salt]
+  * Enabled the gdkpixbuf plugin.
+  * Split up the DirectFB code, building separate plugins for X11 and
+    console. (Applied upstream.)
+  * Added a note about the packaging repository to README.Debian.
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sun,  8 Apr 2007 19:21:08 +0200
+
+xine-lib (1.1.4-2) experimental; urgency=low
+
+  * merge changes from ubuntu
+  * make build deps multiline
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sun,  4 Feb 2007 12:06:25 +0100
+
+xine-lib (1.1.4-1ubuntu2) feisty; urgency=low
+
+  * install shlibs.local file to tighten dependency on libxine1
+  * add build dependency on libmagick9-dev to build to 
+    dmx_image and decoder_image plugin. Also add them to libxine1.install
+  * install the xine(5) manpage to package libxine1
+  * Bumb shlibs file (forgotten in 1.1.4-1)
+  
+ -- Reinhard Tartler <siretart@tauware.de>  Sun,  4 Feb 2007 09:05:58 +0100
+
+xine-lib (1.1.4-1ubuntu1) feisty; urgency=low
+
+  * merge new upstream release from debian
+
+ -- Reinhard Tartler <siretart@tauware.de>  Mon, 29 Jan 2007 15:48:31 +0100
+
+xine-lib (1.1.4-1) experimental; urgency=low
+
+  * New upstream release!
+  * Tons of bugfixes, see /usr/share/doc/libxine1/changelog.gz
+  * Now playes sound in *.flv files (Closes: #396161)
+  * use internal ffmpeg copy for now, since debian's copy is too old :(
+    Will reenable building against debian's ffmpeg ASAP.
+  * add libpulse-dev to build depends, enable pulseaudio support
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sat, 27 Jan 2007 18:26:09 +0100
+
+xine-lib (1.1.3-1ubuntu2) feisty; urgency=low
+
+  * debian/control: Add libpulse-dev to build dependencies to enable
+    PulseAudio output support.
+  * debian/libxine1.install: Add xineplug_ao_out_pulseaudio.so to
+    list of installed plugins.
+
+ -- Daniel T Chen <crimsun@ubuntu.com>  Wed, 24 Jan 2007 23:31:42 -0500
+
+xine-lib (1.1.3-1ubuntu1) feisty; urgency=low
+
+  * Introduce new package libxine-extracodecs to faciliate upgrades
+  * merge from 1.1.3 branch for debian/experimental. 
+  * additional patch: fix ftbfs on kFreeBSD
+  
+  * ubuntu specific changes:
+
+    - libxine-main1 and libxine1-ffmpeg dummy package for upgrades from
+      dapper. Keep this package until (and including) the next LTS 
+      release of ubuntu!
+
+ -- Reinhard Tartler <siretart@tauware.de>  Wed,  3 Jan 2007 22:12:20 +0100
+
+xine-lib (1.1.3-1) experimental; urgency=low
+  
+    * New upstream fixes: "support for xvid files", thanks to
+      \[ATR\]Dj-Death (Closes: #319805).
+    * New upstream fixes: "libxine1: Jack output plugin missing", thanks to Tanu
+      Kaskinen (Closes: #392619).
+    * plays vorbis files again (Closes: #400274)
+    * Introduce new packages: libxine1-ffmpeg and libxine1-gnome to tighten
+      dependencies.
+      - splitting out libxine1-gnome works around Bug: "libxine1: remote
+      streams do not work without non-dependency libgnomevfs2-0", thanks to
+      Michael Marsh (adresses: #309040).
+      - splitting out libxine-kde works around bugs #257368, #354437
+    * Bump to debhelper compat 5
+    * disable gdk (fixing ftbfs) and vidix (as being unmaintained) for
+      now. Please contact me if you are willing and able to test it
+      extensively
+    * apply textrel patch from gentoo
+    * add transfig, gs, sgmltools-lite to build deps to build developer
+      documentation as well
+    * apply patch for freebsd support. Thanks to Aurelien Jarno <aurel32@debian.org>.
+      (Closes: #325489)
+
+    [Darren Salt]
+    * Updated the watch file - should work regardless of changes at Souceforge.
+
+ -- Reinhard Tartler <siretart@tauware.de>  Wed,  3 Jan 2007 19:57:43 +0100
+
+xine-lib (1.1.3-0ubuntu1) feisty; urgency=low
+
+  * disable jack output plugin because jack is not in main
+  * merge from unreleased 1.1.3 branch targeted for debian. ubuntu
+    specific changes:
+
+    - libxine-main1 dummy package for upgrades from dapper. Keep this
+      package until (and including) the next LTS release of ubuntu!
+
+ -- Reinhard Tartler <siretart@tauware.de>  Tue,  2 Jan 2007 23:05:20 +0100
+
+xine-lib (1.1.3-0) UNRELEASED; urgency=low
+
+  * New upstream fixes: "support for xvid files", thanks to
+    \[ATR\]Dj-Death (Closes: #319805).
+  * plays vorbis files again (Closes: #400274)   
+  * Introduce new packages: libxine1-ffmpeg and libxine1-gnome to tighten
+    dependencies.   
+    - splitting out libxine1-gnome works around Bug: "libxine1: remote
+    streams do not work without non-dependency libgnomevfs2-0", thanks to
+    Michael Marsh (adresses: #309040).
+    - splitting out libxine-kde works around bugs #257368, #354437
+  * built against internal ffmpeg
+  * Bump to debhelper compat 5
+  * disable gdk (fixing ftbfs) and vidix (as being unmaintained) for
+    now. Please contact me if you are willing and able to test it
+    extensively
+  * apply textrel patch from gentoo
+  * add transfig, gs, sgmltools-lite to build deps to build developer
+    documentation as well
+  * make libxine1 recommend libxine1-ffmpeg so it gets installed by default
+  * apply patch for freebsd support. Thanks to Aurelien Jarno <aurel32@debian.org>. 
+    (Closes: #325489)
+
+  [Darren Salt]
+  * Updated the watch file - should work regardless of changes at Souceforge.
+  
+ -- Reinhard Tartler <siretart@tauware.de>  Tue,  2 Jan 2007 22:14:14 +0100
+
+xine-lib (1.1.2+repacked1-0ubuntu2) edgy; urgency=low
+
+  * undo backport of this commit because of FTBFS on powerpc, ia64 and sparc:
+    -  [xine-lib @ 2006-07-12 21:08:46 by dsalt]
+       Tidy up the formatting of tvtime method help texts to allow better wrapping
+       by the front end.
+  * add recommends on libxine-extracodecs (recloses Malone #56699)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Fri, 22 Sep 2006 20:10:04 +0200
+
+xine-lib (1.1.2+repacked1-0ubuntu1) edgy; urgency=low
+
+  * repacked the orig tarball. We can get rid of most diff by enabling
+    --enable-external-ffmpeg
+  * revert the caca related backport from upstream, we will keep the
+    old libcaca for edgy
+  * -dbg package is Priority: extra
+  * remerged with debian. Changes:
+    - ripped of plugins from the sources (see xine-extracodecs):
+      + ffmpeg
+      + faad
+      + libmad (mp3 plugin)
+    - fix FTBFS in src/post/deinterlace/plugins/greedy2frame_template.c by
+      adding src/post/deinterlace/plugins/mangle.h from
+      src/libffmpeg/libpostproc.
+    - libxine-main1 dummy package for upgrades from dapper. Keep this
+      package until (and including) the next LTS release of ubuntu!
+    - tighten build dependency on binutils according to dh_strip manpage
+    - insert a copy of libpostproc (from upstream source tarball) at
+      src/libpostproc. Actually, this is how it was in the previous ubuntu
+      package. Note that this is only for the planar postprocessing plugin,
+      which should be moved to the xine-extracodecs package in an later
+      upload.
+    - Adjust configure.ac, src/Makefile.am and src/post/planar/Makefile.am
+      for the new location of libpostproc
+
+ -- Reinhard Tartler <siretart@tauware.de>  Tue, 12 Sep 2006 22:28:12 +0200
+
+xine-lib (1.1.2+dfsg-4) unstable; urgency=low
+
+  * Very focused patches from upstream:
+  * src/input/net_buf_ctrl.c: Fix a div-by-zero crash
+  * xine-lib/src/input/input_http.c: http parsing fix
+  * don't disable alignment of stack variables. Patch applied upstream,
+    got extensive testing in ubuntu, upstream and experimental. Does avoid
+    a confusing warning in the ffmpeg plugin.
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sun, 18 Mar 2007 00:49:32 +0100
+
+xine-lib (1.1.2+dfsg-3) unstable; urgency=high
+
+  * [CVE-2007-1246]: DMO decoder heap allocation overflow. Thanks for the
+    patch, Kees Cook and A Mennucc! (Closes: #414072)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Fri,  9 Mar 2007 09:37:43 +0100
+
+xine-lib (1.1.2+dfsg-2) unstable; urgency=medium
+
+  * Bug fix: "CVE-2006-6172: xine-lib libreal Buffer Overflow
+    Vulnerabilities", thanks to Stefan Fritsch (Closes: #401740).
+
+ -- Reinhard Tartler <siretart@tauware.de>  Wed,  6 Dec 2006 22:15:11 +0100
+
+xine-lib (1.1.2+dfsg-1) unstable; urgency=medium
+
+  * Urgency medium for fixing release critical bug
+  * replace cetus.ttf with a new one based on FreeSans.ttf. Many thanks go
+    to Sune Vuorela for creating this! (Closes: #393677)
+  * apply patch from http://bugzilla.gnome.org/show_bug.cgi?id=344592 to
+    fix title menu if there is no DVD menu. (Closes: #369319)
+  * rename to XS-X-Vcs-Bzr field
+
+ -- Reinhard Tartler <siretart@tauware.de>  Thu, 26 Oct 2006 23:16:12 +0200
+
+xine-lib (1.1.2-6) unstable; urgency=low
+
+  * change override for -dbg package to extra
+  * added X-Vcs-Bzr tag to the source package
+  * revert the following commit from upstream, because it causes FTBFS on
+    many arches:
+    -  [xine-lib @ 2006-07-12 21:08:46 by dsalt]
+        Tidy up the formatting of tvtime method help texts to allow better wrapping
+        by the front end.
+
+ -- Reinhard Tartler <siretart@tauware.de>  Fri, 22 Sep 2006 21:49:56 +0200
+
+xine-lib (1.1.2-5) unstable; urgency=low
+
+  * Urgency kept low despite RC bug. (only FTBFS bug, does not affect testing)
+  * fetched patches from 1.1.3 branch:
+   -  [xine-lib @ 2006-07-12 21:08:46 by dsalt]
+       Tidy up the formatting of tvtime method help texts to allow better wrapping
+       by the front end.
+   -  [xine-lib @ 2006-07-21 03:31:42 by dgp85]
+       Fix building with LOG enabled.
+   -  [xine-lib @ 2006-07-21 04:47:17 by dgp85]
+       When trying to get the langinfo code, first of all, set the locale,
+       or you'll always get ANSI/ASCII.
+   -  [xine-lib @ 2006-08-05 13:31:13 by hadess]
+       use the gdkpixbuf loader to handle JPEG stills in Quicktime movies, as
+       the ffmpeg MJPEG decoder isn't appropriate
+   -  [xine-lib @ 2006-08-05 13:34:42 by hadess]
+       avoid crashing when the FLAC file is broken
+   -  [xine-lib @ 2006-08-08 03:15:02 by miguelfreitas]
+         patch by Chris Brien
+         1) Return the stream length correctly. This fixes a FIXME.
+         2) Set the width and height metadata.
+         3) Reset the demuxer status to DEMUX_OK on seek.
+       (in  src/demuxers/demux_rawdv.c)
+   -  [xine-lib @ 2006-08-08 03:34:15 by miguelfreitas]
+        video/x-ms-wma -> audio/x-ms-wma
+        (in src/demuxers/demux_asf.c)
+        Update API for libcaca 0.99. Patch by cjacker huang.
+        Update libcaca check to use the pkg-config file shipped with libcaca
+        0.99, and change --disable-caca to --without-caca (to conform with
+        other external libraries).
+        Remove reference to removed caca.m4 (libcaca 0.99 will use
+        pkg-config).
+        Removed m4/caca.m4 (Closes: #386745)
+  * Dropped Replaces on xine-dvdnav (only in woody) and xine (only in
+    potato!)
+  * Dropping Conflicts on sinek and xine-ui (<< 0.9.10) (all only woody)
+  * cleaning m4/caca.m4, no longer used
+  * removing doc/faq/faq.html doc/faq/faq.txt doc/hackersguide/hackersguide.html 
+    on clean, missed by build system
+  * include some targets to build 'orig' tarballs from the current branch.
+    This mainly for my convinience for bootstrapping cvs versions of xine and
+    preparing tarballs for the 'main' section of ubuntu, which I carry here in
+    order to minimize divergence
+
+ -- Reinhard Tartler <siretart@tauware.de>  Thu, 14 Sep 2006 21:27:27 +0200
+
+xine-lib (1.1.2-4) unstable; urgency=low
+
+  * build against external liba52
+  * Bug fix: "libxine1: Please use the Debian ffmpeg version", thanks to
+    Josselin Mouette. Please note that the ffmpeg version used has WMV3
+    support. Unfortunately, this version of xine cannot use that support
+    yet. This is 1.1.3 stuff. (Closes: #367095).
+  * Bug fix: "libxine1: Please support m4b files", thanks to Johannes
+    Adams. Bugfix by copying src/demuxers/demux_qt.c from CVS
+    version. (Closes: #384435).
+  * Build against internal libvcdinfo for now and add libvcdinfo-dev to
+    build-conflicts. This is a workaround for Bug: #364837, using internal
+    libvcdinfo makes the segfault go away.
+  * install a note for reportbug users
+  * cleanup (actually remove) confusing and unnecessary documentation.
+  * fetch bug from upstream cvs to fix bug where incorrect aspect ratio was
+    being passed to post plugins up (src/post/planar/expand.c, rev 1.16)
+  * add build dependency on sgmltools-lite to build faq
+  * add build dependencies transfig and gs to correctly build the
+    hackersguide
+  * bump shlibs to this revision because of changes in libcaca output plugin
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sun, 27 Aug 2006 21:41:58 +0200
+
+xine-lib (1.1.2-3) unstable; urgency=low
+
+  * backport fix for cdda:/ MRL from upstream (Closes: #276728)
+  * add note from darren to xine(5) as well
+  * fix totem-xine crashing when started with no argument (closes: #370283)
+    (patch taken from upstream)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sat, 12 Aug 2006 00:27:15 +0200
+
+xine-lib (1.1.2-2) unstable; urgency=high
+
+  Urgency high because of security related upload
+
+  * readd debian/watch file
+  * update debian/rules from CVS. more complete handling of noauto flag
+    to prevent running auto* tools.
+  * disable AC_C_ALWAYS_INLINE from configure.ac. Should fix FTBFS on a
+    number of architectures. (Closes: #378043)
+  * added patch from Darren Salt to fix build with -O0 on at least amd64
+    in src/libffmpeg/libavcodec/i386/Makefile.am
+  * Imported further fixes from upstream CVS:
+    +  src/input/input_dvb.c
+    + src/xine-utils/xine_mutex.c
+  * Imported security fix for included copy of libmms from upstream CVS,
+    (e.g. USN-315-1)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Thu, 13 Jul 2006 21:51:46 +0200
+
+xine-lib (1.1.2-1) unstable; urgency=low
+
+  * New upstream release: 1.1.2
+  * use internal ffmpeg for upload to unstable, we will reinvestigate again
+    in experimental later..
+  * [sparc] Upstream fixed '--enable-vis'. So if compiling with vis, we are
+    using -mcpu=v9. This creates binaries, which probably segfault on 'true'
+    sparc32, but these poor old machines are not going to have much fun with
+    xine anyway... If there is an increasing demand for non-vis sparc
+    binaries, please contact me
+  * updated README.Debian
+  * use AM_MAINTAINER_MODE in configure.ac again
+
+  [Darren Salt]
+  * Option to prevent autogen.sh from being run on package build.
+    Use DEB_BUILD_OPTIONS='noauto'.
+
+ -- Reinhard Tartler <siretart@tauware.de>  Wed, 12 Jul 2006 09:53:38 +0200
+
+xine-lib (1.1.1+cvs20060702-1) experimental; urgency=low
+
+  * new CVS snapshot, including fix for FTBFS on arm
+  * compiling with -mcpu=ultrasparc to avoid FTBFS
+  * updated cvs snapshot
+
+ -- Reinhard Tartler <siretart@tauware.de>  Fri, 30 Jun 2006 22:35:06 +0200
+
+xine-lib (1.1.1+cvs20060624-1) experimental; urgency=low
+
+  * new upstream snapshot, featuring (from upstream ChangeLog)
+    + Security fixes:
+      - CVE-2005-4048: possible buffer overflow in libavcodec (crafted PNGs).
+      - CVE-2006-2802: possible buffer overflow in the HTTP plugin.
+      - possible buffer overflow via bad indexes in specially-crafted AVI files
+    + Also look for Xv support in /usr/lib for X.org's new location
+    + Support for Vorbis-style comments in FLAC files (Closes: #354188)
+    + Add ATSC support to the DVB plugin (Closes: #287875)
+    + Fix up health check to find libX11 and libXv shared objects even if
+      devel packages aren't installed (where appropriate). (Ubuntu 47357)
+    + Fix install problems in case configure was generated by autoconf >= 2.59c.
+      (already included in older debian upload)
+    + Add support for RealPlayer 10 codecs (from SUSE) (Closes: #274180)
+  * add w3m to build-depends
+  * New upstream fixes implicit pointer conversion. Thanks David Mosberger for
+    testing (Closes: #360003)
+  * cleanups in debian/rules
+  * use external (debian) ffmpeg
+  * run autohell on build time (read: on the buildds)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sat, 24 Jun 2006 13:22:26 +0000
+
+xine-lib (1.1.1-3) UNRELEASED; urgency=low
+
+  * (re)introduce libxine1-dbg package. (Closes: #373135)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Wed, 14 Jun 2006 11:27:35 +0200
+
+xine-lib (1.1.1-2) unstable; urgency=medium
+
+  [ Reinhard Tartler ]
+
+  * Use external libmad, acknowledging NMU (Closes: #336437)
+  * enable support for libxvmc1, now that we have xorg in debian
+    (Closes: #281572)
+  * Conflict/Replaces obsolete package 'xine' (Closes: #300852)
+  * Incorporated Darren's changes into a new maintainer upload.
+  * medium urgency, although security fixes a lot of other functionality
+    changes
+  * Some more fixages to inline usage in internal copy of ffmpeg, continuing
+    the patch from Darren Salt.
+  * Verified that this upload fixes build on mips, and other build failiures
+    look pretty similar. Therefore (Closes: #354436)
+  * Verified that /usr/share/doc/libxine1/faq/faq.{html,txt} is now installed
+    correctly (Closes: #369658)
+  * fix gnome-vfs plugin to allow play back of http URLs again. Patch from
+    upstream CVS, thank you for pointing this out, Sam Morris (Closes: #369974)
+
+  [ Darren Salt ]
+
+   * SECURITY FIXES (closes: #369876):
+    - Possible buffer overflow in the AVI demuxer, caused by
+      specially-crafted files or streams;
+    - Possible buffer overflow in the HTTP header-fetching code.
+      (CVE-2006-2802)
+
+  * Tidy up the FAQ list and README installation to quieten dh_install.
+  * Re-update the FSF address in debian/copyright. It got lost in 1.1.1-1.
+  * Add build-dep alternatives for those of us who do backports to sarge.
+  * Tidy up the package descriptions a little.
+  * Bump shlibs to >= 1.1.0 due to new functions. (Closes: #358429, #368247)
+  * Empty config file no longer prevents the config from being saved.
+    (Fixed in upstream 1.1.1) (Closes: #320164)
+  * Pulled in some patches from CVS:
+    - the above security fixes;
+    - fix ALSA resume-from-suspend;
+    - fix incorrect size calculation in interlaced Matroska demuxing;
+    - various uninitialised variables, some of which should be non-zero;
+    - HTTP MRLs requiring authentication would only work when using a proxy;
+    - fix possibly-broken locale handling in the SMB input plugin;
+    - avoid problems where the ffmpeg audio decoder can't find a codec;
+    - avoid a couple of compiler warnings (libavutil);
+    - fix up some typecasting in the win32 codec interface;
+    - avoid problems with negative sizes (general demuxing);
+    - some plugin cache reading code should also be used on ia64;
+    - fix a couple of printf warnings on 64-bit;
+    - add some locking around playback speed change code;
+    - incorrect default CPU acceleration setting on powerpc;
+    - fix crash at startup if VO deinterlacing is enabled, onefield_xv is
+      selected and the image format is YV12;
+    - avoid possible segfault with 1x1 PNGs when handled by the ffmpeg plugin;
+    - wrong names used for libX11 and libXv in the health check code (we now
+      detect the correct names at build time);
+    - add a missing -I to src/libffmpeg/libavcodec/sparc/Makefile.am (should
+      fix an FTBFS on sparc);
+    - alter configure.ac to avoid FTBFS when configure is regenerated with
+      autoconf 2.59c or later.
+  * Add AM_MAINTAINER_MODE.
+  * Fix usage of inlined functions in libffmpeg before they're defined. This is
+    not implemented for all architectures in gcc 4.0.x and was causing FTBFS.
+  * Kill some pointer<->int casting warnings on 64-bit architectures. (Taken
+    from CVS HEAD)
+
+ -- Reinhard Tartler <siretart@tauware.de>  Mon, 12 Jun 2006 18:16:30 +0200
+
+xine-lib (1.1.1-1.1) unstable; urgency=low
+
+  * NMU.
+  * Use external libmad, which fixes crashes on amd64 on apps loading both
+    libxine1 and libmad0. (Closes: #336437)
+  * Pass --with-xv-path=/usr/lib to configure, since otherwise Xv support was
+    lost when compiling against modular X.
+
+ -- Adeodato Simó <dato@net.com.org.es>  Sat, 15 Apr 2006 19:34:33 +0200
+
+xine-lib (1.1.1-1) unstable; urgency=low
+
+  * New upstream release! (Closes: #326936, #353150, #332919)
+
+  [ Reinhard Tartler ]
+    - adding myself to uploaders
+    - Remove build dependencies on xlibs-dev, as well as alternatives on
+      xlibs-dev-static. Debian is on its way towards X11R7!
+      (Closes: #337997, #346488, #345499, #342208, #347162)
+    - Rechecking the long list of NMUs. Thanks to all submitters!
+
+  [ Darren Salt ]
+    - Add debian/watch file for uscan.
+    - Convert debian/copyright to UTF-8.
+    - Add build-deps on libxv-dev and libvcdinfo-dev.
+    - Bump standards version to 3.6.2
+    - Make "post-Sarge"-tagged changes to debian/rules and strip debian/tmp/
+      from debian/*.install.
+    - Remove *.gmo on clean (Just In Case). (Closes: #338000)
+    - Do a little preparation for a possible -dbg package.
+
+  * Acknowledge NMUs.
+    - Backports and gcc 4.0 fixes dropped since they're already in this version.
+      Closes: #288189, #318838   
+    - slang transition: Closes: #315986
+    - aalib transition: Closes: #320317, #323276
+    - flac transition: Closes: #325960 
+    - fix of dependency generation script debian/shlibdeps.sh: 
+      Closes: #326935, #327203, #328168, #328184, #328265, #328454
+    - fix bashism in debian/rules: Closes: #337996
+
+ -- Reinhard Tartler <siretart@tauware.de>  Sun, 19 Feb 2006 18:34:51 +0100
+
+xine-lib (1.0.1-1.6) unstable; urgency=low
+
+  * NMU - Brown paper bag release
+  * debian/control:
+  - make libxine-dev depend on the same -dev packages it build-depends on
+    instead of depending on xlibs-dev (Closes: #347162)
+
+ -- Gustavo Noronha Silva <kov@debian.org>  Wed, 11 Jan 2006 17:32:43 -0200
+
+xine-lib (1.0.1-1.5) unstable; urgency=high
+
+  * Non-maintainer upload.
+  * debian/control:
+  - updated build-depends to no longer depend on the xlibs-dev package,
+    but on the split up packages it really needs
+    (Closes: #337997, #347162, #346488, #345499)
+  * debian/patches/heap-overflow-fix.diff:
+  - security fix for CVE-2005-4048 (Closes: #342208)
+    + urgency high because of this fix
+  * debian/copyright:
+  - updated FSF's address
+
+ -- Gustavo Noronha Silva <kov@debian.org>  Wed, 11 Jan 2006 00:56:18 -0200
+
+xine-lib (1.0.1-1.4) unstable; urgency=high
+
+  * Non-maintainer upload for RC-(security-)bugs.
+  * Apply patch from Ulf Harnhammar fixing a format string vulnerability
+    in CDDB response parsing (CVE-2005-2967, Closes: #332919, #333682).
+  * Fix bashism in debian/rules causing a FTBFS (Closes: #337996).
+
+ -- Thijs Kinkhorst <kink@squirrelmail.org>  Wed, 23 Nov 2005 09:42:39 +0100
+
+xine-lib (1.0.1-1.3) unstable; urgency=low
+  * Non-maintainer upload.
+
+  * Backport patch from 1.0.2 that fixes hard hang-ups when a plugin listed in
+    ~/.xine/catalog.cache becomes unloadable (closes: #328454). Plugins can   
+    become unloadable if DT_NEEDED libraries get uninstalled, which is
+    possible because the package lists many of these libraries in the 
+    Recommends or Suggests fields only. With this fix, amarok should not
+    freeze with the XINE engine anymore (closes: #327203), and totem either
+    (closes: #328265).
+
+    Patch included in debian/patches/fix-hangs-at-load-time.diff, but since
+    there's no patch applying code in debian/rules, it's present in the
+    .diff.gz as well.
+
+  * Fix the script that invokes dpkg-shlibdeps to split dependencies among
+    Depends, Recommends, and Suggests: it generated empty fields if one of the
+    expected plugins was not actually available. (Closes: #328184)
+
+    This means that now the package now suggests libgnomevfs2-0 (closes:
+    #326935) and libflac7 (closes: #328168). Submitters may wish to reopen if
+    they want a discussion with the maintainer about the need of these being 
+    strong Depends instead of Suggests.
+
+  * xineplug_flac.so now links against libflac7 instead of libflac6, which
+    closes: #325960 (the FLAC transition bug).
+
+ -- Adeodato Simó <asp16@alu.ua.es>  Thu, 15 Sep 2005 14:54:50 +0200
+
+xine-lib (1.0.1-1.2) unstable; urgency=low
+
+  * NMU.
+  * The -dev package should depends on libslang2-dev not
+    slang1-dev(Closes: #323276)
+
+ -- Christian Marillat <marillat@debian.org>  Tue, 16 Aug 2005 09:13:42 +0200
+
+xine-lib (1.0.1-1.1) unstable; urgency=medium
+
+  * Non-maintainer upload.
+  * Medium-urgency upload for RC bugfixes.
+  * Multiple fixes for compatibility with gcc 4.0 strictness
+    (closes: #288189, #318838)
+  * This rebuild also gets rid of the dependency on libslang1
+    (closes: #315986); it only trades it for libslang2 unfortunately, 
+    since libcaca is a static lib.
+  * Build-Depend on libaa1-dev instead of the removed aalib1-dev
+    (closes: #320317).
+  * Build-Depend on libxinerama-dev instead of on xlibs-static-dev,
+    which no longer provides this lib; it should be rolled back into
+    xlibs-dev as a dependency eventually, but build-depending on it 
+    directly is sensible anyway.
+  * Disentangle xine from libraries it doesn't actually use directly, so
+    that the dependency tree is less brittle and requires fewer rebuilds
+    in the future (e.g., it currently has a dependency on libstdc++5
+    that it shouldn't need at all); this is doubly important since some
+    plugins aren't mentioned at all in the dependencies, and so can be 
+    left unusable by library changes:
+    - relibtoolize the package to use the Debian version of libtool,
+      with support for pruning indirect dependencies from the linker
+      commandline
+    - as part of the above, add AM_MAINTAINER_MODE to configure.ac to
+      avoid any need for autotools build-dependencies
+    - hard-code -lmodplug, -lartsc, and -lgnomevfs-2, because pkg-config,
+      artsc-config, etc. spit out lib dependencies that are spurious on  
+      GNU/* systems.
+
+ -- Steve Langasek <vorlon@debian.org>  Wed,  3 Aug 2005 04:21:06 -0700
+
+xine-lib (1.0.1-1) unstable; urgency=high
+
+  * new upstream release
+    * fixes MMST and RTSP vulnerabilities (CAN-2005-1195, closes: #305343)
+    * presumably fixes Ogg/Vorbis/Theora audio sync (closes: #301901)
+    * fixes typo in xine-check subsystem (closes: #292341)
+  * build-depends on libsdl1.2 (closes: #297435)
+  * allow installing libxine1-dev with slang1-utf8-dev (closes: #304865)
+  * moved documentation to policy compliant directories (closes: #303463)
+  * made Vorbis and Theora hard dependancies (workaround closes: #288331)
+
+ -- Siggi Langauf <siggi@localhost.localdomain>  Wed, 27 Apr 2005 12:41:46 +0200
+
+xine-lib (1.0-1) unstable; urgency=high
+
+  * new upstream release
+    * links libXv dynamically (closes: #287186)
+  * updated build dependancies:
+    * added libcaca (colored ASCII art) support
+    * added theora support
+    * added libsmbclient based SMB input plugin in addition to the gnomevfs one
+    * added libmodplug based support for various tracker formats
+    * added MNG support via libmng
+  * added vulnerability IDs in 1-rc8-1 changelog
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 26 Dec 2004 12:20:24 +0100
+
+xine-lib (1-rc8-1) unstable; urgency=high
+
+  * new upstream release (closes: #286030)
+    * fixes PNM and RTSP related security vulnerabilities (closes: #286077)
+      This has been assigned CAN-2004-1188.
+    * fixes DVB playback for fullfeatured cards (possibly closes: #281873)
+  * added patch to fix aiff vulnerability (CAN-2004-1300, closes: #285899)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 22 Dec 2004 11:31:09 +0100
+
+xine-lib (1-rc7-1) unstable; urgency=medium
+
+  * New upstream release
+    * new DVB subsystem (closes: #223541, #223555, #223562)
+    * makes Win32 DLL loader work with 2.6 kernels (closes: #265455)
+  * added more explicit dependancy on libpng12-dev, so maybe
+    "apt-get build-dep xine-lib" will work again...
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 10 Nov 2004 09:26:46 +0100
+
+xine-lib (1-rc6a-1) unstable; urgency=high
+
+  * new upstream release (closes: #263418)
+    * fixes buffer overflow with vcd:// MRLs (closes: #265061)
+  * merged Frank and Steve's NMU patch (closes: 270884)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 27 Sep 2004 00:22:28 +0200
+
+xine-lib (1-rc5-1.1) unstable; urgency=high
+
+  * Non-maintainer upload, prepared by Steve Langasek and me
+  * High-urgency upload for a sarge-targetted RC fix.
+  * Use --build, not --host, to specify the architecture; otherwise
+    autoconf thinks we're cross-compiling when we aren't.
+  * src/libffmpeg/libavcodec/sparc/dsputil_vis.c et al: make this code
+    conditional on ENABLE_VIS, since that's what that define is for;
+    fixes FTBFS on sparc when using a 32-bit target (closes: #270884).
+  * Add patch to fix overflows when handling vcd:// MRLs
+    (closes: #265061).
+
+ -- Frank Lichtenheld <djpig@debian.org>  Sun, 26 Sep 2004 02:22:51 +0200
+
+xine-lib (1-rc5-1) unstable; urgency=medium
+
+  * New upstream release (closes: #258274)
+    * fixes MPEG demuxer selection (closes: #249247)
+    * suppresses warning about skipped frames on fast-fwd (closes: #255125)
+  * re-processed autogen.sh, so Debian's libtool is used (closes:  #251584)
+  * passing CFLAGS explicitly to make (closes: 251103)
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 11 Jul 2004 21:01:43 +0200
+
+xine-lib (1-rc4a-1) unstable; urgency=high
+
+  * new upstream version
+    - fixes display errors with popular (Matrox, ATI) graphics cards
+
+  This version, as 1-rc4 before, contains a security fix for the RTSP
+  vulnerability (XSA-2004-3, Bug#247353)
+
+ -- Siggi Langauf <siggi@debian.org>  Thu, 13 May 2004 07:04:14 +0200
+
+xine-lib (1-rc4-1) unstable; urgency=low
+
+  * New upstream release
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 28 Apr 2004 20:28:02 +0200
+
+xine-lib (1-rc3c-1) unstable; urgency=low
+
+  * new upstream version
+    - includes workaround for XV_HUE bug on NVidia cards (closes: #238433)
+  * build-depends on libpng-dev for PNG support (closes: #240524)
+  * build-depends on libfreetype6-dev for TTF support (closes: #242031)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed,  7 Apr 2004 23:58:08 +0200
+
+xine-lib (1-rc3b-1) unstable; urgency=low
+
+  * new upstream release
+    - lots of bug fixes (see upstream ChangeLog), including:
+    - allows devfs compatible DSP device names (closes: #193459)
+    - Michel's segfault patch (closes: #22875)
+
+ -- Siggi Langauf <siggi@debian.org>  Tue, 16 Mar 2004 22:43:36 +0100
+
+xine-lib (1-rc3a-2) unstable; urgency=high
+
+  * updated shlibs: 1-rc3(a) provides new OSD functions (will close: 225618)
+  * fixed OSS plugin initialization code (closes: 225275)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 31 Dec 2003 15:41:17 +0100
+
+xine-lib (1-rc3a-1) unstable; urgency=high
+
+  * new upstream release
+    * fixes ABI compatibility (closes: 224931)
+  * audio demuxer group is loaded again (closes: 225158)
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 28 Dec 2003 11:56:16 +0100
+
+xine-lib (1-rc3-2) unstable; urgency=low
+
+  * merged some updates from upstream CVS:
+    * define SCSI_BLK_MAJOR macro for kernel 2.6 (closes: 224695)
+    * fix endianness for arts audio (closes: 190356)
+
+ -- Siggi Langauf <siggi@debian.org>  Tue, 23 Dec 2003 01:38:29 +0100
+
+xine-lib (1-rc3-1) unstable; urgency=low
+
+  * new upstream release
+    * builds libxine with -fPIC on all architectures (closes: #217140)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 15 Dec 2003 11:49:25 +0100
+
+xine-lib (1-rc2-1) unstable; urgency=low
+
+  * new upstream release
+    * handles "#" and "%" characters in filenames gracefully (closes: #206890)
+    * includes enhanced VCD input plugin (closes: 130489)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 27 Oct 2003 17:10:28 +0100
+
+xine-lib (1-rc1-1) unstable; urgency=high
+
+  * new upstream release
+    * doesn't link static libXv any more (closes: #210650)
+    * ALSA driver doesn't block on busy device any more (closes: #211304)
+  * suggesting libartsc0 (I have a bad feeling about this, closes: #203961)
+
+ -- Siggi Langauf <siggi@debian.org>  Sun,  5 Oct 2003 11:28:06 +0200
+
+xine-lib (1-rc0a-1) unstable; urgency=low
+
+  * new upstream release
+    * includes missing DXR3 support file (source only)
+    * keeps xine from aborting on broken MPEG streams
+  * added speex support
+
+ -- Siggi Langauf <siggi@debian.org>  Sat,  2 Aug 2003 15:40:13 +0200
+
+xine-lib (1-rc0-1) unstable; urgency=low
+
+  * new upstream release
+    * new versioning scheme should sort correctly (closes: #194063)
+    * includes liba52 fix (closes: #196327)
+    * resets decoder priorities if an old config file is found (closes: 193303)
+  * libxine-dev depends on libfreetype6-dev (closes: #195738)
+
+ -- Siggi Langauf <siggi@debian.org>  Fri,  1 Aug 2003 08:55:22 +0200
+
+xine-lib (1-beta12-1) unstable; urgency=low
+
+  * new upstream version
+    * ALSA plugin opens audio device in non-blocking mode (closes: #177877)
+    * (old?) QT DLL decoder fixes (closes: #179136)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 12 May 2003 18:59:34 +0200
+
+xine-lib (1-beta11-0) unstable; urgency=low
+
+  * New Upstream release
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 27 Apr 2003 14:08:30 +0200
+
+xine-lib (1-beta10-2) unstable; urgency=low
+
+  * backported xine-lib configure check from upstream CVS
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 16 Apr 2003 12:46:26 +0200
+
+xine-lib (1-beta10-1) unstable; urgency=low
+
+  * new upstream release
+  * updated debhelper dependancy, avoid using --list-missing (closes: #187433)
+  * changed libxine-dev section to new "libdevel"
+
+ -- Siggi Langauf <siggi@debian.org>  Mon,  7 Apr 2003 19:31:03 +0200
+
+xine-lib (1-beta9-1) unstable; urgency=low
+
+  * New upstream release
+  * correct demuxer should be used since 1-beta8 (closes: #180011)
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 23 Mar 2003 21:15:42 +0100
+
+xine-lib (1-beta8-1) unstable; urgency=low
+
+  * Add pmhahn as Uploaders.
+  * New upstream release.
+  * Standards-Version 3.5.9:
+    - debhelper 4
+    - Use 'noopt' instead of 'debug'
+    - Remove overrides for plugin shared libraries.
+  * Provide non-developer documentation in library package.
+  * Build with dxr3 support (closes: #117170)
+
+ -- Philipp Matthias Hahn <pmhahn@debian.org>  Fri, 14 Mar 2003 10:03:16 +0100
+
+xine-lib (1-beta6-1) unstable; urgency=low
+
+  * new upstream release
+  * updated artsc build dependancy (closes: #182137)
+  * removed obsolete dh_testversion call
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 23 Feb 2003 00:53:19 +0100
+
+xine-lib (1-beta4-3) unstable; urgency=low
+
+  * added version on FLAC dependancy (closes: #181399)
+  * fixed Replaces: xine-dvdnav, so apt should do the transition smoothly
+    (closes: #175790)
+  * downgraded GNOME recommendation to suggestion (closes: #179523)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 19 Feb 2003 04:29:21 +0100
+
+xine-lib (1-beta4-2) unstable; urgency=low
+
+  * updated dependancies (closes: #179251):
+    - added gnome-vfs input and FLAC support
+    - made those dependancies "suggests:"
+    - made sdl optional as well
+
+ -- Siggi Langauf <siggi@debian.org>  Sun,  2 Feb 2003 22:09:02 +0100
+
+xine-lib (1-beta4-1) unstable; urgency=low
+
+  * new upstream release (fixes compilation on mmx capable ix86 machines)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 29 Jan 2003 19:37:15 +0100
+
+xine-lib (1-beta3-1) unstable; urgency=low
+
+  * new upstream release
+
+ -- Siggi Langauf <siggi@debian.org>  Tue, 28 Jan 2003 21:41:05 +0100
+
+xine-lib (1-beta2-4) unstable; urgency=low
+
+  * removed HPPA compiler hacks (3.2 is now default, and it choked anyway...)
+  * removed DXR3 support (closes: #175392, reopens: #117170)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed,  8 Jan 2003 21:49:25 +0100
+
+xine-lib (1-beta2-3) unstable; urgency=high
+
+  * A backslash got lost in the last upload.
+    gcc-3.2 should finally be used on HPPA now...
+
+ -- Siggi Langauf <siggi@debian.org>  Thu,  2 Jan 2003 20:39:51 +0100
+
+xine-lib (1-beta2-2) unstable; urgency=low
+
+  working around autobuilder bugs:
+  - actually using gcc-3.2 on HPPA
+  - uploading i386 binaries, since the i386 autobuilder dies from #165458
+
+ -- Siggi Langauf <siggi@debian.org>  Thu,  2 Jan 2003 12:11:24 +0100
+
+xine-lib (1-beta2-1) unstable; urgency=low
+
+  * new upstream release
+  * on HPPA: working around a compiler bug by explicit build-depend on
+    gcc-3.2 (closes: #174813)
+
+ -- Siggi Langauf <siggi@debian.org>  Thu,  2 Jan 2003 00:43:42 +0100
+
+xine-lib (1-beta1-1) unstable; urgency=low
+
+  * new upstream release.
+    This is actually uploaded to unstable again, so let's check bugs:
+  * doesn't segfault with any of my VCDs (closes: #173424)
+  * supports WMV8 codecs (binary DLL only) (closes: #163363)
+  * should build with dxr3 support (closes: #117170)
+
+ -- Siggi Langauf <siggi@debian.org>  Tue, 24 Dec 2002 18:07:17 +0100
+
+xine-lib (1-beta0-1) unstable; urgency=low
+
+  * new upstream release (now labelled beta)
+    This one fixes the packaging issues, so it's a candidate for unstable.
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 11 Dec 2002 13:48:35 +0100
+
+xine-lib (1-alpha2-0) experimental; urgency=low
+
+  * yet another upstream alpha. This one is becoming usable, but has some
+    packaging issues which prevent a parallel installation of libxine0.
+
+ -- Siggi Langauf <siggi@debian.org>  Tue, 26 Nov 2002 00:34:35 +0100
+
+xine-lib (1-alpha1-0) experimental; urgency=low
+
+  * another upstream alpha. This is still not ready for prime time, but it will
+    build from source if you really want to give it a try...
+
+ -- Siggi Langauf <siggi@debian.org>  Sat,  9 Nov 2002 23:39:01 +0100
+
+xine-lib (1-alpha0-0) unstable; urgency=low
+
+  * new upstream (alpha!) release
+    (this is not suited for the Debian archives, yet.)
+  * NOTE: conflicts with libxine0, because of fonts and l18n
+
+ -- Siggi Langauf <siggi@debian.org>  Sun,  3 Nov 2002 03:00:41 +0100
+
+xine-lib (0.9.13-1) unstable; urgency=low
+
+  * new upstream release
+    - includes ALSA big-endian fix (closes: #154914)
+    - only shows frame stats if frames have been skipped (closes: #151610)
+  * removed control information concerning unreleased betas
+  * conflicts: packages compiled against incompatible libxine0 (closes: #150832)
+ -- Siggi Langauf <siggi@debian.org>  Sat,  3 Aug 2002 22:47:56 +0200
+
+xine-lib (0.9.12-1) unstable; urgency=low
+
+  * new upstream release
+    (only small improvements, see upstream ChangeLog)
+  * moved locale files from libxine-dev to the libxine0
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 23 Jun 2002 11:33:37 +0200
+
+xine-lib (0.9.11-1) unstable; urgency=low
+
+  * new upstream release
+    - pads Xv images, so width % 4 == 0 (closes: #134997)
+
+ -- Siggi Langauf <siggi@debian.org>  Thu, 20 Jun 2002 00:11:37 +0200
+
+xine-lib (0.9.10-2) unstable; urgency=high
+
+  * disabled machine specific optimizations, so autobuilders will
+    build packages than run on their whole processor family (closes: #148414)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 29 May 2002 10:06:09 +0200
+
+xine-lib (0.9.10-1) unstable; urgency=low
+
+  * new upstream release
+    * uses new logo mechanism (closes: #145483)
+    * after long fights using sane SONAME (closes: #145668, #148099)
+    * safer check and bigger buffer in xine_get_homedir() (closes: #133550)
+    (see upstream ChangeLog for further highlights)
+  * build-depends on libz-dev (closes: #14562)
+  * libxine-dev depends on slang1-dev (closes: #140842)
+  * removed references to (never released, long obsolete) xine packages
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 26 May 2002 00:00:14 +0200
+
+xine-lib (0.9.9-2) unstable; urgency=low
+
+  * using LIBRARY_PATH to complete circular linking during install
+    (closes: #145348)
+
+ -- Siggi Langauf <siggi@debian.org>  Thu,  2 May 2002 05:06:06 +0200
+
+xine-lib (0.9.9-1) unstable; urgency=low
+
+  * new upstream release
+  * downgraded ogg/vorbis dependancies to recommendations (closes: #130492)
+  * made resetting volume an option, disabled by default (closes: #127485)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 28 Jan 2002 10:54:14 +0100
+
+xine-lib (0.9.8-2) unstable; urgency=high
+
+  * including version in shlibs file, so shlibdeps will work
+
+ -- Siggi Langauf <siggi@debian.org>  Sat, 19 Jan 2002 16:20:32 +0100
+
+xine-lib (0.9.8-1) unstable; urgency=high
+
+  * new upstream release
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 14 Jan 2002 00:43:52 +0100
+
+xine-lib (0.9.7-3) unstable; urgency=high
+
+  * re-added check for HPPA (closes: #123036)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 17 Dec 2001 11:44:24 +0100
+
+xine-lib (0.9.7-2) unstable; urgency=low
+
+  * this package is based on a recent CVS snapshot, fixes a few things:
+  * don't try to DirectShow support on non-i386 platforms
+  * officially support s390, thanks to Gerhard Tonn (closes: #123805)
+  * subtitles other than the first one re-enabled
+  * improved antialiasinf on OSD fonts
+
+ -- Siggi Langauf <siggi@flake.langauf.de>  Sun, 16 Dec 2001 13:00:14 +0100
+
+xine-lib (0.9.7-1) unstable; urgency=low
+
+  * new upstream release, introducing upstream feature freeze for 1.0
+  * suggesting xine-dvdnav, so people find it more easily
+  * disabled Xv plugin on hppa (closes: #123036)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 12 Dec 2001 19:32:43 +0100
+
+xine-lib (0.9.6-1) unstable; urgency=high
+
+  * new upstream release, fixes some nasty bugs
+    (the 0.9.5 package was never uploaded, sorry...)
+
+ -- Siggi Langauf <siggi@debian.org>  Sat,  1 Dec 2001 09:39:48 +0100
+
+xine-lib (0.9.5-1) unstable; urgency=high
+
+  * new upstream release
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 11 Nov 2001 12:01:00 +0100
+
+xine-lib (0.9.4-1) unstable; urgency=medium
+
+  * new upstream release, fixes libtool, so this actually compiles
+    new features include improved deinterlacing with syncfb and zoom support
+
+ -- Siggi Langauf <siggi@debian.org>  Sun,  4 Nov 2001 13:07:06 +0100
+
+xine-lib (0.9.3-1) unstable; urgency=medium
+
+  * new upstream release
+  * improved error handling in plugin loader (closes: #116572)
+
+ -- Siggi Langauf <siggi@debian.org>  Sat,  3 Nov 2001 11:24:03 +0100
+
+xine-lib (0.9.2-3) unstable; urgency=high
+
+  * removed build-dependancy on libasound (useful on i386 only)
+  * allow for architectures building only some of the plugins
+  * added build-dependancy on ogg and vorbis libraries
+
+ -- Siggi Langauf <siggi@debian.org>  Sat, 20 Oct 2001 17:58:53 +0200
+
+xine-lib (0.9.2-2) unstable; urgency=high
+
+  * added permission workaround for shlibdeps.sh (closes: #115881)
+
+ -- Siggi Langauf <siggi@debian.org>  Wed, 17 Oct 2001 00:41:51 +0200
+
+xine-lib (0.9.2-1) unstable; urgency=high
+
+  * now building alsa09 plugin (instead of alsa05, as you can't have
+                                libasound{1,2}-dev at the same time...)
+  * build-Dependancy on liblircclient-dev => lirc support on non-i386
+  * new upstream release
+    * deinterlace.c should compile everywhere (closes: #112748)
+    * including string.h in m4 test (closes: #115271)
+    * aclocal file is in /usr/share/aclocal (just as 0.9.1)  (closes: #115033)
+    * enables -fPIC on all architectures except i386 (closes: #115006)
+    * many more fixes/features (see upstream changelog)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 15 Oct 2001 21:14:12 +0200
+
+xine-lib (0.9.1-1.1) unstable; urgency=low
+
+  * NMU.
+  * Added ia64 support to configure.in.
+  * For performance reasons, the shared libs are not compiled with
+    -fPIC in the standard distribution, which is incorrect behavior.
+    As a compromise, I've added a "--disable-fpic" configure option
+    which will only do this on platforms where this is allowed.
+    Closes: #115006.
+  * m4/xine.m4: autoconf test uses strdup w/o including string.h.
+    Closes: #115271.
+  * Don't install aclocal files in /usr/local in libxine-dev.
+    Closes: #115033.
+  * Fixed typo in src/video_out/deinterlace.c.  Closes: #112748.
+
+ -- Jeff Licquia <jlicquia@progeny.com>  Tue,  9 Oct 2001 09:55:23 -0600
+
+xine-lib (0.9.1-1) unstable; urgency=low
+
+  * new upstream release (mostly bugfix release, new deinterlacer)
+  * re-added ALSA (0.5.x) plugin
+  * now ships with aRts audio plugin
+
+ -- Siggi Langauf <siggi@debian.org>  Tue, 18 Sep 2001 11:13:34 +0200
+
+xine-lib (0.9.0-2) unstable; urgency=low
+
+  * bugfix release of the package
+  * added build-depends for zlib1g-dev (closes: #112270)
+  * using default FPM routines on m68k, as nobody seems able to write native
+    ones. Performance will be poor and it might not even work, but should
+    compile... (closes: #112257)
+
+ -- Siggi Langauf <siggi@debian.org>  Sun, 16 Sep 2001 11:08:46 +0200
+
+xine-lib (0.9.0-1) unstable; urgency=low
+
+  * new upstream release features generic menu support, see ChangeLog for more
+
+ -- Siggi Langauf <siggi@debian.org>  Fri, 14 Sep 2001 11:31:10 +0200
+
+xine-lib (0.5.3-1) unstable; urgency=low
+
+  * added build-depends: lobesd0-dev (closes: Bug#111140)
+  * new upstream release (fixes many race conditions, etc.)
+
+ -- Siggi Langauf <siggi@debian.org>  Tue,  4 Sep 2001 19:14:01 +0200
+
+xine-lib (0.5.2-1) unstable; urgency=low
+
+  * new upstream release features major rewrites of timing and audio output
+  * added configure support for m68k (libmad still won't compile on m68k!)
+
+ -- Siggi Langauf <siggi@debian.org>  Sun,  2 Sep 2001 18:04:44 +0200
+
+xine-lib (0.5.1-1) unstable; urgency=low
+
+  * new upstream version
+    (0.5.0-1 never made it into the archive)
+
+ -- Siggi Langauf <siggi@debian.org>  Mon, 27 Aug 2001 10:04:17 +0200
+
+xine-lib (0.5.0-1) unstable; urgency=low
+
+  * Initial Release of the new xine-lib/xine-ui based xine.
+
+ -- Siggi Langauf <siggi@debian.org>  Sun,  5 Aug 2001 20:26:31 +0200
diff -Nur xine-lib-1.1.11.1/debian/compat xine-lib-1.1.11.1-ubuntu/debian/compat
--- xine-lib-1.1.11.1/debian/compat	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/compat	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1 @@
+5
diff -Nur xine-lib-1.1.11.1/debian/control xine-lib-1.1.11.1-ubuntu/debian/control
--- xine-lib-1.1.11.1/debian/control	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/control	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,211 @@
+Source: xine-lib
+Section: libs
+Priority: optional
+Maintainer: Ubuntu Core Developers <ubuntu-devel-discuss@lists.ubuntu.com>
+XSBC-Original-Maintainer: Reinhard Tartler <siretart@tauware.de>
+Uploaders: Darren Salt <linux@youmustbejoking.demon.co.uk>
+Build-Depends: debhelper (>= 5.0.1), pkg-config,
+	libavcodec-dev (>= 0.cvs20070307-3),
+	libavformat-dev (>= 0.cvs20070307-3),
+	libpostproc-dev (>= 0.cvs20070307-3),
+	libxcb-xv0-dev, libxcb-shm0-dev, libxcb-shape0-dev,
+	libxinerama-dev, libxv-dev, libxvmc-dev, libxt-dev,
+	libasound2-dev [!kfreebsd-i386 !kfreebsd-amd64 !hurd-i386],
+	libcam-dev [kfreebsd-i386 kfreebsd-amd64],
+	libaa1-dev, libcaca-dev, libmodplug-dev, libpulse-dev,
+	libmagick9-dev | libmagick-dev,	libpng12-dev, libfreetype6-dev,
+	libogg-dev, libvorbis-dev, libtheora-dev,
+	libesd0-dev, libgnomevfs2-dev,
+	liblircclient-dev,
+	libdirectfb-dev, libgtk2.0-dev,
+	libflac-dev, libsdl1.2-dev, libwavpack-dev,
+	libsmbclient-dev, libspeex-dev, libmng-dev,
+	libmad0-dev, libmpcdec-dev, libcdio-dev (>= 0.76-1),
+	zlib1g-dev, w3m, transfig, sgmltools-lite, gs-gpl | gs
+XS-Vcs-hg: http://hg.debian.org/hg/xine-lib/pkg/xine-lib-deb
+XS-Vcs-Browser: http://hg.debian.org/hg/xine-lib/pkg/xine-lib-deb
+XS-DM-Upload-Allowed: yes
+Homepage: http://xinehq.de/
+Standards-Version: 3.7.3
+
+Package: libxine1-doc
+Architecture: all
+Section: doc
+Replaces: libxine1 (<< 1.1.7-1)
+Provides: libxine-doc
+Conflicts: libxine2-doc, libxine1 (<< 1.1.7-1)
+Description: the xine video player library, documentation files
+ This contains documentation for the xine library (libxine). It consists
+ of various textfiles and the xine(5) manpage.
+ .
+ Libxine provides the complete infrastructure for a video/media player. It
+ supports MPEG 1/2 and some AVI and Quicktime videos out of the box, so you
+ can use it to play DVDs, (S)VCDs and most video files out there. It
+ supports network streams, subtitles and even MP3 or Ogg files. It's
+ extensible to your heart's content via plugins for audio and video output,
+ input media, demuxers (stream types), audio/video and subtitle codecs.
+
+Package: libxine1
+Architecture: any
+Depends: libxine1-plugins (= ${source:Version}) | libxine1-misc-plugins (= ${binary:Version}),
+	    libxine1-x (= ${binary:Version}), libxine1-console (= ${binary:Version})
+Recommends: libxine1-ffmpeg
+Suggests: gxine | xine-ui, libxine1-doc | libxine-doc
+Description: the xine video/media player library, meta-package
+ This is the xine media player library (libxine).
+ .
+ Libxine provides the complete infrastructure for a video/media player. It
+ supports MPEG 1/2 and some AVI and Quicktime videos out of the box, so you
+ can use it to play DVDs, (S)VCDs and most video files out there. It
+ supports network streams, subtitles and even MP3 or Ogg files. It's
+ extensible to your heart's content via plugins for audio and video output,
+ input media, demuxers (stream types), audio/video and subtitle codecs.
+ .
+ While this package does not provide a GUI, building a user-interface
+ frontend around this should be quite easy. The xine-ui and gxine
+ packages each provide one for your convenience.
+
+Package: libxine1-bin
+Architecture: any
+Depends: ${shlibs:Depends}
+Recommends: ${shlibs:Recommends}
+Suggests: ${shlibs:Suggests}
+Conflicts: libxine1 (<< 1.1.8-4)
+Replaces: libxine1 (<< 1.1.8-4), libxine-main1 (<< 1.1.2+repacked1-0ubuntu1)
+Description: the xine video/media player library, binary files
+ This package contains the core library of the xine video/media player
+ engine.
+
+Package: libxine-dev
+Architecture: any
+Section: libdevel
+Conflicts: libxine2-dev
+Replaces: libxine2-dev
+Depends: libxine1-bin (>= ${source:Version}), libc6-dev, zlib1g-dev,
+	 libslang2-dev, libfreetype6-dev, pkg-config
+Description: the xine video player library, development packages
+ This contains development files (headers, documentation and the like)
+ and additional documentation for developers for the xine library
+ (libxine).
+ .
+ Libxine provides the complete infrastructure for a video/media player. It
+ supports MPEG 1/2 and some AVI and Quicktime videos out of the box, so you
+ can use it to play DVDs, (S)VCDs and most video files out there. It
+ supports network streams, subtitles and even MP3 or Ogg files. It's
+ extensible to your heart's content via plugins for audio and video output,
+ input media, demuxers (stream types), audio/video and subtitle codecs.
+
+Package: libxine1-ffmpeg
+Architecture: any
+Depends: ${shlibs:Depends}
+Replaces: libxine-extracodecs (<< 1.1.3-1)
+Conflicts: libxine-extracodecs (<< 1.1.3-1)
+Description: MPEG-related plugins for libxine1
+ This package contains plugins for the xine video/media player engine,
+ which are necessary to decode MPEG-based codecs. Among them, this package
+ includes the the ffmpeg input plugin for xine, which enables xine-based
+ players a large variety of modern audio and video codecs.
+ .
+ You most probably want to install this package. It is required if you want
+ to watch DVDs or digital TV using any xine-based player.
+
+Package: libxine1-gnome
+Architecture: any
+Depends: ${shlibs:Depends}
+Description: GNOME-related plugins for libxine1
+ This package contains plugins for the xine video/media player engine,
+ which are commonly used in the GNOME desktop environment. In detail
+ this package contains the ESD output plugin and the GnomeVFS Plugin.
+ .
+ If you are running GNOME, you most probably want to install this package.
+
+Package: libxine1-console
+Architecture: any
+Priority: extra
+Depends: ${shlibs:Depends}
+Replaces: libxine1 (<< 1.1.8-2)
+Conflicts: libxine1 (<< 1.1.8-2)
+Description: libaa/libcaca/framebuffer/directfb related plugins for libxine1
+ This package contains plugins for the xine video/media player engine,
+ which are commonly used on the command line. In detail, this package
+ contains the framebuffer (fb), directfb, libaa and libcaca output plugins.
+ .
+ If you want to view your videos in an xterm, you want to install this
+ package.
+
+Package: libxine1-x
+Architecture: any
+Depends: ${shlibs:Depends}
+Replaces: libxine1 (<< 1.1.8-2)
+Conflicts: libxine1 (<< 1.1.8-2)
+Description: X desktop video output plugins for libxine1
+ This package contains plugins for the xine video/media player engine
+ which are used for video display on the X desktop.
+ .
+ You most probably want to install this package if you are using a
+ graphical frontend like gxine, kaffeine or xine-ui. It contains xine output
+ plugins necessary for drawing on X11 Displays.
+
+Package: libxine1-misc-plugins
+Architecture: any
+Depends: ${shlibs:Depends}
+Replaces: libxine1 (<< 1.1.8-2)
+Conflicts: libxine1 (<< 1.1.8-2)
+Description: Input, audio output and post plugins for libxine1
+ This package contains plugins for the xine video/media player engine
+ which are used for input, audio output and post-processing.
+ .
+ You most probably want to install this package. It contains various
+ plugins you generally would expect to find on a xine installation.
+
+Package: libxine1-dbg
+Architecture: any
+Priority: extra
+Recommends: libxine1-ffmpeg, libxine1-gnome, libxine1-console
+Depends: libxine1-bin (= ${binary:Version})
+Description: debug symbols for libxine1
+ This is the xine media player library (libxine).
+ .
+ This package contains debug data for the shared libraries. Its purpose is
+ to allow debuggers to produce backtraces with names, making it easier to
+ interpret core dumps. The data is installed in /usr/lib/debug.
+ .
+ Most people will not need this package. Please install it to produce useful
+ stacktraces to help debugging the xine library.
+
+Package: libxine1-plugins
+Architecture: all
+Priority: extra
+Depends: libxine1-ffmpeg (>= ${source:Version}), libxine1-misc-plugins (>= ${source:Version})
+Suggests: libxine1-gnome (>= ${source:Version})
+Description: the xine video/media player library, meta package
+ This is the xine media player library (libxine).
+ .
+ Libxine provides the complete infrastructure for a video/media player. It
+ supports MPEG 1/2 and some AVI and Quicktime videos out of the box, so you
+ can use it to play DVDs, (S)VCDs and most video files out there. It
+ supports network streams, subtitles and even MP3 or Ogg files. It's
+ extensible to your heart's content via plugins for audio and video output,
+ input media, demuxers (stream types), audio/video and subtitle codecs.
+ .
+ This empty package is just for your convenience and depends on
+ commonly-used xine plugin packages.
+
+Package: libxine1-all-plugins
+Architecture: all
+Priority: extra
+Depends: libxine1-ffmpeg (>= ${source:Version}), libxine1-misc-plugins (>= ${source:Version}),
+	    libxine1-gnome (>= ${source:Version}), libxine1-x (>= ${source:Version}),
+	    libxine1-console (>= ${source:Version}),
+Description: the xine video/media player library, meta package
+ This is the xine media player library (libxine).
+ .
+ Libxine provides the complete infrastructure for a video/media player. It
+ supports MPEG 1/2 and some AVI and Quicktime videos out of the box, so you
+ can use it to play DVDs, (S)VCDs and most video files out there. It
+ supports network streams, subtitles and even MP3 or Ogg files. It's
+ extensible to your heart's content via plugins for audio and video output,
+ input media, demuxers (stream types), audio/video and subtitle codecs.
+ .
+ This empty package is just for your convenience and depends on all
+ available xine plugin packages.
diff -Nur xine-lib-1.1.11.1/debian/copyright xine-lib-1.1.11.1-ubuntu/debian/copyright
--- xine-lib-1.1.11.1/debian/copyright	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/copyright	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,26 @@
+This package is maintained by Siggi Langauf <siggi@debian.org>.
+
+Current versions can be downloaded from http://xine.sf.net
+
+Upstream Authors: Günter Bartsch and lots of others (see AUTHORS file)
+
+
+Copyright (C) 2000,2001 the xine project
+
+xine is free software; you can redistribute it and/or modify
+it under the terms of the GNU General Public License as published by
+the Free Software Foundation; either version 2 of the License, or
+(at your option) any later version.
+
+xine is distributed in the hope that it will be useful,
+but WITHOUT ANY WARRANTY; without even the implied warranty of
+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+GNU General Public License for more details.
+
+You should have received a copy of the GNU General Public License
+along with this program; if not, write to the Free Software
+Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA
+
+On Debian systems, the full text of the GPL can be found in 
+/usr/share/common-licenses/GPL
+
diff -Nur xine-lib-1.1.11.1/debian/libxine1-bin.docs xine-lib-1.1.11.1-ubuntu/debian/libxine1-bin.docs
--- xine-lib-1.1.11.1/debian/libxine1-bin.docs	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-bin.docs	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1 @@
+AUTHORS
diff -Nur xine-lib-1.1.11.1/debian/libxine1-bin.install xine-lib-1.1.11.1-ubuntu/debian/libxine1-bin.install
--- xine-lib-1.1.11.1/debian/libxine1-bin.install	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-bin.install	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,6 @@
+## Generic Files to install for ALL architectures
+#
+
+debian/tmp/usr/lib/libxine.so.*
+debian/tmp/usr/share/locale/*
+debian/tmp/usr/share/xine/libxine1/fonts/*
diff -Nur xine-lib-1.1.11.1/debian/libxine1-bin.install.i386.specific xine-lib-1.1.11.1-ubuntu/debian/libxine1-bin.install.i386.specific
--- xine-lib-1.1.11.1/debian/libxine1-bin.install.i386.specific	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-bin.install.i386.specific	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,8 @@
+## Files, which only get installed on i386
+#
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_qt.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_w32dll.so
+
+### disable vidix for now - uncomment here and activate in debian/rules!
+# debian/tmp/usr/lib/xine/plugins/*/vidix/*.so
+# debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_vidix.so
diff -Nur xine-lib-1.1.11.1/debian/libxine1-console.install xine-lib-1.1.11.1-ubuntu/debian/libxine1-console.install
--- xine-lib-1.1.11.1/debian/libxine1-console.install	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-console.install	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,4 @@
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_aa.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_caca.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_directfb.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_fb.so
diff -Nur xine-lib-1.1.11.1/debian/libxine1-console.postinst xine-lib-1.1.11.1-ubuntu/debian/libxine1-console.postinst
--- xine-lib-1.1.11.1/debian/libxine1-console.postinst	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-console.postinst	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,7 @@
+#! /bin/sh
+DOCDIR=/usr/share/doc/libxine1-console
+if [ -d "$DOCDIR" -a ! -L "$DOCDIR" ]; then                  
+  rmdir "$DOCDIR" && ln -s libxine1-bin "$DOCDIR"
+fi
+
+##DEBHELPER##
diff -Nur xine-lib-1.1.11.1/debian/libxine1-dbg.postinst xine-lib-1.1.11.1-ubuntu/debian/libxine1-dbg.postinst
--- xine-lib-1.1.11.1/debian/libxine1-dbg.postinst	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-dbg.postinst	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,7 @@
+#! /bin/sh
+DOCDIR=/usr/share/doc/libxine1-dbg
+if [ -d "$DOCDIR" -a ! -L "$DOCDIR" ]; then                  
+  rmdir "$DOCDIR" && ln -s libxine1-bin "$DOCDIR"
+fi
+
+##DEBHELPER##
diff -Nur xine-lib-1.1.11.1/debian/libxine1-doc.docs xine-lib-1.1.11.1-ubuntu/debian/libxine1-doc.docs
--- xine-lib-1.1.11.1/debian/libxine1-doc.docs	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-doc.docs	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,9 @@
+AUTHORS
+debian/tmp/usr/share/doc/xine-lib/faq/*
+debian/tmp/usr/share/doc/xine-lib/README_xxmc.html
+debian/tmp/usr/share/doc/xine-lib/README
+debian/tmp/usr/share/doc/xine-lib/faq.*
+debian/tmp/usr/share/doc/xine-lib/README.syncfb*
+debian/tmp/usr/share/doc/xine-lib/README.opengl*
+debian/tmp/usr/share/doc/xine-lib/README.dxr3*
+debian/tmp/usr/share/doc/xine-lib/README.dvb*
diff -Nur xine-lib-1.1.11.1/debian/libxine1-doc.manpages xine-lib-1.1.11.1-ubuntu/debian/libxine1-doc.manpages
--- xine-lib-1.1.11.1/debian/libxine1-doc.manpages	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-doc.manpages	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1 @@
+debian/tmp/usr/share/man/man5/xine.5
diff -Nur xine-lib-1.1.11.1/debian/libxine1-ffmpeg.install xine-lib-1.1.11.1-ubuntu/debian/libxine1-ffmpeg.install
--- xine-lib-1.1.11.1/debian/libxine1-ffmpeg.install	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-ffmpeg.install	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,14 @@
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_ff.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_faad.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_mad.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_mpeg2.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_a52.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_dts.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_mpeg.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_mpeg_block.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_mpeg_elem.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_mpeg_pes.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_mpeg_ts.so
+
+# postprocess plugins
+debian/tmp/usr/lib/xine/plugins/*/post/xineplug_post_planar.so
diff -Nur xine-lib-1.1.11.1/debian/libxine1-ffmpeg.postinst xine-lib-1.1.11.1-ubuntu/debian/libxine1-ffmpeg.postinst
--- xine-lib-1.1.11.1/debian/libxine1-ffmpeg.postinst	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-ffmpeg.postinst	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,7 @@
+#! /bin/sh
+DOCDIR=/usr/share/doc/libxine1-ffmpeg
+if [ -d "$DOCDIR" -a ! -L "$DOCDIR" ]; then                  
+  rmdir "$DOCDIR" && ln -s libxine1-bin "$DOCDIR"
+fi
+
+##DEBHELPER##
diff -Nur xine-lib-1.1.11.1/debian/libxine1-gnome.install xine-lib-1.1.11.1-ubuntu/debian/libxine1-gnome.install
--- xine-lib-1.1.11.1/debian/libxine1-gnome.install	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-gnome.install	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,3 @@
+debian/tmp/usr/lib/xine/plugins/*/xineplug_ao_out_esd.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_gnome_vfs.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_gdk_pixbuf.so
diff -Nur xine-lib-1.1.11.1/debian/libxine1-gnome.postinst xine-lib-1.1.11.1-ubuntu/debian/libxine1-gnome.postinst
--- xine-lib-1.1.11.1/debian/libxine1-gnome.postinst	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-gnome.postinst	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,7 @@
+#! /bin/sh
+DOCDIR=/usr/share/doc/libxine1-gnome
+if [ -d "$DOCDIR" -a ! -L "$DOCDIR" ]; then                  
+  rmdir "$DOCDIR" && ln -s libxine1-bin "$DOCDIR"
+fi
+
+##DEBHELPER##
diff -Nur xine-lib-1.1.11.1/debian/libxine1-misc-plugins.install xine-lib-1.1.11.1-ubuntu/debian/libxine1-misc-plugins.install
--- xine-lib-1.1.11.1/debian/libxine1-misc-plugins.install	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-misc-plugins.install	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,84 @@
+# input plugins
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_cdda.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_dvb.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_dvd.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_file.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_http.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_mms.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_net.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_pnm.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_pvr.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_rtp.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_rtsp.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_smb.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_stdin_fifo.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_v4l.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_vcd.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_inp_vcdo.so
+
+# audio output plugins
+debian/tmp/usr/lib/xine/plugins/*/xineplug_ao_out_alsa.so
+#debian/tmp/usr/lib/xine/plugins/*/xineplug_ao_out_jack.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_ao_out_file.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_ao_out_none.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_ao_out_oss.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_ao_out_pulseaudio.so
+
+# video output plugins which don't fit in elsewhere
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_none.so
+
+# decoder plugins
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_bitplane.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_dvaudio.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_dxr3_spu.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_dxr3_video.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_gsm610.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_image.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_lpcm.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_mpc.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_nsf.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_real.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_rgb.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_speex.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_spu.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_spucc.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_spucmml.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_spudvb.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_sputext.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_theora.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_vorbis.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_decode_yuv.so
+
+# demuxer plugins
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_asf.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_audio.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_avi.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_fli.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_flv.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_games.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_iff.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_image.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_matroska.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_mng.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_nsv.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_ogg.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_pva.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_qt.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_rawdv.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_real.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_slave.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_sputext.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_yuv4mpeg2.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_dmx_yuv_frames.so
+
+# decoder/demuxer (combined) plugins
+debian/tmp/usr/lib/xine/plugins/*/xineplug_flac.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_wavpack.so
+
+# postprocess plugins
+debian/tmp/usr/lib/xine/plugins/*/post/xineplug_post_mosaico.so
+debian/tmp/usr/lib/xine/plugins/*/post/xineplug_post_audio_filters.so
+debian/tmp/usr/lib/xine/plugins/*/post/xineplug_post_visualizations.so
+debian/tmp/usr/lib/xine/plugins/*/post/xineplug_post_goom.so
+debian/tmp/usr/lib/xine/plugins/*/post/xineplug_post_switch.so
+debian/tmp/usr/lib/xine/plugins/*/post/xineplug_post_tvtime.so
diff -Nur xine-lib-1.1.11.1/debian/libxine1-misc-plugins.postinst xine-lib-1.1.11.1-ubuntu/debian/libxine1-misc-plugins.postinst
--- xine-lib-1.1.11.1/debian/libxine1-misc-plugins.postinst	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-misc-plugins.postinst	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,7 @@
+#! /bin/sh
+DOCDIR=/usr/share/doc/libxine1-misc-plugins
+if [ -d "$DOCDIR" -a ! -L "$DOCDIR" ]; then                  
+  rmdir "$DOCDIR" && ln -s libxine1-bin "$DOCDIR"
+fi
+
+##DEBHELPER##
diff -Nur xine-lib-1.1.11.1/debian/libxine1.postinst xine-lib-1.1.11.1-ubuntu/debian/libxine1.postinst
--- xine-lib-1.1.11.1/debian/libxine1.postinst	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1.postinst	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,7 @@
+#! /bin/sh
+DOCDIR=/usr/share/doc/libxine1
+if [ -d "$DOCDIR" -a ! -L "$DOCDIR" ]; then                  
+  rmdir "$DOCDIR" && ln -s libxine1-bin "$DOCDIR"
+fi
+
+##DEBHELPER##
diff -Nur xine-lib-1.1.11.1/debian/libxine1-x.install xine-lib-1.1.11.1-ubuntu/debian/libxine1-x.install
--- xine-lib-1.1.11.1/debian/libxine1-x.install	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-x.install	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,13 @@
+# X-based video output plugins
+
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_dxr3.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_opengl.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_sdl.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_syncfb.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_xcbshm.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_xcbxv.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_xdirectfb.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_xshm.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_xv.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_xvmc.so
+debian/tmp/usr/lib/xine/plugins/*/xineplug_vo_out_xxmc.so
diff -Nur xine-lib-1.1.11.1/debian/libxine1-x.postinst xine-lib-1.1.11.1-ubuntu/debian/libxine1-x.postinst
--- xine-lib-1.1.11.1/debian/libxine1-x.postinst	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine1-x.postinst	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,7 @@
+#! /bin/sh
+DOCDIR=/usr/share/doc/libxine1-x
+if [ -d "$DOCDIR" -a ! -L "$DOCDIR" ]; then                  
+  rmdir "$DOCDIR" && ln -s libxine1-bin "$DOCDIR"
+fi
+
+##DEBHELPER##
diff -Nur xine-lib-1.1.11.1/debian/libxine-dev.docs xine-lib-1.1.11.1-ubuntu/debian/libxine-dev.docs
--- xine-lib-1.1.11.1/debian/libxine-dev.docs	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine-dev.docs	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1 @@
+debian/tmp/usr/share/doc/xine-lib/hackersguide
diff -Nur xine-lib-1.1.11.1/debian/libxine-dev.install xine-lib-1.1.11.1-ubuntu/debian/libxine-dev.install
--- xine-lib-1.1.11.1/debian/libxine-dev.install	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine-dev.install	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,5 @@
+debian/tmp/usr/bin/xine-config
+debian/tmp/usr/include
+debian/tmp/usr/lib/libxine*.so
+debian/tmp/usr/lib/pkgconfig/libxine.pc
+debian/tmp/usr/share/aclocal/xine.m4
diff -Nur xine-lib-1.1.11.1/debian/libxine-dev.manpages xine-lib-1.1.11.1-ubuntu/debian/libxine-dev.manpages
--- xine-lib-1.1.11.1/debian/libxine-dev.manpages	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/libxine-dev.manpages	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1 @@
+debian/tmp/usr/share/man/man1/xine-config.1
diff -Nur xine-lib-1.1.11.1/debian/overrides/libxine1-bin xine-lib-1.1.11.1-ubuntu/debian/overrides/libxine1-bin
--- xine-lib-1.1.11.1/debian/overrides/libxine1-bin	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/overrides/libxine1-bin	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,6 @@
+# We need to have packages depend on libxine1 rather than libxine1-bin
+# so that plugins are automatically pulled in.
+# (Merging libxine1 & libxine1-bin -> libxine1 causes a circular dependency.)
+
+libxine1-bin: shlibs-declares-dependency-on-other-package libxine1 (>= 1.1.8)
+libxine1-bin: package-name-doesnt-match-sonames libxine1
diff -Nur xine-lib-1.1.11.1/debian/README.Debian xine-lib-1.1.11.1-ubuntu/debian/README.Debian
--- xine-lib-1.1.11.1/debian/README.Debian	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/README.Debian	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,37 @@
+Patching the Debian package
+===========================
+
+http://hg.debian.org/hg/xine-lib/pkg/xine-lib-$VERSION-deb (replace $VERSION
+appropriately) is a Mercurial-format repository which contains the packaging
+files and directly-applied patches.
+
+
+The CSS plugin story...
+=======================
+
+xine does support playing unencrypted and encrypted dvd using the library 
+libdvdread/libdvdcss. Due to legal reasons, it is not possible for debian
+nor derivatives to ship a libdvdcss, which would be needed to play encrypted
+dvds.
+
+For more information how to install the necessary plugin, please read
+/usr/share/doc/libdvdread3/README.Debian
+
+
+The Default audio plugin story... (#354437, et al)
+==================================================
+
+The default audio plugin, unless set otherwise by the user, is 'auto', and not
+e.g. 'arts'.  The reasoning behind this is: If artsd is not running, xine-lib
+will fall back to the next audio driver (should be esd, which also fails if esd
+is not running), so it finally falls back to ALSA (or even OSS).  This is the
+only way to automatically use an audio driver that will work with every
+conceivable setup. (Systems that run a sound daemon usually do so because
+otherwise they would only have one sound channel. So in those cases the daemon
+should be used, unless explicitly configured otherwise.)
+
+So, if you are experiencing instant crashes with the error message 
+'can't create mcop directory', please start xine (xine-ui or gxine) with parameter 
+"-A auto"
+
+
diff -Nur xine-lib-1.1.11.1/debian/rules xine-lib-1.1.11.1-ubuntu/debian/rules
--- xine-lib-1.1.11.1/debian/rules	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/rules	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,224 @@
+#!/usr/bin/make -f
+# Sample debian/rules that uses debhelper.
+# GNU copyright 1997 to 1999 by Joey Hess.
+# adapted for xine-lib 2001 by Siggi Langauf
+# rewritten for new package structure December 2006 by Reinhard Tartler
+
+# Uncomment this to turn on verbose mode.
+# export DH_VERBOSE=1
+
+BINARY_ANY_PACKAGES=$(shell dh_listpackages -a)
+BINARY_ALL_PACKAGES=$(shell dh_listpackages -i)
+
+# These are used for cross-compiling and for saving the configure script
+# from having to guess our platform (since we know it already)
+DEB_HOST_GNU_TYPE	?= $(shell dpkg-architecture -qDEB_HOST_GNU_TYPE)
+DEB_BUILD_GNU_TYPE	?= $(shell dpkg-architecture -qDEB_BUILD_GNU_TYPE)
+DEB_HOST_ARCH		?= $(shell dpkg-architecture -qDEB_HOST_ARCH)
+
+ifneq ($(DEB_HOST_GNU_TYPE),$(DEB_BUILD_GNU_TYPE))
+  $(error cross compiling is not supported by xine)
+endif
+
+# predefine as empty
+DEB_BUILD_CONFIG_OPTIONS :=
+CFLAGS += -g
+
+# add if we don't want optimisations
+ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
+	CFLAGS += -O0
+	DEB_BUILD_CONFIG_OPTIONS += --disable-optimizations
+endif
+
+ifneq (,$(findstring mips,$(DEB_HOST_GNU_TYPE)))
+	DEB_BUILD_CONFIG_OPTIONS += PTHREAD_LIBS="-lpthread"
+endif
+
+# taken from the qemu package
+# Support multiple makes at once
+ifneq (,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
+NJOBS := $(patsubst parallel=%,%,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
+else
+NJOBS := 1
+endif
+
+# set configure flags here
+CONFIGURE_FLAGS := \
+	--prefix=/usr \
+	--mandir=\$${prefix}/share/man \
+	--with-external-libmad \
+	--with-external-a52dec \
+	--with-external-libdts \
+	--with-external-ffmpeg \
+	--with-external-libmpcdec \
+	--enable-ipv6 \
+	--without-jack \
+	--with-pulseaudio \
+	--with-libflac \
+	--with-wavpack \
+	--with-freetype \
+	--disable-vidix \
+	--enable-directfb \
+	$(DEB_BUILD_CONFIG_OPTIONS) \
+	$(DEB_EXTRA_CONFIG_FLAGS) \
+	CFLAGS="$(CFLAGS)"
+
+configure: configure-stamp
+configure-stamp:
+	dh_testdir
+	./configure $(CONFIGURE_FLAGS)
+	touch configure-stamp
+
+build: configure-stamp build-stamp
+build-stamp:
+	dh_testdir
+	$(MAKE) -j $(NJOBS)
+	touch build-stamp
+
+clean:
+	dh_testdir
+	dh_testroot
+	dh_clean build-stamp configure-stamp install-stamp po/*.gmo
+	dh_clean po/stamp-po binary-*-stamp all-files-stamp
+	dh_clean generate-arch-files-stamp
+	[ ! -f Makefile ] || $(MAKE) distclean
+	dh_clean debian/libxine1-bin.install.i386
+	dh_clean debian/libxine1*.install.kfreebsd*
+	dh_clean config.h config.log
+	dh_clean a.out # XXX fix the configure script to not create this
+
+install: build install-stamp
+install-stamp: generate-arch-files-stamp
+	dh_testdir
+	dh_testroot
+	dh_clean -k
+	dh_installdirs
+	$(MAKE) install DESTDIR=$(CURDIR)/debian/tmp \
+	    LIBRARY_PATH=$(CURDIR)/debian/tmp/usr/lib
+	-(cd debian/tmp && find .) | sort -u | sed -e 's%doc/xine-lib%doc/libxine-dev%' > $@
+
+binary-common: build install
+	@echo working on package $(DH_PACKAGE)
+	dh_testdir
+	dh_testroot
+	dh_install
+	test ! -f debian/overrides/$(DH_PACKAGE) || \
+	  install -Dm644 \
+	       debian/overrides/$(DH_PACKAGE) \
+	       debian/$(DH_PACKAGE)/usr/share/lintian/overrides/$(DH_PACKAGE)
+	# mostly, we symlink docs -> libxine1-bin
+	set -e; case "$(DH_PACKAGE)" in \
+	    libxine1-bin|libxine-dev$(subst lib,|lib,$(BINARY_ALL_PACKAGES))) \
+	      dh_installdocs; \
+	      dh_installchangelogs -k ChangeLog; \
+	      ;; \
+	    *) \
+	      mkdir -p debian/$(DH_PACKAGE)/usr/share/doc; \
+	      ln -fs libxine1-bin \
+	         debian/$(DH_PACKAGE)/usr/share/doc/$(DH_PACKAGE); \
+	      ;; \
+	  esac
+	dh_installman
+	dh_link
+	dh_strip --dbg-package=libxine1-dbg
+	dh_compress
+	dh_fixperms
+	dh_makeshlibs -V 'libxine1 (>= 1.1.8)'
+	dh_installdeb
+	dh_shlibdeps -ldebian/libxine1-bin/usr/lib
+	dh_gencontrol
+	dh_md5sums
+	dh_builddeb
+
+# special rules for the -dbg package.
+binary-libxine1-dbg: build install
+	@echo working on $@
+	dh_testdir		-plibxine1-dbg
+	dh_testroot		-plibxine1-dbg
+	dh_install 		-plibxine1-dbg
+	mkdir -p debian/libxine1-dbg/usr/share/doc
+	ln -fs libxine1-bin debian/libxine1-dbg/usr/share/doc/libxine1-dbg
+	dh_link			-plibxine1-dbg
+	dh_compress 		-plibxine1-dbg
+	dh_fixperms 		-plibxine1-dbg
+	dh_installdeb 		-plibxine1-dbg
+	dh_shlibdeps 		-plibxine1-dbg
+	dh_gencontrol 		-plibxine1-dbg
+	dh_md5sums 		-plibxine1-dbg
+	dh_builddeb 		-plibxine1-dbg
+
+# Build architecture independant packages using the common target
+binary-indep: build install
+	set -e; for i in `dh_listpackages -i`; do \
+		$(MAKE) -f debian/rules \
+	             DH_OPTIONS=-p$$i DH_PACKAGE=$$i binary-common; \
+	done
+#	-(cd debian/libxine-dev && find .) | grep -v DEBIAN > $@-stamp
+
+# Build architecture dependant packages using the common targets
+binary-arch: build install binary-arch-stamp diff-installed-files
+binary-arch-stamp: $(addprefix binary-, $(BINARY_ANY_PACKAGES))
+	-cat binary-*-stamp | sort -u > $@
+
+diff-installed-files: install-stamp binary-arch-stamp
+	@echo "Comparing installed files from xine-lib Makefiles" \
+	      "with files installed in packages:"
+	-diff -u $^
+
+generate-arch-files-stamp: \
+		debian/libxine1-bin.install.i386 \
+		debian/libxine1-bin.install.kfreebsd-i386 \
+		debian/libxine1-x.install.kfreebsd-i386 \
+		debian/libxine1-x.install.kfreebsd-amd64 \
+		debian/libxine1-misc-plugins.install.kfreebsd-i386 \
+		debian/libxine1-misc-plugins.install.kfreebsd-amd64 \
+		debian/libxine1-console.install.kfreebsd-i386 \
+		debian/libxine1-console.install.kfreebsd-amd64
+	touch generate-arch-files-stamp
+
+# i386 specific plugins are also available for kfreebsd-i386
+debian/libxine1-bin.install.i386: \
+		debian/libxine1-bin.install \
+		debian/libxine1-bin.install.i386.specific
+	cat $^ >$@
+
+debian/libxine1-bin.install.kfreebsd-i386: debian/libxine1-bin.install.i386
+	ln -f $^ $@
+
+# create install files for Debian GNU/kFreeBSD i386/amd64 by dropping
+# everything which is not available on those architectures.
+debian/libxine1-x.install.kfreebsd-i386: debian/libxine1-x.install
+	grep -v -e dxr3 -e syncfb $^ >$@
+
+debian/libxine1-misc-plugins.install.kfreebsd-i386: debian/libxine1-misc-plugins.install
+	grep -v -e dxr3 -e pvr -e v4l -e alsa $^ >$@
+
+debian/libxine1-console.install.kfreebsd-i386: debian/libxine1-console.install
+	grep -v -e out_fb $^ >$@
+
+debian/libxine1-%-amd64: debian/libxine1-%-i386
+	ln -f $^ $@
+
+
+# Any other binary targets build just one binary package at a time.
+binary-%: build install
+	make -f debian/rules binary-common DH_OPTIONS=-p$* DH_PACKAGE=$*
+	-(cd debian/$* && find .) | grep -v DEBIAN > $@-stamp
+
+binary: binary-indep binary-arch
+.PHONY: build clean binary-indep binary-arch binary-common binary install configure diff-installed-files
+
+
+#run only by hand!
+ifneq (,$(wildcard /usr/share/misc/config.guess))
+config.guess:
+	@echo updateing config.guess
+	cp -f /usr/share/misc/config.guess config.guess
+endif
+
+ifneq (,$(wildcard /usr/share/misc/config.guess))
+config.sub: /usr/share/misc/config.sub
+	@echo updateing config.sub and config.guess
+	cp -f /usr/share/misc/config.sub config.sub
+endif
+
diff -Nur xine-lib-1.1.11.1/debian/shlibs.local xine-lib-1.1.11.1-ubuntu/debian/shlibs.local
--- xine-lib-1.1.11.1/debian/shlibs.local	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/shlibs.local	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1 @@
+libxine 1 libxine1-bin (= ${binary:Version})
diff -Nur xine-lib-1.1.11.1/debian/shlibs.local.libxine1-bin xine-lib-1.1.11.1-ubuntu/debian/shlibs.local.libxine1-bin
--- xine-lib-1.1.11.1/debian/shlibs.local.libxine1-bin	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/shlibs.local.libxine1-bin	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1 @@
+libxine 1
diff -Nur xine-lib-1.1.11.1/debian/watch xine-lib-1.1.11.1-ubuntu/debian/watch
--- xine-lib-1.1.11.1/debian/watch	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/debian/watch	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,2 @@
+version=3
+http://sf.net/xine/xine-lib-(.+)\.tar\.gz
diff -Nur xine-lib-1.1.11.1/doc/faq/Makefile.in xine-lib-1.1.11.1-ubuntu/doc/faq/Makefile.in
--- xine-lib-1.1.11.1/doc/faq/Makefile.in	2008-03-30 16:02:27.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/doc/faq/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/doc/hackersguide/Makefile.in xine-lib-1.1.11.1-ubuntu/doc/hackersguide/Makefile.in
--- xine-lib-1.1.11.1/doc/hackersguide/Makefile.in	2008-03-30 16:02:27.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/doc/hackersguide/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/doc/Makefile.in xine-lib-1.1.11.1-ubuntu/doc/Makefile.in
--- xine-lib-1.1.11.1/doc/Makefile.in	2008-03-30 16:02:27.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/doc/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -520,8 +520,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -546,8 +546,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -557,12 +557,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/doc/man/en/Makefile.in xine-lib-1.1.11.1-ubuntu/doc/man/en/Makefile.in
--- xine-lib-1.1.11.1/doc/man/en/Makefile.in	2008-03-30 16:02:27.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/doc/man/en/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/doc/man/Makefile.in xine-lib-1.1.11.1-ubuntu/doc/man/Makefile.in
--- xine-lib-1.1.11.1/doc/man/Makefile.in	2008-03-30 16:02:27.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/doc/man/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -488,8 +488,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -514,8 +514,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -525,12 +525,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/include/Makefile.in xine-lib-1.1.11.1-ubuntu/include/Makefile.in
--- xine-lib-1.1.11.1/include/Makefile.in	2008-03-30 16:02:27.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/include/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -453,8 +453,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -466,8 +466,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -477,12 +477,13 @@
 CTAGS:  $(HEADERS) $(SOURCES) configure.h.in $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS) configure.h.in $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/lib/Makefile.in xine-lib-1.1.11.1-ubuntu/lib/Makefile.in
--- xine-lib-1.1.11.1/lib/Makefile.in	2008-03-30 16:02:28.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/lib/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -64,7 +64,7 @@
 libxineposix_la_DEPENDENCIES = @LTLIBOBJS@
 am_libxineposix_la_OBJECTS =
 libxineposix_la_OBJECTS = $(am_libxineposix_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -513,8 +513,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -526,8 +526,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -537,12 +537,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/m4/Makefile.in xine-lib-1.1.11.1-ubuntu/m4/Makefile.in
--- xine-lib-1.1.11.1/m4/Makefile.in	2008-03-30 16:02:28.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/m4/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/Makefile.in xine-lib-1.1.11.1-ubuntu/Makefile.in
--- xine-lib-1.1.11.1/Makefile.in	2008-03-30 16:02:42.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -552,8 +552,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -578,8 +578,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -589,12 +589,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
@@ -664,10 +665,6 @@
 	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
 	$(am__remove_distdir)
 
-dist-lzma: distdir
-	tardir=$(distdir) && $(am__tar) | lzma -9 -c >$(distdir).tar.lzma
-	$(am__remove_distdir)
-
 dist-tarZ: distdir
 	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
 	$(am__remove_distdir)
@@ -694,8 +691,6 @@
 	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
 	*.tar.bz2*) \
 	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.lzma*) \
-	  unlzma -c $(distdir).tar.lzma | $(am__untar) ;;\
 	*.tar.Z*) \
 	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
 	*.shar.gz*) \
@@ -851,8 +846,8 @@
 .PHONY: $(RECURSIVE_CLEAN_TARGETS) $(RECURSIVE_TARGETS) CTAGS GTAGS \
 	all all-am am--refresh check check-am clean clean-generic \
 	clean-libtool ctags ctags-recursive dist dist-all dist-bzip2 \
-	dist-gzip dist-lzma dist-shar dist-tarZ dist-zip distcheck \
-	distclean distclean-generic distclean-libtool distclean-tags \
+	dist-gzip dist-shar dist-tarZ dist-zip distcheck distclean \
+	distclean-generic distclean-libtool distclean-tags \
 	distcleancheck distdir distuninstallcheck dvi dvi-am html \
 	html-am info info-am install install-am install-data \
 	install-data-am install-data-hook install-dist_docDATA \
diff -Nur xine-lib-1.1.11.1/misc/cdda_server.c xine-lib-1.1.11.1-ubuntu/misc/cdda_server.c
--- xine-lib-1.1.11.1/misc/cdda_server.c	2008-01-23 06:11:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/misc/cdda_server.c	2009-10-02 15:28:05.000000000 +0200
@@ -480,6 +480,12 @@
 
         sscanf(cmd,"%*s %d %d", &start_frame, &num_frames);
 
+        if (num_frames > INT_MAX / CD_RAW_FRAME_SIZE)
+        {
+          printf ("fatal error: integer overflow\n");
+          exit (1);
+        }
+
         n = num_frames * CD_RAW_FRAME_SIZE;
         buf = malloc( n );
         if( !buf )
@@ -556,6 +562,11 @@
         char *buf;
 
         sscanf(cmd,"%*s %d %d", &blocks, &flags);
+        if (blocks > INT_MAX / DVD_BLOCK_SIZE)
+        {
+          printf ("fatal error: integer overflow\n");
+          exit (1);
+        }
 
         n = blocks * DVD_BLOCK_SIZE;
         buf = malloc( n );
diff -Nur xine-lib-1.1.11.1/misc/fonts/Makefile.in xine-lib-1.1.11.1-ubuntu/misc/fonts/Makefile.in
--- xine-lib-1.1.11.1/misc/fonts/Makefile.in	2008-03-30 16:02:28.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/misc/fonts/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/misc/Makefile.in xine-lib-1.1.11.1-ubuntu/misc/Makefile.in
--- xine-lib-1.1.11.1/misc/Makefile.in	2008-03-30 16:02:28.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/misc/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -568,8 +568,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -594,8 +594,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -605,12 +605,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/audio_out/audio_pulse_out.c xine-lib-1.1.11.1-ubuntu/src/audio_out/audio_pulse_out.c
--- xine-lib-1.1.11.1/src/audio_out/audio_pulse_out.c	2008-03-28 15:24:49.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/audio_out/audio_pulse_out.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,28 @@
-/* 
- * Copyright (C) 2000-2007 the xine project
- * 
+/* -*- Mode: C; c-basic-offset: 2; indent-tabs-mode: nil -*- */
+
+/*
+ * Copyright (C) 2000-2008 the xine project
+ *
  * This file is part of xine, a free video player.
- * 
+ *
  * xine is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License as published by
  * the Free Software Foundation; either version 2 of the License, or
  * (at your option) any later version.
- * 
+ *
  * xine is distributed in the hope that it will be useful,
  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  * GNU General Public License for more details.
- * 
+ *
  * You should have received a copy of the GNU General Public License
  * along with this program; if not, write to the Free Software
  * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110, USA
  *
- * ao plugin for pulseaudio (rename of polypaudio):
+ * ao plugin for PulseAudio:
  * http://0pointer.de/lennart/projects/pulsaudio/
  *
- * originally written for polypaudio simple api. Lennart then suggested
- * using the async api for better control (such as volume), therefore, a lot
- * of this code comes from Lennart's patch to mplayer.
+ * Diego Petteno, Lennart Poettering
  */
 
 #ifdef HAVE_CONFIG_H
@@ -48,15 +48,9 @@
 
 #define GAP_TOLERANCE        AO_MAX_GAP
 
-/* CHECKME: should this be conditional on autotools? */
-extern const char *__progname;
-
 typedef struct {
   audio_driver_class_t  driver_class;
   xine_t                      *xine;
-
-  struct pa_context           *context;   /*< Pulseaudio connection context */
-  struct pa_threaded_mainloop *mainloop;  /*< Main event loop object */
 } pulse_class_t;
 
 typedef struct pulse_driver_s {
@@ -67,11 +61,13 @@
 
   char             *host;    /*< The host to connect to */
   char             *sink;    /*< The sink to connect to */
-  struct pa_stream *stream;  /*< Pulseaudio playback stream object */
 
-  pthread_mutex_t   info_mutex; /**< Mutex for info callback signaling */
+  pa_threaded_mainloop *mainloop;  /*< Main event loop object */
+  pa_context *context;             /*< Pulseaudio connection context */
+  pa_stream  *stream;              /*< Pulseaudio playback stream object */
 
   pa_volume_t       swvolume;
+  int muted;
   pa_cvolume        cvolume;
 
   int               capabilities;
@@ -82,67 +78,117 @@
   uint32_t          bits_per_sample;
   uint32_t          bytes_per_frame;
 
-  uint32_t          frames_written;
-
 } pulse_driver_t;
 
 
 /**
- * @brief Callback function called when a stream operation succeed
- * @param stream Stream which operation has succeeded
- * @param success The success value for the operation (ignored)
- * @param this_Gen pulse_driver_t pointer for the PulseAudio output
- *        instance.
+ * @brief Callback function called when the state of the context is changed
+ * @param c Context which changed status
+ * @param this_gen pulse_class_t pointer for the PulseAudio output class
  */
-static void __xine_pa_stream_success_callback(pa_stream *const stream, const int success,
-					      void *const mutex_gen)
+static void __xine_pa_context_state_callback(pa_context *c, void *this_gen)
 {
-  pthread_mutex_t *const completion_mutex = (pthread_mutex_t*)mutex_gen;
+  pulse_driver_t * this = (pulse_driver_t*) this_gen;
+
+  switch (pa_context_get_state(c)) {
+
+    case PA_CONTEXT_READY:
+    case PA_CONTEXT_TERMINATED:
+    case PA_CONTEXT_FAILED:
+      pa_threaded_mainloop_signal(this->mainloop, 0);
+      break;
 
-  pthread_mutex_unlock(completion_mutex);
+    case PA_CONTEXT_CONNECTING:
+    case PA_CONTEXT_UNCONNECTED:
+    case PA_CONTEXT_AUTHORIZING:
+    case PA_CONTEXT_SETTING_NAME:
+      break;
+  }
 }
 
 /**
- * @brief Callback function called when the state of the context is changed
- * @param ctx Context which operation has succeeded
+ * @brief Callback function called when the state of the stream is changed
+ * @param s Stream that changed status
  * @param this_gen pulse_driver_t pointer for the PulseAudio output
  *        instance.
  */
-static void __xine_pa_context_status_callback(pa_context *const ctx, void *const this_gen)
+static void __xine_pa_stream_state_callback(pa_stream *s, void *this_gen)
 {
-  pulse_driver_t *const this = (pulse_driver_t*)this_gen;
+  pulse_driver_t * this = (pulse_driver_t*) this_gen;
+
+  switch (pa_stream_get_state(s)) {
+
+    case PA_STREAM_READY:
+    case PA_STREAM_TERMINATED:
+    case PA_STREAM_FAILED:
+      pa_threaded_mainloop_signal(this->mainloop, 0);
+      break;
 
-  switch (pa_context_get_state(ctx)) {
-  case PA_CONTEXT_READY:
-  case PA_CONTEXT_TERMINATED:
-  case PA_CONTEXT_FAILED:
-    pa_threaded_mainloop_signal(this->pa_class->mainloop, 0);
-    break;
-
-  case PA_CONTEXT_CONNECTING:
-  case PA_CONTEXT_UNCONNECTED:
-  case PA_CONTEXT_AUTHORIZING:
-  case PA_CONTEXT_SETTING_NAME:
-    break;
+    case PA_STREAM_UNCONNECTED:
+    case PA_STREAM_CREATING:
+      break;
   }
 }
 
 /**
- * @brief Callback function called when a context operation succeed
+ * @brief Callback function called when PA asks for more audio data.
+ * @param s Stream on which data is requested
+ * @param nbytes the number of bytes PA requested
+ * @param this_gen pulse_driver_t pointer for the PulseAudio output
+ *        instance.
+ */
+static void __xine_pa_stream_request_callback(pa_stream *s, size_t nbytes, void *this_gen)
+{
+  pulse_driver_t * this = (pulse_driver_t*) this_gen;
+
+  pa_threaded_mainloop_signal(this->mainloop, 0);
+}
+
+/**
+ * @brief Callback function called when PA notifies about something
+ * @param s Stream on which the notification happened
+ * @param this_gen pulse_driver_t pointer for the PulseAudio output
+ *        instance.
+ */
+static void __xine_pa_stream_notify_callback(pa_stream *s, void *this_gen)
+{
+  pulse_driver_t * this = (pulse_driver_t*) this_gen;
+
+  pa_threaded_mainloop_signal(this->mainloop, 0);
+}
+
+/**
+ * @brief Callback function called when PA completed an operation
  * @param ctx Context which operation has succeeded
- * @param success The success value for the operation (ignored)
+ * @param nbytes the number of bytes PA requested
  * @param this_gen pulse_driver_t pointer for the PulseAudio output
  *        instance.
  */
-static void __xine_pa_context_success_callback(pa_context *const ctx, const int success,
-					      void *const this_gen)
+static void __xine_pa_stream_success_callback(pa_stream *s, int success, void *this_gen)
 {
-  pulse_driver_t *const this = (pulse_driver_t*)this_gen;
+  pulse_driver_t * this = (pulse_driver_t*) this_gen;
 
-  _x_assert(ctx); _x_assert(this);
-  _x_assert(ctx == this->pa_class->context);
+  if (!success)
+    xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: stream operation failed: %s\n", pa_strerror(pa_context_errno(this->context)));
 
-  pa_threaded_mainloop_signal(this->pa_class->mainloop, 0);
+  pa_threaded_mainloop_signal(this->mainloop, 0);
+}
+
+/**
+ * @brief Callback function called when PA completed an operation
+ * @param c Context on which operation has succeeded
+ * @param nbytes the number of bytes PA requested
+ * @param this_gen pulse_driver_t pointer for the PulseAudio output
+ *        instance.
+ */
+static void __xine_pa_context_success_callback(pa_context *c, int success, void *this_gen)
+{
+  pulse_driver_t *this = (pulse_driver_t*) this_gen;
+
+  if (!success)
+    xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: context operation failed: %s\n", pa_strerror(pa_context_errno(this->context)));
+
+  pa_threaded_mainloop_signal(this->mainloop, 0);
 }
 
 /**
@@ -156,14 +202,14 @@
  * This function saves the volume field of the passed structure to the
  * @c cvolume variable of the output instance.
  */
-static void __xine_pa_sink_info_callback(pa_context *const ctx, const pa_sink_input_info *const info,
-					 const int is_last, void *const userdata) {
+static void __xine_pa_sink_info_callback(pa_context *c, const pa_sink_input_info *info,
+                                         int is_last, void *userdata) {
 
   pulse_driver_t *const this = (pulse_driver_t *) userdata;
 
   if (is_last < 0) {
     xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: Failed to get sink input info: %s\n",
-             pa_strerror(pa_context_errno(this->pa_class->context)));
+             pa_strerror(pa_context_errno(this->context)));
     return;
   }
 
@@ -171,36 +217,90 @@
       return;
 
   this->cvolume = info->volume;
+  this->swvolume = pa_sw_volume_to_linear(pa_cvolume_avg(&info->volume));
+  this->muted = info->mute;
+}
+
+static int connect_context(pulse_driver_t *this) {
+
+  if (this->context && (pa_context_get_state(this->context) == PA_CONTEXT_FAILED ||
+                        pa_context_get_state(this->context) == PA_CONTEXT_TERMINATED)) {
+    pa_context_unref(this->context);
+    this->context = NULL;
+  }
+
+  if (!this->context) {
+    char fn[PATH_MAX], *p;
+
+    if (pa_get_binary_name(fn, sizeof(fn)))
+      p = pa_path_get_filename(fn);
+    else
+      p = "Xine";
 
-  pthread_mutex_unlock(&this->info_mutex);
+    this->context = pa_context_new(pa_threaded_mainloop_get_api(this->mainloop), p);
+    _x_assert(this->context);
+
+    pa_context_set_state_callback(this->context, __xine_pa_context_state_callback, this);
+  }
+
+  if (pa_context_get_state(this->context) == PA_CONTEXT_UNCONNECTED) {
+
+    if (pa_context_connect(this->context, this->host, 0, NULL) < 0) {
+      xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: failed to connect context object %s\n", pa_strerror(pa_context_errno(this->context)));
+      return -1;
+    }
+  }
+
+  for (;;) {
+    pa_context_state_t state = pa_context_get_state(this->context);
+
+    if (state == PA_CONTEXT_FAILED || state == PA_CONTEXT_TERMINATED) {
+      xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: failed to connect context object: %s\n", pa_strerror(pa_context_errno(this->context)));
+      return -1;
+    }
+
+    if (state == PA_CONTEXT_READY)
+      break;
+
+    pa_threaded_mainloop_wait(this->mainloop);
+  }
+
+  return 0;
 }
 
 /*
  * open the audio device for writing to
  */
 static int ao_pulse_open(ao_driver_t *this_gen,
-		   uint32_t bits, uint32_t rate, int mode)
+                         uint32_t bits, uint32_t rate, int mode)
 {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
-  struct pa_sample_spec ss;
-  struct pa_buffer_attr a;
-  pa_stream_state_t streamstate;
+  pa_sample_spec ss;
+  pa_channel_map cm;
+  int r;
 
   xprintf (this->xine, XINE_VERBOSITY_DEBUG,
-	   "audio_pulse_out: ao_open bits=%d rate=%d, mode=%d\n", bits, rate, mode);
+           "audio_pulse_out: ao_open bits=%d rate=%d, mode=%d\n", bits, rate, mode);
 
   if ( (mode & this->capabilities) == 0 ) {
     xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: unsupported mode %08x\n", mode);
     return 0;
   }
 
+  pa_threaded_mainloop_lock(this->mainloop);
+
   if (this->stream) {
 
-    if ( mode == this->mode && rate == this->sample_rate &&
-         bits == this->bits_per_sample )
+    if (mode == this->mode && rate == this->sample_rate &&
+        bits == this->bits_per_sample) {
+
+      pa_threaded_mainloop_unlock(this->mainloop);
       return this->sample_rate;
+    }
 
-    this_gen->close(this_gen);
+    pa_stream_disconnect(this->stream);
+    pa_stream_unref(this->stream);
+    this->stream = NULL;
   }
 
   this->mode                   = mode;
@@ -221,6 +321,8 @@
     case 32:
       ss.format = PA_SAMPLE_FLOAT32NE;
       break;
+    default:
+      _x_assert(!"Should not be reached");
   }
 
   if (!pa_sample_spec_valid(&ss)) {
@@ -228,70 +330,86 @@
     goto fail;
   }
 
-  if ( this->pa_class->context && pa_context_get_state(this->pa_class->context) > PA_CONTEXT_READY ) {
-    pa_context_unref(this->pa_class->context);
-    this->pa_class->context = NULL;
-  }
-
-  if ( this->pa_class->context == NULL ) {
-    this->pa_class->context = pa_context_new(pa_threaded_mainloop_get_api(this->pa_class->mainloop),
-					     __progname);
-  }
-
-  pa_context_ref(this->pa_class->context);
+  cm.channels = ss.channels;
 
-  if ( pa_context_get_state(this->pa_class->context) == PA_CONTEXT_UNCONNECTED ) {
-    int ret;
+  switch (mode) {
+    case AO_CAP_MODE_MONO:
+      cm.map[0] = PA_CHANNEL_POSITION_MONO;
+      _x_assert(cm.channels == 1);
+      break;
 
-    pa_threaded_mainloop_lock(this->pa_class->mainloop);
-    ret = pa_context_connect(this->pa_class->context, this->host, 1, NULL);
-    if ( ret < 0 )
-      goto fail_unlock;
+    case AO_CAP_MODE_STEREO:
+      cm.map[0] = PA_CHANNEL_POSITION_FRONT_LEFT;
+      cm.map[1] = PA_CHANNEL_POSITION_FRONT_RIGHT;
+      _x_assert(cm.channels == 2);
+      break;
 
-    pa_context_set_state_callback(this->pa_class->context, __xine_pa_context_status_callback, this);
+    case AO_CAP_MODE_4CHANNEL:
+      cm.map[0] = PA_CHANNEL_POSITION_FRONT_LEFT;
+      cm.map[1] = PA_CHANNEL_POSITION_FRONT_RIGHT;
+      cm.map[2] = PA_CHANNEL_POSITION_REAR_LEFT;
+      cm.map[3] = PA_CHANNEL_POSITION_REAR_RIGHT;
+      _x_assert(cm.channels == 4);
+      break;
 
-    pa_threaded_mainloop_wait(this->pa_class->mainloop);
-    pa_threaded_mainloop_unlock(this->pa_class->mainloop);
+    case AO_CAP_MODE_4_1CHANNEL:
+    case AO_CAP_MODE_5CHANNEL:
+    case AO_CAP_MODE_5_1CHANNEL:
+      cm.map[0] = PA_CHANNEL_POSITION_FRONT_LEFT;
+      cm.map[1] = PA_CHANNEL_POSITION_FRONT_RIGHT;
+      cm.map[2] = PA_CHANNEL_POSITION_REAR_LEFT;
+      cm.map[3] = PA_CHANNEL_POSITION_REAR_RIGHT;
+      cm.map[4] = PA_CHANNEL_POSITION_FRONT_CENTER;
+      cm.map[5] = PA_CHANNEL_POSITION_LFE;
+      cm.channels = 6;
+      break;
+    default:
+      _x_assert(!"Should not be reached");
   }
 
-  if (pa_context_get_state(this->pa_class->context) != PA_CONTEXT_READY) {
-    xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: Failed to connect to server: %s\n",
-	     pa_strerror(pa_context_errno(this->pa_class->context)));
+  if (!pa_channel_map_valid(&cm)) {
+    xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: Invalid channel map\n");
     goto fail;
   }
 
-  this->stream = pa_stream_new(this->pa_class->context, "audio stream", &ss, NULL);
+  if (connect_context(this) < 0)
+    goto fail;
+
+  _x_assert(!this->stream);
+  this->stream = pa_stream_new(this->context, "Audio Stream", &ss, &cm);
   _x_assert(this->stream);
 
-  a.maxlength = pa_bytes_per_second(&ss)*1;
-  a.tlength = a.maxlength*9/10;
-  a.prebuf = a.tlength/2;
-  a.minreq = a.tlength/10;
+  pa_stream_set_state_callback(this->stream, __xine_pa_stream_state_callback, this);
+  pa_stream_set_write_callback(this->stream, __xine_pa_stream_request_callback, this);
+  pa_stream_set_latency_update_callback(this->stream, __xine_pa_stream_notify_callback, this);
 
-  pa_stream_connect_playback(this->stream, this->sink, &a,
-                             PA_STREAM_INTERPOLATE_TIMING|PA_STREAM_AUTO_TIMING_UPDATE, 
+  r = pa_stream_connect_playback(this->stream, this->sink, NULL,
+                             PA_STREAM_INTERPOLATE_TIMING|PA_STREAM_AUTO_TIMING_UPDATE,
                              NULL, NULL);
 
-  do {
-    xine_usec_sleep (100);
+  for (;;) {
+    pa_context_state_t cstate = pa_context_get_state(this->context);
+    pa_stream_state_t sstate = pa_stream_get_state(this->stream);
+
+    if (cstate == PA_CONTEXT_FAILED || cstate == PA_CONTEXT_TERMINATED ||
+        sstate == PA_STREAM_FAILED || sstate == PA_STREAM_TERMINATED) {
+      xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: failed to connect context object: %s\n", pa_strerror(pa_context_errno(this->context)));
+      goto fail;
+    }
 
-    streamstate = pa_stream_get_state(this->stream);
-  } while (streamstate < PA_STREAM_READY);
-     
-  if (streamstate != PA_STREAM_READY) {
-    xprintf (this->xine, XINE_VERBOSITY_LOG, "audio_pulse_out: Failed to connect to server: %s\n",
-             pa_strerror(pa_context_errno(this->pa_class->context)));
-    goto fail;
+    if (sstate == PA_STREAM_READY)
+      break;
+
+    pa_threaded_mainloop_wait(this->mainloop);
   }
-  this->frames_written = 0;
 
-  this->ao_driver.set_property(this, AO_PROP_PCM_VOL, 100);
+  pa_threaded_mainloop_unlock(this->mainloop);
 
   return this->sample_rate;
 
- fail_unlock:
-  pa_threaded_mainloop_unlock(this->pa_class->mainloop);
  fail:
+
+  pa_threaded_mainloop_unlock(this->mainloop);
   this_gen->close(this_gen);
   return 0;
 }
@@ -319,217 +437,348 @@
 {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
   size_t size = num_frames * this->bytes_per_frame;
-  int ret = 0;
-  
-  if ( !this->stream || !this->pa_class->context)
-    return -1;
-
-  switch( pa_stream_get_state(this->stream) ) {
-  case PA_STREAM_READY:
-    while (size > 0) {
-      size_t l;
+  int ret = -1;
+  size_t done = 0;
 
-      while (!(l = pa_stream_writable_size(this->stream))) {
-        xine_usec_sleep (10000);
-      }
+  pa_threaded_mainloop_lock(this->mainloop);
 
-      if (l > size)
-        l = size;
-        
-      pa_stream_write(this->stream, data, l, NULL, 0, PA_SEEK_RELATIVE);
-      data = (int16_t *) ((uint8_t*) data + l);
-      size -= l;
-    }
+  while (size > 0) {
+    size_t l;
 
-    this->frames_written += num_frames;
+    for (;;) {
 
-    if (pa_stream_get_state(this->stream) == PA_STREAM_READY)
-      ret = 1;
+      if (!this->stream ||
+          !this->context ||
+          pa_context_get_state(this->context) != PA_CONTEXT_READY ||
+          pa_stream_get_state(this->stream) != PA_STREAM_READY)
+        goto finish;
 
-    break;
+      if ((l = pa_stream_writable_size(this->stream)) == (size_t) -1)
+        goto finish;
+
+      if (l > 0)
+        break;
+
+      pa_threaded_mainloop_wait(this->mainloop);
+    }
+
+    if (l > size)
+      l = size;
+
+    pa_stream_write(this->stream, data, l, NULL, 0, PA_SEEK_RELATIVE);
+    data = (int16_t *) ((uint8_t*) data + l);
+    size -= l;
+    done += l;
   }
 
+  ret = done;
+
+finish:
+
+  pa_threaded_mainloop_unlock(this->mainloop);
+
+/*   fprintf(stderr, "write-out\n"); */
+
   return ret;
-}
 
+}
 
 static int ao_pulse_delay (ao_driver_t *this_gen)
 {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
-  pa_usec_t latency = 0;
-  unsigned int delay_frames;
+  int ret = 0;
 
-  if ( ! this->stream ) return this->frames_written;
+/*   fprintf(stderr, "delay-in\n"); */
 
-  if (pa_stream_get_latency(this->stream, &latency, NULL) < 0) {
-    pa_context_unref(this->pa_class->context);
-    this->pa_class->context = NULL;
+  pa_threaded_mainloop_lock(this->mainloop);
 
-    pa_stream_disconnect(this->stream);
-    pa_stream_unref(this->stream);
-    this->stream = NULL;
+  for (;;) {
+    pa_usec_t latency = 0;
 
-    return 0;
+    if (!this->stream ||
+        !this->context ||
+        pa_context_get_state(this->context) != PA_CONTEXT_READY ||
+        pa_stream_get_state(this->stream) != PA_STREAM_READY)
+      goto finish;
+
+    if (pa_stream_get_latency(this->stream, &latency, NULL) >= 0) {
+      ret = (int) ((latency * this->sample_rate) / 1000000);
+      goto finish;
+    }
+
+    if (pa_context_errno(this->context) != PA_ERR_NODATA) {
+      xprintf (this->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: failed to query latency: %s\n", pa_strerror(pa_context_errno(this->context)));
+      goto finish;
+    }
+
+    pa_threaded_mainloop_wait(this->mainloop);
   }
 
-  /* convert latency (us) to frame units. */
-  delay_frames = (int)(latency * this->sample_rate / 1000000);
+finish:
 
-  if( delay_frames > this->frames_written )
-    return this->frames_written;
-  else
-    return delay_frames;
+  pa_threaded_mainloop_unlock(this->mainloop);
+
+  return ret;
 }
 
 static void ao_pulse_close(ao_driver_t *this_gen)
 {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
-  
-  if (this->stream) {
-    if (pa_stream_get_state(this->stream) == PA_STREAM_READY) {
-      pthread_mutex_t completion_callback = PTHREAD_MUTEX_INITIALIZER; pthread_mutex_lock(&completion_callback);
-      pa_stream_drain(this->stream, __xine_pa_stream_success_callback, &completion_callback);
 
-      pthread_mutex_lock(&completion_callback);
-      pthread_mutex_destroy(&completion_callback);
-    }
+  pa_threaded_mainloop_lock(this->mainloop);
 
+  if (this->stream) {
     pa_stream_disconnect(this->stream);
     pa_stream_unref(this->stream);
     this->stream = NULL;
-
-    pa_context_unref(this->pa_class->context);
   }
+
+  pa_threaded_mainloop_unlock(this->mainloop);
 }
 
 static uint32_t ao_pulse_get_capabilities (ao_driver_t *this_gen) {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
+
   return this->capabilities;
 }
 
-static void ao_pulse_exit(ao_driver_t *this_gen)
-{
+static void ao_pulse_exit(ao_driver_t *this_gen) {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
 
-  free (this);
+  ao_pulse_close(this_gen);
+
+  pa_threaded_mainloop_lock(this->mainloop);
+
+  if (this->context) {
+    pa_context_disconnect(this->context);
+    pa_context_unref(this->context);
+  }
+
+  pa_threaded_mainloop_unlock(this->mainloop);
+
+  pa_threaded_mainloop_free(this->mainloop);
+
+  free(this->host);
+  free(this->sink);
+  free(this);
+}
+
+static int wait_for_operation(pulse_driver_t *this, pa_operation *o) {
+
+  for (;;) {
+
+    if (!this->stream ||
+        !this->context ||
+        pa_context_get_state(this->context) != PA_CONTEXT_READY ||
+        pa_stream_get_state(this->stream) != PA_STREAM_READY)
+      return -1;
+
+    if (pa_operation_get_state(o) != PA_OPERATION_RUNNING)
+      return 0;
+
+    pa_threaded_mainloop_wait(this->mainloop);
+  }
 }
 
 static int ao_pulse_get_property (ao_driver_t *this_gen, int property) {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
   int result = 0;
+  pa_operation *o = NULL;
 
-  if ( ! this->stream || ! this->pa_class->context )
+  pa_threaded_mainloop_lock(this->mainloop);
+
+  if (!this->stream ||
+      !this->context ||
+      pa_context_get_state(this->context) != PA_CONTEXT_READY ||
+      pa_stream_get_state(this->stream) != PA_STREAM_READY) {
+    pa_threaded_mainloop_unlock(this->mainloop);
     return 0;
+  }
 
   switch(property) {
-  case AO_PROP_PCM_VOL:
-  case AO_PROP_MIXER_VOL:
-    {
-      pthread_mutex_lock(&this->info_mutex);
-      pa_operation *o = pa_context_get_sink_input_info(this->pa_class->context,
-						       pa_stream_get_index(this->stream),
-						       __xine_pa_sink_info_callback, this);
-      if ( ! o ) return 0;
-      pthread_mutex_lock(&this->info_mutex); pthread_mutex_unlock(&this->info_mutex);
-			 
-      result = (pa_sw_volume_to_linear(this->swvolume)*100);
-    }
-    break;
 
-  case AO_PROP_MUTE_VOL:
-    result = pa_cvolume_is_muted(&this->cvolume);
-    break;
+    case AO_PROP_MUTE_VOL:
+    case AO_PROP_PCM_VOL:
+    case AO_PROP_MIXER_VOL:
+
+      o = pa_context_get_sink_input_info(this->context, pa_stream_get_index(this->stream),
+                                         __xine_pa_sink_info_callback, this);
+
+      break;
+  }
+
+  if (o) {
+    wait_for_operation(this, o);
+    pa_operation_unref(o);
   }
-  
+
+  switch(property) {
+
+    case AO_PROP_MUTE_VOL:
+      result = this->muted;
+      break;
+
+    case AO_PROP_PCM_VOL:
+    case AO_PROP_MIXER_VOL:
+      result = (int) (pa_sw_volume_to_linear(this->swvolume)*100);
+      break;
+  }
+
+  pa_threaded_mainloop_unlock(this->mainloop);
+
   return result;
 }
 
 static int ao_pulse_set_property (ao_driver_t *this_gen, int property, int value) {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
   int result = ~value;
+  pa_operation *o = NULL;
 
-  if ( ! this->stream || ! this->pa_class->context )
-    return result;
+  pa_threaded_mainloop_lock(this->mainloop);
+
+  if (!this->stream ||
+      !this->context ||
+      pa_context_get_state(this->context) != PA_CONTEXT_READY ||
+      pa_stream_get_state(this->stream) != PA_STREAM_READY) {
+    pa_threaded_mainloop_unlock(this->mainloop);
+    return 0;
+  }
 
   switch(property) {
-  case AO_PROP_PCM_VOL:
-  case AO_PROP_MIXER_VOL:
-    this->swvolume = pa_sw_volume_from_linear((double)value/100.0);
-    pa_cvolume_set(&this->cvolume, pa_stream_get_sample_spec(this->stream)->channels, this->swvolume);
-
-    pa_context_set_sink_input_volume(this->pa_class->context, pa_stream_get_index(this->stream),
-				     &this->cvolume, __xine_pa_context_success_callback, this);
-
-    result = value;
-    break;
-
-  case AO_PROP_MUTE_VOL:
-    if ( value )
-      pa_cvolume_mute(&this->cvolume, pa_stream_get_sample_spec(this->stream)->channels);
-    else
+    case AO_PROP_PCM_VOL:
+    case AO_PROP_MIXER_VOL:
+
+      this->swvolume = pa_sw_volume_from_linear((double)value/100.0);
       pa_cvolume_set(&this->cvolume, pa_stream_get_sample_spec(this->stream)->channels, this->swvolume);
 
-    pa_context_set_sink_input_volume(this->pa_class->context, pa_stream_get_index(this->stream),
-				     &this->cvolume, __xine_pa_context_success_callback, this);
-    
-    result = value;
-    break;
+      o = pa_context_set_sink_input_volume(this->context, pa_stream_get_index(this->stream),
+                                           &this->cvolume, __xine_pa_context_success_callback, this);
+
+      result = value;
+      break;
+
+    case AO_PROP_MUTE_VOL:
+
+      this->muted = value;
+
+      o = pa_context_set_sink_input_mute(this->context, pa_stream_get_index(this->stream),
+                                           value, __xine_pa_context_success_callback, this);
+
+      result = value;
+  }
+
+  if (o) {
+    wait_for_operation(this, o);
+    pa_operation_unref(o);
   }
-  
+
+  pa_threaded_mainloop_unlock(this->mainloop);
+
   return result;
 }
 
 static int ao_pulse_ctrl(ao_driver_t *this_gen, int cmd, ...) {
   pulse_driver_t *this = (pulse_driver_t *) this_gen;
+  pa_operation *o = NULL;
+
+  pa_threaded_mainloop_lock(this->mainloop);
 
-  if ( ! this->stream ) return 0;
+  if (!this->stream ||
+      !this->context ||
+      pa_context_get_state(this->context) != PA_CONTEXT_READY ||
+      pa_stream_get_state(this->stream) != PA_STREAM_READY) {
+    pa_threaded_mainloop_unlock(this->mainloop);
+    return 0;
+  }
 
   switch (cmd) {
 
-  case AO_CTRL_FLUSH_BUFFERS:
-    _x_assert(this->stream && this->pa_class->context);
+    case AO_CTRL_FLUSH_BUFFERS:
 
-    if(pa_stream_get_state(this->stream) == PA_STREAM_READY) {
-      pthread_mutex_t completion_callback = PTHREAD_MUTEX_INITIALIZER; pthread_mutex_lock(&completion_callback);
-      pa_stream_flush(this->stream, __xine_pa_stream_success_callback, &completion_callback);
+      o = pa_stream_flush(this->stream, __xine_pa_stream_success_callback, this);
+      break;
 
-      pthread_mutex_lock(&completion_callback);
-      pthread_mutex_destroy(&completion_callback);
-    }
+    case AO_CTRL_PLAY_RESUME:
+    case AO_CTRL_PLAY_PAUSE:
 
-    this->frames_written = 0;
+      o = pa_stream_cork(this->stream, cmd == AO_CTRL_PLAY_PAUSE, __xine_pa_stream_success_callback, this);
+      break;
+  }
 
-    break;
+  if (o) {
+    wait_for_operation(this, o);
+    pa_operation_unref(o);
   }
 
+  pa_threaded_mainloop_unlock(this->mainloop);
+
   return 0;
 }
 
 static ao_driver_t *open_plugin (audio_driver_class_t *class_gen, const void *data) {
   pulse_class_t   *class = (pulse_class_t *) class_gen;
   pulse_driver_t  *this;
-  char *device;
+  const char* device;
+  int r;
 
   lprintf ("audio_pulse_out: open_plugin called\n");
 
   this = (pulse_driver_t *) xine_xmalloc (sizeof (pulse_driver_t));
   if (!this)
     return NULL;
+
   this->xine = class->xine;
+  this->host = NULL;
+  this->sink = NULL;
+  this->context = NULL;
+  this->mainloop = NULL;
+
+  device = class->xine->config->register_string(class->xine->config,
+                                         "audio.pulseaudio_device",
+                                         "",
+                                         _("device used for pulseaudio"),
+                                         _("use 'server[:sink]' for setting the "
+                                           "pulseaudio sink device."),
+                                         10, NULL,
+                                         NULL);
+
+  if (device && *device) {
+    char *sep = strrchr(device, ':');
+    if ( sep ) {
+      if (!(this->host = strndup(device, sep-device))) {
+        free(this);
+        return NULL;
+      }
+
+      if (!(this->sink = strdup(sep+1))) {
+        free(this->host);
+        free(this);
+        return NULL;
+      }
+    } else {
+
+      if (!(this->host = strdup(device))) {
+        free(this);
+        return NULL;
+      }
+    }
+  }
+
+  this->mainloop = pa_threaded_mainloop_new();
+  _x_assert(this->mainloop);
+  pa_threaded_mainloop_start(this->mainloop);
 
   /*
    * set capabilities
    */
-  this->capabilities = AO_CAP_MODE_MONO | AO_CAP_MODE_STEREO | AO_CAP_MODE_4CHANNEL |
-                       AO_CAP_MODE_4_1CHANNEL | AO_CAP_MODE_5CHANNEL |
-                       AO_CAP_MODE_5_1CHANNEL | AO_CAP_MIXER_VOL |
-                       AO_CAP_PCM_VOL | AO_CAP_MUTE_VOL | AO_CAP_8BITS |
-                       AO_CAP_16BITS | AO_CAP_FLOAT32;
+  this->capabilities =
+    AO_CAP_MODE_MONO | AO_CAP_MODE_STEREO | AO_CAP_MODE_4CHANNEL |
+    AO_CAP_MODE_4_1CHANNEL | AO_CAP_MODE_5CHANNEL | AO_CAP_MODE_5_1CHANNEL |
+    AO_CAP_MIXER_VOL | AO_CAP_PCM_VOL | AO_CAP_MUTE_VOL |
+    AO_CAP_8BITS | AO_CAP_16BITS | AO_CAP_FLOAT32;
 
   this->sample_rate  = 0;
-  this->host         = NULL;
-  this->sink         = NULL;
-  
+
   this->ao_driver.get_capabilities    = ao_pulse_get_capabilities;
   this->ao_driver.get_property        = ao_pulse_get_property;
   this->ao_driver.set_property        = ao_pulse_set_property;
@@ -541,33 +790,22 @@
   this->ao_driver.close               = ao_pulse_close;
   this->ao_driver.exit                = ao_pulse_exit;
   this->ao_driver.get_gap_tolerance   = ao_pulse_get_gap_tolerance;
-  this->ao_driver.control	      = ao_pulse_ctrl;
-
-  device = this->xine->config->register_string(this->xine->config,
-                                               "audio.pulseaudio_device",
-                                               "",
-                                               _("device used for pulseaudio"),
-                                               _("use 'server[:sink]' for setting the "
-                                                 "pulseaudio sink device."),
-                                               10, NULL,
-                                               NULL);
-
-  if (device && *device) {
-    char *sep = strchr(device, ':');
-    if ( sep ) {
-      this->host = strndup(device, sep-device);
-      this->sink = strdup(&sep[1]);
-    } else
-      this->host = strdup(device);
-  }
-
-  pthread_mutex_init(&this->info_mutex, NULL);
+  this->ao_driver.control             = ao_pulse_ctrl;
 
   xprintf (class->xine, XINE_VERBOSITY_DEBUG, "audio_pulse_out: host %s sink %s\n",
            this->host ? this->host : "(null)", this->sink ? this->sink : "(null)");
 
   this->pa_class = class;
 
+  pa_threaded_mainloop_lock(this->mainloop);
+  r = connect_context(this);
+  pa_threaded_mainloop_unlock(this->mainloop);
+
+  if (r < 0) {
+    ao_pulse_exit((ao_driver_t *) this);
+    return NULL;
+  }
+
   return &this->ao_driver;
 }
 
@@ -587,13 +825,7 @@
 
   pulse_class_t *this = (pulse_class_t *) this_gen;
 
-  if ( this->context )
-    pa_context_unref(this->context);
-
-  pa_threaded_mainloop_stop(this->mainloop);
-  pa_threaded_mainloop_free(this->mainloop);
-
-  free (this);
+  free(this);
 }
 
 static void *init_class (xine_t *xine, void *data) {
@@ -606,25 +838,17 @@
   if (!this)
     return NULL;
 
+  this->xine = xine;
   this->driver_class.open_plugin     = open_plugin;
   this->driver_class.get_identifier  = get_identifier;
   this->driver_class.get_description = get_description;
   this->driver_class.dispose         = dispose_class;
 
-  this->xine                         = xine;
-
-  this->mainloop = pa_threaded_mainloop_new();
-  _x_assert(this->mainloop);
-
-  pa_threaded_mainloop_start(this->mainloop);
-  
-  this->context = NULL;
-
   return this;
 }
 
 static const ao_info_t ao_info_pulse = {
-  6
+  12
 };
 
 /*
@@ -636,5 +860,3 @@
   { PLUGIN_AUDIO_OUT, 8, "pulseaudio", XINE_VERSION_CODE, &ao_info_pulse, init_class },
   { PLUGIN_NONE, 0, "", 0, NULL, NULL }
 };
-
-
diff -Nur xine-lib-1.1.11.1/src/audio_out/Makefile.in xine-lib-1.1.11.1-ubuntu/src/audio_out/Makefile.in
--- xine-lib-1.1.11.1/src/audio_out/Makefile.in	2008-03-30 16:02:28.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/audio_out/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -212,7 +212,7 @@
 	$(xineplug_ao_out_sun_la_LDFLAGS) $(LDFLAGS) -o $@
 @HAVE_SUNAUDIO_TRUE@am_xineplug_ao_out_sun_la_rpath = -rpath \
 @HAVE_SUNAUDIO_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -696,8 +696,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -705,8 +705,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -887,8 +887,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -900,8 +900,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -911,12 +911,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/combined/demux_wavpack.c xine-lib-1.1.11.1-ubuntu/src/combined/demux_wavpack.c
--- xine-lib-1.1.11.1/src/combined/demux_wavpack.c	2008-03-28 15:24:49.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/combined/demux_wavpack.c	2009-10-02 15:28:05.000000000 +0200
@@ -391,7 +391,7 @@
 }
 
 static const char *get_mimetypes (demux_class_t *const this_gen) {
-  return "audio/x-wavpack";
+  return "audio/x-wavpack: wv,wvp: WavPack audio;";
 }
 
 static void class_dispose (demux_class_t *const this_gen) {
diff -Nur xine-lib-1.1.11.1/src/combined/ffmpeg/ff_video_decoder.c xine-lib-1.1.11.1-ubuntu/src/combined/ffmpeg/ff_video_decoder.c
--- xine-lib-1.1.11.1/src/combined/ffmpeg/ff_video_decoder.c	2008-03-28 15:24:49.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/combined/ffmpeg/ff_video_decoder.c	2009-10-02 15:28:05.000000000 +0200
@@ -596,6 +596,10 @@
   su = this->av_frame->data[1];
   sv = this->av_frame->data[2];
 
+  /* Some segfaults & heap corruption have been observed with img->height,
+   * so we use this->bih.biHeight instead (which is the displayed height)
+   */
+
   if (this->context->pix_fmt == PIX_FMT_YUV410P) {
 
     yuv9_to_yv12(
@@ -616,7 +620,7 @@
       img->pitches[2],
      /* width x height */
       img->width,
-      img->height);
+      this->bih.biHeight);
 
   } else if (this->context->pix_fmt == PIX_FMT_YUV411P) {
 
@@ -638,7 +642,7 @@
       img->pitches[2],
      /* width x height */
       img->width,
-      img->height);
+      this->bih.biHeight);
 
   } else if (this->context->pix_fmt == PIX_FMT_RGBA32) {
           
@@ -646,7 +650,7 @@
     uint32_t *argb_pixels;
     uint32_t argb;
 
-    for(y = 0; y < img->height; y++) {
+    for(y = 0; y < this->bih.biHeight; y++) {
       argb_pixels = (uint32_t *)sy;
       for(x = 0; x < img->width; x++) {
         uint8_t r, g, b;
@@ -674,7 +678,7 @@
     uint8_t *src;
     uint16_t pixel16;
 
-    for(y = 0; y < img->height; y++) {
+    for(y = 0; y < this->bih.biHeight; y++) {
       src = sy;
       for(x = 0; x < img->width; x++) {
         uint8_t r, g, b;
@@ -703,7 +707,7 @@
     uint8_t *src;
     uint16_t pixel16;
             
-    for(y = 0; y < img->height; y++) {
+    for(y = 0; y < this->bih.biHeight; y++) {
       src = sy;
       for(x = 0; x < img->width; x++) {
         uint8_t r, g, b;
@@ -731,7 +735,7 @@
     int x, plane_ptr = 0;
     uint8_t *src;
 
-    for(y = 0; y < img->height; y++) {
+    for(y = 0; y < this->bih.biHeight; y++) {
       src = sy;
       for(x = 0; x < img->width; x++) {
         uint8_t r, g, b;
@@ -755,7 +759,7 @@
     int x, plane_ptr = 0;
     uint8_t *src;
 
-    for(y = 0; y < img->height; y++) {
+    for(y = 0; y < this->bih.biHeight; y++) {
       src = sy;
       for(x = 0; x < img->width; x++) {
         uint8_t r, g, b;
@@ -798,7 +802,7 @@
       v_palette[x] = COMPUTE_V(r, g, b);
     }
 
-    for(y = 0; y < img->height; y++) {
+    for(y = 0; y < this->bih.biHeight; y++) {
       src = sy;
       for(x = 0; x < img->width; x++) {
         pixel = *src++;
@@ -815,7 +819,7 @@
           
   } else {
           
-    for (y=0; y<img->height; y++) {
+    for (y = 0; y < this->bih.biHeight; y++) {
       xine_fast_memcpy (dy, sy, img->width);
   
       dy += img->pitches[0];
@@ -823,7 +827,7 @@
       sy += this->av_frame->linesize[0];
     }
 
-    for (y=0; y<(img->height/2); y++) {
+    for (y = 0; y < this->bih.biHeight / 2; y++) {
       
       if (this->context->pix_fmt != PIX_FMT_YUV444P) {
         
diff -Nur xine-lib-1.1.11.1/src/combined/ffmpeg/Makefile.in xine-lib-1.1.11.1-ubuntu/src/combined/ffmpeg/Makefile.in
--- xine-lib-1.1.11.1/src/combined/ffmpeg/Makefile.in	2008-03-30 16:02:29.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/combined/ffmpeg/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -499,8 +499,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -508,8 +508,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -612,8 +612,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -625,8 +625,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -636,12 +636,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/combined/Makefile.in xine-lib-1.1.11.1-ubuntu/src/combined/Makefile.in
--- xine-lib-1.1.11.1/src/combined/Makefile.in	2008-03-30 16:02:29.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/combined/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -85,7 +85,7 @@
 	$(xineplug_wavpack_la_LDFLAGS) $(LDFLAGS) -o $@
 @HAVE_WAVPACK_TRUE@am_xineplug_wavpack_la_rpath = -rpath \
 @HAVE_WAVPACK_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -467,8 +467,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -476,8 +476,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -642,8 +642,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -668,8 +668,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -679,12 +679,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_4xm.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_4xm.c
--- xine-lib-1.1.11.1/src/demuxers/demux_4xm.c	2008-03-28 23:50:47.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_4xm.c	2009-10-02 15:28:05.000000000 +0200
@@ -199,8 +199,12 @@
         return 0;
       }
       current_track = _X_LE_32(&header[i + 8]);
-      if (current_track + 1 > fourxm->track_count) {
+      if (current_track >= fourxm->track_count) {
         fourxm->track_count = current_track + 1;
+        if (!fourxm->track_count || fourxm->track_count >= UINT_MAX / sizeof(audio_track_t)) {
+          free(header);
+          return 0;
+        }
         fourxm->tracks = realloc(fourxm->tracks,
           fourxm->track_count * sizeof(audio_track_t));
         if (!fourxm->tracks) {
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_aac.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_aac.c
--- xine-lib-1.1.11.1/src/demuxers/demux_aac.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_aac.c	2009-10-02 15:28:05.000000000 +0200
@@ -176,7 +176,7 @@
     buf->extra_info->input_time = (8*current_pos) / (bitrate/1000);
 
   bytes_read = this->input->read(this->input, buf->content, buf->max_size);
-  if (bytes_read == 0) {
+  if (bytes_read <= 0) {
     buf->free_buffer(buf);
     this->status = DEMUX_FINISHED;
     return this->status;
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_ac3.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_ac3.c
--- xine-lib-1.1.11.1/src/demuxers/demux_ac3.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_ac3.c	2009-10-02 15:28:05.000000000 +0200
@@ -308,13 +308,7 @@
                                   this->frame_size);
   }
 
-  if (buf->size == 0) {
-    buf->free_buffer(buf);
-    this->status = DEMUX_FINISHED;
-    return this->status;
-  }
-
-  if (buf->size == 0) {
+  if (buf->size <= 0) {
     buf->free_buffer(buf);
     this->status = DEMUX_FINISHED;
     return this->status;
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_asf.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_asf.c
--- xine-lib-1.1.11.1/src/demuxers/demux_asf.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_asf.c	2009-10-02 15:28:05.000000000 +0200
@@ -70,6 +70,7 @@
 #define ASF_MODE_HTTP_REF          2
 #define ASF_MODE_ASF_REF           3
 #define ASF_MODE_ENCRYPTED_CONTENT 4
+#define ASF_MODE_NO_CONTENT        5
 
 typedef struct {
   int                 seq;
@@ -435,6 +436,17 @@
     asf_stream_t *asf_stream = this->asf_header->streams[i];
     asf_demux_stream_t *demux_stream = &this->streams[i];
 
+    if (!asf_stream) {
+      if (this->mode != ASF_MODE_NO_CONTENT) {
+	xine_log(this->stream->xine, XINE_LOG_MSG,
+		 _("demux_asf: warning: A stream appears to be missing.\n"));
+	_x_message(this->stream, XINE_MSG_READ_ERROR,
+		   _("Media stream missing?"), NULL);
+	this->mode = ASF_MODE_NO_CONTENT;
+      }
+      return 0;
+    }
+
     if (asf_stream->encrypted_flag) {
       if (this->mode != ASF_MODE_ENCRYPTED_CONTENT) {
 	xine_log(this->stream->xine, XINE_LOG_MSG,
@@ -1671,6 +1683,7 @@
       return demux_asf_parse_asf_references(this);
 
     case ASF_MODE_ENCRYPTED_CONTENT:
+    case ASF_MODE_NO_CONTENT:
       this->status = DEMUX_FINISHED;
       return this->status;
 
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_avi.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_avi.c
--- xine-lib-1.1.11.1/src/demuxers/demux_avi.c	2008-03-28 23:50:47.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_avi.c	2009-10-02 15:28:05.000000000 +0200
@@ -317,6 +317,8 @@
                                       getIndex==0, but an operation has been
                                       performed that needs an index */
 
+#define AVI_ERR_BAD_SIZE    14     /* A chunk has an invalid size */
+
 #define AVI_HEADER_UNKNOWN  -1
 #define AVI_HEADER_AUDIO     0
 #define AVI_HEADER_VIDEO     1
@@ -780,7 +782,7 @@
     lprintf("chunk: %c%c%c%c, size: %" PRId64 "\n",
             data[0], data[1], data[2], data[3], (int64_t)n);
     
-    if((strncasecmp(data,"LIST",4) == 0) && (n >= 4)) {
+    if (n >= 4 && strncasecmp(data,"LIST",4) == 0) {
       if( this->input->read(this->input, data,4) != 4 ) ERR_EXIT(AVI_ERR_READ);
       n -= 4;
       
@@ -836,6 +838,8 @@
   /* Interpret the header list */
 
   for (i = 0; i < hdrl_len;) {
+    const int old_i = i;
+
     /* List tags are completly ignored */
     lprintf("tag: %c%c%c%c\n",
             hdrl_data[i], hdrl_data[i+1], hdrl_data[i+2], hdrl_data[i+3]);
@@ -1083,6 +1087,8 @@
       lasttag = 0;
     }
     i += n;
+    if (i <= old_i)
+      ERR_EXIT(AVI_ERR_BAD_SIZE);
   }
 
   if( hdrl_data )
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_dts.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_dts.c
--- xine-lib-1.1.11.1/src/demuxers/demux_dts.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_dts.c	2009-10-02 15:28:05.000000000 +0200
@@ -269,7 +269,7 @@
                                   this->frame_size);
   }
 
-  if (buf->size == 0) {
+  if (buf->size <= 0) {
     buf->free_buffer(buf);
     this->status = DEMUX_FINISHED;
     return this->status;
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_matroska.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_matroska.c
--- xine-lib-1.1.11.1/src/demuxers/demux_matroska.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_matroska.c	2009-10-02 15:28:05.000000000 +0200
@@ -113,7 +113,7 @@
 
   /* block */
   uint8_t             *block_data;
-  int                  block_data_size;
+  size_t               block_data_size;
 
   /* current tracks */
   matroska_track_t    *video_track;   /* to remove */
@@ -614,6 +614,8 @@
   int i;
   uint8_t *data;
 
+  if (track->codec_private_len < 3)
+    return;
   nb_lace = track->codec_private[0];
   if (nb_lace != 2)
     return;
@@ -621,6 +623,8 @@
   frame[0] = track->codec_private[1];
   frame[1] = track->codec_private[2];
   frame[2] = track->codec_private_len - frame[0] - frame[1] - 3;
+  if (frame[2] < 0)
+    return;
 
   data = track->codec_private + 3;
   for (i = 0; i < 3; i++) {
@@ -884,7 +888,7 @@
 
 static void handle_realvideo (demux_plugin_t *this_gen, matroska_track_t *track,
                               int decoder_flags,
-                              uint8_t *data, int data_len,
+                              uint8_t *data, size_t data_len,
                               int64_t data_pts, int data_duration,
                               int input_normpos, int input_time) {
   demux_matroska_t *this = (demux_matroska_t *) this_gen;
@@ -933,7 +937,7 @@
 
 static void handle_sub_ssa (demux_plugin_t *this_gen, matroska_track_t *track,
                             int decoder_flags,
-                            uint8_t *data, int data_len,
+                            uint8_t *data, size_t data_len,
                             int64_t data_pts, int data_duration,
                             int input_normpos, int input_time) {
   buf_element_t *buf;
@@ -1008,7 +1012,7 @@
 
 static void handle_sub_utf8 (demux_plugin_t *this_gen, matroska_track_t *track,
                              int decoder_flags,
-                             uint8_t *data, int data_len,
+                             uint8_t *data, size_t data_len,
                              int64_t data_pts, int data_duration,
                              int input_normpos, int input_time) {
   demux_matroska_t *this = (demux_matroska_t *) this_gen;
@@ -1055,7 +1059,7 @@
  */
 static void handle_vobsub (demux_plugin_t *this_gen, matroska_track_t *track,
                            int decoder_flags,
-                           uint8_t *data, int data_len,
+                           uint8_t *data, size_t data_len,
                            int64_t data_pts, int data_duration,
                            int input_normpos, int input_time) {
   demux_matroska_t *this = (demux_matroska_t *) this_gen;
@@ -1188,7 +1192,12 @@
       break;
         
       case MATROSKA_ID_TR_CODECPRIVATE: {
-        char *codec_private = malloc (elem.len);
+        char *codec_private;
+	if (elem.len >= 0x80000000)
+	  return 0;
+        codec_private = malloc (elem.len);
+	if (! codec_private)
+	  return 0;
         lprintf("CodecPrivate\n");
         if (!ebml_read_binary(ebml, &elem, codec_private)) {
 	  free(codec_private);
@@ -1292,12 +1301,14 @@
     if (!strcmp(track->codec_id, MATROSKA_CODEC_ID_V_VFW_FOURCC)) {
       xine_bmiheader *bih;
 
-      lprintf("MATROSKA_CODEC_ID_V_VFW_FOURCC\n");
-      bih = (xine_bmiheader*)track->codec_private;
-      _x_bmiheader_le2me(bih);
+      if (track->codec_private_len >= sizeof(xine_bmiheader)) {
+        lprintf("MATROSKA_CODEC_ID_V_VFW_FOURCC\n");
+        bih = (xine_bmiheader*)track->codec_private;
+        _x_bmiheader_le2me(bih);
 
-      track->buf_type = _x_fourcc_to_buf_video(bih->biCompression);
-      init_codec = init_codec_video;
+        track->buf_type = _x_fourcc_to_buf_video(bih->biCompression);
+        init_codec = init_codec_video;
+      }
 
     } else if (!strcmp(track->codec_id, MATROSKA_CODEC_ID_V_UNCOMPRESSED)) {
     } else if ((!strcmp(track->codec_id, MATROSKA_CODEC_ID_V_MPEG4_SP)) ||
@@ -1403,11 +1414,13 @@
       xine_waveformatex *wfh;
       lprintf("MATROSKA_CODEC_ID_A_ACM\n");
 
-      wfh = (xine_waveformatex*)track->codec_private;
-      _x_waveformatex_le2me(wfh);
+      if (track->codec_private_len >= sizeof(xine_waveformatex)) {
+        wfh = (xine_waveformatex*)track->codec_private;
+        _x_waveformatex_le2me(wfh);
 
-      track->buf_type = _x_formattag_to_buf_audio(wfh->wFormatTag);
-      init_codec = init_codec_audio;
+        track->buf_type = _x_formattag_to_buf_audio(wfh->wFormatTag);
+        init_codec = init_codec_audio;
+      }
     } else if (!strncmp(track->codec_id, MATROSKA_CODEC_ID_A_AAC,
                         sizeof(MATROSKA_CODEC_ID_A_AAC) - 1)) {
       lprintf("MATROSKA_CODEC_ID_A_AAC\n");
@@ -1488,9 +1501,14 @@
           break;
       }
 
-      if (init_codec)
+      if (init_codec) {
+	if (! track->fifo) {
+	  xprintf(this->stream->xine, XINE_VERBOSITY_LOG,
+		  "demux_matroska: Error: fifo not set up for track of type type %" PRIu32 "\n", track->track_type);
+	  return 0;
+        }
         init_codec(this, track);
-      
+      }
     }
   }
   
@@ -1740,7 +1758,7 @@
   return 1;
 }
 
-static void alloc_block_data (demux_matroska_t *this, int len) {
+static void alloc_block_data (demux_matroska_t *this, size_t len) {
   /* memory management */
   if (this->block_data_size < len) {
     if (this->block_data)
@@ -1812,10 +1830,15 @@
 }
 
 
-static int read_block_data (demux_matroska_t *this, int len) {
+static int read_block_data (demux_matroska_t *this, size_t len) {
   alloc_block_data(this, len);
 
   /* block datas */
+  if (! this->block_data) {
+    xprintf(this->stream->xine, XINE_VERBOSITY_LOG,
+            "demux_matroska: memory allocation error\n");
+    return 0;
+  }
   if (this->input->read(this->input, this->block_data, len) != len) {
     off_t pos = this->input->get_current_pos(this->input);
     xprintf(this->stream->xine, XINE_VERBOSITY_LOG,
@@ -1835,7 +1858,7 @@
   return value;
 }
 
-static int parse_block (demux_matroska_t *this, uint64_t block_size,
+static int parse_block (demux_matroska_t *this, size_t block_size,
                         uint64_t cluster_timecode, uint64_t block_duration,
                         int normpos, int is_key) {
   matroska_track_t *track;
@@ -1901,7 +1924,7 @@
   }
 
   if (lacing == MATROSKA_NO_LACING) {
-    int block_size_left;
+    size_t block_size_left;
     lprintf("no lacing\n");
 
     block_size_left = (this->block_data + block_size) - data;
@@ -1921,9 +1944,9 @@
     }
   } else {
 
-    int block_size_left;
+    size_t block_size_left;
     uint8_t lace_num;
-    int frame[MAX_FRAMES];
+    size_t frame[MAX_FRAMES];
     int i;
 
     /* number of laced frames */
@@ -2064,7 +2087,7 @@
   off_t block_pos         = 0;
   off_t file_len          = 0;
   int normpos             = 0;
-  int block_len           = 0;
+  size_t block_len        = 0;
   int is_key              = 1;
 
   while (next_level == 3) {
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_mng.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mng.c
--- xine-lib-1.1.11.1/src/demuxers/demux_mng.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mng.c	2009-10-02 15:28:05.000000000 +0200
@@ -104,7 +104,12 @@
 static mng_bool mymng_read_stream(mng_handle mngh, mng_ptr buffer, mng_uint32 size, mng_uint32 *bytesread){
   demux_mng_t *this = (demux_mng_t*)mng_get_userdata(mngh);
 
-  *bytesread = this->input->read(this->input, buffer, size);
+  off_t n = this->input->read(this->input, buffer, size);
+  if (n < 0) {
+	*bytesread = 0;
+	return MNG_FALSE;
+  }
+  *bytesread = n;
 
   return MNG_TRUE;
 }
@@ -112,11 +117,16 @@
 static mng_bool mymng_process_header(mng_handle mngh, mng_uint32 width, mng_uint32 height){
   demux_mng_t *this = (demux_mng_t*)mng_get_userdata(mngh);
 
+  if (width > 0x8000 || height > 0x8000)
+      return MNG_FALSE;
+
   this->bih.biWidth = (width + 7) & ~7;
   this->bih.biHeight = height;
   this->left_edge = (this->bih.biWidth - width) / 2;
 
-  this->image = malloc(this->bih.biWidth * height * 3);
+  this->image = malloc((mng_size_t)this->bih.biWidth * (mng_size_t)height * 3);
+  if (!this->image)
+    return MNG_FALSE;
 
   mng_set_canvasstyle(mngh, MNG_CANVAS_RGB8);
 
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_mod.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mod.c
--- xine-lib-1.1.11.1/src/demuxers/demux_mod.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mod.c	2009-10-02 15:28:05.000000000 +0200
@@ -73,7 +73,7 @@
   char                *title;
   char                *artist;
   char                *copyright;
-  off_t                filesize;
+  size_t               filesize;
   
   char                *buffer;
 
@@ -134,7 +134,11 @@
   /* Get size and create buffer */
   this->filesize = this->input->get_length(this->input);
   this->buffer = (char *)malloc(this->filesize);
-  
+  if(!this->buffer) {
+    xine_log(this->stream->xine, XINE_LOG_PLUGIN, "modplug - allocation failure\n");
+    return 0;
+  }
+
   /* Seek to beginning */
   this->input->seek(this->input, 0, SEEK_SET);
   
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_mpc.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mpc.c
--- xine-lib-1.1.11.1/src/demuxers/demux_mpc.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mpc.c	2009-10-02 15:28:05.000000000 +0200
@@ -214,7 +214,7 @@
   
   /* Read data */
   bytes_read = this->input->read(this->input, buf->content, bytes_to_read);
-  if(bytes_read == 0) {
+  if(bytes_read <= 0) {
     buf->free_buffer(buf);
     this->status = DEMUX_FINISHED;
     return this->status;
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_mpeg.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mpeg.c
--- xine-lib-1.1.11.1/src/demuxers/demux_mpeg.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_mpeg.c	2009-10-02 15:28:05.000000000 +0200
@@ -920,7 +920,7 @@
       if (pos == len) {
 	len = this->input->read(this->input, dummy_buf, sizeof(dummy_buf));
         pos = 0;
-        if (len == 0) {
+        if (len <= 0) {
           this->status = DEMUX_FINISHED;
 	  break;
 	}
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_nsf.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_nsf.c
--- xine-lib-1.1.11.1/src/demuxers/demux_nsf.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_nsf.c	2009-10-02 15:28:05.000000000 +0200
@@ -106,9 +106,9 @@
 
   this->total_songs = header[6];
   this->current_song = header[7];
-  this->title = strdup(&header[0x0E]);
-  this->artist = strdup(&header[0x2E]);
-  this->copyright = strdup(&header[0x4E]);
+  this->title = strndup((char*)&header[0x0E], 0x20);
+  this->artist = strndup((char*)&header[0x2E], 0x20);
+  this->copyright = strndup((char*)&header[0x4E], 0x20);
 
   this->filesize = this->input->get_length(this->input);
 
@@ -128,7 +128,7 @@
     buf->type = BUF_AUDIO_NSF;
     bytes_read = this->input->read(this->input, buf->content, buf->max_size);
 
-    if (bytes_read == 0) {
+    if (bytes_read <= 0) {
       /* the file has been completely loaded, free the buffer and start
        * sending control buffers */
       buf->free_buffer(buf);
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_ogg.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_ogg.c
--- xine-lib-1.1.11.1/src/demuxers/demux_ogg.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_ogg.c	2009-10-02 15:28:05.000000000 +0200
@@ -237,7 +237,7 @@
   while (ogg_sync_pageout(&this->oy,&this->og)!=1) {
     buffer = ogg_sync_buffer(&this->oy, CHUNKSIZE);
     bytes  = this->input->read(this->input, buffer, CHUNKSIZE);
-    if (bytes == 0) {
+    if (bytes <= 0) {
       if (total == 0) {
         lprintf("read_ogg_packet read nothing\n");
         return 0;
@@ -1352,7 +1352,7 @@
   this->ignore_keyframes = 0;
 
   while (!done) {
-    if (!read_ogg_packet(this)) {
+    if (!read_ogg_packet(this) || !this->og.header || !this->og.body) {
       return;
     }
     /* now we've got at least one new page */
@@ -1478,6 +1478,12 @@
     return this->status;
   }
 
+  if (!this->og.header || !this->og.body) {
+    this->status = DEMUX_FINISHED;
+    lprintf ("EOF\n");
+    return this->status;
+  }
+
   /* now we've got one new page */
 
   cur_serno = ogg_page_serialno (&this->og);
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_qt.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_qt.c
--- xine-lib-1.1.11.1/src/demuxers/demux_qt.c	2008-03-28 23:50:47.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_qt.c	2009-10-02 15:28:05.000000000 +0200
@@ -738,6 +738,8 @@
 
     if (current_atom == ART_ATOM) {
       string_size = _X_BE_32(&meta_atom[i + 4]) - 16 + 1;
+      if (string_size <= 0)
+        continue;
       info->artist = xine_xmalloc(string_size);
       if (info->artist) {
         strncpy(info->artist, &meta_atom[i + 20], string_size - 1);
@@ -745,6 +747,8 @@
       }
     } else if (current_atom == NAM_ATOM) {
       string_size = _X_BE_32(&meta_atom[i + 4]) - 16 + 1;
+      if (string_size <= 0)
+        continue;
       info->name = xine_xmalloc(string_size);
       if (info->name) {
         strncpy(info->name, &meta_atom[i + 20], string_size - 1);
@@ -752,6 +756,8 @@
       }
     } else if (current_atom == ALB_ATOM) {
       string_size = _X_BE_32(&meta_atom[i + 4]) - 16 + 1;
+      if (string_size <= 0)
+        continue;
       info->album = xine_xmalloc(string_size);
       if (info->album) {
         strncpy(info->album, &meta_atom[i + 20], string_size - 1);
@@ -759,6 +765,8 @@
       }
     } else if (current_atom == GEN_ATOM) {
       string_size = _X_BE_32(&meta_atom[i + 4]) - 16 + 1;
+      if (string_size <= 0)
+        continue;
       info->genre = xine_xmalloc(string_size);
       if (info->genre) {
         strncpy(info->genre, &meta_atom[i + 20], string_size - 1);
@@ -766,6 +774,8 @@
       }
     } else if (current_atom == TOO_ATOM) {
       string_size = _X_BE_32(&meta_atom[i + 4]) - 16 + 1;
+      if (string_size <= 0)
+        continue;
       info->comment = xine_xmalloc(string_size);
       if (info->comment) {
         strncpy(info->comment, &meta_atom[i + 20], string_size - 1);
@@ -773,6 +783,8 @@
       }
     } else if (current_atom == WRT_ATOM) {
       string_size = _X_BE_32(&meta_atom[i + 4]) - 16 + 1;
+      if (string_size <= 0)
+        continue;
       info->composer = xine_xmalloc(string_size);
       if (info->composer) {
         strncpy(info->composer, &meta_atom[i + 20], string_size - 1);
@@ -780,6 +792,8 @@
       }
     } else if (current_atom == DAY_ATOM) {
       string_size = _X_BE_32(&meta_atom[i + 4]) - 16 + 1;
+      if (string_size <= 0)
+        continue;
       info->year = xine_xmalloc(string_size);
       if (info->year) {
         strncpy(info->year, &meta_atom[i + 20], string_size - 1);
@@ -896,11 +910,6 @@
     current_atom_size = _X_BE_32(&trak_atom[i - 4]);	
     current_atom = _X_BE_32(&trak_atom[i]);
 
-    if (current_atom_size > trak_atom_size - i) {
-      last_error = QT_NOT_A_VALID_FILE;
-      goto free_trak;
-    }
-
     if (current_atom == TKHD_ATOM) {
       trak->flags = _X_BE_16(&trak_atom[i + 6]);
     } else if (current_atom == ELST_ATOM) {
@@ -952,6 +961,10 @@
 
       /* allocate space for each of the properties unions */
       trak->stsd_atoms_count = _X_BE_32(&trak_atom[i + 8]);
+      if (trak->stsd_atoms_count <= 0) {
+        last_error = QT_HEADER_TROUBLE;
+        goto free_trak;
+      }
       trak->stsd_atoms = calloc(trak->stsd_atoms_count, sizeof(properties_t));
       if (!trak->stsd_atoms) {
         last_error = QT_NO_MEMORY;
@@ -964,6 +977,10 @@
       for (k = 0; k < trak->stsd_atoms_count; k++) {
 
         current_stsd_atom_size = _X_BE_32(&trak_atom[atom_pos - 4]);      
+        if (current_stsd_atom_size < 4) {
+          last_error = QT_HEADER_TROUBLE;
+          goto free_trak;
+        }
 
         if (trak->type == MEDIA_VIDEO) {
 
@@ -1518,7 +1535,8 @@
     } else if (current_atom == STTS_ATOM) {
 
       /* there should only be one of these atoms */
-      if (trak->time_to_sample_table) {
+      if (trak->time_to_sample_table
+          || current_atom_size < 12 || current_atom_size >= UINT_MAX) {
         last_error = QT_HEADER_TROUBLE;
         goto free_trak;
       }
@@ -1528,6 +1546,11 @@
       debug_atom_load("    qt stts atom (time-to-sample atom): %d entries\n",
         trak->time_to_sample_count);
 
+      if (trak->time_to_sample_count > (current_atom_size - 12) / 8) {
+        last_error = QT_HEADER_TROUBLE;
+        goto free_trak;
+      }
+
       trak->time_to_sample_table = (time_to_sample_table_t *)calloc(
         trak->time_to_sample_count+1, sizeof(time_to_sample_table_t));
       if (!trak->time_to_sample_table) {
@@ -1580,13 +1603,16 @@
   qt_atom current_atom;
   unsigned int current_atom_size;
 
+  if (ref_atom_size >= 0x80000000)
+    return QT_NOT_A_VALID_FILE;
+
   /* initialize reference atom */
   ref->url = NULL;
   ref->data_rate = 0;
   ref->qtim_version = 0;
 
   /* traverse through the atom looking for the key atoms */
-  for (i = ATOM_PREAMBLE_SIZE; i < ref_atom_size - 4; i++) {
+  for (i = ATOM_PREAMBLE_SIZE; i + 4 < ref_atom_size; i++) {
 
     current_atom_size = _X_BE_32(&ref_atom[i - 4]);
     current_atom = _X_BE_32(&ref_atom[i]);
@@ -1595,7 +1621,7 @@
       size_t string_size = _X_BE_32(&ref_atom[i + 12]);
       size_t url_offset = 0;
 
-      if (string_size >= current_atom_size || i + string_size >= ref_atom_size)
+      if (string_size >= current_atom_size || string_size >= ref_atom_size - i)
         return QT_NOT_A_VALID_FILE;
 
       /* if the URL starts with "http://", copy it */
@@ -1603,6 +1629,8 @@
 	   memcmp(&ref_atom[i + 16], "rtsp://", 7) &&
 	   base_mrl )
 	url_offset = strlen(base_mrl);
+      if (url_offset >= 0x80000000)
+        return QT_NOT_A_VALID_FILE;
 
       /* otherwise, append relative URL to base MRL */
       string_size += url_offset;
@@ -2187,7 +2215,7 @@
   }
 
   /* check if moov is compressed */
-  if (_X_BE_32(&moov_atom[12]) == CMOV_ATOM) {
+  if (_X_BE_32(&moov_atom[12]) == CMOV_ATOM && moov_atom_size >= 0x28) {
 
     info->compressed_header = 1;
 
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_real.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_real.c
--- xine-lib-1.1.11.1/src/demuxers/demux_real.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_real.c	2009-10-02 15:28:05.000000000 +0200
@@ -264,8 +264,12 @@
   this->input->seek(this->input, original_pos, SEEK_SET);
 }
 
-static mdpr_t *real_parse_mdpr(const char *data) {
-  mdpr_t *mdpr=malloc(sizeof(mdpr_t));
+static mdpr_t *real_parse_mdpr(const char *data, const unsigned int size)
+{
+  if (size < 38)
+    return NULL;
+
+  mdpr_t *mdpr=calloc(sizeof(mdpr_t), 1);
 
   mdpr->stream_number=_X_BE_16(&data[2]);
   mdpr->max_bit_rate=_X_BE_32(&data[4]);
@@ -277,17 +281,29 @@
   mdpr->duration=_X_BE_32(&data[28]);
 
   mdpr->stream_name_size=data[32];
+  if (size < 38 + mdpr->stream_name_size)
+    goto fail;
   mdpr->stream_name=malloc(sizeof(char)*(mdpr->stream_name_size+1));
+  if (!mdpr->stream_name)
+    goto fail;
   memcpy(mdpr->stream_name, &data[33], mdpr->stream_name_size);
   mdpr->stream_name[(int)mdpr->stream_name_size]=0;
 
   mdpr->mime_type_size=data[33+mdpr->stream_name_size];
+  if (size < 38 + mdpr->stream_name_size + mdpr->mime_type_size)
+    goto fail;
   mdpr->mime_type=malloc(sizeof(char)*(mdpr->mime_type_size+1));
+  if (!mdpr->mime_type)
+    goto fail;
   memcpy(mdpr->mime_type, &data[34+mdpr->stream_name_size], mdpr->mime_type_size);
   mdpr->mime_type[(int)mdpr->mime_type_size]=0;
 
   mdpr->type_specific_len=_X_BE_32(&data[34+mdpr->stream_name_size+mdpr->mime_type_size]);
+  if (size < 38 + mdpr->stream_name_size + mdpr->mime_type_size + mdpr->type_specific_data)
+    goto fail;
   mdpr->type_specific_data=malloc(sizeof(char)*(mdpr->type_specific_len));
+  if (!mdpr->type_specific_data)
+    goto fail;
   memcpy(mdpr->type_specific_data,
       &data[38+mdpr->stream_name_size+mdpr->mime_type_size], mdpr->type_specific_len);
 
@@ -307,6 +323,13 @@
 #endif
 
   return mdpr;
+
+fail:
+  free (mdpr->stream_name);
+  free (mdpr->mime_type);
+  free (mdpr->type_specific_data);
+  free (mdpr);
+  return NULL;
 }
 
 static void real_free_mdpr (mdpr_t *mdpr) {
@@ -374,9 +397,14 @@
     case MDPR_TAG:
     case CONT_TAG:
 
+	if (chunk_size < PREAMBLE_SIZE+1) {
+	  this->status = DEMUX_FINISHED;
+	  return;
+	}
       chunk_size -= PREAMBLE_SIZE;
       chunk_buffer = xine_xmalloc(chunk_size);
-      if (this->input->read(this->input, chunk_buffer, chunk_size) !=
+      if (! chunk_buffer ||
+	    this->input->read(this->input, chunk_buffer, chunk_size) !=
 	  chunk_size) {
 	free (chunk_buffer);
 	this->status = DEMUX_FINISHED;
@@ -423,11 +451,15 @@
           continue;
         }
                 
-        mdpr = real_parse_mdpr (chunk_buffer);
+        mdpr = real_parse_mdpr (chunk_buffer, chunk_size);
 
         lprintf ("parsing type specific data...\n");
-
-        if(_X_BE_32(mdpr->type_specific_data) == RA_TAG) {
+	  if (!mdpr) {
+	    free (chunk_buffer);
+	    this->status = DEMUX_FINISHED;
+	    return;
+	  }
+        if(_X_BE_32(mdpr->type_specific_data) == RA_TAG && mdpr->type_specific_len >= 6) {
           int version, len;
 
           if(this->num_audio_streams == MAX_AUDIO_STREAMS) {
@@ -440,25 +472,35 @@
 
           lprintf("audio version %d detected\n", version);
 
+          char *fourcc_ptr = "\0\0\0";
           switch(version) {
             case 3:
               /* Version 3 header stores fourcc after meta info - cheat by reading backwards from the 
                * end of the header instead of having to parse it all */
-              fourcc = _X_ME_32(mdpr->type_specific_data + mdpr->type_specific_len - 5);
+	      if (mdpr->type_specific_len >= 5)
+                fourcc_ptr = mdpr->type_specific_data + mdpr->type_specific_len - 5;
               break;
-            case 4:
-              len = *(mdpr->type_specific_data + 56);
-              fourcc = _X_ME_32(mdpr->type_specific_data + 58 + len);
+            case 4: {
+	      if (mdpr->type_specific_len >= 57) {
+	        const uint8_t len = *(mdpr->type_specific_data + 56);
+	        if (mdpr->type_specific_len >= 62 + len)
+	          fourcc_ptr = mdpr->type_specific_data + 58 + len;
+	      }
+  	    }
               break;
             case 5:
-              fourcc = _X_ME_32(mdpr->type_specific_data + 66);
+	      if (mdpr->type_specific_len >= 70)
+                fourcc_ptr = mdpr->type_specific_data + 66;
               break;
             default:
               lprintf("unsupported audio header version %d\n", version);
               goto unknown;
           }
 
-          lprintf("fourcc = %.4s\n", (char *) &fourcc);
+ 	  lprintf("fourcc = %.4s\n", fourcc_ptr);
+ 
+ 	  fourcc = _X_ME_32(fourcc_ptr);
+
 
           this->audio_streams[this->num_audio_streams].fourcc = fourcc;
           this->audio_streams[this->num_audio_streams].buf_type = _x_formattag_to_buf_audio(fourcc);
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_shn.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_shn.c
--- xine-lib-1.1.11.1/src/demuxers/demux_shn.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_shn.c	2009-10-02 15:28:05.000000000 +0200
@@ -88,7 +88,7 @@
   buf->pts = 0;
 
   bytes_read = this->input->read(this->input, buf->content, buf->max_size);
-  if (bytes_read == 0) {
+  if (bytes_read <= 0) {
     buf->free_buffer(buf);
     this->status = DEMUX_FINISHED;
     return this->status;
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_slave.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_slave.c
--- xine-lib-1.1.11.1/src/demuxers/demux_slave.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_slave.c	2009-10-02 15:28:05.000000000 +0200
@@ -90,10 +90,11 @@
   /* fill the scratch buffer */
   n = this->input->read(this->input, &this->scratch[this->scratch_used],
                         SCRATCH_SIZE - this->scratch_used);
-  this->scratch_used += n;
+  if (n > 0)
+    this->scratch_used += n;
   this->scratch[this->scratch_used] = '\0';
 
-  if( !n ) {
+  if (n <= 0) {
     lprintf("connection closed\n");
     this->status = DEMUX_FINISHED;
     return 0;
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_ts.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_ts.c
--- xine-lib-1.1.11.1/src/demuxers/demux_ts.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_ts.c	2009-10-02 15:28:05.000000000 +0200
@@ -1564,7 +1564,7 @@
     do {
       read_length = this->input->read(this->input, this->buf,
 				      PKT_SIZE * NPKT_PER_READ);
-      if (read_length % PKT_SIZE) {
+      if (read_length < 0 || read_length % PKT_SIZE) {
 	xprintf (this->stream->xine, XINE_VERBOSITY_DEBUG, 
 		 "demux_ts: read returned %d bytes (not a multiple of %d!)\n",
 		 read_length, PKT_SIZE);
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_tta.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_tta.c
--- xine-lib-1.1.11.1/src/demuxers/demux_tta.c	2008-03-25 00:55:18.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_tta.c	2009-10-02 15:28:05.000000000 +0200
@@ -126,6 +126,10 @@
     /* buf->extra_info->input_time = this->current_sample / this->samplerate; */
 
     bytes_read = this->input->read(this->input, buf->content, ( bytes_to_read > buf->max_size ) ? buf->max_size : bytes_to_read);
+    if (bytes_read < 0) {
+      this->status = DEMUX_FINISHED;
+      break;
+    }
 
     buf->size = bytes_read;
 
diff -Nur xine-lib-1.1.11.1/src/demuxers/demux_vox.c xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_vox.c
--- xine-lib-1.1.11.1/src/demuxers/demux_vox.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/demux_vox.c	2009-10-02 15:28:05.000000000 +0200
@@ -77,7 +77,7 @@
   buf = this->audio_fifo->buffer_pool_alloc (this->audio_fifo);
   buf->type = BUF_AUDIO_DIALOGIC_IMA;
   bytes_read = this->input->read(this->input, buf->content, buf->max_size);
-  if (bytes_read == 0) {
+  if (bytes_read <= 0) {
     buf->free_buffer(buf);
     this->status = DEMUX_FINISHED;
     return this->status;
diff -Nur xine-lib-1.1.11.1/src/demuxers/ebml.c xine-lib-1.1.11.1-ubuntu/src/demuxers/ebml.c
--- xine-lib-1.1.11.1/src/demuxers/ebml.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/ebml.c	2009-10-02 15:28:05.000000000 +0200
@@ -327,7 +327,7 @@
   if (text)
   {
     text[elem->len] = '\0';
-    if (ebml_read_ascii (ebml, &elem, text))
+    if (ebml_read_ascii (ebml, elem, text))
       return text;
     free (text);
   }
diff -Nur xine-lib-1.1.11.1/src/demuxers/id3.c xine-lib-1.1.11.1-ubuntu/src/demuxers/id3.c
--- xine-lib-1.1.11.1/src/demuxers/id3.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/id3.c	2009-10-02 15:28:05.000000000 +0200
@@ -275,15 +275,17 @@
                                id3v22_frame_header_t *frame_header) {
   char *buf;
   int enc;
+  const size_t bufsize = frame_header->size +1;
+  if ( bufsize <= 2 ) /* frames has to be _at least_ 1 byte */
+    return 0;
   
-  buf = malloc(frame_header->size + 1);
+  buf = malloc(bufsize);
   if (buf == NULL) {
     lprintf("malloc error");
     return 0;
   }
 
   if (input->read (input, buf, frame_header->size) == frame_header->size) {
-    buf[frame_header->size] = 0;
     enc = buf[0];
     if( enc >= ID3_ENCODING_COUNT )
       enc = 0;
@@ -469,8 +471,11 @@
                                id3v23_frame_header_t *frame_header) {
   char *buf;
   int enc;
-
-  buf = malloc(frame_header->size + 1);
+  const size_t bufsize = frame_header->size +1;
+  if ( bufsize <= 2 ) /* frames has to be _at least_ 1 byte */
+    return 0;
+  
+  buf = malloc(bufsize);
   if (buf == NULL) {
     lprintf("malloc error");
     return 0;
@@ -720,8 +725,11 @@
                                id3v24_frame_header_t *frame_header) {
   char *buf;
   int enc;
-
-  buf = malloc(frame_header->size + 1);
+  const size_t bufsize = frame_header->size +1;
+  if ( bufsize <= 2 ) /* frames has to be _at least_ 1 byte */
+    return 0;
+  
+  buf = malloc(bufsize);
   if (buf == NULL) {
     lprintf("malloc error");
     return 0;
diff -Nur xine-lib-1.1.11.1/src/demuxers/id3.h xine-lib-1.1.11.1-ubuntu/src/demuxers/id3.h
--- xine-lib-1.1.11.1/src/demuxers/id3.h	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/id3.h	2009-10-02 15:28:05.000000000 +0200
@@ -103,22 +103,22 @@
   uint32_t  id;
   uint8_t   revision;
   uint8_t   flags;
-  uint32_t  size;
+  size_t    size;
 } id3v2_header_t;
 
 typedef struct {
   uint32_t  id;
-  uint32_t  size;
+  size_t    size;
 } id3v22_frame_header_t;
 
 typedef struct {
   uint32_t  id;
-  uint32_t  size;
+  size_t    size;
   uint16_t  flags;
 } id3v23_frame_header_t;
 
 typedef struct {
-  uint32_t  size;
+  size_t    size;
   uint16_t  flags;
   uint32_t  padding_size;
   uint32_t  crc;
@@ -128,12 +128,12 @@
 
 typedef struct {
   uint32_t  id;
-  uint32_t  size;
+  size_t    size;
   uint16_t  flags;
 } id3v24_frame_header_t;
 
 typedef struct {
-  uint32_t  size;
+  size_t    size;
   uint8_t   flags;
   uint32_t  crc;
   uint8_t   restrictions;
diff -Nur xine-lib-1.1.11.1/src/demuxers/Makefile.in xine-lib-1.1.11.1-ubuntu/src/demuxers/Makefile.in
--- xine-lib-1.1.11.1/src/demuxers/Makefile.in	2008-03-30 16:02:29.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/demuxers/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -212,7 +212,7 @@
 am_xineplug_dmx_yuv_frames_la_OBJECTS = demux_yuv_frames.lo
 xineplug_dmx_yuv_frames_la_OBJECTS =  \
 	$(am_xineplug_dmx_yuv_frames_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -714,8 +714,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -723,8 +723,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -1085,8 +1085,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -1098,8 +1098,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -1109,12 +1109,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/dxr3/Makefile.in xine-lib-1.1.11.1-ubuntu/src/dxr3/Makefile.in
--- xine-lib-1.1.11.1/src/dxr3/Makefile.in	2008-03-30 16:02:29.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/dxr3/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -116,7 +116,7 @@
 	$(xineplug_vo_out_dxr3_la_LDFLAGS) $(LDFLAGS) -o $@
 @HAVE_DXR3_TRUE@am_xineplug_vo_out_dxr3_la_rpath = -rpath \
 @HAVE_DXR3_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -516,8 +516,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -525,8 +525,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -639,8 +639,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -652,8 +652,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -663,12 +663,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/dvb/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/dvb/Makefile.in
--- xine-lib-1.1.11.1/src/input/dvb/Makefile.in	2008-03-30 16:02:30.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/dvb/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -413,8 +413,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -426,8 +426,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -437,12 +437,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/input_dvb.c xine-lib-1.1.11.1-ubuntu/src/input/input_dvb.c
--- xine-lib-1.1.11.1/src/input/input_dvb.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_dvb.c	2009-10-02 15:28:05.000000000 +0200
@@ -2595,6 +2595,12 @@
   buf_element_t        *buf = fifo->buffer_pool_alloc (fifo);
   int                   total_bytes;
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
 
   buf->content = buf->mem;
   buf->type    = BUF_DEMUX_BLOCK;
diff -Nur xine-lib-1.1.11.1/src/input/input_dvd.c xine-lib-1.1.11.1-ubuntu/src/input/input_dvd.c
--- xine-lib-1.1.11.1/src/input/input_dvd.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_dvd.c	2009-10-02 15:28:05.000000000 +0200
@@ -853,6 +853,9 @@
 static off_t dvd_plugin_read (input_plugin_t *this_gen, char *ch_buf, off_t len) {
 /*  dvd_input_plugin_t *this = (dvd_input_plugin_t*)this_gen; */
 
+  if (len < 4)
+    return -1;
+
   /* FIXME: Tricking the demux_mpeg_block plugin */
   ch_buf[0] = 0;
   ch_buf[1] = 0;
diff -Nur xine-lib-1.1.11.1/src/input/input_file.c xine-lib-1.1.11.1-ubuntu/src/input/input_file.c
--- xine-lib-1.1.11.1/src/input/input_file.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_file.c	2009-10-02 15:28:05.000000000 +0200
@@ -145,6 +145,9 @@
 static off_t file_plugin_read (input_plugin_t *this_gen, char *buf, off_t len) {
   file_input_plugin_t *this = (file_input_plugin_t *) this_gen;
 
+  if (len < 0)
+    return -1;
+
 #ifdef HAVE_MMAP
   if ( check_mmap_file(this) ) {
     off_t l = len;
@@ -166,6 +169,13 @@
   file_input_plugin_t  *this = (file_input_plugin_t *) this_gen;
   buf_element_t        *buf = fifo->buffer_pool_alloc (fifo);
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
+
   buf->type = BUF_DEMUX_BLOCK;
 
 #ifdef HAVE_MMAP
diff -Nur xine-lib-1.1.11.1/src/input/input_gnome_vfs.c xine-lib-1.1.11.1-ubuntu/src/input/input_gnome_vfs.c
--- xine-lib-1.1.11.1/src/input/input_gnome_vfs.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_gnome_vfs.c	2009-10-02 15:28:05.000000000 +0200
@@ -121,6 +121,13 @@
 	off_t total_bytes;
 	buf_element_t *buf = fifo->buffer_pool_alloc (fifo);
 
+	if (todo > buf->max_size)
+	  todo = buf->max_size;
+	if (todo < 0) {
+		buf->free_buffer (buf);
+		return NULL;
+	}
+
 	buf->content = buf->mem;
 	buf->type = BUF_DEMUX_BLOCK;
 
diff -Nur xine-lib-1.1.11.1/src/input/input_http.c xine-lib-1.1.11.1-ubuntu/src/input/input_http.c
--- xine-lib-1.1.11.1/src/input/input_http.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_http.c	2009-10-02 15:28:05.000000000 +0200
@@ -429,6 +429,9 @@
 
   num_bytes = 0;
 
+  if (nlen < 0)
+    return -1;
+
   if (this->curpos < this->preview_size) {
 
     if (nlen > (this->preview_size - this->curpos))
@@ -445,7 +448,7 @@
 
   n = nlen - num_bytes;
 
-  if (n) {
+  if (n > 0) {
     int read_bytes;
     read_bytes = http_plugin_read_int (this, &buf[num_bytes], n);
     
@@ -511,6 +514,13 @@
   off_t                 total_bytes;
   buf_element_t        *buf = fifo->buffer_pool_alloc (fifo);
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
+
   buf->content = buf->mem;
   buf->type = BUF_DEMUX_BLOCK;
 
@@ -562,7 +572,7 @@
   if ((origin == SEEK_CUR) && (offset >= 0)) {
 
     for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-      if( !this_gen->read (this_gen, this->seek_buf, BUFSIZE) )
+      if( this_gen->read (this_gen, this->seek_buf, BUFSIZE) <= 0 )
         return this->curpos;
     }
 
@@ -584,7 +594,7 @@
       offset -= this->curpos;
 
       for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-        if( !this_gen->read (this_gen, this->seek_buf, BUFSIZE) )
+        if( this_gen->read (this_gen, this->seek_buf, BUFSIZE) <= 0 )
           return this->curpos;
       }
 
@@ -999,6 +1009,7 @@
     this->preview_size = http_plugin_read_int (this, this->preview, MAX_PREVIEW_SIZE);
   }
   if (this->preview_size < 0) {
+    this->preview_size = 0;
     xine_log (this->stream->xine, XINE_LOG_MSG, _("input_http: read error %d\n"), errno);
     return -12;
   }
diff -Nur xine-lib-1.1.11.1/src/input/input_mms.c xine-lib-1.1.11.1-ubuntu/src/input/input_mms.c
--- xine-lib-1.1.11.1/src/input/input_mms.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_mms.c	2009-10-02 15:28:05.000000000 +0200
@@ -122,6 +122,13 @@
 
   lprintf ("mms_plugin_read_block: %"PRId64" bytes...\n", todo);
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
+
   buf->content = buf->mem;
   buf->type = BUF_DEMUX_BLOCK;
   
diff -Nur xine-lib-1.1.11.1/src/input/input_net.c xine-lib-1.1.11.1-ubuntu/src/input/input_net.c
--- xine-lib-1.1.11.1/src/input/input_net.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_net.c	2009-10-02 15:28:05.000000000 +0200
@@ -253,6 +253,9 @@
 
   lprintf("reading %" PRIdMAX " bytes...\n", (intmax_t)len);
 
+  if (len < 0)
+    return -1;
+
   total=0;
   if (this->curpos < this->preview_size) {
     n = this->preview_size - this->curpos;
@@ -288,6 +291,13 @@
   buf_element_t        *buf = fifo->buffer_pool_alloc (fifo);
   off_t                 total_bytes;
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
+
   buf->content = buf->mem;
   buf->type = BUF_DEMUX_BLOCK;
   
@@ -331,7 +341,7 @@
   if ((origin == SEEK_CUR) && (offset >= 0)) {
 
     for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-      if( !this_gen->read (this_gen, this->seek_buf, BUFSIZE) )
+      if( this_gen->read (this_gen, this->seek_buf, BUFSIZE) <= 0 )
         return this->curpos;
     }
 
@@ -353,7 +363,7 @@
       offset -= this->curpos;
 
       for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-        if( !this_gen->read (this_gen, this->seek_buf, BUFSIZE) )
+        if( this_gen->read (this_gen, this->seek_buf, BUFSIZE) <= 0 )
           return this->curpos;
       }
 
diff -Nur xine-lib-1.1.11.1/src/input/input_pnm.c xine-lib-1.1.11.1-ubuntu/src/input/input_pnm.c
--- xine-lib-1.1.11.1/src/input/input_pnm.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_pnm.c	2009-10-02 15:28:05.000000000 +0200
@@ -85,7 +85,8 @@
   nbc_check_buffers (this->nbc);
 
   n = pnm_read (this->pnm, buf, len);
-  this->curpos += n;
+  if (n >= 0)
+    this->curpos += n;
 
   return n;
 }
@@ -98,6 +99,13 @@
 
   lprintf ("pnm_plugin_read_block: %"PRId64" bytes...\n", todo);
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
+
   buf->content = buf->mem;
   buf->type = BUF_DEMUX_BLOCK;
   
@@ -125,10 +133,16 @@
   if ((origin == SEEK_CUR) && (offset >= 0)) {
 
     for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-      this->curpos += pnm_plugin_read (this_gen, this->scratch, BUFSIZE);
+      off_t n = pnm_plugin_read (this_gen, this->scratch, BUFSIZE);
+      if (n <= 0)
+	return this->curpos;
+      this->curpos += n;
     }
 
-    this->curpos += pnm_plugin_read (this_gen, this->scratch, offset);
+    off_t n = pnm_plugin_read (this_gen, this->scratch, offset);
+    if (n <= 0)
+      return this->curpos;
+    this->curpos += n;
   }
 
   return this->curpos;
diff -Nur xine-lib-1.1.11.1/src/input/input_pvr.c xine-lib-1.1.11.1-ubuntu/src/input/input_pvr.c
--- xine-lib-1.1.11.1/src/input/input_pvr.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_pvr.c	2009-10-02 15:28:05.000000000 +0200
@@ -424,6 +424,9 @@
 static off_t pvr_plugin_read (input_plugin_t *this_gen, char *buf, off_t len) {
   /*pvr_input_plugin_t *this = (pvr_input_plugin_t *) this_gen;*/
 
+  if (len < 4)
+    return -1;
+
   /* FIXME: Tricking the demux_mpeg_block plugin */
   buf[0] = 0;
   buf[1] = 0;
@@ -1219,6 +1222,14 @@
     return NULL;  
   }
 
+  buf = fifo->buffer_pool_alloc (fifo);
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer(buf);
+    return NULL;
+  }
+
   if( this->scr_tunning == -2 )
     speed = this->speed_before_pause;
 
@@ -1242,7 +1253,6 @@
 
   pvr_event_handler(this);
   
-  buf = fifo->buffer_pool_alloc (fifo);
   buf->content = buf->mem;
     
   pthread_mutex_lock(&this->lock);
diff -Nur xine-lib-1.1.11.1/src/input/input_rtp.c xine-lib-1.1.11.1-ubuntu/src/input/input_rtp.c
--- xine-lib-1.1.11.1/src/input/input_rtp.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_rtp.c	2009-10-02 15:28:05.000000000 +0200
@@ -453,6 +453,9 @@
   struct timespec timeout;
   off_t copied = 0; 
   
+  if (length < 0)
+    return -1;
+
   while(length > 0) {
 
     off_t n;
@@ -524,6 +527,12 @@
   buf_element_t        *buf = fifo->buffer_pool_alloc (fifo);
   int                   total_bytes;
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
 
   buf->content = buf->mem;
   buf->type    = BUF_DEMUX_BLOCK;
@@ -609,11 +618,14 @@
   if (data_type == INPUT_OPTIONAL_DATA_PREVIEW) {
     if (!this->preview_read_done) {
       this->preview_size = rtp_plugin_read(this_gen, this->preview, MAX_PREVIEW_SIZE);
+      if (this->preview_size < 0)
+	this->preview_size = 0;
       lprintf("Preview data length = %d\n", this->preview_size);
 
       this->preview_read_done = 1;
     }
-    memcpy(data, this->preview, this->preview_size);
+    if (this->preview_size)
+      memcpy(data, this->preview, this->preview_size);
     return this->preview_size;
   }
   else {
diff -Nur xine-lib-1.1.11.1/src/input/input_rtsp.c xine-lib-1.1.11.1-ubuntu/src/input/input_rtsp.c
--- xine-lib-1.1.11.1/src/input/input_rtsp.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_rtsp.c	2009-10-02 15:28:05.000000000 +0200
@@ -86,7 +86,8 @@
   nbc_check_buffers (this->nbc);
 
   n = rtsp_session_read (this->rtsp, buf, len);
-  this->curpos += n;
+  if (n > 0)
+    this->curpos += n;
 
   return n;
 }
@@ -99,6 +100,13 @@
 
   lprintf ("rtsp_plugin_read_block: %"PRId64" bytes...\n", todo);
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
+
   buf->content = buf->mem;
   buf->type = BUF_DEMUX_BLOCK;
   
@@ -125,10 +133,16 @@
   if ((origin == SEEK_CUR) && (offset >= 0)) {
 
     for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-      this->curpos += rtsp_plugin_read (this_gen, this->scratch, BUFSIZE);
+      off_t n = rtsp_plugin_read (this_gen, this->scratch, BUFSIZE);
+      if (n <= 0)
+	return this->curpos;
+      this->curpos += n;
     }
 
-    this->curpos += rtsp_plugin_read (this_gen, this->scratch, offset);
+    off_t n = rtsp_plugin_read (this_gen, this->scratch, offset);
+    if (n <= 0)
+      return this->curpos;
+    this->curpos += n;
   }
 
   return this->curpos;
diff -Nur xine-lib-1.1.11.1/src/input/input_smb.c xine-lib-1.1.11.1-ubuntu/src/input/input_smb.c
--- xine-lib-1.1.11.1/src/input/input_smb.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_smb.c	2009-10-02 15:28:05.000000000 +0200
@@ -69,6 +69,8 @@
 	smb_input_t *this = (smb_input_t *) this_gen;
 	off_t n, num_bytes;
 
+	if (len < 0)
+		return -1;
 	num_bytes = 0;
 
 	while (num_bytes < len)
@@ -89,6 +91,13 @@
 	off_t total_bytes;
 	buf_element_t *buf = fifo->buffer_pool_alloc (fifo);
 
+	if (todo > buf->max_size)
+	  todo = buf->max_size;
+	if (todo < 0) {
+		buf->free_buffer (buf);
+		return NULL;
+	}
+
 	buf->content = buf->mem;
 	buf->type = BUF_DEMUX_BLOCK;
 
diff -Nur xine-lib-1.1.11.1/src/input/input_stdin_fifo.c xine-lib-1.1.11.1-ubuntu/src/input/input_stdin_fifo.c
--- xine-lib-1.1.11.1/src/input/input_stdin_fifo.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/input_stdin_fifo.c	2009-10-02 15:28:05.000000000 +0200
@@ -85,6 +85,8 @@
   off_t n, total;
 
   lprintf ("reading %"PRId64" bytes...\n", len);
+  if (len < 0)
+    return -1;
 
   total=0;
   if (this->curpos < this->preview_size) {
@@ -121,6 +123,13 @@
   /* stdin_input_plugin_t  *this = (stdin_input_plugin_t *) this_gen; */
   buf_element_t         *buf = fifo->buffer_pool_alloc (fifo);
 
+  if (todo > buf->max_size)
+    todo = buf->max_size;
+  if (todo < 0) {
+    buf->free_buffer (buf);
+    return NULL;
+  }
+
   buf->content = buf->mem;
   buf->type = BUF_DEMUX_BLOCK;
 
@@ -146,7 +155,7 @@
   if ((origin == SEEK_CUR) && (offset >= 0)) {
 
     for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-      if( !this_gen->read (this_gen, this->seek_buf, BUFSIZE) )
+      if( this_gen->read (this_gen, this->seek_buf, BUFSIZE) <= 0 )
         return this->curpos;
     }
 
@@ -168,7 +177,7 @@
       offset -= this->curpos;
 
       for (;((int)offset) - BUFSIZE > 0; offset -= BUFSIZE) {
-        if( !this_gen->read (this_gen, this->seek_buf, BUFSIZE) )
+        if( this_gen->read (this_gen, this->seek_buf, BUFSIZE) <= 0 )
           return this->curpos;
       }
 
@@ -270,6 +279,8 @@
 
   this->preview_size = stdin_plugin_read (&this->input_plugin, this->preview,
 					  MAX_PREVIEW_SIZE);
+  if (this->preview_size < 0)
+    this->preview_size = 0;
   this->curpos          = 0;
 
   return 1;
diff -Nur xine-lib-1.1.11.1/src/input/libdvdnav/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/libdvdnav/Makefile.in
--- xine-lib-1.1.11.1/src/input/libdvdnav/Makefile.in	2008-03-30 16:02:30.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/libdvdnav/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -73,7 +73,7 @@
 libdvdnav_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(libdvdnav_la_CFLAGS) \
 	$(CFLAGS) $(libdvdnav_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -660,8 +660,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -673,8 +673,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -684,12 +684,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/libreal/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/libreal/Makefile.in
--- xine-lib-1.1.11.1/src/input/libreal/Makefile.in	2008-03-30 16:02:30.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/libreal/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -65,7 +65,7 @@
 libreal_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(libreal_la_CFLAGS) \
 	$(CFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -517,8 +517,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -530,8 +530,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -541,12 +541,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/libreal/rmff.c xine-lib-1.1.11.1-ubuntu/src/input/libreal/rmff.c
--- xine-lib-1.1.11.1/src/input/libreal/rmff.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/input/libreal/rmff.c	2009-10-02 15:28:05.000000000 +0200
@@ -330,12 +330,14 @@
   return prop;
 }
 
-static rmff_mdpr_t *rmff_scan_mdpr(const char *data) {
-
-  rmff_mdpr_t *mdpr = malloc(sizeof(rmff_mdpr_t));
+static rmff_mdpr_t *rmff_scan_mdpr(const char *data)
+{
+  rmff_mdpr_t *mdpr = calloc(sizeof(rmff_mdpr_t), 1);
 
   mdpr->object_id=_X_BE_32(data);
   mdpr->size=_X_BE_32(&data[4]);
+  if (mdpr->size < 46)
+    goto fail;
   mdpr->object_version=_X_BE_16(&data[8]);
   if (mdpr->object_version != 0)
   {
@@ -351,21 +353,40 @@
   mdpr->duration=_X_BE_32(&data[36]);
   
   mdpr->stream_name_size=data[40];
+  if (mdpr->size < 46 + mdpr->stream_name_size)
+    goto fail;
   mdpr->stream_name = malloc(sizeof(char)*(mdpr->stream_name_size+1));
+  if (!mdpr->stream_name)
+    goto fail;
   memcpy(mdpr->stream_name, &data[41], mdpr->stream_name_size);
   mdpr->stream_name[mdpr->stream_name_size]=0;
   
   mdpr->mime_type_size=data[41+mdpr->stream_name_size];
+  if (mdpr->size < 46 + mdpr->stream_name_size + mdpr->mime_type_size)
+    goto fail;
   mdpr->mime_type = malloc(sizeof(char)*(mdpr->mime_type_size+1));
+  if (!mdpr->mime_type)
+    goto fail;
   memcpy(mdpr->mime_type, &data[42+mdpr->stream_name_size], mdpr->mime_type_size);
   mdpr->mime_type[mdpr->mime_type_size]=0;
   
   mdpr->type_specific_len=_X_BE_32(&data[42+mdpr->stream_name_size+mdpr->mime_type_size]);
+  if (mdpr->size < 46 + mdpr->stream_name_size + mdpr->mime_type_size + mdpr->type_specific_data)
+    goto fail;
   mdpr->type_specific_data = malloc(sizeof(char)*(mdpr->type_specific_len));
+  if (!mdpr->type_specific_data)
+    goto fail;
   memcpy(mdpr->type_specific_data, 
       &data[46+mdpr->stream_name_size+mdpr->mime_type_size], mdpr->type_specific_len);
   
   return mdpr;
+
+fail:
+  free (mdpr->stream_name);
+  free (mdpr->mime_type);
+  free (mdpr->type_specific_data);
+  free (mdpr);
+  return NULL;
 }
 
 static rmff_cont_t *rmff_scan_cont(const char *data) {
@@ -466,8 +487,11 @@
       break;
     case MDPR_TAG:
       mdpr=rmff_scan_mdpr(ptr);
-      chunk_size=mdpr->size;
-      header->streams[mdpr->stream_number]=mdpr;
+      if (mdpr) /* FIXME: what to do if NULL? */
+      {
+        chunk_size=mdpr->size;
+        header->streams[mdpr->stream_number]=mdpr;
+      }
       break;
     case CONT_TAG:
       header->cont=rmff_scan_cont(ptr);
diff -Nur xine-lib-1.1.11.1/src/input/librtsp/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/librtsp/Makefile.in
--- xine-lib-1.1.11.1/src/input/librtsp/Makefile.in	2008-03-30 16:02:31.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/librtsp/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -64,7 +64,7 @@
 librtsp_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(librtsp_la_CFLAGS) \
 	$(CFLAGS) $(librtsp_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -497,8 +497,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -510,8 +510,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -521,12 +521,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/Makefile.in
--- xine-lib-1.1.11.1/src/input/Makefile.in	2008-03-30 16:02:30.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -227,7 +227,7 @@
 	$(xineplug_inp_vcdo_la_LDFLAGS) $(LDFLAGS) -o $@
 @HAVE_CDROM_IOCTLS_TRUE@am_xineplug_inp_vcdo_la_rpath = -rpath \
 @HAVE_CDROM_IOCTLS_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -725,8 +725,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -734,8 +734,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -1179,8 +1179,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -1205,8 +1205,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -1216,12 +1216,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/vcd/libcdio/cdio/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/cdio/Makefile.in
--- xine-lib-1.1.11.1/src/input/vcd/libcdio/cdio/Makefile.in	2008-03-30 16:02:31.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/cdio/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -427,8 +427,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -440,8 +440,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -451,12 +451,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/vcd/libcdio/image/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/image/Makefile.in
--- xine-lib-1.1.11.1/src/input/vcd/libcdio/image/Makefile.in	2008-03-30 16:02:31.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/image/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/src/input/vcd/libcdio/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/Makefile.in
--- xine-lib-1.1.11.1/src/input/vcd/libcdio/Makefile.in	2008-03-30 16:02:31.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -93,7 +93,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(libiso9660_la_LDFLAGS) $(LDFLAGS) -o $@
 @ENABLE_VCD_TRUE@@HAVE_VCDNAV_FALSE@am_libiso9660_la_rpath =
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -730,8 +730,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -756,8 +756,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -767,12 +767,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/vcd/libcdio/MSWindows/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/MSWindows/Makefile.in
--- xine-lib-1.1.11.1/src/input/vcd/libcdio/MSWindows/Makefile.in	2008-03-30 16:02:31.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/vcd/libcdio/MSWindows/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/src/input/vcd/libvcd/libvcd/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/vcd/libvcd/libvcd/Makefile.in
--- xine-lib-1.1.11.1/src/input/vcd/libvcd/libvcd/Makefile.in	2008-03-30 16:02:32.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/vcd/libvcd/libvcd/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -410,8 +410,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -423,8 +423,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -434,12 +434,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/vcd/libvcd/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/vcd/libvcd/Makefile.in
--- xine-lib-1.1.11.1/src/input/vcd/libvcd/Makefile.in	2008-03-30 16:02:31.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/vcd/libvcd/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -88,7 +88,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(libvcdinfo_la_LDFLAGS) $(LDFLAGS) -o $@
 @ENABLE_VCD_TRUE@@HAVE_VCDNAV_FALSE@am_libvcdinfo_la_rpath =
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -652,8 +652,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -678,8 +678,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -689,12 +689,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/input/vcd/Makefile.in xine-lib-1.1.11.1-ubuntu/src/input/vcd/Makefile.in
--- xine-lib-1.1.11.1/src/input/vcd/Makefile.in	2008-03-30 16:02:31.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/input/vcd/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -86,7 +86,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(xineplug_inp_vcd_la_LDFLAGS) $(LDFLAGS) -o $@
 @ENABLE_VCD_TRUE@am_xineplug_inp_vcd_la_rpath = -rpath $(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -466,8 +466,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -475,8 +475,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -603,8 +603,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -629,8 +629,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -640,12 +640,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/liba52/Makefile.in xine-lib-1.1.11.1-ubuntu/src/liba52/Makefile.in
--- xine-lib-1.1.11.1/src/liba52/Makefile.in	2008-03-30 16:02:32.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/liba52/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -87,7 +87,7 @@
 	$(xineplug_decode_a52_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_a52_la_LDFLAGS) $(LDFLAGS) -o $@
 @A52_TRUE@am_xineplug_decode_a52_la_rpath = -rpath $(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -472,8 +472,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -481,8 +481,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -583,8 +583,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -596,8 +596,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -607,12 +607,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libdts/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libdts/Makefile.in
--- xine-lib-1.1.11.1/src/libdts/Makefile.in	2008-03-30 16:02:32.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libdts/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -86,7 +86,7 @@
 	$(xineplug_decode_dts_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_dts_la_LDFLAGS) $(LDFLAGS) -o $@
 @DTS_TRUE@am_xineplug_decode_dts_la_rpath = -rpath $(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -460,8 +460,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -469,8 +469,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -555,8 +555,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -568,8 +568,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -579,12 +579,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libfaad/analysis.h xine-lib-1.1.11.1-ubuntu/src/libfaad/analysis.h
--- xine-lib-1.1.11.1/src/libfaad/analysis.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/analysis.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: analysis.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: analysis.h,v 1.18 2007/11/01 12:33:29 menno Exp $
 **/
 
 #ifndef __ANALYSIS_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/bits.c xine-lib-1.1.11.1-ubuntu/src/libfaad/bits.c
--- xine-lib-1.1.11.1/src/libfaad/bits.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/bits.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,17 +19,19 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: bits.c,v 1.9 2005/10/29 23:57:06 tmmm Exp $
+** $Id: bits.c,v 1.44 2007/11/01 12:33:29 menno Exp $
 **/
 
 #include "common.h"
 #include "structs.h"
 
 #include <stdlib.h>
-#include <string.h>
 #include "bits.h"
 
 /* initialize buffer, call once before first getbits or showbits */
@@ -40,25 +42,38 @@
     if (ld == NULL)
         return;
 
-    memset(ld, 0, sizeof(bitfile));
+    // useless
+    //memset(ld, 0, sizeof(bitfile));
 
     if (buffer_size == 0 || _buffer == NULL)
     {
         ld->error = 1;
-        ld->no_more_reading = 1;
         return;
     }
 
-    ld->buffer = faad_malloc((buffer_size+12)*sizeof(uint8_t));
-    memset(ld->buffer, 0, (buffer_size+12)*sizeof(uint8_t));
-    memcpy(ld->buffer, _buffer, buffer_size*sizeof(uint8_t));
+    ld->buffer = _buffer;
 
     ld->buffer_size = buffer_size;
+    ld->bytes_left  = buffer_size;
 
-    tmp = getdword((uint32_t*)ld->buffer);
+    if (ld->bytes_left >= 4)
+    {
+        tmp = getdword((uint32_t*)ld->buffer);
+        ld->bytes_left -= 4;
+    } else {
+        tmp = getdword_n((uint32_t*)ld->buffer, ld->bytes_left);
+        ld->bytes_left = 0;
+    }
     ld->bufa = tmp;
 
-    tmp = getdword((uint32_t*)ld->buffer + 1);
+    if (ld->bytes_left >= 4)
+    {
+        tmp = getdword((uint32_t*)ld->buffer + 1);
+        ld->bytes_left -= 4;
+    } else {
+        tmp = getdword_n((uint32_t*)ld->buffer + 1, ld->bytes_left);
+        ld->bytes_left = 0;
+    }
     ld->bufb = tmp;
 
     ld->start = (uint32_t*)ld->buffer;
@@ -66,21 +81,12 @@
 
     ld->bits_left = 32;
 
-    ld->bytes_used = 0;
-    ld->no_more_reading = 0;
     ld->error = 0;
 }
 
 void faad_endbits(bitfile *ld)
 {
-    if (ld)
-    {
-        if (ld->buffer)
-        {
-            faad_free(ld->buffer);
-            ld->buffer = NULL;
-        }
-    }
+    // void
 }
 
 uint32_t faad_get_processed_bits(bitfile *ld)
@@ -90,12 +96,12 @@
 
 uint8_t faad_byte_align(bitfile *ld)
 {
-    uint8_t remainder = (uint8_t)((32 - ld->bits_left) % 8);
+    int remainder = (32 - ld->bits_left) & 0x7;
 
     if (remainder)
     {
         faad_flushbits(ld, 8 - remainder);
-        return (8 - remainder);
+        return (uint8_t)(8 - remainder);
     }
     return 0;
 }
@@ -105,20 +111,22 @@
     uint32_t tmp;
 
     ld->bufa = ld->bufb;
-    if (ld->no_more_reading == 0)
+    if (ld->bytes_left >= 4)
     {
         tmp = getdword(ld->tail);
-        ld->tail++;
+        ld->bytes_left -= 4;
     } else {
-        tmp = 0;
+        tmp = getdword_n(ld->tail, ld->bytes_left);
+        ld->bytes_left = 0;
     }
     ld->bufb = tmp;
+    ld->tail++;
     ld->bits_left += (32 - bits);
-    ld->bytes_used += 4;
-    if (ld->bytes_used == ld->buffer_size)
-        ld->no_more_reading = 1;
-    if (ld->bytes_used > ld->buffer_size)
-        ld->error = 1;
+    //ld->bytes_left -= 4;
+//    if (ld->bytes_left == 0)
+//        ld->no_more_reading = 1;
+//    if (ld->bytes_left < 0)
+//        ld->error = 1;
 }
 
 /* rewind to beginning */
@@ -126,30 +134,79 @@
 {
     uint32_t tmp;
 
-    tmp = ld->start[0];
-#ifndef ARCH_IS_BIG_ENDIAN
-    BSWAP(tmp);
-#endif
+    ld->bytes_left = ld->buffer_size;
+
+    if (ld->bytes_left >= 4)
+    {
+        tmp = getdword((uint32_t*)&ld->start[0]);
+        ld->bytes_left -= 4;
+    } else {
+        tmp = getdword_n((uint32_t*)&ld->start[0], ld->bytes_left);
+        ld->bytes_left = 0;
+    }
     ld->bufa = tmp;
 
-    tmp = ld->start[1];
-#ifndef ARCH_IS_BIG_ENDIAN
-    BSWAP(tmp);
-#endif
+    if (ld->bytes_left >= 4)
+    {
+        tmp = getdword((uint32_t*)&ld->start[1]);
+        ld->bytes_left -= 4;
+    } else {
+        tmp = getdword_n((uint32_t*)&ld->start[1], ld->bytes_left);
+        ld->bytes_left = 0;
+    }
     ld->bufb = tmp;
+
     ld->bits_left = 32;
     ld->tail = &ld->start[2];
-    ld->bytes_used = 0;
-    ld->no_more_reading = 0;
+}
+
+/* reset to a certain point */
+void faad_resetbits(bitfile *ld, int bits)
+{
+    uint32_t tmp;
+    int words = bits >> 5;
+    int remainder = bits & 0x1F;
+
+    ld->bytes_left = ld->buffer_size - words*4;
+
+    if (ld->bytes_left >= 4)
+    {
+        tmp = getdword(&ld->start[words]);
+        ld->bytes_left -= 4;
+    } else {
+        tmp = getdword_n(&ld->start[words], ld->bytes_left);
+        ld->bytes_left = 0;
+    }
+    ld->bufa = tmp;
+
+    if (ld->bytes_left >= 4)
+    {
+        tmp = getdword(&ld->start[words+1]);
+        ld->bytes_left -= 4;
+    } else {
+        tmp = getdword_n(&ld->start[words+1], ld->bytes_left);
+        ld->bytes_left = 0;
+    }
+    ld->bufb = tmp;
+
+    ld->bits_left = 32 - remainder;
+    ld->tail = &ld->start[words+2];
+
+    /* recheck for reading too many bytes */
+    ld->error = 0;
+//    if (ld->bytes_left == 0)
+//        ld->no_more_reading = 1;
+//    if (ld->bytes_left < 0)
+//        ld->error = 1;
 }
 
 uint8_t *faad_getbitbuffer(bitfile *ld, uint32_t bits
                        DEBUGDEC)
 {
-    uint16_t i;
-    uint8_t temp;
-    uint16_t bytes = (uint16_t)bits / 8;
-    uint8_t remainder = (uint8_t)bits % 8;
+    int i;
+    unsigned int temp;
+    int bytes = bits >> 3;
+    int remainder = bits & 0x7;
 
     uint8_t *buffer = (uint8_t*)faad_malloc((bytes+1)*sizeof(uint8_t));
 
@@ -160,9 +217,9 @@
 
     if (remainder)
     {
-        temp = (uint8_t)faad_getbits(ld, remainder DEBUGVAR(print,var,dbg)) << (8-remainder);
+        temp = faad_getbits(ld, remainder DEBUGVAR(print,var,dbg)) << (8-remainder);
 
-        buffer[bytes] = temp;
+        buffer[bytes] = (uint8_t)temp;
     }
 
     return buffer;
@@ -207,7 +264,8 @@
     if (ld->bits_left == 0)
         ld->bits_left = 32;
 
-    ld->bytes_used = 0;
-    ld->no_more_reading = 0;
+    ld->bytes_left = ld->buffer_size;
     ld->error = 0;
 }
+
+/* EOF */
diff -Nur xine-lib-1.1.11.1/src/libfaad/bits.h xine-lib-1.1.11.1-ubuntu/src/libfaad/bits.h
--- xine-lib-1.1.11.1/src/libfaad/bits.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/bits.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: bits.h,v 1.11 2005/10/30 01:21:53 tmmm Exp $
+** $Id: bits.h,v 1.45 2007/11/01 12:33:29 menno Exp $
 **/
 
 #ifndef __BITS_H__
@@ -37,8 +40,10 @@
 #include <stdio.h>
 #endif
 
-#define BYTE_NUMBIT 8
-#define bit2byte(a) ((a+7)/BYTE_NUMBIT)
+#define BYTE_NUMBIT     8
+#define BYTE_NUMBIT_LD  3
+//#define bit2byte(a) ((a+7)/BYTE_NUMBIT)
+#define bit2byte(a) ((a+7)>>BYTE_NUMBIT_LD)
 
 typedef struct _bitfile
 {
@@ -47,25 +52,16 @@
     uint32_t bufb;
     uint32_t bits_left;
     uint32_t buffer_size; /* size of the buffer in bytes */
-    uint32_t bytes_used;
-    uint8_t no_more_reading;
+    uint32_t bytes_left;
     uint8_t error;
     uint32_t *tail;
     uint32_t *start;
-    void *buffer;
+    const void *buffer;
 } bitfile;
 
 
-#if defined(_MSC_VER)
-#define BSWAP(a) __asm mov eax,a __asm bswap eax __asm mov a, eax
-#elif defined(LINUX) || defined(DJGPP) || defined (__MINGW32__) || defined (__CYGWIN__)
-#define BSWAP(a) __asm__ ( "bswapl %0\n" : "=r" (a) : "0" (a) )
-#else
-#define BSWAP(a) \
-    ((a) = ( ((a)&0xff)<<24) | (((a)&0xff00)<<8) | (((a)>>8)&0xff00) | (((a)>>24)&0xff))
-#endif
-
-static uint32_t bitmask[] = {
+#if 0
+static uint32_t const bitmask[] = {
     0x0, 0x1, 0x3, 0x7, 0xF, 0x1F, 0x3F, 0x7F, 0xFF, 0x1FF,
     0x3FF, 0x7FF, 0xFFF, 0x1FFF, 0x3FFF, 0x7FFF, 0xFFFF,
     0x1FFFF, 0x3FFFF, 0x7FFFF, 0xFFFFF, 0x1FFFFF, 0x3FFFFF,
@@ -74,6 +70,7 @@
     /* added bitmask 32, correct?!?!?! */
     , 0xFFFFFFFF
 };
+#endif
 
 void faad_initbits(bitfile *ld, const void *buffer, const uint32_t buffer_size);
 void faad_endbits(bitfile *ld);
@@ -83,6 +80,7 @@
 uint32_t faad_get_processed_bits(bitfile *ld);
 void faad_flushbits_ex(bitfile *ld, uint32_t bits);
 void faad_rewindbits(bitfile *ld);
+void faad_resetbits(bitfile *ld, int bits);
 uint8_t *faad_getbitbuffer(bitfile *ld, uint32_t bits
                        DEBUGDEC);
 #ifdef DRM
@@ -93,7 +91,6 @@
 /* circumvent memory alignment errors on ARM */
 static INLINE uint32_t getdword(void *mem)
 {
-#ifdef ARM
     uint32_t tmp;
 #ifndef ARCH_IS_BIG_ENDIAN
     ((uint8_t*)&tmp)[0] = ((uint8_t*)mem)[3];
@@ -108,25 +105,52 @@
 #endif
 
     return tmp;
-#else
-    uint32_t tmp;
-    tmp = *(uint32_t*)mem;
+}
+
+/* reads only n bytes from the stream instead of the standard 4 */
+static /*INLINE*/ uint32_t getdword_n(void *mem, int n)
+{
+    uint32_t tmp = 0;
 #ifndef ARCH_IS_BIG_ENDIAN
-    BSWAP(tmp);
+    switch (n)
+    {
+    case 3:
+        ((uint8_t*)&tmp)[1] = ((uint8_t*)mem)[2];
+    case 2:
+        ((uint8_t*)&tmp)[2] = ((uint8_t*)mem)[1];
+    case 1:
+        ((uint8_t*)&tmp)[3] = ((uint8_t*)mem)[0];
+    default:
+        break;
+    }
+#else
+    switch (n)
+    {
+    case 3:
+        ((uint8_t*)&tmp)[2] = ((uint8_t*)mem)[2];
+    case 2:
+        ((uint8_t*)&tmp)[1] = ((uint8_t*)mem)[1];
+    case 1:
+        ((uint8_t*)&tmp)[0] = ((uint8_t*)mem)[0];
+    default:
+        break;
+    }
 #endif
+
     return tmp;
-#endif
 }
 
 static INLINE uint32_t faad_showbits(bitfile *ld, uint32_t bits)
 {
     if (bits <= ld->bits_left)
     {
-        return (ld->bufa >> (ld->bits_left - bits)) & bitmask[bits];
+        //return (ld->bufa >> (ld->bits_left - bits)) & bitmask[bits];
+        return (ld->bufa << (32 - ld->bits_left)) >> (32 - bits);
     }
 
     bits -= ld->bits_left;
-    return ((ld->bufa & bitmask[ld->bits_left]) << bits) | (ld->bufb >> (32 - bits));
+    //return ((ld->bufa & bitmask[ld->bits_left]) << bits) | (ld->bufb >> (32 - bits));
+    return ((ld->bufa & ((1<<ld->bits_left)-1)) << bits) | (ld->bufb >> (32 - bits));
 }
 
 static INLINE void faad_flushbits(bitfile *ld, uint32_t bits)
@@ -144,11 +168,11 @@
 }
 
 /* return next n bits (right adjusted) */
-static INLINE uint32_t faad_getbits(bitfile *ld, uint32_t n DEBUGDEC)
+static /*INLINE*/ uint32_t faad_getbits(bitfile *ld, uint32_t n DEBUGDEC)
 {
     uint32_t ret;
 
-    if (ld->no_more_reading || n == 0)
+    if (n == 0)
         return 0;
 
     ret = faad_showbits(ld, n);
@@ -230,22 +254,23 @@
         ld->start--;
         ld->bits_left += (32 - bits);
 
-        ld->bytes_used += 4;
-        if (ld->bytes_used == ld->buffer_size)
-            ld->no_more_reading = 1;
-        if (ld->bytes_used > ld->buffer_size)
+        if (ld->bytes_left < 4)
+        {
             ld->error = 1;
+            ld->bytes_left = 0;
+        } else {
+            ld->bytes_left -= 4;
+        }
+//        if (ld->bytes_left == 0)
+//            ld->no_more_reading = 1;
     }
 }
 
-static INLINE uint32_t faad_getbits_rev(bitfile *ld, uint32_t n
+static /*INLINE*/ uint32_t faad_getbits_rev(bitfile *ld, uint32_t n
                                         DEBUGDEC)
 {
     uint32_t ret;
 
-    if (ld->no_more_reading)
-        return 0;
-
     if (n == 0)
         return 0;
 
@@ -261,28 +286,73 @@
 }
 
 #ifdef DRM
+/* CRC lookup table for G8 polynome in DRM standard */
+static const uint8_t crc_table_G8[256] = {
+    0x0, 0x1d, 0x3a, 0x27, 0x74, 0x69, 0x4e, 0x53,
+    0xe8, 0xf5, 0xd2, 0xcf, 0x9c, 0x81, 0xa6, 0xbb,
+    0xcd, 0xd0, 0xf7, 0xea, 0xb9, 0xa4, 0x83, 0x9e,
+    0x25, 0x38, 0x1f, 0x2, 0x51, 0x4c, 0x6b, 0x76,
+    0x87, 0x9a, 0xbd, 0xa0, 0xf3, 0xee, 0xc9, 0xd4,
+    0x6f, 0x72, 0x55, 0x48, 0x1b, 0x6, 0x21, 0x3c,
+    0x4a, 0x57, 0x70, 0x6d, 0x3e, 0x23, 0x4, 0x19,
+    0xa2, 0xbf, 0x98, 0x85, 0xd6, 0xcb, 0xec, 0xf1,
+    0x13, 0xe, 0x29, 0x34, 0x67, 0x7a, 0x5d, 0x40,
+    0xfb, 0xe6, 0xc1, 0xdc, 0x8f, 0x92, 0xb5, 0xa8,
+    0xde, 0xc3, 0xe4, 0xf9, 0xaa, 0xb7, 0x90, 0x8d,
+    0x36, 0x2b, 0xc, 0x11, 0x42, 0x5f, 0x78, 0x65,
+    0x94, 0x89, 0xae, 0xb3, 0xe0, 0xfd, 0xda, 0xc7,
+    0x7c, 0x61, 0x46, 0x5b, 0x8, 0x15, 0x32, 0x2f,
+    0x59, 0x44, 0x63, 0x7e, 0x2d, 0x30, 0x17, 0xa,
+    0xb1, 0xac, 0x8b, 0x96, 0xc5, 0xd8, 0xff, 0xe2,
+    0x26, 0x3b, 0x1c, 0x1, 0x52, 0x4f, 0x68, 0x75,
+    0xce, 0xd3, 0xf4, 0xe9, 0xba, 0xa7, 0x80, 0x9d,
+    0xeb, 0xf6, 0xd1, 0xcc, 0x9f, 0x82, 0xa5, 0xb8,
+    0x3, 0x1e, 0x39, 0x24, 0x77, 0x6a, 0x4d, 0x50,
+    0xa1, 0xbc, 0x9b, 0x86, 0xd5, 0xc8, 0xef, 0xf2,
+    0x49, 0x54, 0x73, 0x6e, 0x3d, 0x20, 0x7, 0x1a,
+    0x6c, 0x71, 0x56, 0x4b, 0x18, 0x5, 0x22, 0x3f,
+    0x84, 0x99, 0xbe, 0xa3, 0xf0, 0xed, 0xca, 0xd7,
+    0x35, 0x28, 0xf, 0x12, 0x41, 0x5c, 0x7b, 0x66,
+    0xdd, 0xc0, 0xe7, 0xfa, 0xa9, 0xb4, 0x93, 0x8e,
+    0xf8, 0xe5, 0xc2, 0xdf, 0x8c, 0x91, 0xb6, 0xab,
+    0x10, 0xd, 0x2a, 0x37, 0x64, 0x79, 0x5e, 0x43,
+    0xb2, 0xaf, 0x88, 0x95, 0xc6, 0xdb, 0xfc, 0xe1,
+    0x5a, 0x47, 0x60, 0x7d, 0x2e, 0x33, 0x14, 0x9,
+    0x7f, 0x62, 0x45, 0x58, 0xb, 0x16, 0x31, 0x2c,
+    0x97, 0x8a, 0xad, 0xb0, 0xe3, 0xfe, 0xd9, 0xc4,
+};
+
 static uint8_t faad_check_CRC(bitfile *ld, uint16_t len)
 {
-    uint8_t CRC;
-    uint16_t r=255;  /* Initialize to all ones */
+    int bytes, rem;
+    unsigned int CRC;
+    unsigned int r=255;  /* Initialize to all ones */
 
     /* CRC polynome used x^8 + x^4 + x^3 + x^2 +1 */
 #define GPOLY 0435
 
     faad_rewindbits(ld);
 
-    CRC = (uint8_t) ~faad_getbits(ld, 8
-        DEBUGVAR(1,999,"faad_check_CRC(): CRC"));          /* CRC is stored inverted */
+    CRC = (unsigned int) ~faad_getbits(ld, 8
+        DEBUGVAR(1,999,"faad_check_CRC(): CRC")) & 0xFF;          /* CRC is stored inverted */
+
+    bytes = len >> 3;
+    rem = len & 0x7;
 
-    for (; len>0; len--)
+    for (; bytes > 0; bytes--)
+    {
+        r = crc_table_G8[( r ^ faad_getbits(ld, 8 DEBUGVAR(1,998,"")) ) & 0xFF];
+    }
+    for (; rem > 0; rem--)
     {
         r = ( (r << 1) ^ (( ( faad_get1bit(ld
             DEBUGVAR(1,998,""))  & 1) ^ ((r >> 7) & 1)) * GPOLY )) & 0xFF;
     }
 
     if (r != CRC)
+  //  if (0)
     {
-        return 8;
+        return 28;
     } else {
         return 0;
     }
diff -Nur xine-lib-1.1.11.1/src/libfaad/cfft.c xine-lib-1.1.11.1-ubuntu/src/libfaad/cfft.c
--- xine-lib-1.1.11.1/src/libfaad/cfft.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/cfft.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: cfft.c,v 1.12 2006/09/26 18:00:31 dgp85 Exp $
+** $Id: cfft.c,v 1.35 2007/11/01 12:33:29 menno Exp $
 **/
 
 /*
@@ -546,7 +549,7 @@
                 ComplexMult(&RE(c4), &RE(c5),
                     ti12, ti11, RE(t5), RE(t4));
                 ComplexMult(&IM(c4), &IM(c5),
-                    ti12, ti12, IM(t5), IM(t4));
+                    ti12, ti11, IM(t5), IM(t4));
 
                 RE(ch[ah+l1]) = RE(c2) + IM(c5);
                 IM(ch[ah+l1]) = IM(c2) - RE(c5);
@@ -648,7 +651,7 @@
                     ComplexMult(&RE(c4), &RE(c5),
                         ti12, ti11, RE(t5), RE(t4));
                     ComplexMult(&IM(c4), &IM(c5),
-                        ti12, ti12, IM(t5), IM(t4));
+                        ti12, ti11, IM(t5), IM(t4));
 
                     IM(d2) = IM(c2) - RE(c5);
                     IM(d3) = IM(c3) - RE(c4);
@@ -992,13 +995,11 @@
 
 void cfftu(cfft_info *cfft)
 {
-  if ( ! cfft ) return;
-
-  faad_free(cfft->work);
+    if (cfft->work) faad_free(cfft->work);
 #ifndef FIXED_POINT
-  faad_free(cfft->tab);
+    if (cfft->tab) faad_free(cfft->tab);
 #endif
 
-  faad_free(cfft);
+    if (cfft) faad_free(cfft);
 }
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/cfft.h xine-lib-1.1.11.1-ubuntu/src/libfaad/cfft.h
--- xine-lib-1.1.11.1/src/libfaad/cfft.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/cfft.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: cfft.h,v 1.9 2005/10/29 23:57:06 tmmm Exp $
+** $Id: cfft.h,v 1.24 2007/11/01 12:33:29 menno Exp $
 **/
 
 #ifndef __CFFT_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/cfft_tab.h xine-lib-1.1.11.1-ubuntu/src/libfaad/cfft_tab.h
--- xine-lib-1.1.11.1/src/libfaad/cfft_tab.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/cfft_tab.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: cfft_tab.h,v 1.6 2005/10/29 23:57:06 tmmm Exp $
+** $Id: cfft_tab.h,v 1.21 2007/11/01 12:33:29 menno Exp $
 **/
 
 #ifndef __CFFT_TAB_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_10.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_10.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_10.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_10.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_10.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_10.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* 2-step huffman table HCB_10 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_11.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_11.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_11.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_11.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_11.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_11.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* 2-step huffman table HCB_11 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_1.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_1.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_1.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_1.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_1.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_1.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* 2-step huffman table HCB_1 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_2.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_2.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_2.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_2.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_2.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_2.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* 2-step huffman table HCB_2 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_3.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_3.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_3.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_3.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_3.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_3.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* Binary search huffman table HCB_3 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_4.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_4.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_4.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_4.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_4.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_4.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* 2-step huffman table HCB_4 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_5.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_5.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_5.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_5.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_5.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_5.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* Binary search huffman table HCB_5 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_6.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_6.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_6.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_6.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_6.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_6.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* 2-step huffman table HCB_6 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_7.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_7.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_7.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_7.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_7.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_7.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* Binary search huffman table HCB_7 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_8.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_8.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_8.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_8.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_8.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_8.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* 2-step huffman table HCB_8 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_9.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_9.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_9.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_9.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_9.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_9.h,v 1.5 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* Binary search huffman table HCB_9 */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb.h,v 1.6 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb.h,v 1.8 2007/11/01 12:34:10 menno Exp $
 **/
 
 #ifndef __HCB_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/hcb_sf.h xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_sf.h
--- xine-lib-1.1.11.1/src/libfaad/codebook/hcb_sf.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/hcb_sf.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcb_sf.h,v 1.4 2005/10/29 23:57:08 tmmm Exp $
+** $Id: hcb_sf.h,v 1.7 2007/11/01 12:34:11 menno Exp $
 **/
 
 /* Binary search huffman table HCB_SF */
diff -Nur xine-lib-1.1.11.1/src/libfaad/codebook/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/Makefile.in
--- xine-lib-1.1.11.1/src/libfaad/codebook/Makefile.in	2008-03-30 16:02:32.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/codebook/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/src/libfaad/common.c xine-lib-1.1.11.1-ubuntu/src/libfaad/common.c
--- xine-lib-1.1.11.1/src/libfaad/common.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/common.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: common.c,v 1.8 2005/10/29 23:57:06 tmmm Exp $
+** $Id: common.c,v 1.26 2007/11/01 12:33:30 menno Exp $
 **/
 
 /* just some common functions that could be used anywhere */
@@ -229,16 +232,16 @@
  *  which gives a period of 18.410.713.077.675.721.215. The result is the
  *  XORed values of both generators.
  */
-uint32_t random_int(void)
+uint32_t ne_rng(uint32_t *__r1, uint32_t *__r2)
 {
     uint32_t  t1, t2, t3, t4;
 
-    t3   = t1 = __r1;   t4   = t2 = __r2;       // Parity calculation is done via table lookup, this is also available
+    t3   = t1 = *__r1;  t4   = t2 = *__r2;      // Parity calculation is done via table lookup, this is also available
     t1  &= 0xF5;        t2 >>= 25;              // on CPUs without parity, can be implemented in C and avoid unpredictable
     t1   = Parity [t1]; t2  &= 0x63;            // jumps and slow rotate through the carry flag operations.
     t1 <<= 31;          t2   = Parity [t2];
 
-    return (__r1 = (t3 >> 1) | t1 ) ^ (__r2 = (t4 + t4) | t2 );
+    return (*__r1 = (t3 >> 1) | t1 ) ^ (*__r2 = (t4 + t4) | t2 );
 }
 
 uint32_t ones32(uint32_t x)
diff -Nur xine-lib-1.1.11.1/src/libfaad/common.h xine-lib-1.1.11.1-ubuntu/src/libfaad/common.h
--- xine-lib-1.1.11.1/src/libfaad/common.h	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/common.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: common.h,v 1.17 2006/06/17 20:43:57 dgp85 Exp $
+** $Id: common.h,v 1.72 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __COMMON_H__
@@ -32,13 +35,16 @@
 extern "C" {
 #endif
 
-#ifdef __CYGWIN__
-#define __STRICT_ANSI__
+#ifdef HAVE_CONFIG_H
+#  include <config.h>
 #endif
 
-#include "config.h"
-
+#if 1
 #define INLINE __inline
+#else
+#define INLINE inline
+#endif
+
 #if 0 //defined(_WIN32) && !defined(_WIN32_WCE)
 #define ALIGN __declspec(align(16))
 #else
@@ -63,10 +69,13 @@
 /* Use if target platform has address generators with autoincrement */
 //#define PREFER_POINTERS
 
-#if defined(_WIN32_WCE) || defined(__arm__)
+#ifdef _WIN32_WCE
 #define FIXED_POINT
 #endif
 
+#ifdef __BFIN__
+#define FIXED_POINT
+#endif
 
 #define ERROR_RESILIENCE
 
@@ -79,8 +88,6 @@
 #define LTP_DEC
 /* Allow decoding of LD profile AAC */
 #define LD_DEC
-/* Allow decoding of scalable profiles */
-//#define SCALABLE_DEC
 /* Allow decoding of Digital Radio Mondiale (DRM) */
 //#define DRM
 //#define DRM_PS
@@ -114,20 +121,25 @@
 //#define SBR_LOW_POWER
 #define PS_DEC
 
+#ifdef SBR_LOW_POWER
+#undef PS_DEC
+#endif
+
 /* FIXED POINT: No MAIN decoding */
 #ifdef FIXED_POINT
 # ifdef MAIN_DEC
 #  undef MAIN_DEC
 # endif
-# ifdef SBR_DEC
-#  undef SBR_DEC
-# endif
 #endif // FIXED_POINT
 
 #ifdef DRM
-# ifndef SCALABLE_DEC
-#  define SCALABLE_DEC
+# ifndef ALLOW_SMALL_FRAMELENGTH
+#  define ALLOW_SMALL_FRAMELENGTH
 # endif
+# undef LD_DEC
+# undef LTP_DEC
+# undef MAIN_DEC
+# undef SSR_DEC
 #endif
 
 
@@ -152,6 +164,23 @@
 
 /* END COMPILE TIME DEFINITIONS */
 
+#if defined(_WIN32) && !defined(__MINGW32__)
+
+#include <stdlib.h>
+
+typedef unsigned __int64 uint64_t;
+typedef unsigned __int32 uint32_t;
+typedef unsigned __int16 uint16_t;
+typedef unsigned __int8 uint8_t;
+typedef __int64 int64_t;
+typedef __int32 int32_t;
+typedef __int16 int16_t;
+typedef __int8  int8_t;
+typedef float float32_t;
+
+
+#else
+
 #include <stdio.h>
 #if HAVE_SYS_TYPES_H
 # include <sys/types.h>
@@ -176,8 +205,6 @@
 #if HAVE_STRINGS_H
 # include <strings.h>
 #endif
-
-/* precedence defining int-types by header files for all platforms */
 #if HAVE_INTTYPES_H
 # include <inttypes.h>
 #else
@@ -185,30 +212,23 @@
 #  include <stdint.h>
 # else
 /* we need these... */
-#  ifdef WIN32
-typedef unsigned __int64 uint64_t;
-typedef unsigned __int32 uint32_t;
-typedef unsigned __int16 uint16_t;
-typedef unsigned __int8 uint8_t;
-typedef __int64 int64_t;
-typedef __int32 int32_t;
-typedef __int16 int16_t;
-typedef __int8  int8_t;
-#  else /* WIN32 */
-typedef float float32_t;
+#ifndef __TCS__
 typedef unsigned long long uint64_t;
+typedef long long int64_t;
+#else
+typedef unsigned long uint64_t;
+typedef long int64_t;
+#endif
 typedef unsigned long uint32_t;
 typedef unsigned short uint16_t;
 typedef unsigned char uint8_t;
-typedef long long int64_t;
 typedef long int32_t;
 typedef short int16_t;
 typedef char int8_t;
-#  endif /* WIN32 */
 # endif
 #endif
 #if HAVE_UNISTD_H
-# include <unistd.h>
+//# include <unistd.h>
 #endif
 
 #ifndef HAVE_FLOAT32_T
@@ -229,6 +249,8 @@
 # endif
 #endif
 
+#endif
+
 #ifdef WORDS_BIGENDIAN
 #define ARCH_IS_BIG_ENDIAN
 #endif
@@ -289,7 +311,6 @@
   }
 
 
-#ifndef HAVE_LRINTF
   #if defined(_WIN32) && !defined(__MINGW32__)
     #define HAS_LRINTF
     static INLINE int lrintf(float f)
@@ -302,7 +323,9 @@
         }
         return i;
     }
-  #elif (defined(__i386__) && defined(__GNUC__))
+  #elif (defined(__i386__) && defined(__GNUC__) && \
+	!defined(__CYGWIN__) && !defined(__MINGW32__))
+    #ifndef HAVE_LRINTF
     #define HAS_LRINTF
     // from http://www.stereopsis.com/FPU.html
     static INLINE int lrintf(float f)
@@ -315,8 +338,9 @@
             : "m" (f));
         return i;
     }
+    #endif /* HAVE_LRINTF */
   #endif
-#endif
+
 
   #ifdef __ICL /* only Intel C compiler has fmath ??? */
 
@@ -331,8 +355,6 @@
 
   #else
 
-#include <math.h>
-
 #ifdef HAVE_LRINTF
 #  define HAS_LRINTF
 #  define _ISOC9X_SOURCE 1
@@ -341,6 +363,8 @@
 #  define __USE_ISOC99   1
 #endif
 
+    #include <math.h>
+
 #ifdef HAVE_SINF
 #  define sin sinf
 #error
@@ -380,7 +404,7 @@
 
 /* common functions */
 uint8_t cpu_has_sse(void);
-uint32_t random_int(void);
+uint32_t ne_rng(uint32_t *__r1, uint32_t *__r2);
 uint32_t ones32(uint32_t x);
 uint32_t floor_log2(uint32_t x);
 uint32_t wl_min_lzc(uint32_t x);
diff -Nur xine-lib-1.1.11.1/src/libfaad/decoder.c xine-lib-1.1.11.1-ubuntu/src/libfaad/decoder.c
--- xine-lib-1.1.11.1/src/libfaad/decoder.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/decoder.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: decoder.c,v 1.10 2005/10/29 23:57:06 tmmm Exp $
+** $Id: decoder.c,v 1.111 2007/11/01 12:33:30 menno Exp $
 **/
 
 #include "common.h"
@@ -90,6 +93,7 @@
     return cap;
 }
 
+const unsigned char mes[] = { 0x67,0x20,0x61,0x20,0x20,0x20,0x6f,0x20,0x72,0x20,0x65,0x20,0x6e,0x20,0x20,0x20,0x74,0x20,0x68,0x20,0x67,0x20,0x69,0x20,0x72,0x20,0x79,0x20,0x70,0x20,0x6f,0x20,0x63 };
 NeAACDecHandle NEAACDECAPI NeAACDecOpen(void)
 {
     uint8_t i;
@@ -100,6 +104,7 @@
 
     memset(hDecoder, 0, sizeof(NeAACDecStruct));
 
+    hDecoder->cmes = mes;
     hDecoder->config.outputFormat  = FAAD_FMT_16BIT;
     hDecoder->config.defObjectType = MAIN;
     hDecoder->config.defSampleRate = 44100; /* Default: 44.1kHz */
@@ -116,6 +121,9 @@
     hDecoder->frame = 0;
     hDecoder->sample_buffer = NULL;
 
+    hDecoder->__r1 = 1;
+    hDecoder->__r2 = 1;
+
     for (i = 0; i < MAX_CHANNELS; i++)
     {
         hDecoder->window_shape_prev[i] = 0;
@@ -194,6 +202,7 @@
     return 0;
 }
 
+
 int32_t NEAACDECAPI NeAACDecInit(NeAACDecHandle hDecoder, uint8_t *buffer,
                                  uint32_t buffer_size,
                                  uint32_t *samplerate, uint8_t *channels)
@@ -203,6 +212,7 @@
     adif_header adif;
     adts_header adts;
 
+
     if ((hDecoder == NULL) || (samplerate == NULL) || (channels == NULL))
         return -1;
 
@@ -257,7 +267,6 @@
         }
         faad_endbits(&ld);
     }
-    hDecoder->channelConfiguration = *channels;
 
 #if (defined(PS_DEC) || defined(DRM_PS))
     /* check if we have a mono file */
@@ -268,6 +277,8 @@
     }
 #endif
 
+    hDecoder->channelConfiguration = *channels;
+
 #ifdef SBR_DEC
     /* implicit signalling */
     if (*samplerate <= 24000 && !(hDecoder->config.dontUpSampleImplicitSBR))
@@ -422,8 +433,8 @@
     if ((channels == DRMCH_MONO) || (channels == DRMCH_STEREO))
         (*hDecoder)->sbr_present_flag = 0;
     else
-        (*hDecoder)->sbr_present_flag = 1;    
-#endif        
+        (*hDecoder)->sbr_present_flag = 1;
+#endif
 
     (*hDecoder)->fb = filter_bank_init((*hDecoder)->frameLength);
 
@@ -525,8 +536,14 @@
         chdir = hInfo->num_front_channels;
         if (chdir & 1)
         {
+#if (defined(PS_DEC) || defined(DRM_PS))
+            /* When PS is enabled output is always stereo */
+            hInfo->channel_position[chpos++] = FRONT_CHANNEL_LEFT;
+            hInfo->channel_position[chpos++] = FRONT_CHANNEL_RIGHT;
+#else
             hInfo->channel_position[chpos++] = FRONT_CHANNEL_CENTER;
             chdir--;
+#endif
         }
         for (i = 0; i < chdir; i += 2)
         {
@@ -565,8 +582,15 @@
         switch (hDecoder->channelConfiguration)
         {
         case 1:
+#if (defined(PS_DEC) || defined(DRM_PS))
+            /* When PS is enabled output is always stereo */
+            hInfo->num_front_channels = 2;
+            hInfo->channel_position[0] = FRONT_CHANNEL_LEFT;
+            hInfo->channel_position[1] = FRONT_CHANNEL_RIGHT;
+#else
             hInfo->num_front_channels = 1;
             hInfo->channel_position[0] = FRONT_CHANNEL_CENTER;
+#endif
             break;
         case 2:
             hInfo->num_front_channels = 2;
@@ -722,13 +746,25 @@
         sample_buffer, sample_buffer_size);
 }
 
+#ifdef DRM
+
+#define ERROR_STATE_INIT 6
+
+static void conceal_output(NeAACDecHandle hDecoder, uint16_t frame_len,
+                           uint8_t out_ch, void *sample_buffer)
+{
+    return;
+}
+#endif
+
 static void* aac_frame_decode(NeAACDecHandle hDecoder, NeAACDecFrameInfo *hInfo,
                               uint8_t *buffer, uint32_t buffer_size,
                               void **sample_buffer2, uint32_t sample_buffer_size)
 {
+    uint16_t i;
     uint8_t channels = 0;
     uint8_t output_channels = 0;
-    bitfile ld;
+    bitfile ld = {0};
     uint32_t bitsconsumed;
     uint16_t frame_len;
     void *sample_buffer;
@@ -753,6 +789,33 @@
     memset(hInfo, 0, sizeof(NeAACDecFrameInfo));
     memset(hDecoder->internal_channel, 0, MAX_CHANNELS*sizeof(hDecoder->internal_channel[0]));
 
+#ifdef USE_TIME_LIMIT
+    if ((TIME_LIMIT * get_sample_rate(hDecoder->sf_index)) > hDecoder->TL_count)
+    {
+        hDecoder->TL_count += 1024;
+    } else {
+        hInfo->error = (NUM_ERROR_MESSAGES-1);
+        goto error;
+    }
+#endif
+
+
+    /* check for some common metadata tag types in the bitstream
+     * No need to return an error
+     */
+    /* ID3 */
+    if (buffer_size >= 128)
+    {
+        if (memcmp(buffer, "TAG", 3) == 0)
+        {
+            /* found it */
+            hInfo->bytesconsumed = 128; /* 128 bytes fixed size */
+            /* no error, but no output either */
+            return NULL;
+        }
+    }
+
+
     /* initialize the bitstream */
     faad_initbits(&ld, buffer, buffer_size);
 
@@ -780,7 +843,7 @@
         /* We do not support stereo right now */
         if (0) //(hDecoder->channelConfiguration == 2)
         {
-            hInfo->error = 8; // Throw CRC error
+            hInfo->error = 28; // Throw CRC error
             goto error;
         }
 
@@ -808,14 +871,14 @@
 #endif
 
     /* decode the complete bitstream */
-#ifdef SCALABLE_DEC
-    if ((hDecoder->object_type == 6) || (hDecoder->object_type == DRM_ER_LC))
+#ifdef DRM
+    if (/*(hDecoder->object_type == 6) ||*/ (hDecoder->object_type == DRM_ER_LC))
     {
-        aac_scalable_main_element(hDecoder, hInfo, &ld, &hDecoder->pce, hDecoder->drc);
+        DRM_aac_scalable_main_element(hDecoder, hInfo, &ld, &hDecoder->pce, hDecoder->drc);
     } else {
 #endif
         raw_data_block(hDecoder, hInfo, &ld, &hDecoder->pce, hDecoder->drc);
-#ifdef SCALABLE_DEC
+#ifdef DRM
     }
 #endif
 
@@ -978,10 +1041,16 @@
     }
 #endif
 
+
     sample_buffer = output_to_PCM(hDecoder, hDecoder->time_out, sample_buffer,
         output_channels, frame_len, hDecoder->config.outputFormat);
 
 
+#ifdef DRM
+    //conceal_output(hDecoder, frame_len, output_channels, sample_buffer);
+#endif
+
+
     hDecoder->postSeekResetFlag = 0;
 
     hDecoder->frame++;
@@ -1013,6 +1082,30 @@
 
 error:
 
+
+#ifdef DRM
+    hDecoder->error_state = ERROR_STATE_INIT;
+#endif
+
+    /* reset filterbank state */
+    for (i = 0; i < MAX_CHANNELS; i++)
+    {
+        if (hDecoder->fb_intermed[i] != NULL)
+        {
+            memset(hDecoder->fb_intermed[i], 0, hDecoder->frameLength*sizeof(real_t));
+        }
+    }
+#ifdef SBR_DEC
+    for (i = 0; i < MAX_SYNTAX_ELEMENTS; i++)
+    {
+        if (hDecoder->sbr[i] != NULL)
+        {
+            sbrReset(hDecoder->sbr[i]);
+        }
+    }
+#endif
+
+
     faad_endbits(&ld);
 
     /* cleanup */
diff -Nur xine-lib-1.1.11.1/src/libfaad/decoder.h xine-lib-1.1.11.1-ubuntu/src/libfaad/decoder.h
--- xine-lib-1.1.11.1/src/libfaad/decoder.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/decoder.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: decoder.h,v 1.9 2005/10/29 23:57:06 tmmm Exp $
+** $Id: decoder.h,v 1.48 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __DECODER_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/drc.c xine-lib-1.1.11.1-ubuntu/src/libfaad/drc.c
--- xine-lib-1.1.11.1/src/libfaad/drc.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/drc.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: drc.c,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: drc.c,v 1.28 2007/11/01 12:33:30 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/drc.h xine-lib-1.1.11.1-ubuntu/src/libfaad/drc.h
--- xine-lib-1.1.11.1/src/libfaad/drc.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/drc.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: drc.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: drc.h,v 1.22 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __DRC_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/drm_dec.c xine-lib-1.1.11.1-ubuntu/src/libfaad/drm_dec.c
--- xine-lib-1.1.11.1/src/libfaad/drm_dec.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/drm_dec.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
-** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR and PS decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: drm_dec.c,v 1.1 2005/10/30 00:50:19 tmmm Exp $
+** $Id: drm_dec.c,v 1.9 2007/11/01 12:33:30 menno Exp $
 **/
 
 #include <stdlib.h>
@@ -243,17 +246,9 @@
     { FRAC_CONST(0.929071574),  FRAC_CONST(0)           }
 };
 
-static const uint8_t sa_freq_scale[9][2] = 
+static const uint8_t sa_freq_scale[9] = 
 {
-    { 0, 0},  
-    { 1, 1},  
-    { 2, 2},  
-    { 3, 3},  
-    { 5, 5},  
-    { 7, 7},  
-    {10,10},  
-    {13,13},  
-    {46,23}
+    0, 1, 2, 3, 5, 7, 10, 13, 23
 };
 
 static const uint8_t pan_freq_scale[21] = 
@@ -290,9 +285,9 @@
     FRAC_CONST(0.48954165955695)
 };
 
-static const uint8_t delay_length[][2] = 
+static const uint8_t delay_length[3] = 
 {
-    { 1, 3 }, { 2, 4 }, { 3, 5 }
+    3, 4, 5
 };
 
 static const real_t delay_fraction[] = 
@@ -300,15 +295,9 @@
     FRAC_CONST(0.43), FRAC_CONST(0.75), FRAC_CONST(0.347)
 };
 
-static const real_t peak_decay[2] = 
-{
-    FRAC_CONST(0.58664621951003), FRAC_CONST(0.76592833836465)
-};
+static const real_t peak_decay = FRAC_CONST(0.76592833836465);
 
-static const real_t smooth_coeff[2] = 
-{
-    FRAC_CONST(0.6), FRAC_CONST(0.25)
-};
+static const real_t smooth_coeff = FRAC_CONST(0.25);
 
 /* Please note that these are the same tables as in plain PS */
 static const complex_t Q_Fract_allpass_Qmf[][3] = {
@@ -566,25 +555,22 @@
     {    
         if (ps->bs_sa_dt_flag && !ps->g_last_had_sa) 
         {        
-            for (band = 0; band < DRM_NUM_SA_BANDS; band++)
-            {   
-                ps->g_prev_sa_index[band] = 0;
-            }           
-        }       
-        if (ps->bs_sa_dt_flag)
-        {
+            /* wait until we get a DT frame */
+            ps->bs_enable_sa = 0;
+        } else if (ps->bs_sa_dt_flag) {
+            /* DT frame, we have a last frame, so we can decode */
             ps->g_sa_index[0] = sa_delta_clip(ps, ps->g_prev_sa_index[0]+ps->bs_sa_data[0]);            
-
         } else {
+            /* DF always decodable */
             ps->g_sa_index[0] = sa_delta_clip(ps,ps->bs_sa_data[0]);          
         }
         
         for (band = 1; band < DRM_NUM_SA_BANDS; band++)
         {   
-            if (ps->bs_sa_dt_flag)
+            if (ps->bs_sa_dt_flag && ps->g_last_had_sa)
             {
                 ps->g_sa_index[band] = sa_delta_clip(ps, ps->g_prev_sa_index[band] + ps->bs_sa_data[band]);
-            } else {
+            } else if (!ps->bs_sa_dt_flag) {
                 ps->g_sa_index[band] = sa_delta_clip(ps, ps->g_sa_index[band-1] + ps->bs_sa_data[band]);                
             }
         }
@@ -618,28 +604,19 @@
     {
         if (ps->bs_pan_dt_flag && !ps->g_last_had_pan) 
         {
-/* The DRM PS spec doesn't say anything about this case. (deltacoded in time without a previous frame)
-   AAC PS spec you must tread previous frame as 0, so that's what we try. 
-*/
-            for (band = 0; band < DRM_NUM_PAN_BANDS; band++)
-            {   
-                ps->g_prev_pan_index[band] = 0;
-            }
-        } 
-
-        if (ps->bs_pan_dt_flag)
-        {   
-             ps->g_pan_index[0] = pan_delta_clip(ps,  ps->g_prev_pan_index[0]+ps->bs_pan_data[0]);
+            ps->bs_enable_pan = 0;
+        }  else if (ps->bs_pan_dt_flag) {   
+            ps->g_pan_index[0] = pan_delta_clip(ps,  ps->g_prev_pan_index[0]+ps->bs_pan_data[0]);
         } else {
-             ps->g_pan_index[0] = pan_delta_clip(ps, ps->bs_pan_data[0]);
+            ps->g_pan_index[0] = pan_delta_clip(ps, ps->bs_pan_data[0]);
         }
     
         for (band = 1; band < DRM_NUM_PAN_BANDS; band++)
         {   
-            if (ps->bs_pan_dt_flag)
+            if (ps->bs_pan_dt_flag && ps->g_last_had_pan)
             {
                 ps->g_pan_index[band] = pan_delta_clip(ps, ps->g_prev_pan_index[band] + ps->bs_pan_data[band]);
-            } else {
+            } else if (!ps->bs_pan_dt_flag) {
                 ps->g_pan_index[band] = pan_delta_clip(ps, ps->g_pan_index[band-1] + ps->bs_pan_data[band]);
             }
         }
@@ -658,7 +635,7 @@
     }
 }
 
-static void drm_calc_sa_side_signal(drm_ps_info *ps, qmf_t X[38][64], uint8_t rateselect) 
+static void drm_calc_sa_side_signal(drm_ps_info *ps, qmf_t X[38][64]) 
 {      
     uint8_t s, b, k;
     complex_t qfrac, tmp0, tmp, in, R0;
@@ -673,7 +650,7 @@
     uint32_t in_re, in_im;
 #endif
 
-    for (b = 0; b < sa_freq_scale[DRM_NUM_SA_BANDS][rateselect]; b++)
+    for (b = 0; b < sa_freq_scale[DRM_NUM_SA_BANDS]; b++)
     {
         /* set delay indices */    
         for (k = 0; k < NUM_OF_LINKS; k++)
@@ -701,16 +678,16 @@
             power = MUL_R(RE(in),RE(in)) + MUL_R(IM(in),IM(in));
 #endif
 
-            ps->peakdecay_fast[b] = MUL_F(ps->peakdecay_fast[b], peak_decay[rateselect]);
+            ps->peakdecay_fast[b] = MUL_F(ps->peakdecay_fast[b], peak_decay);
             if (ps->peakdecay_fast[b] < power)
                 ps->peakdecay_fast[b] = power;
 
             peakdiff = ps->prev_peakdiff[b];
-            peakdiff += MUL_F((ps->peakdecay_fast[b] - power - ps->prev_peakdiff[b]), smooth_coeff[rateselect]);
+            peakdiff += MUL_F((ps->peakdecay_fast[b] - power - ps->prev_peakdiff[b]), smooth_coeff);
             ps->prev_peakdiff[b] = peakdiff;
 
             nrg = ps->prev_nrg[b];
-            nrg += MUL_F((power - ps->prev_nrg[b]), smooth_coeff[rateselect]);
+            nrg += MUL_F((power - ps->prev_nrg[b]), smooth_coeff);
             ps->prev_nrg[b] = nrg;
 
             if (MUL_R(peakdiff, gamma) <= nrg) {
@@ -763,7 +740,7 @@
 
             for (k = 0; k < NUM_OF_LINKS; k++)
             {
-                if (++temp_delay_ser[k] >= delay_length[k][rateselect])
+                if (++temp_delay_ser[k] >= delay_length[k])
                     temp_delay_ser[k] = 0;
             }
         }       
@@ -773,7 +750,7 @@
         ps->delay_buf_index_ser[k] = temp_delay_ser[k];
 }
 
-static void drm_add_ambiance(drm_ps_info *ps, uint8_t rateselect, qmf_t X_left[38][64], qmf_t X_right[38][64]) 
+static void drm_add_ambiance(drm_ps_info *ps, qmf_t X_left[38][64], qmf_t X_right[38][64]) 
 {
     uint8_t s, b, ifreq, qclass;    
     real_t sa_map[MAX_SA_BAND], sa_dir_map[MAX_SA_BAND], k_sa_map[MAX_SA_BAND], k_sa_dir_map[MAX_SA_BAND];
@@ -783,7 +760,7 @@
     {
         /* Instead of dequantization and mapping, we use an inverse mapping
            to look up all the values we need */
-        for (b = 0; b < sa_freq_scale[DRM_NUM_SA_BANDS][rateselect]; b++)
+        for (b = 0; b < sa_freq_scale[DRM_NUM_SA_BANDS]; b++)
         {
             const real_t inv_f_num_of_subsamples = FRAC_CONST(0.03333333333);
 
@@ -804,7 +781,7 @@
 
         for (s = 0; s < NUM_OF_SUBSAMPLES; s++)
         {
-            for (b = 0; b < sa_freq_scale[DRM_NUM_SA_BANDS][rateselect]; b++)
+            for (b = 0; b < sa_freq_scale[DRM_NUM_SA_BANDS]; b++)
             {                
                 QMF_RE(X_right[s][b]) = MUL_F(QMF_RE(X_left[s][b]), sa_dir_map[b]) - MUL_F(QMF_RE(ps->SA[s][b]), sa_map[b]);
                 QMF_IM(X_right[s][b]) = MUL_F(QMF_IM(X_left[s][b]), sa_dir_map[b]) - MUL_F(QMF_IM(ps->SA[s][b]), sa_map[b]);
@@ -814,7 +791,7 @@
                 sa_map[b]     += k_sa_map[b];
                 sa_dir_map[b] += k_sa_dir_map[b];
             }
-            for (b = sa_freq_scale[DRM_NUM_SA_BANDS][rateselect]; b < NUM_OF_QMF_CHANNELS; b++)
+            for (b = sa_freq_scale[DRM_NUM_SA_BANDS]; b < NUM_OF_QMF_CHANNELS; b++)
             {                
                 QMF_RE(X_right[s][b]) = QMF_RE(X_left[s][b]);
                 QMF_IM(X_right[s][b]) = QMF_IM(X_left[s][b]);
@@ -833,7 +810,7 @@
     }
 }
 
-static void drm_add_pan(drm_ps_info *ps, uint8_t rateselect, qmf_t X_left[38][64], qmf_t X_right[38][64]) 
+static void drm_add_pan(drm_ps_info *ps, qmf_t X_left[38][64], qmf_t X_right[38][64]) 
 {
     uint8_t s, b, qclass, ifreq;
     real_t tmp, coeff1, coeff2;
@@ -924,10 +901,8 @@
 }
 
 /* main DRM PS decoding function */
-uint8_t drm_ps_decode(drm_ps_info *ps, uint8_t guess, uint32_t samplerate, qmf_t X_left[38][64], qmf_t X_right[38][64])
-{
-    uint8_t rateselect = (samplerate >= 24000);
-    
+uint8_t drm_ps_decode(drm_ps_info *ps, uint8_t guess, qmf_t X_left[38][64], qmf_t X_right[38][64])
+{       
     if (ps == NULL) 
     {
         memcpy(X_right, X_left, sizeof(qmf_t)*30*64);
@@ -958,8 +933,8 @@
   
     ps->drm_ps_data_available = 0;
 
-    drm_calc_sa_side_signal(ps, X_left, rateselect);
-    drm_add_ambiance(ps, rateselect, X_left, X_right);
+    drm_calc_sa_side_signal(ps, X_left);
+    drm_add_ambiance(ps, X_left, X_right);
 
     if (ps->bs_enable_sa)
     {
@@ -973,7 +948,7 @@
     
     if (ps->bs_enable_pan)
     {
-        drm_add_pan(ps, rateselect, X_left, X_right);
+        drm_add_pan(ps, X_left, X_right);
     
         ps->g_last_had_pan = 1;        
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/drm_dec.h xine-lib-1.1.11.1-ubuntu/src/libfaad/drm_dec.h
--- xine-lib-1.1.11.1/src/libfaad/drm_dec.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/drm_dec.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: drm_dec.h,v 1.1 2005/10/30 00:50:19 tmmm Exp $
+** $Id: drm_dec.h,v 1.8 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __DRM_DEC_H__
@@ -88,7 +91,7 @@
 drm_ps_info *drm_ps_init(void);
 void drm_ps_free(drm_ps_info *ps);
 
-uint8_t drm_ps_decode(drm_ps_info *ps, uint8_t guess, uint32_t samplerate, qmf_t X_left[38][64], qmf_t X_right[38][64]);
+uint8_t drm_ps_decode(drm_ps_info *ps, uint8_t guess, qmf_t X_left[38][64], qmf_t X_right[38][64]);
 
 #ifdef __cplusplus
 }
diff -Nur xine-lib-1.1.11.1/src/libfaad/error.c xine-lib-1.1.11.1-ubuntu/src/libfaad/error.c
--- xine-lib-1.1.11.1/src/libfaad/error.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/error.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: error.c,v 1.8 2005/10/29 23:57:06 tmmm Exp $
+** $Id: error.c,v 1.32 2007/11/01 12:33:30 menno Exp $
 **/
 
 #include "common.h"
@@ -56,6 +59,11 @@
     "Unexpected fill element with SBR data",
     "Not all elements were provided with SBR data",
     "LTP decoding not available",
-    "Output data buffer too small"
+    "Output data buffer too small",
+    "CRC error in DRM data",
+    "PNS not allowed in DRM data stream",
+    "No standard extension payload allowed in DRM",
+    "PCE shall be the first element in a frame",
+    "Bitstream value not allowed by specification"
 };
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/error.h xine-lib-1.1.11.1-ubuntu/src/libfaad/error.h
--- xine-lib-1.1.11.1/src/libfaad/error.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/error.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: error.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: error.h,v 1.26 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __ERROR_H__
@@ -32,7 +35,7 @@
 extern "C" {
 #endif
 
-#define NUM_ERROR_MESSAGES 28
+#define NUM_ERROR_MESSAGES 33
 extern char *err_msg[];
 
 #ifdef __cplusplus
diff -Nur xine-lib-1.1.11.1/src/libfaad/filtbank.c xine-lib-1.1.11.1-ubuntu/src/libfaad/filtbank.c
--- xine-lib-1.1.11.1/src/libfaad/filtbank.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/filtbank.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: filtbank.c,v 1.10 2005/10/29 23:57:06 tmmm Exp $
+** $Id: filtbank.c,v 1.45 2007/11/01 12:33:30 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/filtbank.h xine-lib-1.1.11.1-ubuntu/src/libfaad/filtbank.h
--- xine-lib-1.1.11.1/src/libfaad/filtbank.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/filtbank.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: filtbank.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: filtbank.h,v 1.27 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __FILTBANK_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/fixed.h xine-lib-1.1.11.1-ubuntu/src/libfaad/fixed.h
--- xine-lib-1.1.11.1/src/libfaad/fixed.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/fixed.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: fixed.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: fixed.h,v 1.32 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __FIXED_H__
@@ -36,6 +39,7 @@
 #include <cmnintrin.h>
 #endif
 
+
 #define COEF_BITS 28
 #define COEF_PRECISION (1 << COEF_BITS)
 #define REAL_BITS 14 // MAXIMUM OF 14 FOR FIXED POINT SBR
@@ -240,9 +244,27 @@
       return _MulHigh(A,B) << (32-FRAC_BITS);
   }
 #else
+#ifdef __BFIN__
+#define _MulHigh(X,Y) ({ int __xxo;                      \
+     asm (                                               \
+         "a1 = %2.H * %1.L (IS,M);\n\t"                  \
+         "a0 = %1.H * %2.H, a1+= %1.H * %2.L (IS,M);\n\t"\
+         "a1 = a1 >>> 16;\n\t"                           \
+         "%0 = (a0 += a1);\n\t"                          \
+         : "=d" (__xxo) : "d" (X), "d" (Y) : "A0","A1"); __xxo; })
+
+#define MUL_F(X,Y) ({ int __xxo;                         \
+     asm (                                               \
+         "a1 = %2.H * %1.L (M);\n\t"                     \
+         "a0 = %1.H * %2.H, a1+= %1.H * %2.L (M);\n\t"   \
+         "a1 = a1 >>> 16;\n\t"                           \
+         "%0 = (a0 += a1);\n\t"                          \
+         : "=d" (__xxo) : "d" (X), "d" (Y) : "A0","A1"); __xxo; })
+#else
   #define _MulHigh(A,B) (real_t)(((int64_t)(A)*(int64_t)(B)+(1 << (FRAC_SIZE-1))) >> FRAC_SIZE)
   #define MUL_F(A,B) (real_t)(((int64_t)(A)*(int64_t)(B)+(1 << (FRAC_BITS-1))) >> FRAC_BITS)
 #endif
+#endif
   #define MUL_Q2(A,B) (real_t)(((int64_t)(A)*(int64_t)(B)+(1 << (Q2_BITS-1))) >> Q2_BITS)
   #define MUL_SHIFT6(A,B) (real_t)(((int64_t)(A)*(int64_t)(B)+(1 << (6-1))) >> 6)
   #define MUL_SHIFT23(A,B) (real_t)(((int64_t)(A)*(int64_t)(B)+(1 << (23-1))) >> 23)
diff -Nur xine-lib-1.1.11.1/src/libfaad/hcr.c xine-lib-1.1.11.1-ubuntu/src/libfaad/hcr.c
--- xine-lib-1.1.11.1/src/libfaad/hcr.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/hcr.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2004 G.C. Pascutto, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: hcr.c,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: hcr.c,v 1.24 2007/11/01 12:33:30 menno Exp $
 **/
 
 #include "common.h"
@@ -222,6 +225,7 @@
 
     uint16_t sp_offset[8];
     uint16_t g, i, sortloop, set, bitsread;
+    uint16_t bitsleft, codewordsleft;
     uint8_t w_idx, sfb, this_CB, last_CB, this_sec_CB; 
     
     const uint16_t nshort = hDecoder->frameLength/8;
@@ -236,7 +240,7 @@
     /* since there is spectral data, at least one codeword has nonzero length */
     if (ics->length_of_longest_codeword == 0)
         return 10;
-    
+
     if (sp_data_len < ics->length_of_longest_codeword)
         return 10; 
 
@@ -272,7 +276,7 @@
         for (sfb = 0; sfb < ics->max_sfb; sfb++)
         {
             /* loop over all in this sfb, 4 lines per loop */
-            for (w_idx = 0; 4*w_idx < (ics->swb_offset[sfb+1] - ics->swb_offset[sfb]); w_idx++)
+            for (w_idx = 0; 4*w_idx < (min(ics->swb_offset[sfb+1], ics->swb_offset_max) - ics->swb_offset[sfb]); w_idx++)
             {
                 for(g = 0; g < ics->num_window_groups; g++)
                 {
@@ -404,6 +408,25 @@
             rewrev_bits(&segment[i]);
     }
 
+#if 0 // Seems to give false errors
+    bitsleft = 0;    
+        
+    for (i = 0; i < numberOfSegments && !bitsleft; i++)
+        bitsleft += segment[i].len;
+
+    if (bitsleft) return 10;
+
+    codewordsleft = 0;
+
+    for (i = 0; (i < numberOfCodewords - numberOfSegments) && (!codewordsleft); i++)    
+        if (!codeword[i].decoded)            
+                codewordsleft++; 
+
+    if (codewordsleft) return 10;
+#endif
+
+
     return 0;
+
 }
 #endif
diff -Nur xine-lib-1.1.11.1/src/libfaad/huffman.c xine-lib-1.1.11.1-ubuntu/src/libfaad/huffman.c
--- xine-lib-1.1.11.1/src/libfaad/huffman.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/huffman.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: huffman.c,v 1.5 2005/10/29 23:57:06 tmmm Exp $
+** $Id: huffman.c,v 1.26 2007/11/01 12:33:30 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/huffman.h xine-lib-1.1.11.1-ubuntu/src/libfaad/huffman.h
--- xine-lib-1.1.11.1/src/libfaad/huffman.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/huffman.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: huffman.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: huffman.h,v 1.28 2007/11/01 12:33:30 menno Exp $
 **/
 
 #ifndef __HUFFMAN_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/ic_predict.c xine-lib-1.1.11.1-ubuntu/src/libfaad/ic_predict.c
--- xine-lib-1.1.11.1/src/libfaad/ic_predict.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ic_predict.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ic_predict.c,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: ic_predict.c,v 1.28 2007/11/01 12:33:31 menno Exp $
 **/
 
 #include "common.h"
@@ -81,7 +84,8 @@
 {
     uint16_t tmp;
     int16_t i, j;
-    real_t dr1, predictedvalue;
+    real_t dr1;
+	float32_t predictedvalue;
     real_t e0, e1;
     real_t k1, k2;
 
@@ -114,7 +118,7 @@
 #define B 0.953125
         real_t c = COR[0];
         real_t v = VAR[0];
-        real_t tmp;
+        float32_t tmp;
         if (c == 0 || v <= 1)
         {
             k1 = 0;
@@ -144,7 +148,7 @@
 #define B 0.953125
         real_t c = COR[1];
         real_t v = VAR[1];
-        real_t tmp;
+        float32_t tmp;
         if (c == 0 || v <= 1)
         {
             k2 = 0;
@@ -209,7 +213,7 @@
                 if (is_noise(ics, g, sfb))
                 {
                     offs = ics->swb_offset[sfb];
-                    offs2 = ics->swb_offset[sfb+1];
+                    offs2 = min(ics->swb_offset[sfb+1], ics->swb_offset_max);
 
                     for (i = offs; i < offs2; i++)
                         reset_pred_state(&state[i]);
@@ -241,7 +245,7 @@
         for (sfb = 0; sfb < max_pred_sfb(sf_index); sfb++)
         {
             uint16_t low  = ics->swb_offset[sfb];
-            uint16_t high = ics->swb_offset[sfb+1];
+            uint16_t high = min(ics->swb_offset[sfb+1], ics->swb_offset_max);
 
             for (bin = low; bin < high; bin++)
             {
diff -Nur xine-lib-1.1.11.1/src/libfaad/ic_predict.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ic_predict.h
--- xine-lib-1.1.11.1/src/libfaad/ic_predict.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ic_predict.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ic_predict.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: ic_predict.h,v 1.23 2007/11/01 12:33:31 menno Exp $
 **/
 
 #ifdef MAIN_DEC
diff -Nur xine-lib-1.1.11.1/src/libfaad/iq_table.h xine-lib-1.1.11.1-ubuntu/src/libfaad/iq_table.h
--- xine-lib-1.1.11.1/src/libfaad/iq_table.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/iq_table.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: iq_table.h,v 1.6 2005/10/29 23:57:06 tmmm Exp $
+** $Id: iq_table.h,v 1.20 2007/11/01 12:33:31 menno Exp $
 **/
 
 #ifndef IQ_TABLE_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/is.c xine-lib-1.1.11.1-ubuntu/src/libfaad/is.c
--- xine-lib-1.1.11.1/src/libfaad/is.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/is.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: is.c,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: is.c,v 1.28 2007/11/01 12:33:31 menno Exp $
 **/
 
 #include "common.h"
@@ -84,7 +87,7 @@
 
                     /* Scale from left to right channel,
                        do not touch left channel */
-                    for (i = icsr->swb_offset[sfb]; i < icsr->swb_offset[sfb+1]; i++)
+                    for (i = icsr->swb_offset[sfb]; i < min(icsr->swb_offset[sfb+1], ics->swb_offset_max); i++)
                     {
 #ifndef FIXED_POINT
                         r_spec[(group*nshort)+i] = MUL_R(l_spec[(group*nshort)+i], scale);
diff -Nur xine-lib-1.1.11.1/src/libfaad/is.h xine-lib-1.1.11.1-ubuntu/src/libfaad/is.h
--- xine-lib-1.1.11.1/src/libfaad/is.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/is.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: is.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: is.h,v 1.20 2007/11/01 12:33:31 menno Exp $
 **/
 
 #ifndef __IS_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/kbd_win.h xine-lib-1.1.11.1-ubuntu/src/libfaad/kbd_win.h
--- xine-lib-1.1.11.1/src/libfaad/kbd_win.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/kbd_win.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: kbd_win.h,v 1.7 2005/10/29 23:57:06 tmmm Exp $
+** $Id: kbd_win.h,v 1.21 2007/11/01 12:33:31 menno Exp $
 **/
 
 #ifndef __KBD_WIN_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/lt_predict.c xine-lib-1.1.11.1-ubuntu/src/libfaad/lt_predict.c
--- xine-lib-1.1.11.1/src/libfaad/lt_predict.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/lt_predict.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: lt_predict.c,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: lt_predict.c,v 1.27 2007/11/01 12:33:31 menno Exp $
 **/
 
 
@@ -53,9 +56,6 @@
 #ifdef LD_DEC
         || (object_type == LD)
 #endif
-#ifdef SCALABLE_DEC
-        || (object_type == 6) /* TODO */
-#endif
         )
     {
         return 1;
@@ -120,7 +120,7 @@
                 if (ltp->long_used[sfb])
                 {
                     uint16_t low  = ics->swb_offset[sfb];
-                    uint16_t high = ics->swb_offset[sfb+1];
+                    uint16_t high = min(ics->swb_offset[sfb+1], ics->swb_offset_max);
 
                     for (bin = low; bin < high; bin++)
                     {
diff -Nur xine-lib-1.1.11.1/src/libfaad/lt_predict.h xine-lib-1.1.11.1-ubuntu/src/libfaad/lt_predict.h
--- xine-lib-1.1.11.1/src/libfaad/lt_predict.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/lt_predict.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: lt_predict.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: lt_predict.h,v 1.20 2007/11/01 12:33:31 menno Exp $
 **/
 
 #ifdef LTP_DEC
diff -Nur xine-lib-1.1.11.1/src/libfaad/Makefile.am xine-lib-1.1.11.1-ubuntu/src/libfaad/Makefile.am
--- xine-lib-1.1.11.1/src/libfaad/Makefile.am	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/Makefile.am	2009-10-02 15:28:05.000000000 +0200
@@ -103,4 +103,18 @@
 	ssr_win.h \
 	structs.h \
 	syntax.h \
-	tns.h 
+	tns.h \
+	neaacdec.h \
+	codebook/hcb.h \
+	codebook/hcb_1.h \
+	codebook/hcb_2.h \
+	codebook/hcb_3.h \
+	codebook/hcb_4.h \
+	codebook/hcb_5.h \
+	codebook/hcb_6.h \
+	codebook/hcb_7.h \
+	codebook/hcb_8.h \
+	codebook/hcb_9.h \
+	codebook/hcb_10.h \
+	codebook/hcb_11.h \
+	codebook/hcb_sf.h
diff -Nur xine-lib-1.1.11.1/src/libfaad/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libfaad/Makefile.in
--- xine-lib-1.1.11.1/src/libfaad/Makefile.in	2008-03-30 16:02:32.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -114,7 +114,7 @@
 	$(xineplug_decode_faad_la_LDFLAGS) $(LDFLAGS) -o $@
 @BUILD_FAAD_TRUE@am_xineplug_decode_faad_la_rpath = -rpath \
 @BUILD_FAAD_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -582,8 +582,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -591,8 +591,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -1027,8 +1027,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -1053,8 +1053,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -1064,12 +1064,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libfaad/mdct.c xine-lib-1.1.11.1-ubuntu/src/libfaad/mdct.c
--- xine-lib-1.1.11.1/src/libfaad/mdct.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/mdct.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: mdct.c,v 1.11 2005/10/29 23:57:07 tmmm Exp $
+** $Id: mdct.c,v 1.47 2007/11/01 12:33:31 menno Exp $
 **/
 
 /*
@@ -33,7 +36,7 @@
  * As described in:
  *  P. Duhamel, Y. Mahieux, and J.P. Petit, "A Fast Algorithm for the
  *  Implementation of Filter Banks Based on 'Time Domain Aliasing
- *  Cancellation'," IEEE Proc. on ICASSP'91, 1991, pp. 2209-2212.
+ *  Cancellation," IEEE Proc. on ICASSP91, 1991, pp. 2209-2212.
  *
  *
  * As of April 6th 2002 completely rewritten.
diff -Nur xine-lib-1.1.11.1/src/libfaad/mdct.h xine-lib-1.1.11.1-ubuntu/src/libfaad/mdct.h
--- xine-lib-1.1.11.1/src/libfaad/mdct.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/mdct.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: mdct.h,v 1.8 2005/10/29 23:57:07 tmmm Exp $
+** $Id: mdct.h,v 1.30 2007/11/01 12:33:31 menno Exp $
 **/
 
 #ifndef __MDCT_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/mdct_tab.h xine-lib-1.1.11.1-ubuntu/src/libfaad/mdct_tab.h
--- xine-lib-1.1.11.1/src/libfaad/mdct_tab.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/mdct_tab.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: mdct_tab.h,v 1.1 2005/10/30 00:50:19 tmmm Exp $
+** $Id: mdct_tab.h,v 1.7 2007/11/01 12:33:32 menno Exp $
 **/
 
 #ifndef __MDCT_TAB_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/mp4.c xine-lib-1.1.11.1-ubuntu/src/libfaad/mp4.c
--- xine-lib-1.1.11.1/src/libfaad/mp4.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/mp4.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: mp4.c,v 1.9 2005/10/29 23:57:07 tmmm Exp $
+** $Id: mp4.c,v 1.38 2007/11/01 12:33:32 menno Exp $
 **/
 
 #include "common.h"
@@ -58,11 +61,7 @@
 #else
     0, /*  5 SBR */
 #endif
-#ifdef SCALABLE_DEC
-    1, /*  6 AAC Scalable */
-#else
     0, /*  6 AAC Scalable */
-#endif
     0, /*  7 TwinVQ */
     0, /*  8 CELP */
     0, /*  9 HVXC */
@@ -83,11 +82,7 @@
 #else
     0, /* 19 ER AAC LTP */
 #endif
-#ifdef SCALABLE_DEC
-    1, /* 20 ER AAC scalable */
-#else
     0, /* 20 ER AAC scalable */
-#endif
     0, /* 21 ER TwinVQ */
     0, /* 22 ER BSAC */
 #ifdef LD_DEC
@@ -248,10 +243,10 @@
 
         if (syncExtensionType == 0x2b7)
         {
-            mp4ASC->objectTypeIndex = (uint8_t)faad_getbits(&ld, 5
+            uint8_t tmp_OTi = (uint8_t)faad_getbits(&ld, 5
                 DEBUGVAR(1,10,"parse_audio_decoder_specific_info(): extensionAudioObjectType"));
 
-            if (mp4ASC->objectTypeIndex == 5)
+            if (tmp_OTi == 5)
             {
                 mp4ASC->sbr_present_flag = (uint8_t)faad_get1bit(&ld
                     DEBUGVAR(1,11,"parse_audio_decoder_specific_info(): sbr_present_flag"));
@@ -259,6 +254,10 @@
                 if (mp4ASC->sbr_present_flag)
                 {
                     uint8_t tmp;
+
+					/* Don't set OT to SBR until checked that it is actually there */
+					mp4ASC->objectTypeIndex = tmp_OTi;
+
                     tmp = (uint8_t)faad_getbits(&ld, 4
                         DEBUGVAR(1,12,"parse_audio_decoder_specific_info(): extensionSamplingFrequencyIndex"));
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/mp4.h xine-lib-1.1.11.1-ubuntu/src/libfaad/mp4.h
--- xine-lib-1.1.11.1/src/libfaad/mp4.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/mp4.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: mp4.h,v 1.8 2005/10/29 23:57:07 tmmm Exp $
+** $Id: mp4.h,v 1.25 2007/11/01 12:33:32 menno Exp $
 **/
 
 #ifndef __MP4_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/ms.c xine-lib-1.1.11.1-ubuntu/src/libfaad/ms.c
--- xine-lib-1.1.11.1/src/libfaad/ms.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ms.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ms.c,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: ms.c,v 1.21 2007/11/01 12:33:32 menno Exp $
 **/
 
 #include "common.h"
@@ -58,7 +61,7 @@
                     if ((ics->ms_used[g][sfb] || ics->ms_mask_present == 2) &&
                         !is_intensity(icsr, g, sfb) && !is_noise(ics, g, sfb))
                     {
-                        for (i = ics->swb_offset[sfb]; i < ics->swb_offset[sfb+1]; i++)
+                        for (i = ics->swb_offset[sfb]; i < min(ics->swb_offset[sfb+1], ics->swb_offset_max); i++)
                         {
                             k = (group*nshort) + i;
                             tmp = l_spec[k] - r_spec[k];
diff -Nur xine-lib-1.1.11.1/src/libfaad/ms.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ms.h
--- xine-lib-1.1.11.1/src/libfaad/ms.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ms.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ms.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: ms.h,v 1.19 2007/11/01 12:33:32 menno Exp $
 **/
 
 #ifndef __MS_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/output.c xine-lib-1.1.11.1-ubuntu/src/libfaad/output.c
--- xine-lib-1.1.11.1/src/libfaad/output.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/output.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: output.c,v 1.9 2006/06/30 21:36:27 dgp85 Exp $
+** $Id: output.c,v 1.46 2007/11/01 12:33:32 menno Exp $
 **/
 
 #include "common.h"
@@ -463,7 +466,7 @@
     }
 }
 
-static void* output_to_PCM_orig(NeAACDecHandle hDecoder,
+void* output_to_PCM(NeAACDecHandle hDecoder,
                     real_t **input, void *sample_buffer, uint8_t channels,
                     uint16_t frame_len, uint8_t format)
 {
@@ -554,56 +557,4 @@
     return sample_buffer;
 }
 
-void *output_to_PCM(NeAACDecHandle hDecoder,
-                    real_t **input, void *sample_buffer, uint8_t channels,
-                    uint16_t frame_len, uint8_t format)
-{
-    int ch, i;
-    int16_t *short_sample_buffer;
-    real_t *ch0, *ch1, *ch2, *ch3, *ch4;
-
-    if (format != FAAD_FMT_16BIT)
-        return output_to_PCM_orig(hDecoder, input, sample_buffer, channels, frame_len, format);
-
-    short_sample_buffer = (int16_t *)sample_buffer;
-    ch0 = input[hDecoder->internal_channel[0]];
-    ch1 = input[hDecoder->internal_channel[1]];
-    ch2 = input[hDecoder->internal_channel[2]];
-    ch3 = input[hDecoder->internal_channel[3]];
-    ch4 = input[hDecoder->internal_channel[4]];
-
-    if (hDecoder->downMatrix)
-    {
-        for (i = 0; i < frame_len; ++i)
-        {
-            int32_t tmp = (ch1[i] + ((ch0[i] + ch3[i]) >> 1) + ((ch0[i] + ch3[i]) >> 2) + (1 << (REAL_BITS))) >> (REAL_BITS + 1);
-            if ((tmp + 0x8000) & ~0xffff)
-                tmp = ~(tmp >> 31) - 0x8000;
-            short_sample_buffer[0] = tmp;
-            tmp = (ch2[i] + ((ch0[i] + ch4[i]) >> 1) + ((ch0[i] + ch4[i]) >> 2) + (1 << (REAL_BITS))) >> (REAL_BITS + 1);
-            if ((tmp + 0x8000) & ~0xffff)
-                tmp = ~(tmp >> 31) - 0x8000;
-            short_sample_buffer[1] = tmp;
-            short_sample_buffer += channels;
-        }
-        return sample_buffer;
-    }
-
-    /* Copy output to a standard PCM buffer */
-    for (i = 0; i < frame_len; ++i)
-    {
-        for (ch = 0; ch < channels; ++ch)
-        {
-            int32_t tmp = input[hDecoder->internal_channel[ch]][i];
-            tmp += (1 << (REAL_BITS - 1));
-            tmp >>= REAL_BITS;
-            if ((tmp + 0x8000) & ~0xffff)
-                tmp = ~(tmp >> 31) - 0x8000;
-            *(short_sample_buffer++) = tmp;
-        }
-    }
-
-    return sample_buffer;
-}
-
 #endif
diff -Nur xine-lib-1.1.11.1/src/libfaad/output.h xine-lib-1.1.11.1-ubuntu/src/libfaad/output.h
--- xine-lib-1.1.11.1/src/libfaad/output.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/output.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: output.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: output.h,v 1.25 2007/11/01 12:33:32 menno Exp $
 **/
 
 #ifndef __OUTPUT_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/pns.c xine-lib-1.1.11.1-ubuntu/src/libfaad/pns.c
--- xine-lib-1.1.11.1/src/libfaad/pns.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/pns.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: pns.c,v 1.8 2005/10/29 23:57:07 tmmm Exp $
+** $Id: pns.c,v 1.38 2007/11/01 12:33:32 menno Exp $
 **/
 
 #include "common.h"
@@ -33,7 +36,8 @@
 
 /* static function declarations */
 static void gen_rand_vector(real_t *spec, int16_t scale_factor, uint16_t size,
-                            uint8_t sub);
+                            uint8_t sub,
+                            /* RNG states */ uint32_t *__r1, uint32_t *__r2);
 
 
 #ifdef FIXED_POINT
@@ -68,7 +72,7 @@
     return root;
 }
 
-static real_t pow2_table[] =
+static real_t const pow2_table[] =
 {
     COEF_CONST(1.0),
     COEF_CONST(1.18920711500272),
@@ -83,7 +87,8 @@
    multiplication/accumulation per random value.
 */
 static INLINE void gen_rand_vector(real_t *spec, int16_t scale_factor, uint16_t size,
-                                   uint8_t sub)
+                                   uint8_t sub,
+                                   /* RNG states */ uint32_t *__r1, uint32_t *__r2)
 {
 #ifndef FIXED_POINT
     uint16_t i;
@@ -93,7 +98,7 @@
 
     for (i = 0; i < size; i++)
     {
-        real_t tmp = scale*(real_t)(int32_t)random_int();
+        real_t tmp = scale*(real_t)(int32_t)ne_rng(__r1, __r2);
         spec[i] = tmp;
         energy += tmp*tmp;
     }
@@ -112,7 +117,7 @@
     for (i = 0; i < size; i++)
     {
         /* this can be replaced by a 16 bit random generator!!!! */
-        real_t tmp = (int32_t)random_int();
+        real_t tmp = (int32_t)ne_rng(__r1, __r2);
         if (tmp < 0)
             tmp = -(tmp & ((1<<(REAL_BITS-1))-1));
         else
@@ -152,7 +157,8 @@
 
 void pns_decode(ic_stream *ics_left, ic_stream *ics_right,
                 real_t *spec_left, real_t *spec_right, uint16_t frame_len,
-                uint8_t channel_pair, uint8_t object_type)
+                uint8_t channel_pair, uint8_t object_type,
+                /* RNG states */ uint32_t *__r1, uint32_t *__r2)
 {
     uint8_t g, sfb, b;
     uint16_t size, offs;
@@ -202,11 +208,11 @@
 #endif
 
                     offs = ics_left->swb_offset[sfb];
-                    size = ics_left->swb_offset[sfb+1] - offs;
+                    size = min(ics_left->swb_offset[sfb+1], ics_left->swb_offset_max) - offs;
 
                     /* Generate random vector */
                     gen_rand_vector(&spec_left[(group*nshort)+offs],
-                        ics_left->scale_factors[g][sfb], size, sub);
+                        ics_left->scale_factors[g][sfb], size, sub, __r1, __r2);
                 }
 
 /* From the spec:
@@ -233,7 +239,7 @@
                             uint16_t c;
 
                             offs = ics_right->swb_offset[sfb];
-                            size = ics_right->swb_offset[sfb+1] - offs;
+                            size = min(ics_right->swb_offset[sfb+1], ics_right->swb_offset_max) - offs;
 
                             for (c = 0; c < size; c++)
                             {
@@ -250,11 +256,11 @@
 #endif
 
                             offs = ics_right->swb_offset[sfb];
-                            size = ics_right->swb_offset[sfb+1] - offs;
+                            size = min(ics_right->swb_offset[sfb+1], ics_right->swb_offset_max) - offs;
 
                             /* Generate random vector */
                             gen_rand_vector(&spec_right[(group*nshort)+offs],
-                                ics_right->scale_factors[g][sfb], size, sub);
+                                ics_right->scale_factors[g][sfb], size, sub, __r1, __r2);
                         }
                     }
                 }
diff -Nur xine-lib-1.1.11.1/src/libfaad/pns.h xine-lib-1.1.11.1-ubuntu/src/libfaad/pns.h
--- xine-lib-1.1.11.1/src/libfaad/pns.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/pns.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: pns.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: pns.h,v 1.27 2007/11/01 12:33:33 menno Exp $
 **/
 
 #ifndef __PNS_H__
@@ -38,7 +41,8 @@
 
 void pns_decode(ic_stream *ics_left, ic_stream *ics_right,
                 real_t *spec_left, real_t *spec_right, uint16_t frame_len,
-                uint8_t channel_pair, uint8_t object_type);
+                uint8_t channel_pair, uint8_t object_type,
+                /* RNG states */ uint32_t *__r1, uint32_t *__r2);
 
 static INLINE uint8_t is_noise(ic_stream *ics, uint8_t group, uint8_t sfb)
 {
diff -Nur xine-lib-1.1.11.1/src/libfaad/ps_dec.c xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_dec.c
--- xine-lib-1.1.11.1/src/libfaad/ps_dec.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_dec.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
-** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR and PS decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ps_dec.c,v 1.3 2006/09/26 17:55:59 dgp85 Exp $
+** $Id: ps_dec.c,v 1.14 2007/11/01 12:33:33 menno Exp $
 **/
 
 #include "common.h"
@@ -159,7 +162,7 @@
 
 /* static function declarations */
 static void ps_data_decode(ps_info *ps);
-static hyb_info *hybrid_init(void);
+static hyb_info *hybrid_init();
 static void channel_filter2(hyb_info *hyb, uint8_t frame_len, const real_t *filter,
                             qmf_t *buffer, qmf_t **X_hybrid);
 static void INLINE DCT3_4_unscaled(real_t *y, real_t *x);
@@ -175,7 +178,7 @@
                          int8_t min_index, int8_t max_index);
 static void delta_modulo_decode(uint8_t enable, int8_t *index, int8_t *index_prev,
                                 uint8_t dt_flag, uint8_t nr_par, uint8_t stride,
-                                int8_t log2modulo);
+                                int8_t and_modulo);
 static void map20indexto34(int8_t *index, uint8_t bins);
 #ifdef PS_LOW_POWER
 static void map34indexto20(int8_t *index, uint8_t bins);
@@ -189,7 +192,7 @@
 /*  */
 
 
-static hyb_info *hybrid_init(void)
+static hyb_info *hybrid_init()
 {
     uint8_t i;
 
@@ -230,16 +233,24 @@
 {
     uint8_t i;
 
-    faad_free(hyb->work);
+    if (hyb->work)
+        faad_free(hyb->work);
 
     for (i = 0; i < 5; i++)
-      faad_free(hyb->buffer[i]);
-    faad_free(hyb->buffer);
+    {
+        if (hyb->buffer[i])
+            faad_free(hyb->buffer[i]);
+    }
+    if (hyb->buffer)
+        faad_free(hyb->buffer);
 
     for (i = 0; i < hyb->frame_len; i++)
-      faad_free(hyb->temp[i]);
-    
-    faad_free(hyb->temp);
+    {
+        if (hyb->temp[i])
+            faad_free(hyb->temp[i]);
+    }
+    if (hyb->temp)
+        faad_free(hyb->temp);
 }
 
 /* real filter, size 2 */
@@ -666,7 +677,7 @@
 /* in: log2 value of the modulo value to allow using AND instead of MOD */
 static void delta_modulo_decode(uint8_t enable, int8_t *index, int8_t *index_prev,
                                 uint8_t dt_flag, uint8_t nr_par, uint8_t stride,
-                                int8_t log2modulo)
+                                int8_t and_modulo)
 {
     int8_t i;
 
@@ -676,19 +687,19 @@
         {
             /* delta coded in frequency direction */
             index[0] = 0 + index[0];
-            index[0] &= log2modulo;
+            index[0] &= and_modulo;
 
             for (i = 1; i < nr_par; i++)
             {
                 index[i] = index[i-1] + index[i];
-                index[i] &= log2modulo;
+                index[i] &= and_modulo;
             }
         } else {
             /* delta coded in time direction */
             for (i = 0; i < nr_par; i++)
             {
                 index[i] = index_prev[i*stride] + index[i];
-                index[i] &= log2modulo;
+                index[i] &= and_modulo;
             }
         }
     } else {
@@ -833,11 +844,11 @@
 
         /* delta modulo decode ipd parameters */
         delta_modulo_decode(ps->enable_ipdopd, ps->ipd_index[env], ipd_index_prev,
-            ps->ipd_dt[env], ps->nr_ipdopd_par, 1, /*log2(8)*/ 3);
+            ps->ipd_dt[env], ps->nr_ipdopd_par, 1, 7);
 
         /* delta modulo decode opd parameters */
         delta_modulo_decode(ps->enable_ipdopd, ps->opd_index[env], opd_index_prev,
-            ps->opd_dt[env], ps->nr_ipdopd_par, 1, /*log2(8)*/ 3);
+            ps->opd_dt[env], ps->nr_ipdopd_par, 1, 7);
     }
 
     /* handle error case */
@@ -906,8 +917,6 @@
 
         if (ps->border_position[ps->num_env] < 32 /* 30 for 960? */)
         {
-            ps->num_env++;
-            ps->border_position[ps->num_env] = 32 /* 30 for 960? */;
             for (bin = 0; bin < 34; bin++)
             {
                 ps->iid_index[ps->num_env][bin] = ps->iid_index[ps->num_env-1][bin];
@@ -918,6 +927,8 @@
                 ps->ipd_index[ps->num_env][bin] = ps->ipd_index[ps->num_env-1][bin];
                 ps->opd_index[ps->num_env][bin] = ps->opd_index[ps->num_env-1][bin];
             }
+            ps->num_env++;
+            ps->border_position[ps->num_env] = 32 /* 30 for 960? */;
         }
 
         for (env = 1; env < ps->num_env; env++)
@@ -1410,6 +1421,26 @@
     FRAC_CONST(-0.000000000000000)
 };
 
+static real_t magnitude_c(complex_t c)
+{
+#ifdef FIXED_POINT
+#define ps_abs(A) (((A) > 0) ? (A) : (-(A)))
+#define ALPHA FRAC_CONST(0.948059448969)
+#define BETA  FRAC_CONST(0.392699081699)
+
+    real_t abs_inphase = ps_abs(RE(c));
+    real_t abs_quadrature = ps_abs(IM(c));
+
+    if (abs_inphase > abs_quadrature) {
+        return MUL_F(abs_inphase, ALPHA) + MUL_F(abs_quadrature, BETA);
+    } else {
+        return MUL_F(abs_quadrature, ALPHA) + MUL_F(abs_inphase, BETA);
+    }
+#else
+    return sqrt(RE(c)*RE(c) + IM(c)*IM(c));
+#endif
+}
+
 static void ps_mix_phase(ps_info *ps, qmf_t X_left[38][64], qmf_t X_right[38][64],
                          qmf_t X_hybrid_left[32][32], qmf_t X_hybrid_right[32][32])
 {
@@ -1580,8 +1611,7 @@
             if ((ps->enable_ipdopd) && (bk < nr_ipdopd_par))
             {
                 int8_t i;
-                real_t xxyy, ppqq;
-                real_t yq, xp, xq, py, tmp;
+                real_t xy, pq, xypq;
 
                 /* ringbuffer index */
                 i = ps->phase_hist;
@@ -1614,7 +1644,7 @@
 
                 /* ringbuffer index */
                 if (i == 0)
-                { 
+                {
                     i = 2;
                 }
                 i--;
@@ -1644,53 +1674,54 @@
                 RE(phaseRight) = (float)cos(opd);
                 IM(phaseRight) = (float)sin(opd);
 #else
+
                 // x = IM(tempLeft)
                 // y = RE(tempLeft)
                 // p = IM(tempRight)
                 // q = RE(tempRight)
-                // cos(atan2(x,y)) = 1/sqrt(1 + (x*x)/(y*y))
-                // sin(atan2(x,y)) = x/(y*sqrt(1 + (x*x)/(y*y)))
-                // cos(atan2(x,y)-atan2(p,q)) = (y*q+x*p)/(y*q * sqrt(1 + (x*x)/(y*y)) * sqrt(1 + (p*p)/(q*q)));
-                // sin(atan2(x,y)-atan2(p,q)) = (x*q-p*y)/(y*q * sqrt(1 + (x*x)/(y*y)) * sqrt(1 + (p*p)/(q*q)));
-
-                /* (x*x)/(y*y)  (REAL > 0) */
-                xxyy = DIV_R(MUL_C(IM(tempLeft),IM(tempLeft)), MUL_C(RE(tempLeft),RE(tempLeft)));
-                ppqq = DIV_R(MUL_C(IM(tempRight),IM(tempRight)), MUL_C(RE(tempRight),RE(tempRight)));
-
-                /* 1 + (x*x)/(y*y)  (REAL > 1) */
-                xxyy += REAL_CONST(1);
-                ppqq += REAL_CONST(1);
-
-                /* 1 / sqrt(1 + (x*x)/(y*y))  (FRAC <= 1) */
-                xxyy = DIV_R(FRAC_CONST(1), ps_sqrt(xxyy));
-                ppqq = DIV_R(FRAC_CONST(1), ps_sqrt(ppqq));
-
-                /* COEF */
-                yq = MUL_C(RE(tempLeft), RE(tempRight));
-                xp = MUL_C(IM(tempLeft), IM(tempRight));
-                xq = MUL_C(IM(tempLeft), RE(tempRight));
-                py = MUL_C(RE(tempLeft), IM(tempRight));
-
-                RE(phaseLeft) = xxyy;
-                IM(phaseLeft) = MUL_R(xxyy, (DIV_R(IM(tempLeft), RE(tempLeft))));
-
-                tmp = DIV_C(MUL_F(xxyy, ppqq), yq);
-
-                /* MUL_C(FRAC,COEF) = FRAC */
-                RE(phaseRight) = MUL_C(tmp, (yq+xp));
-                IM(phaseRight) = MUL_C(tmp, (xq-py));
+                // cos(atan2(x,y)) = y/sqrt((x*x) + (y*y))
+                // sin(atan2(x,y)) = x/sqrt((x*x) + (y*y))
+                // cos(atan2(x,y)-atan2(p,q)) = (y*q + x*p) / ( sqrt((x*x) + (y*y)) * sqrt((p*p) + (q*q)) );
+                // sin(atan2(x,y)-atan2(p,q)) = (x*q - y*p) / ( sqrt((x*x) + (y*y)) * sqrt((p*p) + (q*q)) );
+
+                xy = magnitude_c(tempRight);
+                pq = magnitude_c(tempLeft);
+
+                if (xy != 0)
+                {
+                    RE(phaseLeft) = DIV_R(RE(tempRight), xy);
+                    IM(phaseLeft) = DIV_R(IM(tempRight), xy);
+                } else {
+                    RE(phaseLeft) = 0;
+                    IM(phaseLeft) = 0;
+                }
+
+                xypq = MUL_R(xy, pq);
+
+                if (xypq != 0)
+                {
+                    real_t tmp1 = MUL_R(RE(tempRight), RE(tempLeft)) + MUL_R(IM(tempRight), IM(tempLeft));
+                    real_t tmp2 = MUL_R(IM(tempRight), RE(tempLeft)) - MUL_R(RE(tempRight), IM(tempLeft));
+
+                    RE(phaseRight) = DIV_R(tmp1, xypq);
+                    IM(phaseRight) = DIV_R(tmp2, xypq);
+                } else {
+                    RE(phaseRight) = 0;
+                    IM(phaseRight) = 0;
+                }
+
 #endif
 
-                /* MUL_F(COEF, FRAC) = COEF */
-                IM(h11) = MUL_F(RE(h11), IM(phaseLeft));
-                IM(h12) = MUL_F(RE(h12), IM(phaseRight));
-                IM(h21) = MUL_F(RE(h21), IM(phaseLeft));
-                IM(h22) = MUL_F(RE(h22), IM(phaseRight));
-
-                RE(h11) = MUL_F(RE(h11), RE(phaseLeft));
-                RE(h12) = MUL_F(RE(h12), RE(phaseRight));
-                RE(h21) = MUL_F(RE(h21), RE(phaseLeft));
-                RE(h22) = MUL_F(RE(h22), RE(phaseRight));
+                /* MUL_F(COEF, REAL) = COEF */
+                IM(h11) = MUL_R(RE(h11), IM(phaseLeft));
+                IM(h12) = MUL_R(RE(h12), IM(phaseRight));
+                IM(h21) = MUL_R(RE(h21), IM(phaseLeft));
+                IM(h22) = MUL_R(RE(h22), IM(phaseRight));
+
+                RE(h11) = MUL_R(RE(h11), RE(phaseLeft));
+                RE(h12) = MUL_R(RE(h12), RE(phaseRight));
+                RE(h21) = MUL_R(RE(h21), RE(phaseLeft));
+                RE(h22) = MUL_R(RE(h22), RE(phaseRight));
             }
 
             /* length of the envelope n_e+1 - n_e (in time samples) */
@@ -1927,8 +1958,8 @@
 /* main Parametric Stereo decoding function */
 uint8_t ps_decode(ps_info *ps, qmf_t X_left[38][64], qmf_t X_right[38][64])
 {
-    qmf_t X_hybrid_left[32][32] = {{{0}}};
-    qmf_t X_hybrid_right[32][32] = {{{0}}};
+    qmf_t X_hybrid_left[32][32] = {{0}};
+    qmf_t X_hybrid_right[32][32] = {{0}};
 
     /* delta decoding of the bitstream data */
     ps_data_decode(ps);
diff -Nur xine-lib-1.1.11.1/src/libfaad/ps_dec.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_dec.h
--- xine-lib-1.1.11.1/src/libfaad/ps_dec.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_dec.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ps_dec.h,v 1.1 2005/10/30 00:50:19 tmmm Exp $
+** $Id: ps_dec.h,v 1.12 2007/11/01 12:33:33 menno Exp $
 **/
 
 #ifndef __PS_DEC_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/ps_syntax.c xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_syntax.c
--- xine-lib-1.1.11.1/src/libfaad/ps_syntax.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_syntax.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
-** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR and PS decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ps_syntax.c,v 1.1 2005/10/30 00:50:19 tmmm Exp $
+** $Id: ps_syntax.c,v 1.11 2007/11/01 12:33:33 menno Exp $
 **/
 
 #include "common.h"
@@ -308,9 +311,9 @@
     { 2, 3 },                 /* index 1: 2 bits: 0x */
     { 4, 5 },                 /* index 2: 3 bits: 00x */
     { /*1*/ -30, /*7*/ -24 }, /* index 3: 3 bits: 01x */
-    { /*5*/ -26, 6 },         /* index 4: 4 bits: 000x */
-    { /*2*/ -29, /*6*/ -25 }, /* index 5: 4 bits: 001x */
-    { /*4*/ -27, /*3*/ -28 }  /* index 6: 5 bits: 0001x */
+    { /*5*/ -26, /*2*/ -29 }, /* index 4: 4 bits: 000x */
+    { /*6*/ -25, 6 },         /* index 5: 4 bits: 001x */
+    { /*4*/ -27, /*3*/ -28 }  /* index 6: 5 bits: 0011x */
 };
 
 /* static function declarations */
@@ -380,7 +383,10 @@
 
     /* we are here, but no header has been read yet */
     if (ps->header_read == 0)
+    {
+        ps->ps_data_available = 0;
         return 1;
+    }
 
     ps->frame_class = (uint8_t)faad_get1bit(ld
         DEBUGVAR(1,1006,"ps_data(): frame_class"));
@@ -394,7 +400,7 @@
         for (n = 1; n < ps->num_env+1; n++)
         {
             ps->border_position[n] = (uint8_t)faad_getbits(ld, 5
-                DEBUGVAR(1,1008,"ps_data(): border_position"));
+                DEBUGVAR(1,1008,"ps_data(): border_position")) + 1;
         }
     }
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/ps_tables.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_tables.h
--- xine-lib-1.1.11.1/src/libfaad/ps_tables.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ps_tables.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ps_tables.h,v 1.1 2005/10/30 00:50:19 tmmm Exp $
+** $Id: ps_tables.h,v 1.8 2007/11/01 12:33:33 menno Exp $
 **/
 
 #ifndef __PS_TABLES_H__
@@ -541,7 +544,7 @@
 };
 
 #ifdef __cplusplus
-
+}
 #endif
 #endif
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/pulse.c xine-lib-1.1.11.1-ubuntu/src/libfaad/pulse.c
--- xine-lib-1.1.11.1/src/libfaad/pulse.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/pulse.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,12 +19,14 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: pulse.c,v 1.8 2005/10/29 23:57:07 tmmm Exp $
+** $Id: pulse.c,v 1.21 2007/11/01 12:33:34 menno Exp $
 **/
-
 #include "common.h"
 #include "structs.h"
 
@@ -37,7 +39,7 @@
     uint16_t k;
     pulse_info *pul = &(ics->pul);
 
-    k = ics->swb_offset[pul->pulse_start_sfb];
+    k = min(ics->swb_offset[pul->pulse_start_sfb], ics->swb_offset_max);
 
     for (i = 0; i <= pul->number_pulse; i++)
     {
diff -Nur xine-lib-1.1.11.1/src/libfaad/pulse.h xine-lib-1.1.11.1-ubuntu/src/libfaad/pulse.h
--- xine-lib-1.1.11.1/src/libfaad/pulse.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/pulse.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: pulse.h,v 1.8 2005/10/29 23:57:07 tmmm Exp $
+** $Id: pulse.h,v 1.20 2007/11/01 12:33:34 menno Exp $
 **/
 
 #ifndef __PULSE_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/rvlc.c xine-lib-1.1.11.1-ubuntu/src/libfaad/rvlc.c
--- xine-lib-1.1.11.1/src/libfaad/rvlc.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/rvlc.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: rvlc.c,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: rvlc.c,v 1.21 2007/11/01 12:33:34 menno Exp $
 **/
 
 /* RVLC scalefactor decoding
diff -Nur xine-lib-1.1.11.1/src/libfaad/rvlc.h xine-lib-1.1.11.1-ubuntu/src/libfaad/rvlc.h
--- xine-lib-1.1.11.1/src/libfaad/rvlc.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/rvlc.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: rvlc.h,v 1.6 2005/10/29 23:57:07 tmmm Exp $
+** $Id: rvlc.h,v 1.17 2007/11/01 12:33:34 menno Exp $
 **/
 
 #ifndef __RVLC_SCF_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_dct.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dct.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_dct.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dct.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,30 +1,38 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_dct.c,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_dct.c,v 1.20 2007/11/01 12:33:34 menno Exp $
 **/
 
+
+/* Most of the DCT/DST codes here are generated using Spiral which is GPL
+ * For more info see: http://www.spiral.net/
+ */
+
 #include "common.h"
 
 #ifdef SBR_DEC
@@ -479,1791 +487,1791 @@
     y[1] = f397 - f396;
 }
 
-#ifdef SBR_LOW_POWER
-
-void DCT2_16_unscaled(real_t *y, real_t *x)
-{
-    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
-    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
-    real_t f21, f22, f23, f24, f25, f26, f27, f28, f31, f32;
-    real_t f33, f34, f37, f38, f39, f40, f41, f42, f43, f44;
-    real_t f45, f46, f47, f48, f49, f51, f53, f54, f57, f58;
-    real_t f59, f60, f61, f62, f63, f64, f65, f66, f67, f68;
-    real_t f69, f70, f71, f72, f73, f74, f75, f76, f77, f78;
-    real_t f79, f80, f81, f82, f83, f84, f85, f86, f87, f88;
-    real_t f89, f90, f91, f92, f95, f96, f97, f98, f101, f102;
-    real_t f103, f104, f107, f108, f109, f110;
-
-    f0 = x[0] - x[15];
-    f1 = x[0] + x[15];
-    f2 = x[1] - x[14];
-    f3 = x[1] + x[14];
-    f4 = x[2] - x[13];
-    f5 = x[2] + x[13];
-    f6 = x[3] - x[12];
-    f7 = x[3] + x[12];
-    f8 = x[4] - x[11];
-    f9 = x[4] + x[11];
-    f10 = x[5] - x[10];
-    f11 = x[5] + x[10];
-    f12 = x[6] - x[9];
-    f13 = x[6] + x[9];
-    f14 = x[7] - x[8];
-    f15 = x[7] + x[8];
-    f16 = f1 - f15;
-    f17 = f1 + f15;
-    f18 = f3 - f13;
-    f19 = f3 + f13;
-    f20 = f5 - f11;
-    f21 = f5 + f11;
-    f22 = f7 - f9;
-    f23 = f7 + f9;
-    f24 = f17 - f23;
-    f25 = f17 + f23;
-    f26 = f19 - f21;
-    f27 = f19 + f21;
-    f28 = f25 - f27;
-    y[0] = f25 + f27;
-    y[8] = MUL_F(f28, FRAC_CONST(0.7071067811865476));
-    f31 = f24 + f26;
-    f32 = MUL_C(f24, COEF_CONST(1.3065629648763766));
-    f33 = MUL_F(f31, FRAC_CONST(-0.9238795325112866));
-    f34 = MUL_F(f26, FRAC_CONST(-0.5411961001461967));
-    y[12] = f32 + f33;
-    y[4] = f34 - f33;
-    f37 = f16 + f22;
-    f38 = MUL_C(f16, COEF_CONST(1.1758756024193588));
-    f39 = MUL_F(f37, FRAC_CONST(-0.9807852804032304));
-    f40 = MUL_F(f22, FRAC_CONST(-0.7856949583871021));
-    f41 = f38 + f39;
-    f42 = f40 - f39;
-    f43 = f18 + f20;
-    f44 = MUL_C(f18, COEF_CONST(1.3870398453221473));
-    f45 = MUL_F(f43, FRAC_CONST(-0.8314696123025455));
-    f46 = MUL_F(f20, FRAC_CONST(-0.2758993792829436));
-    f47 = f44 + f45;
-    f48 = f46 - f45;
-    f49 = f42 - f48;
-    y[2] = f42 + f48;
-    f51 = MUL_F(f49, FRAC_CONST(0.7071067811865476));
-    y[14] = f41 - f47;
-    f53 = f41 + f47;
-    f54 = MUL_F(f53, FRAC_CONST(0.7071067811865476));
-    y[10] = f51 - f54;
-    y[6] = f51 + f54;
-    f57 = f2 - f4;
-    f58 = f2 + f4;
-    f59 = f6 - f8;
-    f60 = f6 + f8;
-    f61 = f10 - f12;
-    f62 = f10 + f12;
-    f63 = MUL_F(f60, FRAC_CONST(0.7071067811865476));
-    f64 = f0 - f63;
-    f65 = f0 + f63;
-    f66 = f58 + f62;
-    f67 = MUL_C(f58, COEF_CONST(1.3065629648763766));
-    f68 = MUL_F(f66, FRAC_CONST(-0.9238795325112866));
-    f69 = MUL_F(f62, FRAC_CONST(-0.5411961001461967));
-    f70 = f67 + f68;
-    f71 = f69 - f68;
-    f72 = f65 - f71;
-    f73 = f65 + f71;
-    f74 = f64 - f70;
-    f75 = f64 + f70;
-    f76 = MUL_F(f59, FRAC_CONST(0.7071067811865476));
-    f77 = f14 - f76;
-    f78 = f14 + f76;
-    f79 = f61 + f57;
-    f80 = MUL_C(f61, COEF_CONST(1.3065629648763766));
-    f81 = MUL_F(f79, FRAC_CONST(-0.9238795325112866));
-    f82 = MUL_F(f57, FRAC_CONST(-0.5411961001461967));
-    f83 = f80 + f81;
-    f84 = f82 - f81;
-    f85 = f78 - f84;
-    f86 = f78 + f84;
-    f87 = f77 - f83;
-    f88 = f77 + f83;
-    f89 = f86 + f73;
-    f90 = MUL_F(f86, FRAC_CONST(-0.8971675863426361));
-    f91 = MUL_F(f89, FRAC_CONST(0.9951847266721968));
-    f92 = MUL_C(f73, COEF_CONST(1.0932018670017576));
-    y[1] = f90 + f91;
-    y[15] = f92 - f91;
-    f95 = f75 - f88;
-    f96 = MUL_F(f88, FRAC_CONST(-0.6666556584777466));
-    f97 = MUL_F(f95, FRAC_CONST(0.9569403357322089));
-    f98 = MUL_C(f75, COEF_CONST(1.2472250129866713));
-    y[3] = f97 - f96;
-    y[13] = f98 - f97;
-    f101 = f87 + f74;
-    f102 = MUL_F(f87, FRAC_CONST(-0.4105245275223571));
-    f103 = MUL_F(f101, FRAC_CONST(0.8819212643483549));
-    f104 = MUL_C(f74, COEF_CONST(1.3533180011743529));
-    y[5] = f102 + f103;
-    y[11] = f104 - f103;
-    f107 = f72 - f85;
-    f108 = MUL_F(f85, FRAC_CONST(-0.1386171691990915));
-    f109 = MUL_F(f107, FRAC_CONST(0.7730104533627370));
-    f110 = MUL_C(f72, COEF_CONST(1.4074037375263826));
-    y[7] = f109 - f108;
-    y[9] = f110 - f109;
-}
-
-void DCT4_16(real_t *y, real_t *x)
+void DST4_32(real_t *y, real_t *x)
 {
-    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
-    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
-    real_t f21, f22, f23, f24, f25, f26, f27, f28, f29, f30;
-    real_t f31, f32, f33, f34, f35, f36, f37, f38, f39, f40;
-    real_t f41, f42, f43, f44, f45, f46, f47, f48, f49, f50;
-    real_t f51, f52, f53, f54, f55, f56, f57, f58, f59, f60;
-    real_t f61, f62, f63, f64, f65, f66, f67, f68, f69, f70;
-    real_t f71, f72, f73, f74, f75, f76, f77, f78, f79, f80;
-    real_t f81, f82, f83, f84, f85, f86, f87, f88, f89, f90;
-    real_t f91, f92, f93, f94, f95, f96, f97, f98, f99, f100;
-    real_t f101, f102, f103, f104, f105, f106, f107, f108, f109, f110;
-    real_t f111, f112, f113, f114, f115, f116, f117, f118, f119, f120;
-    real_t f121, f122, f123, f124, f125, f126, f127, f128, f130, f132;
-    real_t f134, f136, f138, f140, f142, f144, f145, f148, f149, f152;
-    real_t f153, f156, f157;
+    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9;
+    real_t f10, f11, f12, f13, f14, f15, f16, f17, f18, f19;
+    real_t f20, f21, f22, f23, f24, f25, f26, f27, f28, f29;
+    real_t f30, f31, f32, f33, f34, f35, f36, f37, f38, f39;
+    real_t f40, f41, f42, f43, f44, f45, f46, f47, f48, f49;
+    real_t f50, f51, f52, f53, f54, f55, f56, f57, f58, f59;
+    real_t f60, f61, f62, f63, f64, f65, f66, f67, f68, f69;
+    real_t f70, f71, f72, f73, f74, f75, f76, f77, f78, f79;
+    real_t f80, f81, f82, f83, f84, f85, f86, f87, f88, f89;
+    real_t f90, f91, f92, f93, f94, f95, f96, f97, f98, f99;
+    real_t f100, f101, f102, f103, f104, f105, f106, f107, f108, f109;
+    real_t f110, f111, f112, f113, f114, f115, f116, f117, f118, f119;
+    real_t f120, f121, f122, f123, f124, f125, f126, f127, f128, f129;
+    real_t f130, f131, f132, f133, f134, f135, f136, f137, f138, f139;
+    real_t f140, f141, f142, f143, f144, f145, f146, f147, f148, f149;
+    real_t f150, f151, f152, f153, f154, f155, f156, f157, f158, f159;
+    real_t f160, f161, f162, f163, f164, f165, f166, f167, f168, f169;
+    real_t f170, f171, f172, f173, f174, f175, f176, f177, f178, f179;
+    real_t f180, f181, f182, f183, f184, f185, f186, f187, f188, f189;
+    real_t f190, f191, f192, f193, f194, f195, f196, f197, f198, f199;
+    real_t f200, f201, f202, f203, f204, f205, f206, f207, f208, f209;
+    real_t f210, f211, f212, f213, f214, f215, f216, f217, f218, f219;
+    real_t f220, f221, f222, f223, f224, f225, f226, f227, f228, f229;
+    real_t f230, f231, f232, f233, f234, f235, f236, f237, f238, f239;
+    real_t f240, f241, f242, f243, f244, f245, f246, f247, f248, f249;
+    real_t f250, f251, f252, f253, f254, f255, f256, f257, f258, f259;
+    real_t f260, f261, f262, f263, f264, f265, f266, f267, f268, f269;
+    real_t f270, f271, f272, f273, f274, f275, f276, f277, f278, f279;
+    real_t f280, f281, f282, f283, f284, f285, f286, f287, f288, f289;
+    real_t f290, f291, f292, f293, f294, f295, f296, f297, f298, f299;
+    real_t f300, f301, f302, f303, f304, f305, f306, f307, f308, f309;
+    real_t f310, f311, f312, f313, f314, f315, f316, f317, f318, f319;
+    real_t f320, f321, f322, f323, f324, f325, f326, f327, f328, f329;
+    real_t f330, f331, f332, f333, f334, f335;
 
-    f0 = x[0] + x[15];
-    f1 = MUL_C(COEF_CONST(1.0478631305325901), x[0]);
-    f2 = MUL_F(FRAC_CONST(-0.9987954562051724), f0);
-    f3 = MUL_F(FRAC_CONST(-0.9497277818777548), x[15]);
-    f4 = f1 + f2;
-    f5 = f3 - f2;
-    f6 = x[2] + x[13];
-    f7 = MUL_C(COEF_CONST(1.2130114330978077), x[2]);
-    f8 = MUL_F(FRAC_CONST(-0.9700312531945440), f6);
-    f9 = MUL_F(FRAC_CONST(-0.7270510732912803), x[13]);
-    f10 = f7 + f8;
-    f11 = f9 - f8;
-    f12 = x[4] + x[11];
-    f13 = MUL_C(COEF_CONST(1.3315443865537255), x[4]);
-    f14 = MUL_F(FRAC_CONST(-0.9039892931234433), f12);
-    f15 = MUL_F(FRAC_CONST(-0.4764341996931612), x[11]);
-    f16 = f13 + f14;
-    f17 = f15 - f14;
-    f18 = x[6] + x[9];
-    f19 = MUL_C(COEF_CONST(1.3989068359730781), x[6]);
-    f20 = MUL_F(FRAC_CONST(-0.8032075314806453), f18);
-    f21 = MUL_F(FRAC_CONST(-0.2075082269882124), x[9]);
-    f22 = f19 + f20;
-    f23 = f21 - f20;
-    f24 = x[8] + x[7];
-    f25 = MUL_C(COEF_CONST(1.4125100802019777), x[8]);
-    f26 = MUL_F(FRAC_CONST(-0.6715589548470187), f24);
-    f27 = MUL_F(FRAC_CONST(0.0693921705079402), x[7]);
-    f28 = f25 + f26;
-    f29 = f27 - f26;
-    f30 = x[10] + x[5];
-    f31 = MUL_C(COEF_CONST(1.3718313541934939), x[10]);
-    f32 = MUL_F(FRAC_CONST(-0.5141027441932219), f30);
-    f33 = MUL_F(FRAC_CONST(0.3436258658070501), x[5]);
-    f34 = f31 + f32;
-    f35 = f33 - f32;
-    f36 = x[12] + x[3];
-    f37 = MUL_C(COEF_CONST(1.2784339185752409), x[12]);
-    f38 = MUL_F(FRAC_CONST(-0.3368898533922200), f36);
-    f39 = MUL_F(FRAC_CONST(0.6046542117908008), x[3]);
-    f40 = f37 + f38;
-    f41 = f39 - f38;
-    f42 = x[14] + x[1];
-    f43 = MUL_C(COEF_CONST(1.1359069844201433), x[14]);
-    f44 = MUL_F(FRAC_CONST(-0.1467304744553624), f42);
-    f45 = MUL_F(FRAC_CONST(0.8424460355094185), x[1]);
-    f46 = f43 + f44;
-    f47 = f45 - f44;
-    f48 = f5 - f29;
-    f49 = f5 + f29;
-    f50 = f4 - f28;
-    f51 = f4 + f28;
-    f52 = f11 - f35;
-    f53 = f11 + f35;
-    f54 = f10 - f34;
-    f55 = f10 + f34;
-    f56 = f17 - f41;
-    f57 = f17 + f41;
-    f58 = f16 - f40;
-    f59 = f16 + f40;
-    f60 = f23 - f47;
-    f61 = f23 + f47;
-    f62 = f22 - f46;
-    f63 = f22 + f46;
-    f64 = f48 + f50;
-    f65 = MUL_C(COEF_CONST(1.1758756024193588), f48);
-    f66 = MUL_F(FRAC_CONST(-0.9807852804032304), f64);
-    f67 = MUL_F(FRAC_CONST(-0.7856949583871021), f50);
-    f68 = f65 + f66;
-    f69 = f67 - f66;
-    f70 = f52 + f54;
-    f71 = MUL_C(COEF_CONST(1.3870398453221475), f52);
-    f72 = MUL_F(FRAC_CONST(-0.5555702330196022), f70);
-    f73 = MUL_F(FRAC_CONST(0.2758993792829431), f54);
-    f74 = f71 + f72;
-    f75 = f73 - f72;
-    f76 = f56 + f58;
-    f77 = MUL_F(FRAC_CONST(0.7856949583871022), f56);
-    f78 = MUL_F(FRAC_CONST(0.1950903220161283), f76);
-    f79 = MUL_C(COEF_CONST(1.1758756024193586), f58);
-    f80 = f77 + f78;
-    f81 = f79 - f78;
-    f82 = f60 + f62;
-    f83 = MUL_F(FRAC_CONST(-0.2758993792829430), f60);
-    f84 = MUL_F(FRAC_CONST(0.8314696123025452), f82);
-    f85 = MUL_C(COEF_CONST(1.3870398453221475), f62);
-    f86 = f83 + f84;
-    f87 = f85 - f84;
-    f88 = f49 - f57;
-    f89 = f49 + f57;
-    f90 = f51 - f59;
-    f91 = f51 + f59;
-    f92 = f53 - f61;
-    f93 = f53 + f61;
-    f94 = f55 - f63;
-    f95 = f55 + f63;
-    f96 = f69 - f81;
-    f97 = f69 + f81;
-    f98 = f68 - f80;
-    f99 = f68 + f80;
-    f100 = f75 - f87;
-    f101 = f75 + f87;
-    f102 = f74 - f86;
-    f103 = f74 + f86;
-    f104 = f88 + f90;
-    f105 = MUL_C(COEF_CONST(1.3065629648763766), f88);
-    f106 = MUL_F(FRAC_CONST(-0.9238795325112866), f104);
-    f107 = MUL_F(FRAC_CONST(-0.5411961001461967), f90);
+    f0 = x[0] - x[1];
+    f1 = x[2] - x[1];
+    f2 = x[2] - x[3];
+    f3 = x[4] - x[3];
+    f4 = x[4] - x[5];
+    f5 = x[6] - x[5];
+    f6 = x[6] - x[7];
+    f7 = x[8] - x[7];
+    f8 = x[8] - x[9];
+    f9 = x[10] - x[9];
+    f10 = x[10] - x[11];
+    f11 = x[12] - x[11];
+    f12 = x[12] - x[13];
+    f13 = x[14] - x[13];
+    f14 = x[14] - x[15];
+    f15 = x[16] - x[15];
+    f16 = x[16] - x[17];
+    f17 = x[18] - x[17];
+    f18 = x[18] - x[19];
+    f19 = x[20] - x[19];
+    f20 = x[20] - x[21];
+    f21 = x[22] - x[21];
+    f22 = x[22] - x[23];
+    f23 = x[24] - x[23];
+    f24 = x[24] - x[25];
+    f25 = x[26] - x[25];
+    f26 = x[26] - x[27];
+    f27 = x[28] - x[27];
+    f28 = x[28] - x[29];
+    f29 = x[30] - x[29];
+    f30 = x[30] - x[31];
+    f31 = MUL_F(FRAC_CONST(0.7071067811865476), f15);
+    f32 = x[0] - f31;
+    f33 = x[0] + f31;
+    f34 = f7 + f23;
+    f35 = MUL_C(COEF_CONST(1.3065629648763766), f7);
+    f36 = MUL_F(FRAC_CONST(-0.9238795325112866), f34);
+    f37 = MUL_F(FRAC_CONST(-0.5411961001461967), f23);
+    f38 = f35 + f36;
+    f39 = f37 - f36;
+    f40 = f33 - f39;
+    f41 = f33 + f39;
+    f42 = f32 - f38;
+    f43 = f32 + f38;
+    f44 = f11 - f19;
+    f45 = f11 + f19;
+    f46 = MUL_F(FRAC_CONST(0.7071067811865476), f45);
+    f47 = f3 - f46;
+    f48 = f3 + f46;
+    f49 = MUL_F(FRAC_CONST(0.7071067811865476), f44);
+    f50 = f49 - f27;
+    f51 = f49 + f27;
+    f52 = f51 + f48;
+    f53 = MUL_F(FRAC_CONST(-0.7856949583871021), f51);
+    f54 = MUL_F(FRAC_CONST(0.9807852804032304), f52);
+    f55 = MUL_C(COEF_CONST(1.1758756024193588), f48);
+    f56 = f53 + f54;
+    f57 = f55 - f54;
+    f58 = f50 + f47;
+    f59 = MUL_F(FRAC_CONST(-0.2758993792829430), f50);
+    f60 = MUL_F(FRAC_CONST(0.8314696123025452), f58);
+    f61 = MUL_C(COEF_CONST(1.3870398453221475), f47);
+    f62 = f59 + f60;
+    f63 = f61 - f60;
+    f64 = f41 - f56;
+    f65 = f41 + f56;
+    f66 = f43 - f62;
+    f67 = f43 + f62;
+    f68 = f42 - f63;
+    f69 = f42 + f63;
+    f70 = f40 - f57;
+    f71 = f40 + f57;
+    f72 = f5 - f9;
+    f73 = f5 + f9;
+    f74 = f13 - f17;
+    f75 = f13 + f17;
+    f76 = f21 - f25;
+    f77 = f21 + f25;
+    f78 = MUL_F(FRAC_CONST(0.7071067811865476), f75);
+    f79 = f1 - f78;
+    f80 = f1 + f78;
+    f81 = f73 + f77;
+    f82 = MUL_C(COEF_CONST(1.3065629648763766), f73);
+    f83 = MUL_F(FRAC_CONST(-0.9238795325112866), f81);
+    f84 = MUL_F(FRAC_CONST(-0.5411961001461967), f77);
+    f85 = f82 + f83;
+    f86 = f84 - f83;
+    f87 = f80 - f86;
+    f88 = f80 + f86;
+    f89 = f79 - f85;
+    f90 = f79 + f85;
+    f91 = MUL_F(FRAC_CONST(0.7071067811865476), f74);
+    f92 = f29 - f91;
+    f93 = f29 + f91;
+    f94 = f76 + f72;
+    f95 = MUL_C(COEF_CONST(1.3065629648763766), f76);
+    f96 = MUL_F(FRAC_CONST(-0.9238795325112866), f94);
+    f97 = MUL_F(FRAC_CONST(-0.5411961001461967), f72);
+    f98 = f95 + f96;
+    f99 = f97 - f96;
+    f100 = f93 - f99;
+    f101 = f93 + f99;
+    f102 = f92 - f98;
+    f103 = f92 + f98;
+    f104 = f101 + f88;
+    f105 = MUL_F(FRAC_CONST(-0.8971675863426361), f101);
+    f106 = MUL_F(FRAC_CONST(0.9951847266721968), f104);
+    f107 = MUL_C(COEF_CONST(1.0932018670017576), f88);
     f108 = f105 + f106;
     f109 = f107 - f106;
-    f110 = f92 + f94;
-    f111 = MUL_F(FRAC_CONST(0.5411961001461969), f92);
-    f112 = MUL_F(FRAC_CONST(0.3826834323650898), f110);
-    f113 = MUL_C(COEF_CONST(1.3065629648763766), f94);
-    f114 = f111 + f112;
+    f110 = f90 - f103;
+    f111 = MUL_F(FRAC_CONST(-0.6666556584777466), f103);
+    f112 = MUL_F(FRAC_CONST(0.9569403357322089), f110);
+    f113 = MUL_C(COEF_CONST(1.2472250129866713), f90);
+    f114 = f112 - f111;
     f115 = f113 - f112;
-    f116 = f96 + f98;
-    f117 = MUL_C(COEF_CONST(1.3065629648763766), f96);
-    f118 = MUL_F(FRAC_CONST(-0.9238795325112866), f116);
-    f119 = MUL_F(FRAC_CONST(-0.5411961001461967), f98);
+    f116 = f102 + f89;
+    f117 = MUL_F(FRAC_CONST(-0.4105245275223571), f102);
+    f118 = MUL_F(FRAC_CONST(0.8819212643483549), f116);
+    f119 = MUL_C(COEF_CONST(1.3533180011743529), f89);
     f120 = f117 + f118;
     f121 = f119 - f118;
-    f122 = f100 + f102;
-    f123 = MUL_F(FRAC_CONST(0.5411961001461969), f100);
-    f124 = MUL_F(FRAC_CONST(0.3826834323650898), f122);
-    f125 = MUL_C(COEF_CONST(1.3065629648763766), f102);
-    f126 = f123 + f124;
+    f122 = f87 - f100;
+    f123 = MUL_F(FRAC_CONST(-0.1386171691990915), f100);
+    f124 = MUL_F(FRAC_CONST(0.7730104533627370), f122);
+    f125 = MUL_C(COEF_CONST(1.4074037375263826), f87);
+    f126 = f124 - f123;
     f127 = f125 - f124;
-    f128 = f89 - f93;
-    y[0] = f89 + f93;
-    f130 = f91 - f95;
-    y[15] = f91 + f95;
-    f132 = f109 - f115;
-    y[3] = f109 + f115;
-    f134 = f108 - f114;
-    y[12] = f108 + f114;
-    f136 = f97 - f101;
-    y[1] = f97 + f101;
-    f138 = f99 - f103;
-    y[14] = f99 + f103;
-    f140 = f121 - f127;
-    y[2] = f121 + f127;
-    f142 = f120 - f126;
-    y[13] = f120 + f126;
-    f144 = f128 - f130;
-    f145 = f128 + f130;
-    y[8] = MUL_F(FRAC_CONST(0.7071067811865474), f144);
-    y[7] = MUL_F(FRAC_CONST(0.7071067811865474), f145);
-    f148 = f132 - f134;
-    f149 = f132 + f134;
-    y[11] = MUL_F(FRAC_CONST(0.7071067811865474), f148);
-    y[4] = MUL_F(FRAC_CONST(0.7071067811865474), f149);
-    f152 = f136 - f138;
-    f153 = f136 + f138;
-    y[9] = MUL_F(FRAC_CONST(0.7071067811865474), f152);
-    y[6] = MUL_F(FRAC_CONST(0.7071067811865474), f153);
-    f156 = f140 - f142;
-    f157 = f140 + f142;
-    y[10] = MUL_F(FRAC_CONST(0.7071067811865474), f156);
-    y[5] = MUL_F(FRAC_CONST(0.7071067811865474), f157);
-}
-
-void DCT3_32_unscaled(real_t *y, real_t *x)
-{
-    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
-    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
-    real_t f21, f22, f23, f24, f25, f26, f27, f28, f29, f30;
-    real_t f31, f32, f33, f34, f35, f36, f37, f38, f39, f40;
-    real_t f41, f42, f43, f44, f45, f46, f47, f48, f49, f50;
-    real_t f51, f52, f53, f54, f55, f56, f57, f58, f59, f60;
-    real_t f61, f62, f63, f64, f65, f66, f67, f68, f69, f70;
-    real_t f71, f72, f73, f74, f75, f76, f77, f78, f79, f80;
-    real_t f81, f82, f83, f84, f85, f86, f87, f88, f89, f90;
-    real_t f91, f92, f93, f94, f95, f96, f97, f98, f99, f100;
-    real_t f101, f102, f103, f104, f105, f106, f107, f108, f109, f110;
-    real_t f111, f112, f113, f114, f115, f116, f117, f118, f119, f120;
-    real_t f121, f122, f123, f124, f125, f126, f127, f128, f129, f130;
-    real_t f131, f132, f133, f134, f135, f136, f137, f138, f139, f140;
-    real_t f141, f142, f143, f144, f145, f146, f147, f148, f149, f150;
-    real_t f151, f152, f153, f154, f155, f156, f157, f158, f159, f160;
-    real_t f161, f162, f163, f164, f165, f166, f167, f168, f169, f170;
-    real_t f171, f172, f173, f174, f175, f176, f177, f178, f179, f180;
-    real_t f181, f182, f183, f184, f185, f186, f187, f188, f189, f190;
-    real_t f191, f192, f193, f194, f195, f196, f197, f198, f199, f200;
-    real_t f201, f202, f203, f204, f205, f206, f207, f208, f209, f210;
-    real_t f211, f212, f213, f214, f215, f216, f217, f218, f219, f220;
-    real_t f221, f222, f223, f224, f225, f226, f227, f228, f229, f230;
-    real_t f231, f232, f233, f234, f235, f236, f237, f238, f239, f240;
-    real_t f241, f242, f243, f244, f245, f246, f247, f248, f249, f250;
-    real_t f251, f252, f253, f254, f255, f256, f257, f258, f259, f260;
-    real_t f261, f262, f263, f264, f265, f266, f267, f268, f269, f270;
-    real_t f271, f272;
-
-    f0 = MUL_F(x[16], FRAC_CONST(0.7071067811865476));
-    f1 = x[0] - f0;
-    f2 = x[0] + f0;
-    f3 = x[8] + x[24];
-    f4 = MUL_C(x[8], COEF_CONST(1.3065629648763766));
-    f5 = MUL_F(f3, FRAC_CONST((-0.9238795325112866)));
-    f6 = MUL_F(x[24], FRAC_CONST((-0.5411961001461967)));
-    f7 = f4 + f5;
-    f8 = f6 - f5;
-    f9 = f2 - f8;
-    f10 = f2 + f8;
-    f11 = f1 - f7;
-    f12 = f1 + f7;
-    f13 = x[4] + x[28];
-    f14 = MUL_C(x[4], COEF_CONST(1.1758756024193588));
-    f15 = MUL_F(f13, FRAC_CONST((-0.9807852804032304)));
-    f16 = MUL_F(x[28], FRAC_CONST((-0.7856949583871021)));
-    f17 = f14 + f15;
-    f18 = f16 - f15;
-    f19 = x[12] + x[20];
-    f20 = MUL_C(x[12], COEF_CONST(1.3870398453221473));
-    f21 = MUL_F(f19, FRAC_CONST((-0.8314696123025455)));
-    f22 = MUL_F(x[20], FRAC_CONST((-0.2758993792829436)));
-    f23 = f20 + f21;
-    f24 = f22 - f21;
-    f25 = f18 - f24;
-    f26 = f18 + f24;
-    f27 = MUL_F(f25, FRAC_CONST(0.7071067811865476));
-    f28 = f17 - f23;
-    f29 = f17 + f23;
-    f30 = MUL_F(f29, FRAC_CONST(0.7071067811865476));
-    f31 = f27 - f30;
-    f32 = f27 + f30;
-    f33 = f10 - f26;
-    f34 = f10 + f26;
-    f35 = f12 - f32;
-    f36 = f12 + f32;
-    f37 = f11 - f31;
-    f38 = f11 + f31;
-    f39 = f9 - f28;
-    f40 = f9 + f28;
-    f41 = x[2] + x[30];
-    f42 = MUL_C(x[2], COEF_CONST(1.0932018670017569));
-    f43 = MUL_F(f41, FRAC_CONST((-0.9951847266721969)));
-    f44 = MUL_F(x[30], FRAC_CONST((-0.8971675863426368)));
-    f45 = f42 + f43;
-    f46 = f44 - f43;
-    f47 = x[6] + x[26];
-    f48 = MUL_C(x[6], COEF_CONST(1.2472250129866711));
-    f49 = MUL_F(f47, FRAC_CONST((-0.9569403357322089)));
-    f50 = MUL_F(x[26], FRAC_CONST((-0.6666556584777469)));
-    f51 = f48 + f49;
-    f52 = f50 - f49;
-    f53 = x[10] + x[22];
-    f54 = MUL_C(x[10], COEF_CONST(1.3533180011743526));
-    f55 = MUL_F(f53, FRAC_CONST((-0.8819212643483551)));
-    f56 = MUL_F(x[22], FRAC_CONST((-0.4105245275223575)));
-    f57 = f54 + f55;
-    f58 = f56 - f55;
-    f59 = x[14] + x[18];
-    f60 = MUL_C(x[14], COEF_CONST(1.4074037375263826));
-    f61 = MUL_F(f59, FRAC_CONST((-0.7730104533627369)));
-    f62 = MUL_F(x[18], FRAC_CONST((-0.1386171691990913)));
-    f63 = f60 + f61;
-    f64 = f62 - f61;
-    f65 = f46 - f64;
-    f66 = f46 + f64;
-    f67 = f52 - f58;
-    f68 = f52 + f58;
-    f69 = f66 - f68;
-    f70 = f66 + f68;
-    f71 = MUL_F(f69, FRAC_CONST(0.7071067811865476));
-    f72 = f65 + f67;
-    f73 = MUL_C(f65, COEF_CONST(1.3065629648763766));
-    f74 = MUL_F(f72, FRAC_CONST((-0.9238795325112866)));
-    f75 = MUL_F(f67, FRAC_CONST((-0.5411961001461967)));
-    f76 = f73 + f74;
-    f77 = f75 - f74;
-    f78 = f45 - f63;
-    f79 = f45 + f63;
-    f80 = f51 - f57;
-    f81 = f51 + f57;
-    f82 = f79 + f81;
-    f83 = MUL_C(f79, COEF_CONST(1.3065629648763770));
-    f84 = MUL_F(f82, FRAC_CONST((-0.3826834323650904)));
-    f85 = MUL_F(f81, FRAC_CONST(0.5411961001461961));
-    f86 = f83 + f84;
-    f87 = f85 - f84;
-    f88 = f78 - f80;
-    f89 = f78 + f80;
-    f90 = MUL_F(f89, FRAC_CONST(0.7071067811865476));
-    f91 = f77 - f87;
-    f92 = f77 + f87;
-    f93 = f71 - f90;
-    f94 = f71 + f90;
-    f95 = f76 - f86;
-    f96 = f76 + f86;
-    f97 = f34 - f70;
-    f98 = f34 + f70;
-    f99 = f36 - f92;
-    f100 = f36 + f92;
-    f101 = f38 - f91;
-    f102 = f38 + f91;
-    f103 = f40 - f94;
-    f104 = f40 + f94;
-    f105 = f39 - f93;
-    f106 = f39 + f93;
-    f107 = f37 - f96;
-    f108 = f37 + f96;
-    f109 = f35 - f95;
-    f110 = f35 + f95;
-    f111 = f33 - f88;
-    f112 = f33 + f88;
-    f113 = x[1] + x[31];
-    f114 = MUL_C(x[1], COEF_CONST(1.0478631305325901));
-    f115 = MUL_F(f113, FRAC_CONST((-0.9987954562051724)));
-    f116 = MUL_F(x[31], FRAC_CONST((-0.9497277818777548)));
-    f117 = f114 + f115;
-    f118 = f116 - f115;
-    f119 = x[5] + x[27];
-    f120 = MUL_C(x[5], COEF_CONST(1.2130114330978077));
-    f121 = MUL_F(f119, FRAC_CONST((-0.9700312531945440)));
-    f122 = MUL_F(x[27], FRAC_CONST((-0.7270510732912803)));
-    f123 = f120 + f121;
-    f124 = f122 - f121;
-    f125 = x[9] + x[23];
-    f126 = MUL_C(x[9], COEF_CONST(1.3315443865537255));
-    f127 = MUL_F(f125, FRAC_CONST((-0.9039892931234433)));
-    f128 = MUL_F(x[23], FRAC_CONST((-0.4764341996931612)));
-    f129 = f126 + f127;
-    f130 = f128 - f127;
-    f131 = x[13] + x[19];
-    f132 = MUL_C(x[13], COEF_CONST(1.3989068359730781));
-    f133 = MUL_F(f131, FRAC_CONST((-0.8032075314806453)));
-    f134 = MUL_F(x[19], FRAC_CONST((-0.2075082269882124)));
-    f135 = f132 + f133;
-    f136 = f134 - f133;
-    f137 = x[17] + x[15];
-    f138 = MUL_C(x[17], COEF_CONST(1.4125100802019777));
-    f139 = MUL_F(f137, FRAC_CONST((-0.6715589548470187)));
-    f140 = MUL_F(x[15], FRAC_CONST(0.0693921705079402));
-    f141 = f138 + f139;
-    f142 = f140 - f139;
-    f143 = x[21] + x[11];
-    f144 = MUL_C(x[21], COEF_CONST(1.3718313541934939));
-    f145 = MUL_F(f143, FRAC_CONST((-0.5141027441932219)));
-    f146 = MUL_F(x[11], FRAC_CONST(0.3436258658070501));
-    f147 = f144 + f145;
-    f148 = f146 - f145;
-    f149 = x[25] + x[7];
-    f150 = MUL_C(x[25], COEF_CONST(1.2784339185752409));
-    f151 = MUL_F(f149, FRAC_CONST((-0.3368898533922200)));
-    f152 = MUL_F(x[7], FRAC_CONST(0.6046542117908008));
-    f153 = f150 + f151;
-    f154 = f152 - f151;
-    f155 = x[29] + x[3];
-    f156 = MUL_C(x[29], COEF_CONST(1.1359069844201433));
-    f157 = MUL_F(f155, FRAC_CONST((-0.1467304744553624)));
-    f158 = MUL_F(x[3], FRAC_CONST(0.8424460355094185));
-    f159 = f156 + f157;
-    f160 = f158 - f157;
-    f161 = f118 - f142;
-    f162 = f118 + f142;
-    f163 = f117 - f141;
-    f164 = f117 + f141;
-    f165 = f124 - f148;
-    f166 = f124 + f148;
-    f167 = f123 - f147;
-    f168 = f123 + f147;
-    f169 = f130 - f154;
-    f170 = f130 + f154;
-    f171 = f129 - f153;
-    f172 = f129 + f153;
-    f173 = f136 - f160;
-    f174 = f136 + f160;
-    f175 = f135 - f159;
-    f176 = f135 + f159;
-    f177 = f161 + f163;
-    f178 = MUL_C(f161, COEF_CONST(1.1758756024193588));
-    f179 = MUL_F(f177, FRAC_CONST((-0.9807852804032304)));
-    f180 = MUL_F(f163, FRAC_CONST((-0.7856949583871021)));
-    f181 = f178 + f179;
-    f182 = f180 - f179;
-    f183 = f165 + f167;
-    f184 = MUL_C(f165, COEF_CONST(1.3870398453221475));
-    f185 = MUL_F(f183, FRAC_CONST((-0.5555702330196022)));
-    f186 = MUL_F(f167, FRAC_CONST(0.2758993792829431));
-    f187 = f184 + f185;
-    f188 = f186 - f185;
-    f189 = f169 + f171;
-    f190 = MUL_F(f169, FRAC_CONST(0.7856949583871022));
-    f191 = MUL_F(f189, FRAC_CONST(0.1950903220161283));
-    f192 = MUL_C(f171, COEF_CONST(1.1758756024193586));
-    f193 = f190 + f191;
-    f194 = f192 - f191;
-    f195 = f173 + f175;
-    f196 = MUL_F(f173, FRAC_CONST((-0.2758993792829430)));
-    f197 = MUL_F(f195, FRAC_CONST(0.8314696123025452));
-    f198 = MUL_C(f175, COEF_CONST(1.3870398453221475));
-    f199 = f196 + f197;
-    f200 = f198 - f197;
-    f201 = f162 - f170;
-    f202 = f162 + f170;
-    f203 = f164 - f172;
-    f204 = f164 + f172;
-    f205 = f166 - f174;
-    f206 = f166 + f174;
-    f207 = f168 - f176;
-    f208 = f168 + f176;
-    f209 = f182 - f194;
-    f210 = f182 + f194;
-    f211 = f181 - f193;
-    f212 = f181 + f193;
-    f213 = f188 - f200;
-    f214 = f188 + f200;
-    f215 = f187 - f199;
-    f216 = f187 + f199;
-    f217 = f201 + f203;
-    f218 = MUL_C(f201, COEF_CONST(1.3065629648763766));
-    f219 = MUL_F(f217, FRAC_CONST((-0.9238795325112866)));
-    f220 = MUL_F(f203, FRAC_CONST((-0.5411961001461967)));
-    f221 = f218 + f219;
-    f222 = f220 - f219;
-    f223 = f205 + f207;
-    f224 = MUL_F(f205, FRAC_CONST(0.5411961001461969));
-    f225 = MUL_F(f223, FRAC_CONST(0.3826834323650898));
-    f226 = MUL_C(f207, COEF_CONST(1.3065629648763766));
-    f227 = f224 + f225;
-    f228 = f226 - f225;
-    f229 = f209 + f211;
-    f230 = MUL_C(f209, COEF_CONST(1.3065629648763766));
-    f231 = MUL_F(f229, FRAC_CONST((-0.9238795325112866)));
-    f232 = MUL_F(f211, FRAC_CONST((-0.5411961001461967)));
-    f233 = f230 + f231;
-    f234 = f232 - f231;
-    f235 = f213 + f215;
-    f236 = MUL_F(f213, FRAC_CONST(0.5411961001461969));
-    f237 = MUL_F(f235, FRAC_CONST(0.3826834323650898));
-    f238 = MUL_C(f215, COEF_CONST(1.3065629648763766));
-    f239 = f236 + f237;
-    f240 = f238 - f237;
-    f241 = f202 - f206;
-    f242 = f202 + f206;
-    f243 = f204 - f208;
-    f244 = f204 + f208;
-    f245 = f222 - f228;
-    f246 = f222 + f228;
-    f247 = f221 - f227;
-    f248 = f221 + f227;
-    f249 = f210 - f214;
-    f250 = f210 + f214;
-    f251 = f212 - f216;
-    f252 = f212 + f216;
-    f253 = f234 - f240;
-    f254 = f234 + f240;
-    f255 = f233 - f239;
-    f256 = f233 + f239;
-    f257 = f241 - f243;
-    f258 = f241 + f243;
-    f259 = MUL_F(f257, FRAC_CONST(0.7071067811865474));
-    f260 = MUL_F(f258, FRAC_CONST(0.7071067811865474));
-    f261 = f245 - f247;
-    f262 = f245 + f247;
-    f263 = MUL_F(f261, FRAC_CONST(0.7071067811865474));
-    f264 = MUL_F(f262, FRAC_CONST(0.7071067811865474));
-    f265 = f249 - f251;
-    f266 = f249 + f251;
-    f267 = MUL_F(f265, FRAC_CONST(0.7071067811865474));
-    f268 = MUL_F(f266, FRAC_CONST(0.7071067811865474));
-    f269 = f253 - f255;
-    f270 = f253 + f255;
-    f271 = MUL_F(f269, FRAC_CONST(0.7071067811865474));
-    f272 = MUL_F(f270, FRAC_CONST(0.7071067811865474));
-    y[31] = f98 - f242;
-    y[0] = f98 + f242;
-    y[30] = f100 - f250;
-    y[1] = f100 + f250;
-    y[29] = f102 - f254;
-    y[2] = f102 + f254;
-    y[28] = f104 - f246;
-    y[3] = f104 + f246;
-    y[27] = f106 - f264;
-    y[4] = f106 + f264;
-    y[26] = f108 - f272;
-    y[5] = f108 + f272;
-    y[25] = f110 - f268;
-    y[6] = f110 + f268;
-    y[24] = f112 - f260;
-    y[7] = f112 + f260;
-    y[23] = f111 - f259;
-    y[8] = f111 + f259;
-    y[22] = f109 - f267;
-    y[9] = f109 + f267;
-    y[21] = f107 - f271;
-    y[10] = f107 + f271;
-    y[20] = f105 - f263;
-    y[11] = f105 + f263;
-    y[19] = f103 - f248;
-    y[12] = f103 + f248;
-    y[18] = f101 - f256;
-    y[13] = f101 + f256;
-    y[17] = f99 - f252;
-    y[14] = f99 + f252;
-    y[16] = f97 - f244;
-    y[15] = f97 + f244;
-}
-
-void DCT2_32_unscaled(real_t *y, real_t *x)
-{
-    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
-    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
-    real_t f21, f22, f23, f24, f25, f26, f27, f28, f29, f30;
-    real_t f31, f32, f33, f34, f35, f36, f37, f38, f39, f40;
-    real_t f41, f42, f43, f44, f45, f46, f47, f48, f49, f50;
-    real_t f51, f52, f53, f54, f55, f56, f57, f58, f59, f60;
-    real_t f63, f64, f65, f66, f69, f70, f71, f72, f73, f74;
-    real_t f75, f76, f77, f78, f79, f80, f81, f83, f85, f86;
-    real_t f89, f90, f91, f92, f93, f94, f95, f96, f97, f98;
-    real_t f99, f100, f101, f102, f103, f104, f105, f106, f107, f108;
-    real_t f109, f110, f111, f112, f113, f114, f115, f116, f117, f118;
-    real_t f119, f120, f121, f122, f123, f124, f127, f128, f129, f130;
-    real_t f133, f134, f135, f136, f139, f140, f141, f142, f145, f146;
-    real_t f147, f148, f149, f150, f151, f152, f153, f154, f155, f156;
-    real_t f157, f158, f159, f160, f161, f162, f163, f164, f165, f166;
-    real_t f167, f168, f169, f170, f171, f172, f173, f174, f175, f176;
-    real_t f177, f178, f179, f180, f181, f182, f183, f184, f185, f186;
-    real_t f187, f188, f189, f190, f191, f192, f193, f194, f195, f196;
-    real_t f197, f198, f199, f200, f201, f202, f203, f204, f205, f206;
-    real_t f207, f208, f209, f210, f211, f212, f213, f214, f215, f216;
-    real_t f217, f218, f219, f220, f221, f222, f223, f224, f225, f226;
-    real_t f227, f228, f229, f230, f231, f232, f233, f234, f235, f236;
-    real_t f237, f238, f239, f240, f241, f242, f243, f244, f247, f248;
-    real_t f249, f250, f253, f254, f255, f256, f259, f260, f261, f262;
-    real_t f265, f266, f267, f268, f271, f272, f273, f274, f277, f278;
-    real_t f279, f280, f283, f284, f285, f286;
-
-    f0 = x[0] - x[31];
-    f1 = x[0] + x[31];
-    f2 = x[1] - x[30];
-    f3 = x[1] + x[30];
-    f4 = x[2] - x[29];
-    f5 = x[2] + x[29];
-    f6 = x[3] - x[28];
-    f7 = x[3] + x[28];
-    f8 = x[4] - x[27];
-    f9 = x[4] + x[27];
-    f10 = x[5] - x[26];
-    f11 = x[5] + x[26];
-    f12 = x[6] - x[25];
-    f13 = x[6] + x[25];
-    f14 = x[7] - x[24];
-    f15 = x[7] + x[24];
-    f16 = x[8] - x[23];
-    f17 = x[8] + x[23];
-    f18 = x[9] - x[22];
-    f19 = x[9] + x[22];
-    f20 = x[10] - x[21];
-    f21 = x[10] + x[21];
-    f22 = x[11] - x[20];
-    f23 = x[11] + x[20];
-    f24 = x[12] - x[19];
-    f25 = x[12] + x[19];
-    f26 = x[13] - x[18];
-    f27 = x[13] + x[18];
-    f28 = x[14] - x[17];
-    f29 = x[14] + x[17];
-    f30 = x[15] - x[16];
-    f31 = x[15] + x[16];
-    f32 = f1 - f31;
-    f33 = f1 + f31;
-    f34 = f3 - f29;
-    f35 = f3 + f29;
-    f36 = f5 - f27;
-    f37 = f5 + f27;
-    f38 = f7 - f25;
-    f39 = f7 + f25;
-    f40 = f9 - f23;
-    f41 = f9 + f23;
-    f42 = f11 - f21;
-    f43 = f11 + f21;
-    f44 = f13 - f19;
-    f45 = f13 + f19;
-    f46 = f15 - f17;
-    f47 = f15 + f17;
-    f48 = f33 - f47;
-    f49 = f33 + f47;
-    f50 = f35 - f45;
-    f51 = f35 + f45;
-    f52 = f37 - f43;
-    f53 = f37 + f43;
-    f54 = f39 - f41;
-    f55 = f39 + f41;
-    f56 = f49 - f55;
-    f57 = f49 + f55;
-    f58 = f51 - f53;
-    f59 = f51 + f53;
-    f60 = f57 - f59;
-    y[0] = f57 + f59;
-    y[16] = MUL_F(FRAC_CONST(0.7071067811865476), f60);
-    f63 = f56 + f58;
-    f64 = MUL_C(COEF_CONST(1.3065629648763766), f56);
-    f65 = MUL_F(FRAC_CONST(-0.9238795325112866), f63);
-    f66 = MUL_F(FRAC_CONST(-0.5411961001461967), f58);
-    y[24] = f64 + f65;
-    y[8] = f66 - f65;
-    f69 = f48 + f54;
-    f70 = MUL_C(COEF_CONST(1.1758756024193588), f48);
-    f71 = MUL_F(FRAC_CONST(-0.9807852804032304), f69);
-    f72 = MUL_F(FRAC_CONST(-0.7856949583871021), f54);
-    f73 = f70 + f71;
-    f74 = f72 - f71;
-    f75 = f50 + f52;
-    f76 = MUL_C(COEF_CONST(1.3870398453221473), f50);
-    f77 = MUL_F(FRAC_CONST(-0.8314696123025455), f75);
-    f78 = MUL_F(FRAC_CONST(-0.2758993792829436), f52);
-    f79 = f76 + f77;
-    f80 = f78 - f77;
-    f81 = f74 - f80;
-    y[4] = f74 + f80;
-    f83 = MUL_F(FRAC_CONST(0.7071067811865476), f81);
-    y[28] = f73 - f79;
-    f85 = f73 + f79;
-    f86 = MUL_F(FRAC_CONST(0.7071067811865476), f85);
-    y[20] = f83 - f86;
-    y[12] = f83 + f86;
-    f89 = f34 - f36;
-    f90 = f34 + f36;
-    f91 = f38 - f40;
-    f92 = f38 + f40;
-    f93 = f42 - f44;
-    f94 = f42 + f44;
-    f95 = MUL_F(FRAC_CONST(0.7071067811865476), f92);
-    f96 = f32 - f95;
-    f97 = f32 + f95;
-    f98 = f90 + f94;
-    f99 = MUL_C(COEF_CONST(1.3065629648763766), f90);
-    f100 = MUL_F(FRAC_CONST(-0.9238795325112866), f98);
-    f101 = MUL_F(FRAC_CONST(-0.5411961001461967), f94);
-    f102 = f99 + f100;
-    f103 = f101 - f100;
-    f104 = f97 - f103;
-    f105 = f97 + f103;
-    f106 = f96 - f102;
-    f107 = f96 + f102;
-    f108 = MUL_F(FRAC_CONST(0.7071067811865476), f91);
-    f109 = f46 - f108;
-    f110 = f46 + f108;
-    f111 = f93 + f89;
-    f112 = MUL_C(COEF_CONST(1.3065629648763766), f93);
-    f113 = MUL_F(FRAC_CONST(-0.9238795325112866), f111);
-    f114 = MUL_F(FRAC_CONST(-0.5411961001461967), f89);
-    f115 = f112 + f113;
-    f116 = f114 - f113;
-    f117 = f110 - f116;
-    f118 = f110 + f116;
-    f119 = f109 - f115;
-    f120 = f109 + f115;
-    f121 = f118 + f105;
-    f122 = MUL_F(FRAC_CONST(-0.8971675863426361), f118);
-    f123 = MUL_F(FRAC_CONST(0.9951847266721968), f121);
-    f124 = MUL_C(COEF_CONST(1.0932018670017576), f105);
-    y[2] = f122 + f123;
-    y[30] = f124 - f123;
-    f127 = f107 - f120;
-    f128 = MUL_F(FRAC_CONST(-0.6666556584777466), f120);
-    f129 = MUL_F(FRAC_CONST(0.9569403357322089), f127);
-    f130 = MUL_C(COEF_CONST(1.2472250129866713), f107);
-    y[6] = f129 - f128;
-    y[26] = f130 - f129;
-    f133 = f119 + f106;
-    f134 = MUL_F(FRAC_CONST(-0.4105245275223571), f119);
-    f135 = MUL_F(FRAC_CONST(0.8819212643483549), f133);
-    f136 = MUL_C(COEF_CONST(1.3533180011743529), f106);
-    y[10] = f134 + f135;
-    y[22] = f136 - f135;
-    f139 = f104 - f117;
-    f140 = MUL_F(FRAC_CONST(-0.1386171691990915), f117);
-    f141 = MUL_F(FRAC_CONST(0.7730104533627370), f139);
-    f142 = MUL_C(COEF_CONST(1.4074037375263826), f104);
-    y[14] = f141 - f140;
-    y[18] = f142 - f141;
-    f145 = f2 - f4;
-    f146 = f2 + f4;
-    f147 = f6 - f8;
-    f148 = f6 + f8;
-    f149 = f10 - f12;
-    f150 = f10 + f12;
-    f151 = f14 - f16;
-    f152 = f14 + f16;
-    f153 = f18 - f20;
-    f154 = f18 + f20;
-    f155 = f22 - f24;
-    f156 = f22 + f24;
-    f157 = f26 - f28;
-    f158 = f26 + f28;
-    f159 = MUL_F(FRAC_CONST(0.7071067811865476), f152);
-    f160 = f0 - f159;
-    f161 = f0 + f159;
-    f162 = f148 + f156;
-    f163 = MUL_C(COEF_CONST(1.3065629648763766), f148);
-    f164 = MUL_F(FRAC_CONST(-0.9238795325112866), f162);
-    f165 = MUL_F(FRAC_CONST(-0.5411961001461967), f156);
-    f166 = f163 + f164;
-    f167 = f165 - f164;
-    f168 = f161 - f167;
-    f169 = f161 + f167;
-    f170 = f160 - f166;
-    f171 = f160 + f166;
-    f172 = f146 + f158;
-    f173 = MUL_C(COEF_CONST(1.1758756024193588), f146);
-    f174 = MUL_F(FRAC_CONST(-0.9807852804032304), f172);
-    f175 = MUL_F(FRAC_CONST(-0.7856949583871021), f158);
-    f176 = f173 + f174;
-    f177 = f175 - f174;
-    f178 = f150 + f154;
-    f179 = MUL_C(COEF_CONST(1.3870398453221473), f150);
-    f180 = MUL_F(FRAC_CONST(-0.8314696123025455), f178);
-    f181 = MUL_F(FRAC_CONST(-0.2758993792829436), f154);
-    f182 = f179 + f180;
-    f183 = f181 - f180;
-    f184 = f177 - f183;
-    f185 = f177 + f183;
-    f186 = MUL_F(FRAC_CONST(0.7071067811865476), f184);
-    f187 = f176 - f182;
-    f188 = f176 + f182;
-    f189 = MUL_F(FRAC_CONST(0.7071067811865476), f188);
-    f190 = f186 - f189;
-    f191 = f186 + f189;
-    f192 = f169 - f185;
-    f193 = f169 + f185;
-    f194 = f171 - f191;
-    f195 = f171 + f191;
-    f196 = f170 - f190;
-    f197 = f170 + f190;
-    f198 = f168 - f187;
-    f199 = f168 + f187;
-    f200 = MUL_F(FRAC_CONST(0.7071067811865476), f151);
-    f201 = f30 - f200;
-    f202 = f30 + f200;
-    f203 = f155 + f147;
-    f204 = MUL_C(COEF_CONST(1.3065629648763766), f155);
-    f205 = MUL_F(FRAC_CONST(-0.9238795325112866), f203);
-    f206 = MUL_F(FRAC_CONST(-0.5411961001461967), f147);
-    f207 = f204 + f205;
-    f208 = f206 - f205;
-    f209 = f202 - f208;
-    f210 = f202 + f208;
-    f211 = f201 - f207;
-    f212 = f201 + f207;
-    f213 = f157 + f145;
-    f214 = MUL_C(COEF_CONST(1.1758756024193588), f157);
-    f215 = MUL_F(FRAC_CONST(-0.9807852804032304), f213);
-    f216 = MUL_F(FRAC_CONST(-0.7856949583871021), f145);
-    f217 = f214 + f215;
-    f218 = f216 - f215;
-    f219 = f153 + f149;
-    f220 = MUL_C(COEF_CONST(1.3870398453221473), f153);
-    f221 = MUL_F(FRAC_CONST(-0.8314696123025455), f219);
-    f222 = MUL_F(FRAC_CONST(-0.2758993792829436), f149);
-    f223 = f220 + f221;
-    f224 = f222 - f221;
-    f225 = f218 - f224;
-    f226 = f218 + f224;
-    f227 = MUL_F(FRAC_CONST(0.7071067811865476), f225);
-    f228 = f217 - f223;
-    f229 = f217 + f223;
-    f230 = MUL_F(FRAC_CONST(0.7071067811865476), f229);
-    f231 = f227 - f230;
-    f232 = f227 + f230;
-    f233 = f210 - f226;
-    f234 = f210 + f226;
-    f235 = f212 - f232;
-    f236 = f212 + f232;
-    f237 = f211 - f231;
-    f238 = f211 + f231;
-    f239 = f209 - f228;
-    f240 = f209 + f228;
-    f241 = f234 + f193;
-    f242 = MUL_F(FRAC_CONST(-0.9497277818777543), f234);
-    f243 = MUL_F(FRAC_CONST(0.9987954562051724), f241);
-    f244 = MUL_C(COEF_CONST(1.0478631305325905), f193);
-    y[1] = f242 + f243;
-    y[31] = f244 - f243;
-    f247 = f195 - f236;
-    f248 = MUL_F(FRAC_CONST(-0.8424460355094192), f236);
-    f249 = MUL_F(FRAC_CONST(0.9891765099647810), f247);
-    f250 = MUL_C(COEF_CONST(1.1359069844201428), f195);
-    y[3] = f249 - f248;
-    y[29] = f250 - f249;
-    f253 = f238 + f197;
-    f254 = MUL_F(FRAC_CONST(-0.7270510732912801), f238);
-    f255 = MUL_F(FRAC_CONST(0.9700312531945440), f253);
-    f256 = MUL_C(COEF_CONST(1.2130114330978079), f197);
-    y[5] = f254 + f255;
-    y[27] = f256 - f255;
-    f259 = f199 - f240;
-    f260 = MUL_F(FRAC_CONST(-0.6046542117908007), f240);
-    f261 = MUL_F(FRAC_CONST(0.9415440651830208), f259);
-    f262 = MUL_C(COEF_CONST(1.2784339185752409), f199);
-    y[7] = f261 - f260;
-    y[25] = f262 - f261;
-    f265 = f239 + f198;
-    f266 = MUL_F(FRAC_CONST(-0.4764341996931611), f239);
-    f267 = MUL_F(FRAC_CONST(0.9039892931234433), f265);
-    f268 = MUL_C(COEF_CONST(1.3315443865537255), f198);
-    y[9] = f266 + f267;
-    y[23] = f268 - f267;
-    f271 = f196 - f237;
-    f272 = MUL_F(FRAC_CONST(-0.3436258658070505), f237);
-    f273 = MUL_F(FRAC_CONST(0.8577286100002721), f271);
-    f274 = MUL_C(COEF_CONST(1.3718313541934939), f196);
-    y[11] = f273 - f272;
-    y[21] = f274 - f273;
-    f277 = f235 + f194;
-    f278 = MUL_F(FRAC_CONST(-0.2075082269882114), f235);
-    f279 = MUL_F(FRAC_CONST(0.8032075314806448), f277);
-    f280 = MUL_C(COEF_CONST(1.3989068359730783), f194);
-    y[13] = f278 + f279;
-    y[19] = f280 - f279;
-    f283 = f192 - f233;
-    f284 = MUL_F(FRAC_CONST(-0.0693921705079408), f233);
-    f285 = MUL_F(FRAC_CONST(0.7409511253549591), f283);
-    f286 = MUL_C(COEF_CONST(1.4125100802019774), f192);
-    y[15] = f285 - f284;
-    y[17] = f286 - f285;
-}
-
-#else
-
-
-#define n 32
-#define log2n 5
-
-// w_array_real[i] = cos(2*M_PI*i/32)
-static const real_t w_array_real[] = {
-    FRAC_CONST(1.000000000000000), FRAC_CONST(0.980785279337272),
-    FRAC_CONST(0.923879528329380), FRAC_CONST(0.831469603195765),
-    FRAC_CONST(0.707106765732237), FRAC_CONST(0.555570210304169),
-    FRAC_CONST(0.382683402077046), FRAC_CONST(0.195090284503576),
-    FRAC_CONST(0.000000000000000), FRAC_CONST(-0.195090370246552),
-    FRAC_CONST(-0.382683482845162), FRAC_CONST(-0.555570282993553),
-    FRAC_CONST(-0.707106827549476), FRAC_CONST(-0.831469651765257),
-    FRAC_CONST(-0.923879561784627), FRAC_CONST(-0.980785296392607)
-};
-
-// w_array_imag[i] = sin(-2*M_PI*i/32)
-static const real_t w_array_imag[] = {
-    FRAC_CONST(0.000000000000000), FRAC_CONST(-0.195090327375064),
-    FRAC_CONST(-0.382683442461104), FRAC_CONST(-0.555570246648862),
-    FRAC_CONST(-0.707106796640858), FRAC_CONST(-0.831469627480512),
-    FRAC_CONST(-0.923879545057005), FRAC_CONST(-0.980785287864940),
-    FRAC_CONST(-1.000000000000000), FRAC_CONST(-0.980785270809601),
-    FRAC_CONST(-0.923879511601754), FRAC_CONST(-0.831469578911016),
-    FRAC_CONST(-0.707106734823616), FRAC_CONST(-0.555570173959476),
-    FRAC_CONST(-0.382683361692986), FRAC_CONST(-0.195090241632088)
-};
-
-// FFT decimation in frequency
-// 4*16*2+16=128+16=144 multiplications
-// 6*16*2+10*8+4*16*2=192+80+128=400 additions
-static void fft_dif(real_t * Real, real_t * Imag)
-{
-    real_t w_real, w_imag; // For faster access
-    real_t point1_real, point1_imag, point2_real, point2_imag; // For faster access
-    uint32_t j, i, i2, w_index; // Counters
-
-    // First 2 stages of 32 point FFT decimation in frequency
-    // 4*16*2=64*2=128 multiplications
-    // 6*16*2=96*2=192 additions
-	// Stage 1 of 32 point FFT decimation in frequency
-    for (i = 0; i < 16; i++)
-    {
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-        i2 = i+16;
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        w_real = w_array_real[i];
-        w_imag = w_array_imag[i];
-
-        // temp1 = x[i] - x[i2]
-        point1_real -= point2_real;
-        point1_imag -= point2_imag;
-
-        // x[i1] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = (x[i] - x[i2]) * w
-        Real[i2] = (MUL_F(point1_real,w_real) - MUL_F(point1_imag,w_imag));
-        Imag[i2] = (MUL_F(point1_real,w_imag) + MUL_F(point1_imag,w_real));
-     }
-    // Stage 2 of 32 point FFT decimation in frequency
-    for (j = 0, w_index = 0; j < 8; j++, w_index += 2)
-    {
-        w_real = w_array_real[w_index];
-        w_imag = w_array_imag[w_index];
-
-    	i = j;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-        i2 = i+8;
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // temp1 = x[i] - x[i2]
-        point1_real -= point2_real;
-        point1_imag -= point2_imag;
-
-        // x[i1] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = (x[i] - x[i2]) * w
-        Real[i2] = (MUL_F(point1_real,w_real) - MUL_F(point1_imag,w_imag));
-        Imag[i2] = (MUL_F(point1_real,w_imag) + MUL_F(point1_imag,w_real));
-
-        i = j+16;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-        i2 = i+8;
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // temp1 = x[i] - x[i2]
-        point1_real -= point2_real;
-        point1_imag -= point2_imag;
-
-        // x[i1] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = (x[i] - x[i2]) * w
-        Real[i2] = (MUL_F(point1_real,w_real) - MUL_F(point1_imag,w_imag));
-        Imag[i2] = (MUL_F(point1_real,w_imag) + MUL_F(point1_imag,w_real));
-    }
-
-    // Stage 3 of 32 point FFT decimation in frequency
-    // 2*4*2=16 multiplications
-    // 4*4*2+6*4*2=10*8=80 additions
-    for (i = 0; i < n; i += 8)
-    {
-        i2 = i+4;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // out[i1] = point1 + point2
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // out[i2] = point1 - point2
-        Real[i2] = point1_real - point2_real;
-        Imag[i2] = point1_imag - point2_imag;
-    }
-    w_real = w_array_real[4]; // = sqrt(2)/2
-    // w_imag = -w_real; // = w_array_imag[4]; // = -sqrt(2)/2
-    for (i = 1; i < n; i += 8)
-    {
-        i2 = i+4;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // temp1 = x[i] - x[i2]
-        point1_real -= point2_real;
-        point1_imag -= point2_imag;
-
-        // x[i1] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = (x[i] - x[i2]) * w
-        Real[i2] = MUL_F(point1_real+point1_imag, w_real);
-        Imag[i2] = MUL_F(point1_imag-point1_real, w_real);
-    }
-    for (i = 2; i < n; i += 8)
-    {
-        i2 = i+4;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // x[i] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = (x[i] - x[i2]) * (-i)
-        Real[i2] = point1_imag - point2_imag;
-        Imag[i2] = point2_real - point1_real;
-    }
-    w_real = w_array_real[12]; // = -sqrt(2)/2
-    // w_imag = w_real; // = w_array_imag[12]; // = -sqrt(2)/2
-    for (i = 3; i < n; i += 8)
-    {
-        i2 = i+4;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // temp1 = x[i] - x[i2]
-        point1_real -= point2_real;
-        point1_imag -= point2_imag;
-
-        // x[i1] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = (x[i] - x[i2]) * w
-        Real[i2] = MUL_F(point1_real-point1_imag, w_real);
-        Imag[i2] = MUL_F(point1_real+point1_imag, w_real);
-    }
-
-
-    // Stage 4 of 32 point FFT decimation in frequency (no multiplications)
-    // 16*4=64 additions
-    for (i = 0; i < n; i += 4)
-    {
-        i2 = i+2;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // x[i1] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = x[i] - x[i2]
-        Real[i2] = point1_real - point2_real;
-        Imag[i2] = point1_imag - point2_imag;
-    }
-    for (i = 1; i < n; i += 4)
-    {
-        i2 = i+2;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // x[i] = x[i] + x[i2]
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // x[i2] = (x[i] - x[i2]) * (-i)
-        Real[i2] = point1_imag - point2_imag;
-        Imag[i2] = point2_real - point1_real;
-    }
-
-    // Stage 5 of 32 point FFT decimation in frequency (no multiplications)
-    // 16*4=64 additions
-    for (i = 0; i < n; i += 2)
-    {
-        i2 = i+1;
-        point1_real = Real[i];
-        point1_imag = Imag[i];
-
-        point2_real = Real[i2];
-        point2_imag = Imag[i2];
-
-        // out[i1] = point1 + point2
-        Real[i] += point2_real;
-        Imag[i] += point2_imag;
-
-        // out[i2] = point1 - point2
-        Real[i2] = point1_real - point2_real;
-        Imag[i2] = point1_imag - point2_imag;
-    }
-
-#ifdef REORDER_IN_FFT
-    FFTReorder(Real, Imag);
-#endif // #ifdef REORDER_IN_FFT
-}
-#undef n
-#undef log2n
-
-static const real_t dct4_64_tab[] = {
-    COEF_CONST(0.999924719333649), COEF_CONST(0.998118102550507),
-    COEF_CONST(0.993906974792480), COEF_CONST(0.987301409244537),
-    COEF_CONST(0.978317379951477), COEF_CONST(0.966976463794708),
-    COEF_CONST(0.953306019306183), COEF_CONST(0.937339007854462),
-    COEF_CONST(0.919113874435425), COEF_CONST(0.898674488067627),
-    COEF_CONST(0.876070082187653), COEF_CONST(0.851355195045471),
-    COEF_CONST(0.824589252471924), COEF_CONST(0.795836925506592),
-    COEF_CONST(0.765167236328125), COEF_CONST(0.732654273509979),
-    COEF_CONST(0.698376238346100), COEF_CONST(0.662415742874146),
-    COEF_CONST(0.624859452247620), COEF_CONST(0.585797846317291),
-    COEF_CONST(0.545324981212616), COEF_CONST(0.503538429737091),
-    COEF_CONST(0.460538715124130), COEF_CONST(0.416429549455643),
-    COEF_CONST(0.371317148208618), COEF_CONST(0.325310230255127),
-    COEF_CONST(0.278519600629807), COEF_CONST(0.231058135628700),
-    COEF_CONST(0.183039888739586), COEF_CONST(0.134580686688423),
-    COEF_CONST(0.085797272622585), COEF_CONST(0.036807164549828),
-    COEF_CONST(-1.012196302413940), COEF_CONST(-1.059438824653626),
-    COEF_CONST(-1.104129195213318), COEF_CONST(-1.146159529685974),
-    COEF_CONST(-1.185428738594055), COEF_CONST(-1.221842169761658),
-    COEF_CONST(-1.255311965942383), COEF_CONST(-1.285757660865784),
-    COEF_CONST(-1.313105940818787), COEF_CONST(-1.337290763854981),
-    COEF_CONST(-1.358253836631775), COEF_CONST(-1.375944852828980),
-    COEF_CONST(-1.390321016311646), COEF_CONST(-1.401347875595093),
-    COEF_CONST(-1.408998727798462), COEF_CONST(-1.413255214691162),
-    COEF_CONST(-1.414107084274292), COEF_CONST(-1.411552190780640),
-    COEF_CONST(-1.405596733093262), COEF_CONST(-1.396255016326904),
-    COEF_CONST(-1.383549690246582), COEF_CONST(-1.367511272430420),
-    COEF_CONST(-1.348178386688232), COEF_CONST(-1.325597524642944),
-    COEF_CONST(-1.299823284149170), COEF_CONST(-1.270917654037476),
-    COEF_CONST(-1.238950133323669), COEF_CONST(-1.203998088836670),
-    COEF_CONST(-1.166145324707031), COEF_CONST(-1.125483393669128),
-    COEF_CONST(-1.082109928131104), COEF_CONST(-1.036129593849182),
-    COEF_CONST(-0.987653195858002), COEF_CONST(-0.936797380447388),
-    COEF_CONST(-0.883684754371643), COEF_CONST(-0.828443288803101),
-    COEF_CONST(-0.771206021308899), COEF_CONST(-0.712110757827759),
-    COEF_CONST(-0.651300072669983), COEF_CONST(-0.588920354843140),
-    COEF_CONST(-0.525121808052063), COEF_CONST(-0.460058242082596),
-    COEF_CONST(-0.393886327743530), COEF_CONST(-0.326765477657318),
-    COEF_CONST(-0.258857429027557), COEF_CONST(-0.190325915813446),
-    COEF_CONST(-0.121335685253143), COEF_CONST(-0.052053272724152),
-    COEF_CONST(0.017354607582092), COEF_CONST(0.086720645427704),
-    COEF_CONST(0.155877828598022), COEF_CONST(0.224659323692322),
-    COEF_CONST(0.292899727821350), COEF_CONST(0.360434412956238),
-    COEF_CONST(0.427100926637650), COEF_CONST(0.492738455533981),
-    COEF_CONST(0.557188928127289), COEF_CONST(0.620297133922577),
-    COEF_CONST(0.681910991668701), COEF_CONST(0.741881847381592),
-    COEF_CONST(0.800065577030182), COEF_CONST(0.856321990489960),
-    COEF_CONST(0.910515367984772), COEF_CONST(0.962515234947205),
-    COEF_CONST(1.000000000000000), COEF_CONST(0.998795449733734),
-    COEF_CONST(0.995184719562531), COEF_CONST(0.989176511764526),
-    COEF_CONST(0.980785250663757), COEF_CONST(0.970031261444092),
-    COEF_CONST(0.956940352916718), COEF_CONST(0.941544055938721),
-    COEF_CONST(0.923879504203796), COEF_CONST(0.903989315032959),
-    COEF_CONST(0.881921231746674), COEF_CONST(0.857728600502014),
-    COEF_CONST(0.831469595432281), COEF_CONST(0.803207516670227),
-    COEF_CONST(0.773010432720184), COEF_CONST(0.740951120853424),
-    COEF_CONST(0.707106769084930), COEF_CONST(0.671558916568756),
-    COEF_CONST(0.634393274784088), COEF_CONST(0.595699310302734),
-    COEF_CONST(0.555570185184479), COEF_CONST(0.514102697372437),
-    COEF_CONST(0.471396654844284), COEF_CONST(0.427555114030838),
-    COEF_CONST(0.382683426141739), COEF_CONST(0.336889833211899),
-    COEF_CONST(0.290284633636475), COEF_CONST(0.242980122566223),
-    COEF_CONST(0.195090234279633), COEF_CONST(0.146730497479439),
-    COEF_CONST(0.098017133772373), COEF_CONST(0.049067649990320),
-    COEF_CONST(-1.000000000000000), COEF_CONST(-1.047863125801086),
-    COEF_CONST(-1.093201875686646), COEF_CONST(-1.135906934738159),
-    COEF_CONST(-1.175875544548035), COEF_CONST(-1.213011503219605),
-    COEF_CONST(-1.247225046157837), COEF_CONST(-1.278433918952942),
-    COEF_CONST(-1.306562900543213), COEF_CONST(-1.331544399261475),
-    COEF_CONST(-1.353317975997925), COEF_CONST(-1.371831417083740),
-    COEF_CONST(-1.387039899826050), COEF_CONST(-1.398906826972961),
-    COEF_CONST(-1.407403707504273), COEF_CONST(-1.412510156631470),
-    COEF_CONST(0), COEF_CONST(-1.412510156631470),
-    COEF_CONST(-1.407403707504273), COEF_CONST(-1.398906826972961),
-    COEF_CONST(-1.387039899826050), COEF_CONST(-1.371831417083740),
-    COEF_CONST(-1.353317975997925), COEF_CONST(-1.331544399261475),
-    COEF_CONST(-1.306562900543213), COEF_CONST(-1.278433918952942),
-    COEF_CONST(-1.247225046157837), COEF_CONST(-1.213011384010315),
-    COEF_CONST(-1.175875544548035), COEF_CONST(-1.135907053947449),
-    COEF_CONST(-1.093201875686646), COEF_CONST(-1.047863125801086),
-    COEF_CONST(-1.000000000000000), COEF_CONST(-0.949727773666382),
-    COEF_CONST(-0.897167563438416), COEF_CONST(-0.842446029186249),
-    COEF_CONST(-0.785694956779480), COEF_CONST(-0.727051079273224),
-    COEF_CONST(-0.666655659675598), COEF_CONST(-0.604654192924500),
-    COEF_CONST(-0.541196048259735), COEF_CONST(-0.476434230804443),
-    COEF_CONST(-0.410524487495422), COEF_CONST(-0.343625843524933),
-    COEF_CONST(-0.275899350643158), COEF_CONST(-0.207508206367493),
-    COEF_CONST(-0.138617098331451), COEF_CONST(-0.069392144680023),
-    COEF_CONST(0), COEF_CONST(0.069392263889313),
-    COEF_CONST(0.138617157936096), COEF_CONST(0.207508206367493),
-    COEF_CONST(0.275899469852448), COEF_CONST(0.343625962734222),
-    COEF_CONST(0.410524636507034), COEF_CONST(0.476434201002121),
-    COEF_CONST(0.541196107864380), COEF_CONST(0.604654192924500),
-    COEF_CONST(0.666655719280243), COEF_CONST(0.727051138877869),
-    COEF_CONST(0.785695075988770), COEF_CONST(0.842446029186249),
-    COEF_CONST(0.897167563438416), COEF_CONST(0.949727773666382)
-};
-
-/* size 64 only! */
-void dct4_kernel(real_t * in_real, real_t * in_imag, real_t * out_real, real_t * out_imag)
-{
-    // Tables with bit reverse values for 5 bits, bit reverse of i at i-th position
-    const uint8_t bit_rev_tab[32] = { 0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23,15,31 };
-    uint16_t i, i_rev;
-
-    /* Step 2: modulate */
-    // 3*32=96 multiplications
-    // 3*32=96 additions
-    for (i = 0; i < 32; i++)
-    {
-    	real_t x_re, x_im, tmp;
-    	x_re = in_real[i];
-    	x_im = in_imag[i];
-        tmp =        MUL_C(x_re + x_im, dct4_64_tab[i]);
-        in_real[i] = MUL_C(x_im, dct4_64_tab[i + 64]) + tmp;
-        in_imag[i] = MUL_C(x_re, dct4_64_tab[i + 32]) + tmp;
-    }
-
-    /* Step 3: FFT, but with output in bit reverse order */
-    fft_dif(in_real, in_imag);
-
-    /* Step 4: modulate + bitreverse reordering */
-    // 3*31+2=95 multiplications
-    // 3*31+2=95 additions
-    for (i = 0; i < 16; i++)
-    {
-    	real_t x_re, x_im, tmp;
-    	i_rev = bit_rev_tab[i];
-    	x_re = in_real[i_rev];
-    	x_im = in_imag[i_rev];
-
-        tmp =         MUL_C(x_re + x_im, dct4_64_tab[i + 3*32]);
-        out_real[i] = MUL_C(x_im, dct4_64_tab[i + 5*32]) + tmp;
-        out_imag[i] = MUL_C(x_re, dct4_64_tab[i + 4*32]) + tmp;
-    }
-    // i = 16, i_rev = 1 = rev(16);
-    out_imag[16] = MUL_C(in_imag[1] - in_real[1], dct4_64_tab[16 + 3*32]);
-    out_real[16] = MUL_C(in_real[1] + in_imag[1], dct4_64_tab[16 + 3*32]);
-    for (i = 17; i < 32; i++)
-    {
-    	real_t x_re, x_im, tmp;
-    	i_rev = bit_rev_tab[i];
-    	x_re = in_real[i_rev];
-    	x_im = in_imag[i_rev];
-        tmp =         MUL_C(x_re + x_im, dct4_64_tab[i + 3*32]);
-        out_real[i] = MUL_C(x_im, dct4_64_tab[i + 5*32]) + tmp;
-        out_imag[i] = MUL_C(x_re, dct4_64_tab[i + 4*32]) + tmp;
-    }
-
+    f128 = f65 - f108;
+    f129 = f65 + f108;
+    f130 = f67 - f114;
+    f131 = f67 + f114;
+    f132 = f69 - f120;
+    f133 = f69 + f120;
+    f134 = f71 - f126;
+    f135 = f71 + f126;
+    f136 = f70 - f127;
+    f137 = f70 + f127;
+    f138 = f68 - f121;
+    f139 = f68 + f121;
+    f140 = f66 - f115;
+    f141 = f66 + f115;
+    f142 = f64 - f109;
+    f143 = f64 + f109;
+    f144 = f0 + f30;
+    f145 = MUL_C(COEF_CONST(1.0478631305325901), f0);
+    f146 = MUL_F(FRAC_CONST(-0.9987954562051724), f144);
+    f147 = MUL_F(FRAC_CONST(-0.9497277818777548), f30);
+    f148 = f145 + f146;
+    f149 = f147 - f146;
+    f150 = f4 + f26;
+    f151 = MUL_F(FRAC_CONST(1.2130114330978077), f4);
+    f152 = MUL_F(FRAC_CONST(-0.9700312531945440), f150);
+    f153 = MUL_F(FRAC_CONST(-0.7270510732912803), f26);
+    f154 = f151 + f152;
+    f155 = f153 - f152;
+    f156 = f8 + f22;
+    f157 = MUL_C(COEF_CONST(1.3315443865537255), f8);
+    f158 = MUL_F(FRAC_CONST(-0.9039892931234433), f156);
+    f159 = MUL_F(FRAC_CONST(-0.4764341996931612), f22);
+    f160 = f157 + f158;
+    f161 = f159 - f158;
+    f162 = f12 + f18;
+    f163 = MUL_C(COEF_CONST(1.3989068359730781), f12);
+    f164 = MUL_F(FRAC_CONST(-0.8032075314806453), f162);
+    f165 = MUL_F(FRAC_CONST(-0.2075082269882124), f18);
+    f166 = f163 + f164;
+    f167 = f165 - f164;
+    f168 = f16 + f14;
+    f169 = MUL_C(COEF_CONST(1.4125100802019777), f16);
+    f170 = MUL_F(FRAC_CONST(-0.6715589548470187), f168);
+    f171 = MUL_F(FRAC_CONST(0.0693921705079402), f14);
+    f172 = f169 + f170;
+    f173 = f171 - f170;
+    f174 = f20 + f10;
+    f175 = MUL_C(COEF_CONST(1.3718313541934939), f20);
+    f176 = MUL_F(FRAC_CONST(-0.5141027441932219), f174);
+    f177 = MUL_F(FRAC_CONST(0.3436258658070501), f10);
+    f178 = f175 + f176;
+    f179 = f177 - f176;
+    f180 = f24 + f6;
+    f181 = MUL_C(COEF_CONST(1.2784339185752409), f24);
+    f182 = MUL_F(FRAC_CONST(-0.3368898533922200), f180);
+    f183 = MUL_F(FRAC_CONST(0.6046542117908008), f6);
+    f184 = f181 + f182;
+    f185 = f183 - f182;
+    f186 = f28 + f2;
+    f187 = MUL_C(COEF_CONST(1.1359069844201433), f28);
+    f188 = MUL_F(FRAC_CONST(-0.1467304744553624), f186);
+    f189 = MUL_F(FRAC_CONST(0.8424460355094185), f2);
+    f190 = f187 + f188;
+    f191 = f189 - f188;
+    f192 = f149 - f173;
+    f193 = f149 + f173;
+    f194 = f148 - f172;
+    f195 = f148 + f172;
+    f196 = f155 - f179;
+    f197 = f155 + f179;
+    f198 = f154 - f178;
+    f199 = f154 + f178;
+    f200 = f161 - f185;
+    f201 = f161 + f185;
+    f202 = f160 - f184;
+    f203 = f160 + f184;
+    f204 = f167 - f191;
+    f205 = f167 + f191;
+    f206 = f166 - f190;
+    f207 = f166 + f190;
+    f208 = f192 + f194;
+    f209 = MUL_C(COEF_CONST(1.1758756024193588), f192);
+    f210 = MUL_F(FRAC_CONST(-0.9807852804032304), f208);
+    f211 = MUL_F(FRAC_CONST(-0.7856949583871021), f194);
+    f212 = f209 + f210;
+    f213 = f211 - f210;
+    f214 = f196 + f198;
+    f215 = MUL_C(COEF_CONST(1.3870398453221475), f196);
+    f216 = MUL_F(FRAC_CONST(-0.5555702330196022), f214);
+    f217 = MUL_F(FRAC_CONST(0.2758993792829431), f198);
+    f218 = f215 + f216;
+    f219 = f217 - f216;
+    f220 = f200 + f202;
+    f221 = MUL_F(FRAC_CONST(0.7856949583871022), f200);
+    f222 = MUL_F(FRAC_CONST(0.1950903220161283), f220);
+    f223 = MUL_C(COEF_CONST(1.1758756024193586), f202);
+    f224 = f221 + f222;
+    f225 = f223 - f222;
+    f226 = f204 + f206;
+    f227 = MUL_F(FRAC_CONST(-0.2758993792829430), f204);
+    f228 = MUL_F(FRAC_CONST(0.8314696123025452), f226);
+    f229 = MUL_C(COEF_CONST(1.3870398453221475), f206);
+    f230 = f227 + f228;
+    f231 = f229 - f228;
+    f232 = f193 - f201;
+    f233 = f193 + f201;
+    f234 = f195 - f203;
+    f235 = f195 + f203;
+    f236 = f197 - f205;
+    f237 = f197 + f205;
+    f238 = f199 - f207;
+    f239 = f199 + f207;
+    f240 = f213 - f225;
+    f241 = f213 + f225;
+    f242 = f212 - f224;
+    f243 = f212 + f224;
+    f244 = f219 - f231;
+    f245 = f219 + f231;
+    f246 = f218 - f230;
+    f247 = f218 + f230;
+    f248 = f232 + f234;
+    f249 = MUL_C(COEF_CONST(1.3065629648763766), f232);
+    f250 = MUL_F(FRAC_CONST(-0.9238795325112866), f248);
+    f251 = MUL_F(FRAC_CONST(-0.5411961001461967), f234);
+    f252 = f249 + f250;
+    f253 = f251 - f250;
+    f254 = f236 + f238;
+    f255 = MUL_F(FRAC_CONST(0.5411961001461969), f236);
+    f256 = MUL_F(FRAC_CONST(0.3826834323650898), f254);
+    f257 = MUL_C(COEF_CONST(1.3065629648763766), f238);
+    f258 = f255 + f256;
+    f259 = f257 - f256;
+    f260 = f240 + f242;
+    f261 = MUL_C(COEF_CONST(1.3065629648763766), f240);
+    f262 = MUL_F(FRAC_CONST(-0.9238795325112866), f260);
+    f263 = MUL_F(FRAC_CONST(-0.5411961001461967), f242);
+    f264 = f261 + f262;
+    f265 = f263 - f262;
+    f266 = f244 + f246;
+    f267 = MUL_F(FRAC_CONST(0.5411961001461969), f244);
+    f268 = MUL_F(FRAC_CONST(0.3826834323650898), f266);
+    f269 = MUL_C(COEF_CONST(1.3065629648763766), f246);
+    f270 = f267 + f268;
+    f271 = f269 - f268;
+    f272 = f233 - f237;
+    f273 = f233 + f237;
+    f274 = f235 - f239;
+    f275 = f235 + f239;
+    f276 = f253 - f259;
+    f277 = f253 + f259;
+    f278 = f252 - f258;
+    f279 = f252 + f258;
+    f280 = f241 - f245;
+    f281 = f241 + f245;
+    f282 = f243 - f247;
+    f283 = f243 + f247;
+    f284 = f265 - f271;
+    f285 = f265 + f271;
+    f286 = f264 - f270;
+    f287 = f264 + f270;
+    f288 = f272 - f274;
+    f289 = f272 + f274;
+    f290 = MUL_F(FRAC_CONST(0.7071067811865474), f288);
+    f291 = MUL_F(FRAC_CONST(0.7071067811865474), f289);
+    f292 = f276 - f278;
+    f293 = f276 + f278;
+    f294 = MUL_F(FRAC_CONST(0.7071067811865474), f292);
+    f295 = MUL_F(FRAC_CONST(0.7071067811865474), f293);
+    f296 = f280 - f282;
+    f297 = f280 + f282;
+    f298 = MUL_F(FRAC_CONST(0.7071067811865474), f296);
+    f299 = MUL_F(FRAC_CONST(0.7071067811865474), f297);
+    f300 = f284 - f286;
+    f301 = f284 + f286;
+    f302 = MUL_F(FRAC_CONST(0.7071067811865474), f300);
+    f303 = MUL_F(FRAC_CONST(0.7071067811865474), f301);
+    f304 = f129 - f273;
+    f305 = f129 + f273;
+    f306 = f131 - f281;
+    f307 = f131 + f281;
+    f308 = f133 - f285;
+    f309 = f133 + f285;
+    f310 = f135 - f277;
+    f311 = f135 + f277;
+    f312 = f137 - f295;
+    f313 = f137 + f295;
+    f314 = f139 - f303;
+    f315 = f139 + f303;
+    f316 = f141 - f299;
+    f317 = f141 + f299;
+    f318 = f143 - f291;
+    f319 = f143 + f291;
+    f320 = f142 - f290;
+    f321 = f142 + f290;
+    f322 = f140 - f298;
+    f323 = f140 + f298;
+    f324 = f138 - f302;
+    f325 = f138 + f302;
+    f326 = f136 - f294;
+    f327 = f136 + f294;
+    f328 = f134 - f279;
+    f329 = f134 + f279;
+    f330 = f132 - f287;
+    f331 = f132 + f287;
+    f332 = f130 - f283;
+    f333 = f130 + f283;
+    f334 = f128 - f275;
+    f335 = f128 + f275;
+    y[31] = MUL_F(FRAC_CONST(0.5001506360206510), f305);
+    y[30] = MUL_F(FRAC_CONST(0.5013584524464084), f307);
+    y[29] = MUL_F(FRAC_CONST(0.5037887256810443), f309);
+    y[28] = MUL_F(FRAC_CONST(0.5074711720725553), f311);
+    y[27] = MUL_F(FRAC_CONST(0.5124514794082247), f313);
+    y[26] = MUL_F(FRAC_CONST(0.5187927131053328), f315);
+    y[25] = MUL_F(FRAC_CONST(0.5265773151542700), f317);
+    y[24] = MUL_F(FRAC_CONST(0.5359098169079920), f319);
+    y[23] = MUL_F(FRAC_CONST(0.5469204379855088), f321);
+    y[22] = MUL_F(FRAC_CONST(0.5597698129470802), f323);
+    y[21] = MUL_F(FRAC_CONST(0.5746551840326600), f325);
+    y[20] = MUL_F(FRAC_CONST(0.5918185358574165), f327);
+    y[19] = MUL_F(FRAC_CONST(0.6115573478825099), f329);
+    y[18] = MUL_F(FRAC_CONST(0.6342389366884031), f331);
+    y[17] = MUL_F(FRAC_CONST(0.6603198078137061), f333);
+    y[16] = MUL_F(FRAC_CONST(0.6903721282002123), f335);
+    y[15] = MUL_F(FRAC_CONST(0.7251205223771985), f334);
+    y[14] = MUL_F(FRAC_CONST(0.7654941649730891), f332);
+    y[13] = MUL_F(FRAC_CONST(0.8127020908144905), f330);
+    y[12] = MUL_F(FRAC_CONST(0.8683447152233481), f328);
+    y[11] = MUL_F(FRAC_CONST(0.9345835970364075), f326);
+    y[10] = MUL_C(COEF_CONST(1.0144082649970547), f324);
+    y[9] = MUL_C(COEF_CONST(1.1120716205797176), f322);
+    y[8] = MUL_C(COEF_CONST(1.2338327379765710), f320);
+    y[7] = MUL_C(COEF_CONST(1.3892939586328277), f318);
+    y[6] = MUL_C(COEF_CONST(1.5939722833856311), f316);
+    y[5] = MUL_C(COEF_CONST(1.8746759800084078), f314);
+    y[4] = MUL_C(COEF_CONST(2.2820500680051619), f312);
+    y[3] = MUL_C(COEF_CONST(2.9246284281582162), f310);
+    y[2] = MUL_C(COEF_CONST(4.0846110781292477), f308);
+    y[1] = MUL_C(COEF_CONST(6.7967507116736332), f306);
+    y[0] = MUL_R(REAL_CONST(20.3738781672314530), f304);
 }
 
-void DST4_32(real_t *y, real_t *x)
+#ifdef SBR_LOW_POWER
+
+void DCT2_16_unscaled(real_t *y, real_t *x)
 {
-    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9;
-    real_t f10, f11, f12, f13, f14, f15, f16, f17, f18, f19;
-    real_t f20, f21, f22, f23, f24, f25, f26, f27, f28, f29;
-    real_t f30, f31, f32, f33, f34, f35, f36, f37, f38, f39;
-    real_t f40, f41, f42, f43, f44, f45, f46, f47, f48, f49;
-    real_t f50, f51, f52, f53, f54, f55, f56, f57, f58, f59;
-    real_t f60, f61, f62, f63, f64, f65, f66, f67, f68, f69;
-    real_t f70, f71, f72, f73, f74, f75, f76, f77, f78, f79;
-    real_t f80, f81, f82, f83, f84, f85, f86, f87, f88, f89;
-    real_t f90, f91, f92, f93, f94, f95, f96, f97, f98, f99;
-    real_t f100, f101, f102, f103, f104, f105, f106, f107, f108, f109;
-    real_t f110, f111, f112, f113, f114, f115, f116, f117, f118, f119;
-    real_t f120, f121, f122, f123, f124, f125, f126, f127, f128, f129;
-    real_t f130, f131, f132, f133, f134, f135, f136, f137, f138, f139;
-    real_t f140, f141, f142, f143, f144, f145, f146, f147, f148, f149;
-    real_t f150, f151, f152, f153, f154, f155, f156, f157, f158, f159;
-    real_t f160, f161, f162, f163, f164, f165, f166, f167, f168, f169;
-    real_t f170, f171, f172, f173, f174, f175, f176, f177, f178, f179;
-    real_t f180, f181, f182, f183, f184, f185, f186, f187, f188, f189;
-    real_t f190, f191, f192, f193, f194, f195, f196, f197, f198, f199;
-    real_t f200, f201, f202, f203, f204, f205, f206, f207, f208, f209;
-    real_t f210, f211, f212, f213, f214, f215, f216, f217, f218, f219;
-    real_t f220, f221, f222, f223, f224, f225, f226, f227, f228, f229;
-    real_t f230, f231, f232, f233, f234, f235, f236, f237, f238, f239;
-    real_t f240, f241, f242, f243, f244, f245, f246, f247, f248, f249;
-    real_t f250, f251, f252, f253, f254, f255, f256, f257, f258, f259;
-    real_t f260, f261, f262, f263, f264, f265, f266, f267, f268, f269;
-    real_t f270, f271, f272, f273, f274, f275, f276, f277, f278, f279;
-    real_t f280, f281, f282, f283, f284, f285, f286, f287, f288, f289;
-    real_t f290, f291, f292, f293, f294, f295, f296, f297, f298, f299;
-    real_t f300, f301, f302, f303, f304, f305, f306, f307, f308, f309;
-    real_t f310, f311, f312, f313, f314, f315, f316, f317, f318, f319;
-    real_t f320, f321, f322, f323, f324, f325, f326, f327, f328, f329;
-    real_t f330, f331, f332, f333, f334, f335;
+    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
+    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
+    real_t f21, f22, f23, f24, f25, f26, f27, f28, f31, f32;
+    real_t f33, f34, f37, f38, f39, f40, f41, f42, f43, f44;
+    real_t f45, f46, f47, f48, f49, f51, f53, f54, f57, f58;
+    real_t f59, f60, f61, f62, f63, f64, f65, f66, f67, f68;
+    real_t f69, f70, f71, f72, f73, f74, f75, f76, f77, f78;
+    real_t f79, f80, f81, f82, f83, f84, f85, f86, f87, f88;
+    real_t f89, f90, f91, f92, f95, f96, f97, f98, f101, f102;
+    real_t f103, f104, f107, f108, f109, f110;
 
-    f0 = x[0] - x[1];
-    f1 = x[2] - x[1];
-    f2 = x[2] - x[3];
-    f3 = x[4] - x[3];
-    f4 = x[4] - x[5];
-    f5 = x[6] - x[5];
-    f6 = x[6] - x[7];
-    f7 = x[8] - x[7];
-    f8 = x[8] - x[9];
-    f9 = x[10] - x[9];
-    f10 = x[10] - x[11];
-    f11 = x[12] - x[11];
-    f12 = x[12] - x[13];
-    f13 = x[14] - x[13];
-    f14 = x[14] - x[15];
-    f15 = x[16] - x[15];
-    f16 = x[16] - x[17];
-    f17 = x[18] - x[17];
-    f18 = x[18] - x[19];
-    f19 = x[20] - x[19];
-    f20 = x[20] - x[21];
-    f21 = x[22] - x[21];
-    f22 = x[22] - x[23];
-    f23 = x[24] - x[23];
-    f24 = x[24] - x[25];
-    f25 = x[26] - x[25];
-    f26 = x[26] - x[27];
-    f27 = x[28] - x[27];
-    f28 = x[28] - x[29];
-    f29 = x[30] - x[29];
-    f30 = x[30] - x[31];
-    f31 = MUL_F(FRAC_CONST(0.7071067811865476), f15);
-    f32 = x[0] - f31;
-    f33 = x[0] + f31;
-    f34 = f7 + f23;
-    f35 = MUL_C(COEF_CONST(1.3065629648763766), f7);
-    f36 = MUL_F(FRAC_CONST(-0.9238795325112866), f34);
-    f37 = MUL_F(FRAC_CONST(-0.5411961001461967), f23);
-    f38 = f35 + f36;
-    f39 = f37 - f36;
-    f40 = f33 - f39;
-    f41 = f33 + f39;
-    f42 = f32 - f38;
-    f43 = f32 + f38;
-    f44 = f11 - f19;
-    f45 = f11 + f19;
-    f46 = MUL_F(FRAC_CONST(0.7071067811865476), f45);
-    f47 = f3 - f46;
-    f48 = f3 + f46;
-    f49 = MUL_F(FRAC_CONST(0.7071067811865476), f44);
-    f50 = f49 - f27;
-    f51 = f49 + f27;
-    f52 = f51 + f48;
-    f53 = MUL_F(FRAC_CONST(-0.7856949583871021), f51);
-    f54 = MUL_F(FRAC_CONST(0.9807852804032304), f52);
-    f55 = MUL_C(COEF_CONST(1.1758756024193588), f48);
-    f56 = f53 + f54;
-    f57 = f55 - f54;
-    f58 = f50 + f47;
-    f59 = MUL_F(FRAC_CONST(-0.2758993792829430), f50);
-    f60 = MUL_F(FRAC_CONST(0.8314696123025452), f58);
-    f61 = MUL_C(COEF_CONST(1.3870398453221475), f47);
-    f62 = f59 + f60;
-    f63 = f61 - f60;
-    f64 = f41 - f56;
-    f65 = f41 + f56;
-    f66 = f43 - f62;
-    f67 = f43 + f62;
-    f68 = f42 - f63;
-    f69 = f42 + f63;
-    f70 = f40 - f57;
-    f71 = f40 + f57;
-    f72 = f5 - f9;
-    f73 = f5 + f9;
-    f74 = f13 - f17;
-    f75 = f13 + f17;
-    f76 = f21 - f25;
-    f77 = f21 + f25;
-    f78 = MUL_F(FRAC_CONST(0.7071067811865476), f75);
-    f79 = f1 - f78;
-    f80 = f1 + f78;
-    f81 = f73 + f77;
-    f82 = MUL_C(COEF_CONST(1.3065629648763766), f73);
-    f83 = MUL_F(FRAC_CONST(-0.9238795325112866), f81);
-    f84 = MUL_F(FRAC_CONST(-0.5411961001461967), f77);
-    f85 = f82 + f83;
-    f86 = f84 - f83;
-    f87 = f80 - f86;
-    f88 = f80 + f86;
-    f89 = f79 - f85;
-    f90 = f79 + f85;
-    f91 = MUL_F(FRAC_CONST(0.7071067811865476), f74);
-    f92 = f29 - f91;
-    f93 = f29 + f91;
-    f94 = f76 + f72;
-    f95 = MUL_C(COEF_CONST(1.3065629648763766), f76);
-    f96 = MUL_F(FRAC_CONST(-0.9238795325112866), f94);
-    f97 = MUL_F(FRAC_CONST(-0.5411961001461967), f72);
-    f98 = f95 + f96;
-    f99 = f97 - f96;
-    f100 = f93 - f99;
-    f101 = f93 + f99;
-    f102 = f92 - f98;
-    f103 = f92 + f98;
-    f104 = f101 + f88;
-    f105 = MUL_F(FRAC_CONST(-0.8971675863426361), f101);
-    f106 = MUL_F(FRAC_CONST(0.9951847266721968), f104);
-    f107 = MUL_C(COEF_CONST(1.0932018670017576), f88);
+    f0 = x[0] - x[15];
+    f1 = x[0] + x[15];
+    f2 = x[1] - x[14];
+    f3 = x[1] + x[14];
+    f4 = x[2] - x[13];
+    f5 = x[2] + x[13];
+    f6 = x[3] - x[12];
+    f7 = x[3] + x[12];
+    f8 = x[4] - x[11];
+    f9 = x[4] + x[11];
+    f10 = x[5] - x[10];
+    f11 = x[5] + x[10];
+    f12 = x[6] - x[9];
+    f13 = x[6] + x[9];
+    f14 = x[7] - x[8];
+    f15 = x[7] + x[8];
+    f16 = f1 - f15;
+    f17 = f1 + f15;
+    f18 = f3 - f13;
+    f19 = f3 + f13;
+    f20 = f5 - f11;
+    f21 = f5 + f11;
+    f22 = f7 - f9;
+    f23 = f7 + f9;
+    f24 = f17 - f23;
+    f25 = f17 + f23;
+    f26 = f19 - f21;
+    f27 = f19 + f21;
+    f28 = f25 - f27;
+    y[0] = f25 + f27;
+    y[8] = MUL_F(f28, FRAC_CONST(0.7071067811865476));
+    f31 = f24 + f26;
+    f32 = MUL_C(f24, COEF_CONST(1.3065629648763766));
+    f33 = MUL_F(f31, FRAC_CONST(-0.9238795325112866));
+    f34 = MUL_F(f26, FRAC_CONST(-0.5411961001461967));
+    y[12] = f32 + f33;
+    y[4] = f34 - f33;
+    f37 = f16 + f22;
+    f38 = MUL_C(f16, COEF_CONST(1.1758756024193588));
+    f39 = MUL_F(f37, FRAC_CONST(-0.9807852804032304));
+    f40 = MUL_F(f22, FRAC_CONST(-0.7856949583871021));
+    f41 = f38 + f39;
+    f42 = f40 - f39;
+    f43 = f18 + f20;
+    f44 = MUL_C(f18, COEF_CONST(1.3870398453221473));
+    f45 = MUL_F(f43, FRAC_CONST(-0.8314696123025455));
+    f46 = MUL_F(f20, FRAC_CONST(-0.2758993792829436));
+    f47 = f44 + f45;
+    f48 = f46 - f45;
+    f49 = f42 - f48;
+    y[2] = f42 + f48;
+    f51 = MUL_F(f49, FRAC_CONST(0.7071067811865476));
+    y[14] = f41 - f47;
+    f53 = f41 + f47;
+    f54 = MUL_F(f53, FRAC_CONST(0.7071067811865476));
+    y[10] = f51 - f54;
+    y[6] = f51 + f54;
+    f57 = f2 - f4;
+    f58 = f2 + f4;
+    f59 = f6 - f8;
+    f60 = f6 + f8;
+    f61 = f10 - f12;
+    f62 = f10 + f12;
+    f63 = MUL_F(f60, FRAC_CONST(0.7071067811865476));
+    f64 = f0 - f63;
+    f65 = f0 + f63;
+    f66 = f58 + f62;
+    f67 = MUL_C(f58, COEF_CONST(1.3065629648763766));
+    f68 = MUL_F(f66, FRAC_CONST(-0.9238795325112866));
+    f69 = MUL_F(f62, FRAC_CONST(-0.5411961001461967));
+    f70 = f67 + f68;
+    f71 = f69 - f68;
+    f72 = f65 - f71;
+    f73 = f65 + f71;
+    f74 = f64 - f70;
+    f75 = f64 + f70;
+    f76 = MUL_F(f59, FRAC_CONST(0.7071067811865476));
+    f77 = f14 - f76;
+    f78 = f14 + f76;
+    f79 = f61 + f57;
+    f80 = MUL_C(f61, COEF_CONST(1.3065629648763766));
+    f81 = MUL_F(f79, FRAC_CONST(-0.9238795325112866));
+    f82 = MUL_F(f57, FRAC_CONST(-0.5411961001461967));
+    f83 = f80 + f81;
+    f84 = f82 - f81;
+    f85 = f78 - f84;
+    f86 = f78 + f84;
+    f87 = f77 - f83;
+    f88 = f77 + f83;
+    f89 = f86 + f73;
+    f90 = MUL_F(f86, FRAC_CONST(-0.8971675863426361));
+    f91 = MUL_F(f89, FRAC_CONST(0.9951847266721968));
+    f92 = MUL_C(f73, COEF_CONST(1.0932018670017576));
+    y[1] = f90 + f91;
+    y[15] = f92 - f91;
+    f95 = f75 - f88;
+    f96 = MUL_F(f88, FRAC_CONST(-0.6666556584777466));
+    f97 = MUL_F(f95, FRAC_CONST(0.9569403357322089));
+    f98 = MUL_C(f75, COEF_CONST(1.2472250129866713));
+    y[3] = f97 - f96;
+    y[13] = f98 - f97;
+    f101 = f87 + f74;
+    f102 = MUL_F(f87, FRAC_CONST(-0.4105245275223571));
+    f103 = MUL_F(f101, FRAC_CONST(0.8819212643483549));
+    f104 = MUL_C(f74, COEF_CONST(1.3533180011743529));
+    y[5] = f102 + f103;
+    y[11] = f104 - f103;
+    f107 = f72 - f85;
+    f108 = MUL_F(f85, FRAC_CONST(-0.1386171691990915));
+    f109 = MUL_F(f107, FRAC_CONST(0.7730104533627370));
+    f110 = MUL_C(f72, COEF_CONST(1.4074037375263826));
+    y[7] = f109 - f108;
+    y[9] = f110 - f109;
+}
+
+void DCT4_16(real_t *y, real_t *x)
+{
+    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
+    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
+    real_t f21, f22, f23, f24, f25, f26, f27, f28, f29, f30;
+    real_t f31, f32, f33, f34, f35, f36, f37, f38, f39, f40;
+    real_t f41, f42, f43, f44, f45, f46, f47, f48, f49, f50;
+    real_t f51, f52, f53, f54, f55, f56, f57, f58, f59, f60;
+    real_t f61, f62, f63, f64, f65, f66, f67, f68, f69, f70;
+    real_t f71, f72, f73, f74, f75, f76, f77, f78, f79, f80;
+    real_t f81, f82, f83, f84, f85, f86, f87, f88, f89, f90;
+    real_t f91, f92, f93, f94, f95, f96, f97, f98, f99, f100;
+    real_t f101, f102, f103, f104, f105, f106, f107, f108, f109, f110;
+    real_t f111, f112, f113, f114, f115, f116, f117, f118, f119, f120;
+    real_t f121, f122, f123, f124, f125, f126, f127, f128, f130, f132;
+    real_t f134, f136, f138, f140, f142, f144, f145, f148, f149, f152;
+    real_t f153, f156, f157;
+
+    f0 = x[0] + x[15];
+    f1 = MUL_C(COEF_CONST(1.0478631305325901), x[0]);
+    f2 = MUL_F(FRAC_CONST(-0.9987954562051724), f0);
+    f3 = MUL_F(FRAC_CONST(-0.9497277818777548), x[15]);
+    f4 = f1 + f2;
+    f5 = f3 - f2;
+    f6 = x[2] + x[13];
+    f7 = MUL_C(COEF_CONST(1.2130114330978077), x[2]);
+    f8 = MUL_F(FRAC_CONST(-0.9700312531945440), f6);
+    f9 = MUL_F(FRAC_CONST(-0.7270510732912803), x[13]);
+    f10 = f7 + f8;
+    f11 = f9 - f8;
+    f12 = x[4] + x[11];
+    f13 = MUL_C(COEF_CONST(1.3315443865537255), x[4]);
+    f14 = MUL_F(FRAC_CONST(-0.9039892931234433), f12);
+    f15 = MUL_F(FRAC_CONST(-0.4764341996931612), x[11]);
+    f16 = f13 + f14;
+    f17 = f15 - f14;
+    f18 = x[6] + x[9];
+    f19 = MUL_C(COEF_CONST(1.3989068359730781), x[6]);
+    f20 = MUL_F(FRAC_CONST(-0.8032075314806453), f18);
+    f21 = MUL_F(FRAC_CONST(-0.2075082269882124), x[9]);
+    f22 = f19 + f20;
+    f23 = f21 - f20;
+    f24 = x[8] + x[7];
+    f25 = MUL_C(COEF_CONST(1.4125100802019777), x[8]);
+    f26 = MUL_F(FRAC_CONST(-0.6715589548470187), f24);
+    f27 = MUL_F(FRAC_CONST(0.0693921705079402), x[7]);
+    f28 = f25 + f26;
+    f29 = f27 - f26;
+    f30 = x[10] + x[5];
+    f31 = MUL_C(COEF_CONST(1.3718313541934939), x[10]);
+    f32 = MUL_F(FRAC_CONST(-0.5141027441932219), f30);
+    f33 = MUL_F(FRAC_CONST(0.3436258658070501), x[5]);
+    f34 = f31 + f32;
+    f35 = f33 - f32;
+    f36 = x[12] + x[3];
+    f37 = MUL_C(COEF_CONST(1.2784339185752409), x[12]);
+    f38 = MUL_F(FRAC_CONST(-0.3368898533922200), f36);
+    f39 = MUL_F(FRAC_CONST(0.6046542117908008), x[3]);
+    f40 = f37 + f38;
+    f41 = f39 - f38;
+    f42 = x[14] + x[1];
+    f43 = MUL_C(COEF_CONST(1.1359069844201433), x[14]);
+    f44 = MUL_F(FRAC_CONST(-0.1467304744553624), f42);
+    f45 = MUL_F(FRAC_CONST(0.8424460355094185), x[1]);
+    f46 = f43 + f44;
+    f47 = f45 - f44;
+    f48 = f5 - f29;
+    f49 = f5 + f29;
+    f50 = f4 - f28;
+    f51 = f4 + f28;
+    f52 = f11 - f35;
+    f53 = f11 + f35;
+    f54 = f10 - f34;
+    f55 = f10 + f34;
+    f56 = f17 - f41;
+    f57 = f17 + f41;
+    f58 = f16 - f40;
+    f59 = f16 + f40;
+    f60 = f23 - f47;
+    f61 = f23 + f47;
+    f62 = f22 - f46;
+    f63 = f22 + f46;
+    f64 = f48 + f50;
+    f65 = MUL_C(COEF_CONST(1.1758756024193588), f48);
+    f66 = MUL_F(FRAC_CONST(-0.9807852804032304), f64);
+    f67 = MUL_F(FRAC_CONST(-0.7856949583871021), f50);
+    f68 = f65 + f66;
+    f69 = f67 - f66;
+    f70 = f52 + f54;
+    f71 = MUL_C(COEF_CONST(1.3870398453221475), f52);
+    f72 = MUL_F(FRAC_CONST(-0.5555702330196022), f70);
+    f73 = MUL_F(FRAC_CONST(0.2758993792829431), f54);
+    f74 = f71 + f72;
+    f75 = f73 - f72;
+    f76 = f56 + f58;
+    f77 = MUL_F(FRAC_CONST(0.7856949583871022), f56);
+    f78 = MUL_F(FRAC_CONST(0.1950903220161283), f76);
+    f79 = MUL_C(COEF_CONST(1.1758756024193586), f58);
+    f80 = f77 + f78;
+    f81 = f79 - f78;
+    f82 = f60 + f62;
+    f83 = MUL_F(FRAC_CONST(-0.2758993792829430), f60);
+    f84 = MUL_F(FRAC_CONST(0.8314696123025452), f82);
+    f85 = MUL_C(COEF_CONST(1.3870398453221475), f62);
+    f86 = f83 + f84;
+    f87 = f85 - f84;
+    f88 = f49 - f57;
+    f89 = f49 + f57;
+    f90 = f51 - f59;
+    f91 = f51 + f59;
+    f92 = f53 - f61;
+    f93 = f53 + f61;
+    f94 = f55 - f63;
+    f95 = f55 + f63;
+    f96 = f69 - f81;
+    f97 = f69 + f81;
+    f98 = f68 - f80;
+    f99 = f68 + f80;
+    f100 = f75 - f87;
+    f101 = f75 + f87;
+    f102 = f74 - f86;
+    f103 = f74 + f86;
+    f104 = f88 + f90;
+    f105 = MUL_C(COEF_CONST(1.3065629648763766), f88);
+    f106 = MUL_F(FRAC_CONST(-0.9238795325112866), f104);
+    f107 = MUL_F(FRAC_CONST(-0.5411961001461967), f90);
     f108 = f105 + f106;
     f109 = f107 - f106;
-    f110 = f90 - f103;
-    f111 = MUL_F(FRAC_CONST(-0.6666556584777466), f103);
-    f112 = MUL_F(FRAC_CONST(0.9569403357322089), f110);
-    f113 = MUL_C(COEF_CONST(1.2472250129866713), f90);
-    f114 = f112 - f111;
+    f110 = f92 + f94;
+    f111 = MUL_F(FRAC_CONST(0.5411961001461969), f92);
+    f112 = MUL_F(FRAC_CONST(0.3826834323650898), f110);
+    f113 = MUL_C(COEF_CONST(1.3065629648763766), f94);
+    f114 = f111 + f112;
     f115 = f113 - f112;
-    f116 = f102 + f89;
-    f117 = MUL_F(FRAC_CONST(-0.4105245275223571), f102);
-    f118 = MUL_F(FRAC_CONST(0.8819212643483549), f116);
-    f119 = MUL_C(COEF_CONST(1.3533180011743529), f89);
+    f116 = f96 + f98;
+    f117 = MUL_C(COEF_CONST(1.3065629648763766), f96);
+    f118 = MUL_F(FRAC_CONST(-0.9238795325112866), f116);
+    f119 = MUL_F(FRAC_CONST(-0.5411961001461967), f98);
     f120 = f117 + f118;
     f121 = f119 - f118;
-    f122 = f87 - f100;
-    f123 = MUL_F(FRAC_CONST(-0.1386171691990915), f100);
-    f124 = MUL_F(FRAC_CONST(0.7730104533627370), f122);
-    f125 = MUL_C(COEF_CONST(1.4074037375263826), f87);
-    f126 = f124 - f123;
+    f122 = f100 + f102;
+    f123 = MUL_F(FRAC_CONST(0.5411961001461969), f100);
+    f124 = MUL_F(FRAC_CONST(0.3826834323650898), f122);
+    f125 = MUL_C(COEF_CONST(1.3065629648763766), f102);
+    f126 = f123 + f124;
     f127 = f125 - f124;
-    f128 = f65 - f108;
-    f129 = f65 + f108;
-    f130 = f67 - f114;
-    f131 = f67 + f114;
-    f132 = f69 - f120;
-    f133 = f69 + f120;
-    f134 = f71 - f126;
-    f135 = f71 + f126;
-    f136 = f70 - f127;
-    f137 = f70 + f127;
-    f138 = f68 - f121;
-    f139 = f68 + f121;
-    f140 = f66 - f115;
-    f141 = f66 + f115;
-    f142 = f64 - f109;
-    f143 = f64 + f109;
-    f144 = f0 + f30;
-    f145 = MUL_C(COEF_CONST(1.0478631305325901), f0);
-    f146 = MUL_F(FRAC_CONST(-0.9987954562051724), f144);
-    f147 = MUL_F(FRAC_CONST(-0.9497277818777548), f30);
-    f148 = f145 + f146;
-    f149 = f147 - f146;
-    f150 = f4 + f26;
-    f151 = MUL_F(FRAC_CONST(1.2130114330978077), f4);
-    f152 = MUL_F(FRAC_CONST(-0.9700312531945440), f150);
-    f153 = MUL_F(FRAC_CONST(-0.7270510732912803), f26);
-    f154 = f151 + f152;
-    f155 = f153 - f152;
-    f156 = f8 + f22;
-    f157 = MUL_C(COEF_CONST(1.3315443865537255), f8);
-    f158 = MUL_F(FRAC_CONST(-0.9039892931234433), f156);
-    f159 = MUL_F(FRAC_CONST(-0.4764341996931612), f22);
-    f160 = f157 + f158;
-    f161 = f159 - f158;
-    f162 = f12 + f18;
-    f163 = MUL_C(COEF_CONST(1.3989068359730781), f12);
-    f164 = MUL_F(FRAC_CONST(-0.8032075314806453), f162);
-    f165 = MUL_F(FRAC_CONST(-0.2075082269882124), f18);
+    f128 = f89 - f93;
+    y[0] = f89 + f93;
+    f130 = f91 - f95;
+    y[15] = f91 + f95;
+    f132 = f109 - f115;
+    y[3] = f109 + f115;
+    f134 = f108 - f114;
+    y[12] = f108 + f114;
+    f136 = f97 - f101;
+    y[1] = f97 + f101;
+    f138 = f99 - f103;
+    y[14] = f99 + f103;
+    f140 = f121 - f127;
+    y[2] = f121 + f127;
+    f142 = f120 - f126;
+    y[13] = f120 + f126;
+    f144 = f128 - f130;
+    f145 = f128 + f130;
+    y[8] = MUL_F(FRAC_CONST(0.7071067811865474), f144);
+    y[7] = MUL_F(FRAC_CONST(0.7071067811865474), f145);
+    f148 = f132 - f134;
+    f149 = f132 + f134;
+    y[11] = MUL_F(FRAC_CONST(0.7071067811865474), f148);
+    y[4] = MUL_F(FRAC_CONST(0.7071067811865474), f149);
+    f152 = f136 - f138;
+    f153 = f136 + f138;
+    y[9] = MUL_F(FRAC_CONST(0.7071067811865474), f152);
+    y[6] = MUL_F(FRAC_CONST(0.7071067811865474), f153);
+    f156 = f140 - f142;
+    f157 = f140 + f142;
+    y[10] = MUL_F(FRAC_CONST(0.7071067811865474), f156);
+    y[5] = MUL_F(FRAC_CONST(0.7071067811865474), f157);
+}
+
+void DCT3_32_unscaled(real_t *y, real_t *x)
+{
+    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
+    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
+    real_t f21, f22, f23, f24, f25, f26, f27, f28, f29, f30;
+    real_t f31, f32, f33, f34, f35, f36, f37, f38, f39, f40;
+    real_t f41, f42, f43, f44, f45, f46, f47, f48, f49, f50;
+    real_t f51, f52, f53, f54, f55, f56, f57, f58, f59, f60;
+    real_t f61, f62, f63, f64, f65, f66, f67, f68, f69, f70;
+    real_t f71, f72, f73, f74, f75, f76, f77, f78, f79, f80;
+    real_t f81, f82, f83, f84, f85, f86, f87, f88, f89, f90;
+    real_t f91, f92, f93, f94, f95, f96, f97, f98, f99, f100;
+    real_t f101, f102, f103, f104, f105, f106, f107, f108, f109, f110;
+    real_t f111, f112, f113, f114, f115, f116, f117, f118, f119, f120;
+    real_t f121, f122, f123, f124, f125, f126, f127, f128, f129, f130;
+    real_t f131, f132, f133, f134, f135, f136, f137, f138, f139, f140;
+    real_t f141, f142, f143, f144, f145, f146, f147, f148, f149, f150;
+    real_t f151, f152, f153, f154, f155, f156, f157, f158, f159, f160;
+    real_t f161, f162, f163, f164, f165, f166, f167, f168, f169, f170;
+    real_t f171, f172, f173, f174, f175, f176, f177, f178, f179, f180;
+    real_t f181, f182, f183, f184, f185, f186, f187, f188, f189, f190;
+    real_t f191, f192, f193, f194, f195, f196, f197, f198, f199, f200;
+    real_t f201, f202, f203, f204, f205, f206, f207, f208, f209, f210;
+    real_t f211, f212, f213, f214, f215, f216, f217, f218, f219, f220;
+    real_t f221, f222, f223, f224, f225, f226, f227, f228, f229, f230;
+    real_t f231, f232, f233, f234, f235, f236, f237, f238, f239, f240;
+    real_t f241, f242, f243, f244, f245, f246, f247, f248, f249, f250;
+    real_t f251, f252, f253, f254, f255, f256, f257, f258, f259, f260;
+    real_t f261, f262, f263, f264, f265, f266, f267, f268, f269, f270;
+    real_t f271, f272;
+
+    f0 = MUL_F(x[16], FRAC_CONST(0.7071067811865476));
+    f1 = x[0] - f0;
+    f2 = x[0] + f0;
+    f3 = x[8] + x[24];
+    f4 = MUL_C(x[8], COEF_CONST(1.3065629648763766));
+    f5 = MUL_F(f3, FRAC_CONST((-0.9238795325112866)));
+    f6 = MUL_F(x[24], FRAC_CONST((-0.5411961001461967)));
+    f7 = f4 + f5;
+    f8 = f6 - f5;
+    f9 = f2 - f8;
+    f10 = f2 + f8;
+    f11 = f1 - f7;
+    f12 = f1 + f7;
+    f13 = x[4] + x[28];
+    f14 = MUL_C(x[4], COEF_CONST(1.1758756024193588));
+    f15 = MUL_F(f13, FRAC_CONST((-0.9807852804032304)));
+    f16 = MUL_F(x[28], FRAC_CONST((-0.7856949583871021)));
+    f17 = f14 + f15;
+    f18 = f16 - f15;
+    f19 = x[12] + x[20];
+    f20 = MUL_C(x[12], COEF_CONST(1.3870398453221473));
+    f21 = MUL_F(f19, FRAC_CONST((-0.8314696123025455)));
+    f22 = MUL_F(x[20], FRAC_CONST((-0.2758993792829436)));
+    f23 = f20 + f21;
+    f24 = f22 - f21;
+    f25 = f18 - f24;
+    f26 = f18 + f24;
+    f27 = MUL_F(f25, FRAC_CONST(0.7071067811865476));
+    f28 = f17 - f23;
+    f29 = f17 + f23;
+    f30 = MUL_F(f29, FRAC_CONST(0.7071067811865476));
+    f31 = f27 - f30;
+    f32 = f27 + f30;
+    f33 = f10 - f26;
+    f34 = f10 + f26;
+    f35 = f12 - f32;
+    f36 = f12 + f32;
+    f37 = f11 - f31;
+    f38 = f11 + f31;
+    f39 = f9 - f28;
+    f40 = f9 + f28;
+    f41 = x[2] + x[30];
+    f42 = MUL_C(x[2], COEF_CONST(1.0932018670017569));
+    f43 = MUL_F(f41, FRAC_CONST((-0.9951847266721969)));
+    f44 = MUL_F(x[30], FRAC_CONST((-0.8971675863426368)));
+    f45 = f42 + f43;
+    f46 = f44 - f43;
+    f47 = x[6] + x[26];
+    f48 = MUL_C(x[6], COEF_CONST(1.2472250129866711));
+    f49 = MUL_F(f47, FRAC_CONST((-0.9569403357322089)));
+    f50 = MUL_F(x[26], FRAC_CONST((-0.6666556584777469)));
+    f51 = f48 + f49;
+    f52 = f50 - f49;
+    f53 = x[10] + x[22];
+    f54 = MUL_C(x[10], COEF_CONST(1.3533180011743526));
+    f55 = MUL_F(f53, FRAC_CONST((-0.8819212643483551)));
+    f56 = MUL_F(x[22], FRAC_CONST((-0.4105245275223575)));
+    f57 = f54 + f55;
+    f58 = f56 - f55;
+    f59 = x[14] + x[18];
+    f60 = MUL_C(x[14], COEF_CONST(1.4074037375263826));
+    f61 = MUL_F(f59, FRAC_CONST((-0.7730104533627369)));
+    f62 = MUL_F(x[18], FRAC_CONST((-0.1386171691990913)));
+    f63 = f60 + f61;
+    f64 = f62 - f61;
+    f65 = f46 - f64;
+    f66 = f46 + f64;
+    f67 = f52 - f58;
+    f68 = f52 + f58;
+    f69 = f66 - f68;
+    f70 = f66 + f68;
+    f71 = MUL_F(f69, FRAC_CONST(0.7071067811865476));
+    f72 = f65 + f67;
+    f73 = MUL_C(f65, COEF_CONST(1.3065629648763766));
+    f74 = MUL_F(f72, FRAC_CONST((-0.9238795325112866)));
+    f75 = MUL_F(f67, FRAC_CONST((-0.5411961001461967)));
+    f76 = f73 + f74;
+    f77 = f75 - f74;
+    f78 = f45 - f63;
+    f79 = f45 + f63;
+    f80 = f51 - f57;
+    f81 = f51 + f57;
+    f82 = f79 + f81;
+    f83 = MUL_C(f79, COEF_CONST(1.3065629648763770));
+    f84 = MUL_F(f82, FRAC_CONST((-0.3826834323650904)));
+    f85 = MUL_F(f81, FRAC_CONST(0.5411961001461961));
+    f86 = f83 + f84;
+    f87 = f85 - f84;
+    f88 = f78 - f80;
+    f89 = f78 + f80;
+    f90 = MUL_F(f89, FRAC_CONST(0.7071067811865476));
+    f91 = f77 - f87;
+    f92 = f77 + f87;
+    f93 = f71 - f90;
+    f94 = f71 + f90;
+    f95 = f76 - f86;
+    f96 = f76 + f86;
+    f97 = f34 - f70;
+    f98 = f34 + f70;
+    f99 = f36 - f92;
+    f100 = f36 + f92;
+    f101 = f38 - f91;
+    f102 = f38 + f91;
+    f103 = f40 - f94;
+    f104 = f40 + f94;
+    f105 = f39 - f93;
+    f106 = f39 + f93;
+    f107 = f37 - f96;
+    f108 = f37 + f96;
+    f109 = f35 - f95;
+    f110 = f35 + f95;
+    f111 = f33 - f88;
+    f112 = f33 + f88;
+    f113 = x[1] + x[31];
+    f114 = MUL_C(x[1], COEF_CONST(1.0478631305325901));
+    f115 = MUL_F(f113, FRAC_CONST((-0.9987954562051724)));
+    f116 = MUL_F(x[31], FRAC_CONST((-0.9497277818777548)));
+    f117 = f114 + f115;
+    f118 = f116 - f115;
+    f119 = x[5] + x[27];
+    f120 = MUL_C(x[5], COEF_CONST(1.2130114330978077));
+    f121 = MUL_F(f119, FRAC_CONST((-0.9700312531945440)));
+    f122 = MUL_F(x[27], FRAC_CONST((-0.7270510732912803)));
+    f123 = f120 + f121;
+    f124 = f122 - f121;
+    f125 = x[9] + x[23];
+    f126 = MUL_C(x[9], COEF_CONST(1.3315443865537255));
+    f127 = MUL_F(f125, FRAC_CONST((-0.9039892931234433)));
+    f128 = MUL_F(x[23], FRAC_CONST((-0.4764341996931612)));
+    f129 = f126 + f127;
+    f130 = f128 - f127;
+    f131 = x[13] + x[19];
+    f132 = MUL_C(x[13], COEF_CONST(1.3989068359730781));
+    f133 = MUL_F(f131, FRAC_CONST((-0.8032075314806453)));
+    f134 = MUL_F(x[19], FRAC_CONST((-0.2075082269882124)));
+    f135 = f132 + f133;
+    f136 = f134 - f133;
+    f137 = x[17] + x[15];
+    f138 = MUL_C(x[17], COEF_CONST(1.4125100802019777));
+    f139 = MUL_F(f137, FRAC_CONST((-0.6715589548470187)));
+    f140 = MUL_F(x[15], FRAC_CONST(0.0693921705079402));
+    f141 = f138 + f139;
+    f142 = f140 - f139;
+    f143 = x[21] + x[11];
+    f144 = MUL_C(x[21], COEF_CONST(1.3718313541934939));
+    f145 = MUL_F(f143, FRAC_CONST((-0.5141027441932219)));
+    f146 = MUL_F(x[11], FRAC_CONST(0.3436258658070501));
+    f147 = f144 + f145;
+    f148 = f146 - f145;
+    f149 = x[25] + x[7];
+    f150 = MUL_C(x[25], COEF_CONST(1.2784339185752409));
+    f151 = MUL_F(f149, FRAC_CONST((-0.3368898533922200)));
+    f152 = MUL_F(x[7], FRAC_CONST(0.6046542117908008));
+    f153 = f150 + f151;
+    f154 = f152 - f151;
+    f155 = x[29] + x[3];
+    f156 = MUL_C(x[29], COEF_CONST(1.1359069844201433));
+    f157 = MUL_F(f155, FRAC_CONST((-0.1467304744553624)));
+    f158 = MUL_F(x[3], FRAC_CONST(0.8424460355094185));
+    f159 = f156 + f157;
+    f160 = f158 - f157;
+    f161 = f118 - f142;
+    f162 = f118 + f142;
+    f163 = f117 - f141;
+    f164 = f117 + f141;
+    f165 = f124 - f148;
+    f166 = f124 + f148;
+    f167 = f123 - f147;
+    f168 = f123 + f147;
+    f169 = f130 - f154;
+    f170 = f130 + f154;
+    f171 = f129 - f153;
+    f172 = f129 + f153;
+    f173 = f136 - f160;
+    f174 = f136 + f160;
+    f175 = f135 - f159;
+    f176 = f135 + f159;
+    f177 = f161 + f163;
+    f178 = MUL_C(f161, COEF_CONST(1.1758756024193588));
+    f179 = MUL_F(f177, FRAC_CONST((-0.9807852804032304)));
+    f180 = MUL_F(f163, FRAC_CONST((-0.7856949583871021)));
+    f181 = f178 + f179;
+    f182 = f180 - f179;
+    f183 = f165 + f167;
+    f184 = MUL_C(f165, COEF_CONST(1.3870398453221475));
+    f185 = MUL_F(f183, FRAC_CONST((-0.5555702330196022)));
+    f186 = MUL_F(f167, FRAC_CONST(0.2758993792829431));
+    f187 = f184 + f185;
+    f188 = f186 - f185;
+    f189 = f169 + f171;
+    f190 = MUL_F(f169, FRAC_CONST(0.7856949583871022));
+    f191 = MUL_F(f189, FRAC_CONST(0.1950903220161283));
+    f192 = MUL_C(f171, COEF_CONST(1.1758756024193586));
+    f193 = f190 + f191;
+    f194 = f192 - f191;
+    f195 = f173 + f175;
+    f196 = MUL_F(f173, FRAC_CONST((-0.2758993792829430)));
+    f197 = MUL_F(f195, FRAC_CONST(0.8314696123025452));
+    f198 = MUL_C(f175, COEF_CONST(1.3870398453221475));
+    f199 = f196 + f197;
+    f200 = f198 - f197;
+    f201 = f162 - f170;
+    f202 = f162 + f170;
+    f203 = f164 - f172;
+    f204 = f164 + f172;
+    f205 = f166 - f174;
+    f206 = f166 + f174;
+    f207 = f168 - f176;
+    f208 = f168 + f176;
+    f209 = f182 - f194;
+    f210 = f182 + f194;
+    f211 = f181 - f193;
+    f212 = f181 + f193;
+    f213 = f188 - f200;
+    f214 = f188 + f200;
+    f215 = f187 - f199;
+    f216 = f187 + f199;
+    f217 = f201 + f203;
+    f218 = MUL_C(f201, COEF_CONST(1.3065629648763766));
+    f219 = MUL_F(f217, FRAC_CONST((-0.9238795325112866)));
+    f220 = MUL_F(f203, FRAC_CONST((-0.5411961001461967)));
+    f221 = f218 + f219;
+    f222 = f220 - f219;
+    f223 = f205 + f207;
+    f224 = MUL_F(f205, FRAC_CONST(0.5411961001461969));
+    f225 = MUL_F(f223, FRAC_CONST(0.3826834323650898));
+    f226 = MUL_C(f207, COEF_CONST(1.3065629648763766));
+    f227 = f224 + f225;
+    f228 = f226 - f225;
+    f229 = f209 + f211;
+    f230 = MUL_C(f209, COEF_CONST(1.3065629648763766));
+    f231 = MUL_F(f229, FRAC_CONST((-0.9238795325112866)));
+    f232 = MUL_F(f211, FRAC_CONST((-0.5411961001461967)));
+    f233 = f230 + f231;
+    f234 = f232 - f231;
+    f235 = f213 + f215;
+    f236 = MUL_F(f213, FRAC_CONST(0.5411961001461969));
+    f237 = MUL_F(f235, FRAC_CONST(0.3826834323650898));
+    f238 = MUL_C(f215, COEF_CONST(1.3065629648763766));
+    f239 = f236 + f237;
+    f240 = f238 - f237;
+    f241 = f202 - f206;
+    f242 = f202 + f206;
+    f243 = f204 - f208;
+    f244 = f204 + f208;
+    f245 = f222 - f228;
+    f246 = f222 + f228;
+    f247 = f221 - f227;
+    f248 = f221 + f227;
+    f249 = f210 - f214;
+    f250 = f210 + f214;
+    f251 = f212 - f216;
+    f252 = f212 + f216;
+    f253 = f234 - f240;
+    f254 = f234 + f240;
+    f255 = f233 - f239;
+    f256 = f233 + f239;
+    f257 = f241 - f243;
+    f258 = f241 + f243;
+    f259 = MUL_F(f257, FRAC_CONST(0.7071067811865474));
+    f260 = MUL_F(f258, FRAC_CONST(0.7071067811865474));
+    f261 = f245 - f247;
+    f262 = f245 + f247;
+    f263 = MUL_F(f261, FRAC_CONST(0.7071067811865474));
+    f264 = MUL_F(f262, FRAC_CONST(0.7071067811865474));
+    f265 = f249 - f251;
+    f266 = f249 + f251;
+    f267 = MUL_F(f265, FRAC_CONST(0.7071067811865474));
+    f268 = MUL_F(f266, FRAC_CONST(0.7071067811865474));
+    f269 = f253 - f255;
+    f270 = f253 + f255;
+    f271 = MUL_F(f269, FRAC_CONST(0.7071067811865474));
+    f272 = MUL_F(f270, FRAC_CONST(0.7071067811865474));
+    y[31] = f98 - f242;
+    y[0] = f98 + f242;
+    y[30] = f100 - f250;
+    y[1] = f100 + f250;
+    y[29] = f102 - f254;
+    y[2] = f102 + f254;
+    y[28] = f104 - f246;
+    y[3] = f104 + f246;
+    y[27] = f106 - f264;
+    y[4] = f106 + f264;
+    y[26] = f108 - f272;
+    y[5] = f108 + f272;
+    y[25] = f110 - f268;
+    y[6] = f110 + f268;
+    y[24] = f112 - f260;
+    y[7] = f112 + f260;
+    y[23] = f111 - f259;
+    y[8] = f111 + f259;
+    y[22] = f109 - f267;
+    y[9] = f109 + f267;
+    y[21] = f107 - f271;
+    y[10] = f107 + f271;
+    y[20] = f105 - f263;
+    y[11] = f105 + f263;
+    y[19] = f103 - f248;
+    y[12] = f103 + f248;
+    y[18] = f101 - f256;
+    y[13] = f101 + f256;
+    y[17] = f99 - f252;
+    y[14] = f99 + f252;
+    y[16] = f97 - f244;
+    y[15] = f97 + f244;
+}
+
+void DCT2_32_unscaled(real_t *y, real_t *x)
+{
+    real_t f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10;
+    real_t f11, f12, f13, f14, f15, f16, f17, f18, f19, f20;
+    real_t f21, f22, f23, f24, f25, f26, f27, f28, f29, f30;
+    real_t f31, f32, f33, f34, f35, f36, f37, f38, f39, f40;
+    real_t f41, f42, f43, f44, f45, f46, f47, f48, f49, f50;
+    real_t f51, f52, f53, f54, f55, f56, f57, f58, f59, f60;
+    real_t f63, f64, f65, f66, f69, f70, f71, f72, f73, f74;
+    real_t f75, f76, f77, f78, f79, f80, f81, f83, f85, f86;
+    real_t f89, f90, f91, f92, f93, f94, f95, f96, f97, f98;
+    real_t f99, f100, f101, f102, f103, f104, f105, f106, f107, f108;
+    real_t f109, f110, f111, f112, f113, f114, f115, f116, f117, f118;
+    real_t f119, f120, f121, f122, f123, f124, f127, f128, f129, f130;
+    real_t f133, f134, f135, f136, f139, f140, f141, f142, f145, f146;
+    real_t f147, f148, f149, f150, f151, f152, f153, f154, f155, f156;
+    real_t f157, f158, f159, f160, f161, f162, f163, f164, f165, f166;
+    real_t f167, f168, f169, f170, f171, f172, f173, f174, f175, f176;
+    real_t f177, f178, f179, f180, f181, f182, f183, f184, f185, f186;
+    real_t f187, f188, f189, f190, f191, f192, f193, f194, f195, f196;
+    real_t f197, f198, f199, f200, f201, f202, f203, f204, f205, f206;
+    real_t f207, f208, f209, f210, f211, f212, f213, f214, f215, f216;
+    real_t f217, f218, f219, f220, f221, f222, f223, f224, f225, f226;
+    real_t f227, f228, f229, f230, f231, f232, f233, f234, f235, f236;
+    real_t f237, f238, f239, f240, f241, f242, f243, f244, f247, f248;
+    real_t f249, f250, f253, f254, f255, f256, f259, f260, f261, f262;
+    real_t f265, f266, f267, f268, f271, f272, f273, f274, f277, f278;
+    real_t f279, f280, f283, f284, f285, f286;
+
+    f0 = x[0] - x[31];
+    f1 = x[0] + x[31];
+    f2 = x[1] - x[30];
+    f3 = x[1] + x[30];
+    f4 = x[2] - x[29];
+    f5 = x[2] + x[29];
+    f6 = x[3] - x[28];
+    f7 = x[3] + x[28];
+    f8 = x[4] - x[27];
+    f9 = x[4] + x[27];
+    f10 = x[5] - x[26];
+    f11 = x[5] + x[26];
+    f12 = x[6] - x[25];
+    f13 = x[6] + x[25];
+    f14 = x[7] - x[24];
+    f15 = x[7] + x[24];
+    f16 = x[8] - x[23];
+    f17 = x[8] + x[23];
+    f18 = x[9] - x[22];
+    f19 = x[9] + x[22];
+    f20 = x[10] - x[21];
+    f21 = x[10] + x[21];
+    f22 = x[11] - x[20];
+    f23 = x[11] + x[20];
+    f24 = x[12] - x[19];
+    f25 = x[12] + x[19];
+    f26 = x[13] - x[18];
+    f27 = x[13] + x[18];
+    f28 = x[14] - x[17];
+    f29 = x[14] + x[17];
+    f30 = x[15] - x[16];
+    f31 = x[15] + x[16];
+    f32 = f1 - f31;
+    f33 = f1 + f31;
+    f34 = f3 - f29;
+    f35 = f3 + f29;
+    f36 = f5 - f27;
+    f37 = f5 + f27;
+    f38 = f7 - f25;
+    f39 = f7 + f25;
+    f40 = f9 - f23;
+    f41 = f9 + f23;
+    f42 = f11 - f21;
+    f43 = f11 + f21;
+    f44 = f13 - f19;
+    f45 = f13 + f19;
+    f46 = f15 - f17;
+    f47 = f15 + f17;
+    f48 = f33 - f47;
+    f49 = f33 + f47;
+    f50 = f35 - f45;
+    f51 = f35 + f45;
+    f52 = f37 - f43;
+    f53 = f37 + f43;
+    f54 = f39 - f41;
+    f55 = f39 + f41;
+    f56 = f49 - f55;
+    f57 = f49 + f55;
+    f58 = f51 - f53;
+    f59 = f51 + f53;
+    f60 = f57 - f59;
+    y[0] = f57 + f59;
+    y[16] = MUL_F(FRAC_CONST(0.7071067811865476), f60);
+    f63 = f56 + f58;
+    f64 = MUL_C(COEF_CONST(1.3065629648763766), f56);
+    f65 = MUL_F(FRAC_CONST(-0.9238795325112866), f63);
+    f66 = MUL_F(FRAC_CONST(-0.5411961001461967), f58);
+    y[24] = f64 + f65;
+    y[8] = f66 - f65;
+    f69 = f48 + f54;
+    f70 = MUL_C(COEF_CONST(1.1758756024193588), f48);
+    f71 = MUL_F(FRAC_CONST(-0.9807852804032304), f69);
+    f72 = MUL_F(FRAC_CONST(-0.7856949583871021), f54);
+    f73 = f70 + f71;
+    f74 = f72 - f71;
+    f75 = f50 + f52;
+    f76 = MUL_C(COEF_CONST(1.3870398453221473), f50);
+    f77 = MUL_F(FRAC_CONST(-0.8314696123025455), f75);
+    f78 = MUL_F(FRAC_CONST(-0.2758993792829436), f52);
+    f79 = f76 + f77;
+    f80 = f78 - f77;
+    f81 = f74 - f80;
+    y[4] = f74 + f80;
+    f83 = MUL_F(FRAC_CONST(0.7071067811865476), f81);
+    y[28] = f73 - f79;
+    f85 = f73 + f79;
+    f86 = MUL_F(FRAC_CONST(0.7071067811865476), f85);
+    y[20] = f83 - f86;
+    y[12] = f83 + f86;
+    f89 = f34 - f36;
+    f90 = f34 + f36;
+    f91 = f38 - f40;
+    f92 = f38 + f40;
+    f93 = f42 - f44;
+    f94 = f42 + f44;
+    f95 = MUL_F(FRAC_CONST(0.7071067811865476), f92);
+    f96 = f32 - f95;
+    f97 = f32 + f95;
+    f98 = f90 + f94;
+    f99 = MUL_C(COEF_CONST(1.3065629648763766), f90);
+    f100 = MUL_F(FRAC_CONST(-0.9238795325112866), f98);
+    f101 = MUL_F(FRAC_CONST(-0.5411961001461967), f94);
+    f102 = f99 + f100;
+    f103 = f101 - f100;
+    f104 = f97 - f103;
+    f105 = f97 + f103;
+    f106 = f96 - f102;
+    f107 = f96 + f102;
+    f108 = MUL_F(FRAC_CONST(0.7071067811865476), f91);
+    f109 = f46 - f108;
+    f110 = f46 + f108;
+    f111 = f93 + f89;
+    f112 = MUL_C(COEF_CONST(1.3065629648763766), f93);
+    f113 = MUL_F(FRAC_CONST(-0.9238795325112866), f111);
+    f114 = MUL_F(FRAC_CONST(-0.5411961001461967), f89);
+    f115 = f112 + f113;
+    f116 = f114 - f113;
+    f117 = f110 - f116;
+    f118 = f110 + f116;
+    f119 = f109 - f115;
+    f120 = f109 + f115;
+    f121 = f118 + f105;
+    f122 = MUL_F(FRAC_CONST(-0.8971675863426361), f118);
+    f123 = MUL_F(FRAC_CONST(0.9951847266721968), f121);
+    f124 = MUL_C(COEF_CONST(1.0932018670017576), f105);
+    y[2] = f122 + f123;
+    y[30] = f124 - f123;
+    f127 = f107 - f120;
+    f128 = MUL_F(FRAC_CONST(-0.6666556584777466), f120);
+    f129 = MUL_F(FRAC_CONST(0.9569403357322089), f127);
+    f130 = MUL_C(COEF_CONST(1.2472250129866713), f107);
+    y[6] = f129 - f128;
+    y[26] = f130 - f129;
+    f133 = f119 + f106;
+    f134 = MUL_F(FRAC_CONST(-0.4105245275223571), f119);
+    f135 = MUL_F(FRAC_CONST(0.8819212643483549), f133);
+    f136 = MUL_C(COEF_CONST(1.3533180011743529), f106);
+    y[10] = f134 + f135;
+    y[22] = f136 - f135;
+    f139 = f104 - f117;
+    f140 = MUL_F(FRAC_CONST(-0.1386171691990915), f117);
+    f141 = MUL_F(FRAC_CONST(0.7730104533627370), f139);
+    f142 = MUL_C(COEF_CONST(1.4074037375263826), f104);
+    y[14] = f141 - f140;
+    y[18] = f142 - f141;
+    f145 = f2 - f4;
+    f146 = f2 + f4;
+    f147 = f6 - f8;
+    f148 = f6 + f8;
+    f149 = f10 - f12;
+    f150 = f10 + f12;
+    f151 = f14 - f16;
+    f152 = f14 + f16;
+    f153 = f18 - f20;
+    f154 = f18 + f20;
+    f155 = f22 - f24;
+    f156 = f22 + f24;
+    f157 = f26 - f28;
+    f158 = f26 + f28;
+    f159 = MUL_F(FRAC_CONST(0.7071067811865476), f152);
+    f160 = f0 - f159;
+    f161 = f0 + f159;
+    f162 = f148 + f156;
+    f163 = MUL_C(COEF_CONST(1.3065629648763766), f148);
+    f164 = MUL_F(FRAC_CONST(-0.9238795325112866), f162);
+    f165 = MUL_F(FRAC_CONST(-0.5411961001461967), f156);
     f166 = f163 + f164;
     f167 = f165 - f164;
-    f168 = f16 + f14;
-    f169 = MUL_C(COEF_CONST(1.4125100802019777), f16);
-    f170 = MUL_F(FRAC_CONST(-0.6715589548470187), f168);
-    f171 = MUL_F(FRAC_CONST(0.0693921705079402), f14);
-    f172 = f169 + f170;
-    f173 = f171 - f170;
-    f174 = f20 + f10;
-    f175 = MUL_C(COEF_CONST(1.3718313541934939), f20);
-    f176 = MUL_F(FRAC_CONST(-0.5141027441932219), f174);
-    f177 = MUL_F(FRAC_CONST(0.3436258658070501), f10);
-    f178 = f175 + f176;
-    f179 = f177 - f176;
-    f180 = f24 + f6;
-    f181 = MUL_C(COEF_CONST(1.2784339185752409), f24);
-    f182 = MUL_F(FRAC_CONST(-0.3368898533922200), f180);
-    f183 = MUL_F(FRAC_CONST(0.6046542117908008), f6);
-    f184 = f181 + f182;
-    f185 = f183 - f182;
-    f186 = f28 + f2;
-    f187 = MUL_C(COEF_CONST(1.1359069844201433), f28);
-    f188 = MUL_F(FRAC_CONST(-0.1467304744553624), f186);
-    f189 = MUL_F(FRAC_CONST(0.8424460355094185), f2);
-    f190 = f187 + f188;
-    f191 = f189 - f188;
-    f192 = f149 - f173;
-    f193 = f149 + f173;
-    f194 = f148 - f172;
-    f195 = f148 + f172;
-    f196 = f155 - f179;
-    f197 = f155 + f179;
-    f198 = f154 - f178;
-    f199 = f154 + f178;
-    f200 = f161 - f185;
-    f201 = f161 + f185;
-    f202 = f160 - f184;
-    f203 = f160 + f184;
-    f204 = f167 - f191;
-    f205 = f167 + f191;
-    f206 = f166 - f190;
-    f207 = f166 + f190;
-    f208 = f192 + f194;
-    f209 = MUL_C(COEF_CONST(1.1758756024193588), f192);
-    f210 = MUL_F(FRAC_CONST(-0.9807852804032304), f208);
-    f211 = MUL_F(FRAC_CONST(-0.7856949583871021), f194);
-    f212 = f209 + f210;
-    f213 = f211 - f210;
-    f214 = f196 + f198;
-    f215 = MUL_C(COEF_CONST(1.3870398453221475), f196);
-    f216 = MUL_F(FRAC_CONST(-0.5555702330196022), f214);
-    f217 = MUL_F(FRAC_CONST(0.2758993792829431), f198);
-    f218 = f215 + f216;
-    f219 = f217 - f216;
-    f220 = f200 + f202;
-    f221 = MUL_F(FRAC_CONST(0.7856949583871022), f200);
-    f222 = MUL_F(FRAC_CONST(0.1950903220161283), f220);
-    f223 = MUL_C(COEF_CONST(1.1758756024193586), f202);
-    f224 = f221 + f222;
-    f225 = f223 - f222;
-    f226 = f204 + f206;
-    f227 = MUL_F(FRAC_CONST(-0.2758993792829430), f204);
-    f228 = MUL_F(FRAC_CONST(0.8314696123025452), f226);
-    f229 = MUL_C(COEF_CONST(1.3870398453221475), f206);
-    f230 = f227 + f228;
-    f231 = f229 - f228;
-    f232 = f193 - f201;
-    f233 = f193 + f201;
-    f234 = f195 - f203;
-    f235 = f195 + f203;
-    f236 = f197 - f205;
-    f237 = f197 + f205;
-    f238 = f199 - f207;
-    f239 = f199 + f207;
-    f240 = f213 - f225;
-    f241 = f213 + f225;
-    f242 = f212 - f224;
-    f243 = f212 + f224;
-    f244 = f219 - f231;
-    f245 = f219 + f231;
-    f246 = f218 - f230;
-    f247 = f218 + f230;
-    f248 = f232 + f234;
-    f249 = MUL_C(COEF_CONST(1.3065629648763766), f232);
-    f250 = MUL_F(FRAC_CONST(-0.9238795325112866), f248);
-    f251 = MUL_F(FRAC_CONST(-0.5411961001461967), f234);
-    f252 = f249 + f250;
-    f253 = f251 - f250;
-    f254 = f236 + f238;
-    f255 = MUL_F(FRAC_CONST(0.5411961001461969), f236);
-    f256 = MUL_F(FRAC_CONST(0.3826834323650898), f254);
-    f257 = MUL_C(COEF_CONST(1.3065629648763766), f238);
-    f258 = f255 + f256;
-    f259 = f257 - f256;
-    f260 = f240 + f242;
-    f261 = MUL_C(COEF_CONST(1.3065629648763766), f240);
-    f262 = MUL_F(FRAC_CONST(-0.9238795325112866), f260);
-    f263 = MUL_F(FRAC_CONST(-0.5411961001461967), f242);
-    f264 = f261 + f262;
-    f265 = f263 - f262;
-    f266 = f244 + f246;
-    f267 = MUL_F(FRAC_CONST(0.5411961001461969), f244);
-    f268 = MUL_F(FRAC_CONST(0.3826834323650898), f266);
-    f269 = MUL_C(COEF_CONST(1.3065629648763766), f246);
-    f270 = f267 + f268;
-    f271 = f269 - f268;
-    f272 = f233 - f237;
-    f273 = f233 + f237;
-    f274 = f235 - f239;
-    f275 = f235 + f239;
-    f276 = f253 - f259;
-    f277 = f253 + f259;
-    f278 = f252 - f258;
-    f279 = f252 + f258;
-    f280 = f241 - f245;
-    f281 = f241 + f245;
-    f282 = f243 - f247;
-    f283 = f243 + f247;
-    f284 = f265 - f271;
-    f285 = f265 + f271;
-    f286 = f264 - f270;
-    f287 = f264 + f270;
-    f288 = f272 - f274;
-    f289 = f272 + f274;
-    f290 = MUL_F(FRAC_CONST(0.7071067811865474), f288);
-    f291 = MUL_F(FRAC_CONST(0.7071067811865474), f289);
-    f292 = f276 - f278;
-    f293 = f276 + f278;
-    f294 = MUL_F(FRAC_CONST(0.7071067811865474), f292);
-    f295 = MUL_F(FRAC_CONST(0.7071067811865474), f293);
-    f296 = f280 - f282;
-    f297 = f280 + f282;
-    f298 = MUL_F(FRAC_CONST(0.7071067811865474), f296);
-    f299 = MUL_F(FRAC_CONST(0.7071067811865474), f297);
-    f300 = f284 - f286;
-    f301 = f284 + f286;
-    f302 = MUL_F(FRAC_CONST(0.7071067811865474), f300);
-    f303 = MUL_F(FRAC_CONST(0.7071067811865474), f301);
-    f304 = f129 - f273;
-    f305 = f129 + f273;
-    f306 = f131 - f281;
-    f307 = f131 + f281;
-    f308 = f133 - f285;
-    f309 = f133 + f285;
-    f310 = f135 - f277;
-    f311 = f135 + f277;
-    f312 = f137 - f295;
-    f313 = f137 + f295;
-    f314 = f139 - f303;
-    f315 = f139 + f303;
-    f316 = f141 - f299;
-    f317 = f141 + f299;
-    f318 = f143 - f291;
-    f319 = f143 + f291;
-    f320 = f142 - f290;
-    f321 = f142 + f290;
-    f322 = f140 - f298;
-    f323 = f140 + f298;
-    f324 = f138 - f302;
-    f325 = f138 + f302;
-    f326 = f136 - f294;
-    f327 = f136 + f294;
-    f328 = f134 - f279;
-    f329 = f134 + f279;
-    f330 = f132 - f287;
-    f331 = f132 + f287;
-    f332 = f130 - f283;
-    f333 = f130 + f283;
-    f334 = f128 - f275;
-    f335 = f128 + f275;
-    y[31] = MUL_F(FRAC_CONST(0.5001506360206510), f305);
-    y[30] = MUL_F(FRAC_CONST(0.5013584524464084), f307);
-    y[29] = MUL_F(FRAC_CONST(0.5037887256810443), f309);
-    y[28] = MUL_F(FRAC_CONST(0.5074711720725553), f311);
-    y[27] = MUL_F(FRAC_CONST(0.5124514794082247), f313);
-    y[26] = MUL_F(FRAC_CONST(0.5187927131053328), f315);
-    y[25] = MUL_F(FRAC_CONST(0.5265773151542700), f317);
-    y[24] = MUL_F(FRAC_CONST(0.5359098169079920), f319);
-    y[23] = MUL_F(FRAC_CONST(0.5469204379855088), f321);
-    y[22] = MUL_F(FRAC_CONST(0.5597698129470802), f323);
-    y[21] = MUL_F(FRAC_CONST(0.5746551840326600), f325);
-    y[20] = MUL_F(FRAC_CONST(0.5918185358574165), f327);
-    y[19] = MUL_F(FRAC_CONST(0.6115573478825099), f329);
-    y[18] = MUL_F(FRAC_CONST(0.6342389366884031), f331);
-    y[17] = MUL_F(FRAC_CONST(0.6603198078137061), f333);
-    y[16] = MUL_F(FRAC_CONST(0.6903721282002123), f335);
-    y[15] = MUL_F(FRAC_CONST(0.7251205223771985), f334);
-    y[14] = MUL_F(FRAC_CONST(0.7654941649730891), f332);
-    y[13] = MUL_F(FRAC_CONST(0.8127020908144905), f330);
-    y[12] = MUL_F(FRAC_CONST(0.8683447152233481), f328);
-    y[11] = MUL_F(FRAC_CONST(0.9345835970364075), f326);
-    y[10] = MUL_C(COEF_CONST(1.0144082649970547), f324);
-    y[9] = MUL_C(COEF_CONST(1.1120716205797176), f322);
-    y[8] = MUL_C(COEF_CONST(1.2338327379765710), f320);
-    y[7] = MUL_C(COEF_CONST(1.3892939586328277), f318);
-    y[6] = MUL_C(COEF_CONST(1.5939722833856311), f316);
-    y[5] = MUL_C(COEF_CONST(1.8746759800084078), f314);
-    y[4] = MUL_C(COEF_CONST(2.2820500680051619), f312);
-    y[3] = MUL_C(COEF_CONST(2.9246284281582162), f310);
-    y[2] = MUL_C(COEF_CONST(4.0846110781292477), f308);
-    y[1] = MUL_C(COEF_CONST(6.7967507116736332), f306);
-    y[0] = MUL_R(REAL_CONST(20.3738781672314530), f304);
+    f168 = f161 - f167;
+    f169 = f161 + f167;
+    f170 = f160 - f166;
+    f171 = f160 + f166;
+    f172 = f146 + f158;
+    f173 = MUL_C(COEF_CONST(1.1758756024193588), f146);
+    f174 = MUL_F(FRAC_CONST(-0.9807852804032304), f172);
+    f175 = MUL_F(FRAC_CONST(-0.7856949583871021), f158);
+    f176 = f173 + f174;
+    f177 = f175 - f174;
+    f178 = f150 + f154;
+    f179 = MUL_C(COEF_CONST(1.3870398453221473), f150);
+    f180 = MUL_F(FRAC_CONST(-0.8314696123025455), f178);
+    f181 = MUL_F(FRAC_CONST(-0.2758993792829436), f154);
+    f182 = f179 + f180;
+    f183 = f181 - f180;
+    f184 = f177 - f183;
+    f185 = f177 + f183;
+    f186 = MUL_F(FRAC_CONST(0.7071067811865476), f184);
+    f187 = f176 - f182;
+    f188 = f176 + f182;
+    f189 = MUL_F(FRAC_CONST(0.7071067811865476), f188);
+    f190 = f186 - f189;
+    f191 = f186 + f189;
+    f192 = f169 - f185;
+    f193 = f169 + f185;
+    f194 = f171 - f191;
+    f195 = f171 + f191;
+    f196 = f170 - f190;
+    f197 = f170 + f190;
+    f198 = f168 - f187;
+    f199 = f168 + f187;
+    f200 = MUL_F(FRAC_CONST(0.7071067811865476), f151);
+    f201 = f30 - f200;
+    f202 = f30 + f200;
+    f203 = f155 + f147;
+    f204 = MUL_C(COEF_CONST(1.3065629648763766), f155);
+    f205 = MUL_F(FRAC_CONST(-0.9238795325112866), f203);
+    f206 = MUL_F(FRAC_CONST(-0.5411961001461967), f147);
+    f207 = f204 + f205;
+    f208 = f206 - f205;
+    f209 = f202 - f208;
+    f210 = f202 + f208;
+    f211 = f201 - f207;
+    f212 = f201 + f207;
+    f213 = f157 + f145;
+    f214 = MUL_C(COEF_CONST(1.1758756024193588), f157);
+    f215 = MUL_F(FRAC_CONST(-0.9807852804032304), f213);
+    f216 = MUL_F(FRAC_CONST(-0.7856949583871021), f145);
+    f217 = f214 + f215;
+    f218 = f216 - f215;
+    f219 = f153 + f149;
+    f220 = MUL_C(COEF_CONST(1.3870398453221473), f153);
+    f221 = MUL_F(FRAC_CONST(-0.8314696123025455), f219);
+    f222 = MUL_F(FRAC_CONST(-0.2758993792829436), f149);
+    f223 = f220 + f221;
+    f224 = f222 - f221;
+    f225 = f218 - f224;
+    f226 = f218 + f224;
+    f227 = MUL_F(FRAC_CONST(0.7071067811865476), f225);
+    f228 = f217 - f223;
+    f229 = f217 + f223;
+    f230 = MUL_F(FRAC_CONST(0.7071067811865476), f229);
+    f231 = f227 - f230;
+    f232 = f227 + f230;
+    f233 = f210 - f226;
+    f234 = f210 + f226;
+    f235 = f212 - f232;
+    f236 = f212 + f232;
+    f237 = f211 - f231;
+    f238 = f211 + f231;
+    f239 = f209 - f228;
+    f240 = f209 + f228;
+    f241 = f234 + f193;
+    f242 = MUL_F(FRAC_CONST(-0.9497277818777543), f234);
+    f243 = MUL_F(FRAC_CONST(0.9987954562051724), f241);
+    f244 = MUL_C(COEF_CONST(1.0478631305325905), f193);
+    y[1] = f242 + f243;
+    y[31] = f244 - f243;
+    f247 = f195 - f236;
+    f248 = MUL_F(FRAC_CONST(-0.8424460355094192), f236);
+    f249 = MUL_F(FRAC_CONST(0.9891765099647810), f247);
+    f250 = MUL_C(COEF_CONST(1.1359069844201428), f195);
+    y[3] = f249 - f248;
+    y[29] = f250 - f249;
+    f253 = f238 + f197;
+    f254 = MUL_F(FRAC_CONST(-0.7270510732912801), f238);
+    f255 = MUL_F(FRAC_CONST(0.9700312531945440), f253);
+    f256 = MUL_C(COEF_CONST(1.2130114330978079), f197);
+    y[5] = f254 + f255;
+    y[27] = f256 - f255;
+    f259 = f199 - f240;
+    f260 = MUL_F(FRAC_CONST(-0.6046542117908007), f240);
+    f261 = MUL_F(FRAC_CONST(0.9415440651830208), f259);
+    f262 = MUL_C(COEF_CONST(1.2784339185752409), f199);
+    y[7] = f261 - f260;
+    y[25] = f262 - f261;
+    f265 = f239 + f198;
+    f266 = MUL_F(FRAC_CONST(-0.4764341996931611), f239);
+    f267 = MUL_F(FRAC_CONST(0.9039892931234433), f265);
+    f268 = MUL_C(COEF_CONST(1.3315443865537255), f198);
+    y[9] = f266 + f267;
+    y[23] = f268 - f267;
+    f271 = f196 - f237;
+    f272 = MUL_F(FRAC_CONST(-0.3436258658070505), f237);
+    f273 = MUL_F(FRAC_CONST(0.8577286100002721), f271);
+    f274 = MUL_C(COEF_CONST(1.3718313541934939), f196);
+    y[11] = f273 - f272;
+    y[21] = f274 - f273;
+    f277 = f235 + f194;
+    f278 = MUL_F(FRAC_CONST(-0.2075082269882114), f235);
+    f279 = MUL_F(FRAC_CONST(0.8032075314806448), f277);
+    f280 = MUL_C(COEF_CONST(1.3989068359730783), f194);
+    y[13] = f278 + f279;
+    y[19] = f280 - f279;
+    f283 = f192 - f233;
+    f284 = MUL_F(FRAC_CONST(-0.0693921705079408), f233);
+    f285 = MUL_F(FRAC_CONST(0.7409511253549591), f283);
+    f286 = MUL_C(COEF_CONST(1.4125100802019774), f192);
+    y[15] = f285 - f284;
+    y[17] = f286 - f285;
+}
+
+#else
+
+
+#define n 32
+#define log2n 5
+
+// w_array_real[i] = cos(2*M_PI*i/32)
+static const real_t w_array_real[] = {
+    FRAC_CONST(1.000000000000000), FRAC_CONST(0.980785279337272),
+    FRAC_CONST(0.923879528329380), FRAC_CONST(0.831469603195765),
+    FRAC_CONST(0.707106765732237), FRAC_CONST(0.555570210304169),
+    FRAC_CONST(0.382683402077046), FRAC_CONST(0.195090284503576),
+    FRAC_CONST(0.000000000000000), FRAC_CONST(-0.195090370246552),
+    FRAC_CONST(-0.382683482845162), FRAC_CONST(-0.555570282993553),
+    FRAC_CONST(-0.707106827549476), FRAC_CONST(-0.831469651765257),
+    FRAC_CONST(-0.923879561784627), FRAC_CONST(-0.980785296392607)
+};
+
+// w_array_imag[i] = sin(-2*M_PI*i/32)
+static const real_t w_array_imag[] = {
+    FRAC_CONST(0.000000000000000), FRAC_CONST(-0.195090327375064),
+    FRAC_CONST(-0.382683442461104), FRAC_CONST(-0.555570246648862),
+    FRAC_CONST(-0.707106796640858), FRAC_CONST(-0.831469627480512),
+    FRAC_CONST(-0.923879545057005), FRAC_CONST(-0.980785287864940),
+    FRAC_CONST(-1.000000000000000), FRAC_CONST(-0.980785270809601),
+    FRAC_CONST(-0.923879511601754), FRAC_CONST(-0.831469578911016),
+    FRAC_CONST(-0.707106734823616), FRAC_CONST(-0.555570173959476),
+    FRAC_CONST(-0.382683361692986), FRAC_CONST(-0.195090241632088)
+};
+
+// FFT decimation in frequency
+// 4*16*2+16=128+16=144 multiplications
+// 6*16*2+10*8+4*16*2=192+80+128=400 additions
+static void fft_dif(real_t * Real, real_t * Imag)
+{
+    real_t w_real, w_imag; // For faster access
+    real_t point1_real, point1_imag, point2_real, point2_imag; // For faster access
+    uint32_t j, i, i2, w_index; // Counters
+
+    // First 2 stages of 32 point FFT decimation in frequency
+    // 4*16*2=64*2=128 multiplications
+    // 6*16*2=96*2=192 additions
+	// Stage 1 of 32 point FFT decimation in frequency
+    for (i = 0; i < 16; i++)
+    {
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+        i2 = i+16;
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        w_real = w_array_real[i];
+        w_imag = w_array_imag[i];
+
+        // temp1 = x[i] - x[i2]
+        point1_real -= point2_real;
+        point1_imag -= point2_imag;
+
+        // x[i1] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = (x[i] - x[i2]) * w
+        Real[i2] = (MUL_F(point1_real,w_real) - MUL_F(point1_imag,w_imag));
+        Imag[i2] = (MUL_F(point1_real,w_imag) + MUL_F(point1_imag,w_real));
+     }
+    // Stage 2 of 32 point FFT decimation in frequency
+    for (j = 0, w_index = 0; j < 8; j++, w_index += 2)
+    {
+        w_real = w_array_real[w_index];
+        w_imag = w_array_imag[w_index];
+
+    	i = j;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+        i2 = i+8;
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // temp1 = x[i] - x[i2]
+        point1_real -= point2_real;
+        point1_imag -= point2_imag;
+
+        // x[i1] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = (x[i] - x[i2]) * w
+        Real[i2] = (MUL_F(point1_real,w_real) - MUL_F(point1_imag,w_imag));
+        Imag[i2] = (MUL_F(point1_real,w_imag) + MUL_F(point1_imag,w_real));
+
+        i = j+16;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+        i2 = i+8;
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // temp1 = x[i] - x[i2]
+        point1_real -= point2_real;
+        point1_imag -= point2_imag;
+
+        // x[i1] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = (x[i] - x[i2]) * w
+        Real[i2] = (MUL_F(point1_real,w_real) - MUL_F(point1_imag,w_imag));
+        Imag[i2] = (MUL_F(point1_real,w_imag) + MUL_F(point1_imag,w_real));
+    }
+
+    // Stage 3 of 32 point FFT decimation in frequency
+    // 2*4*2=16 multiplications
+    // 4*4*2+6*4*2=10*8=80 additions
+    for (i = 0; i < n; i += 8)
+    {
+        i2 = i+4;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // out[i1] = point1 + point2
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // out[i2] = point1 - point2
+        Real[i2] = point1_real - point2_real;
+        Imag[i2] = point1_imag - point2_imag;
+    }
+    w_real = w_array_real[4]; // = sqrt(2)/2
+    // w_imag = -w_real; // = w_array_imag[4]; // = -sqrt(2)/2
+    for (i = 1; i < n; i += 8)
+    {
+        i2 = i+4;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // temp1 = x[i] - x[i2]
+        point1_real -= point2_real;
+        point1_imag -= point2_imag;
+
+        // x[i1] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = (x[i] - x[i2]) * w
+        Real[i2] = MUL_F(point1_real+point1_imag, w_real);
+        Imag[i2] = MUL_F(point1_imag-point1_real, w_real);
+    }
+    for (i = 2; i < n; i += 8)
+    {
+        i2 = i+4;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // x[i] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = (x[i] - x[i2]) * (-i)
+        Real[i2] = point1_imag - point2_imag;
+        Imag[i2] = point2_real - point1_real;
+    }
+    w_real = w_array_real[12]; // = -sqrt(2)/2
+    // w_imag = w_real; // = w_array_imag[12]; // = -sqrt(2)/2
+    for (i = 3; i < n; i += 8)
+    {
+        i2 = i+4;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // temp1 = x[i] - x[i2]
+        point1_real -= point2_real;
+        point1_imag -= point2_imag;
+
+        // x[i1] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = (x[i] - x[i2]) * w
+        Real[i2] = MUL_F(point1_real-point1_imag, w_real);
+        Imag[i2] = MUL_F(point1_real+point1_imag, w_real);
+    }
+
+
+    // Stage 4 of 32 point FFT decimation in frequency (no multiplications)
+    // 16*4=64 additions
+    for (i = 0; i < n; i += 4)
+    {
+        i2 = i+2;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // x[i1] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = x[i] - x[i2]
+        Real[i2] = point1_real - point2_real;
+        Imag[i2] = point1_imag - point2_imag;
+    }
+    for (i = 1; i < n; i += 4)
+    {
+        i2 = i+2;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // x[i] = x[i] + x[i2]
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // x[i2] = (x[i] - x[i2]) * (-i)
+        Real[i2] = point1_imag - point2_imag;
+        Imag[i2] = point2_real - point1_real;
+    }
+
+    // Stage 5 of 32 point FFT decimation in frequency (no multiplications)
+    // 16*4=64 additions
+    for (i = 0; i < n; i += 2)
+    {
+        i2 = i+1;
+        point1_real = Real[i];
+        point1_imag = Imag[i];
+
+        point2_real = Real[i2];
+        point2_imag = Imag[i2];
+
+        // out[i1] = point1 + point2
+        Real[i] += point2_real;
+        Imag[i] += point2_imag;
+
+        // out[i2] = point1 - point2
+        Real[i2] = point1_real - point2_real;
+        Imag[i2] = point1_imag - point2_imag;
+    }
+
+#ifdef REORDER_IN_FFT
+    FFTReorder(Real, Imag);
+#endif // #ifdef REORDER_IN_FFT
+}
+#undef n
+#undef log2n
+
+static const real_t dct4_64_tab[] = {
+    COEF_CONST(0.999924719333649), COEF_CONST(0.998118102550507),
+    COEF_CONST(0.993906974792480), COEF_CONST(0.987301409244537),
+    COEF_CONST(0.978317379951477), COEF_CONST(0.966976463794708),
+    COEF_CONST(0.953306019306183), COEF_CONST(0.937339007854462),
+    COEF_CONST(0.919113874435425), COEF_CONST(0.898674488067627),
+    COEF_CONST(0.876070082187653), COEF_CONST(0.851355195045471),
+    COEF_CONST(0.824589252471924), COEF_CONST(0.795836925506592),
+    COEF_CONST(0.765167236328125), COEF_CONST(0.732654273509979),
+    COEF_CONST(0.698376238346100), COEF_CONST(0.662415742874146),
+    COEF_CONST(0.624859452247620), COEF_CONST(0.585797846317291),
+    COEF_CONST(0.545324981212616), COEF_CONST(0.503538429737091),
+    COEF_CONST(0.460538715124130), COEF_CONST(0.416429549455643),
+    COEF_CONST(0.371317148208618), COEF_CONST(0.325310230255127),
+    COEF_CONST(0.278519600629807), COEF_CONST(0.231058135628700),
+    COEF_CONST(0.183039888739586), COEF_CONST(0.134580686688423),
+    COEF_CONST(0.085797272622585), COEF_CONST(0.036807164549828),
+    COEF_CONST(-1.012196302413940), COEF_CONST(-1.059438824653626),
+    COEF_CONST(-1.104129195213318), COEF_CONST(-1.146159529685974),
+    COEF_CONST(-1.185428738594055), COEF_CONST(-1.221842169761658),
+    COEF_CONST(-1.255311965942383), COEF_CONST(-1.285757660865784),
+    COEF_CONST(-1.313105940818787), COEF_CONST(-1.337290763854981),
+    COEF_CONST(-1.358253836631775), COEF_CONST(-1.375944852828980),
+    COEF_CONST(-1.390321016311646), COEF_CONST(-1.401347875595093),
+    COEF_CONST(-1.408998727798462), COEF_CONST(-1.413255214691162),
+    COEF_CONST(-1.414107084274292), COEF_CONST(-1.411552190780640),
+    COEF_CONST(-1.405596733093262), COEF_CONST(-1.396255016326904),
+    COEF_CONST(-1.383549690246582), COEF_CONST(-1.367511272430420),
+    COEF_CONST(-1.348178386688232), COEF_CONST(-1.325597524642944),
+    COEF_CONST(-1.299823284149170), COEF_CONST(-1.270917654037476),
+    COEF_CONST(-1.238950133323669), COEF_CONST(-1.203998088836670),
+    COEF_CONST(-1.166145324707031), COEF_CONST(-1.125483393669128),
+    COEF_CONST(-1.082109928131104), COEF_CONST(-1.036129593849182),
+    COEF_CONST(-0.987653195858002), COEF_CONST(-0.936797380447388),
+    COEF_CONST(-0.883684754371643), COEF_CONST(-0.828443288803101),
+    COEF_CONST(-0.771206021308899), COEF_CONST(-0.712110757827759),
+    COEF_CONST(-0.651300072669983), COEF_CONST(-0.588920354843140),
+    COEF_CONST(-0.525121808052063), COEF_CONST(-0.460058242082596),
+    COEF_CONST(-0.393886327743530), COEF_CONST(-0.326765477657318),
+    COEF_CONST(-0.258857429027557), COEF_CONST(-0.190325915813446),
+    COEF_CONST(-0.121335685253143), COEF_CONST(-0.052053272724152),
+    COEF_CONST(0.017354607582092), COEF_CONST(0.086720645427704),
+    COEF_CONST(0.155877828598022), COEF_CONST(0.224659323692322),
+    COEF_CONST(0.292899727821350), COEF_CONST(0.360434412956238),
+    COEF_CONST(0.427100926637650), COEF_CONST(0.492738455533981),
+    COEF_CONST(0.557188928127289), COEF_CONST(0.620297133922577),
+    COEF_CONST(0.681910991668701), COEF_CONST(0.741881847381592),
+    COEF_CONST(0.800065577030182), COEF_CONST(0.856321990489960),
+    COEF_CONST(0.910515367984772), COEF_CONST(0.962515234947205),
+    COEF_CONST(1.000000000000000), COEF_CONST(0.998795449733734),
+    COEF_CONST(0.995184719562531), COEF_CONST(0.989176511764526),
+    COEF_CONST(0.980785250663757), COEF_CONST(0.970031261444092),
+    COEF_CONST(0.956940352916718), COEF_CONST(0.941544055938721),
+    COEF_CONST(0.923879504203796), COEF_CONST(0.903989315032959),
+    COEF_CONST(0.881921231746674), COEF_CONST(0.857728600502014),
+    COEF_CONST(0.831469595432281), COEF_CONST(0.803207516670227),
+    COEF_CONST(0.773010432720184), COEF_CONST(0.740951120853424),
+    COEF_CONST(0.707106769084930), COEF_CONST(0.671558916568756),
+    COEF_CONST(0.634393274784088), COEF_CONST(0.595699310302734),
+    COEF_CONST(0.555570185184479), COEF_CONST(0.514102697372437),
+    COEF_CONST(0.471396654844284), COEF_CONST(0.427555114030838),
+    COEF_CONST(0.382683426141739), COEF_CONST(0.336889833211899),
+    COEF_CONST(0.290284633636475), COEF_CONST(0.242980122566223),
+    COEF_CONST(0.195090234279633), COEF_CONST(0.146730497479439),
+    COEF_CONST(0.098017133772373), COEF_CONST(0.049067649990320),
+    COEF_CONST(-1.000000000000000), COEF_CONST(-1.047863125801086),
+    COEF_CONST(-1.093201875686646), COEF_CONST(-1.135906934738159),
+    COEF_CONST(-1.175875544548035), COEF_CONST(-1.213011503219605),
+    COEF_CONST(-1.247225046157837), COEF_CONST(-1.278433918952942),
+    COEF_CONST(-1.306562900543213), COEF_CONST(-1.331544399261475),
+    COEF_CONST(-1.353317975997925), COEF_CONST(-1.371831417083740),
+    COEF_CONST(-1.387039899826050), COEF_CONST(-1.398906826972961),
+    COEF_CONST(-1.407403707504273), COEF_CONST(-1.412510156631470),
+    COEF_CONST(0), COEF_CONST(-1.412510156631470),
+    COEF_CONST(-1.407403707504273), COEF_CONST(-1.398906826972961),
+    COEF_CONST(-1.387039899826050), COEF_CONST(-1.371831417083740),
+    COEF_CONST(-1.353317975997925), COEF_CONST(-1.331544399261475),
+    COEF_CONST(-1.306562900543213), COEF_CONST(-1.278433918952942),
+    COEF_CONST(-1.247225046157837), COEF_CONST(-1.213011384010315),
+    COEF_CONST(-1.175875544548035), COEF_CONST(-1.135907053947449),
+    COEF_CONST(-1.093201875686646), COEF_CONST(-1.047863125801086),
+    COEF_CONST(-1.000000000000000), COEF_CONST(-0.949727773666382),
+    COEF_CONST(-0.897167563438416), COEF_CONST(-0.842446029186249),
+    COEF_CONST(-0.785694956779480), COEF_CONST(-0.727051079273224),
+    COEF_CONST(-0.666655659675598), COEF_CONST(-0.604654192924500),
+    COEF_CONST(-0.541196048259735), COEF_CONST(-0.476434230804443),
+    COEF_CONST(-0.410524487495422), COEF_CONST(-0.343625843524933),
+    COEF_CONST(-0.275899350643158), COEF_CONST(-0.207508206367493),
+    COEF_CONST(-0.138617098331451), COEF_CONST(-0.069392144680023),
+    COEF_CONST(0), COEF_CONST(0.069392263889313),
+    COEF_CONST(0.138617157936096), COEF_CONST(0.207508206367493),
+    COEF_CONST(0.275899469852448), COEF_CONST(0.343625962734222),
+    COEF_CONST(0.410524636507034), COEF_CONST(0.476434201002121),
+    COEF_CONST(0.541196107864380), COEF_CONST(0.604654192924500),
+    COEF_CONST(0.666655719280243), COEF_CONST(0.727051138877869),
+    COEF_CONST(0.785695075988770), COEF_CONST(0.842446029186249),
+    COEF_CONST(0.897167563438416), COEF_CONST(0.949727773666382)
+};
+
+/* size 64 only! */
+void dct4_kernel(real_t * in_real, real_t * in_imag, real_t * out_real, real_t * out_imag)
+{
+    // Tables with bit reverse values for 5 bits, bit reverse of i at i-th position
+    const uint8_t bit_rev_tab[32] = { 0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23,15,31 };
+    uint32_t i, i_rev;
+
+    /* Step 2: modulate */
+    // 3*32=96 multiplications
+    // 3*32=96 additions
+    for (i = 0; i < 32; i++)
+    {
+    	real_t x_re, x_im, tmp;
+    	x_re = in_real[i];
+    	x_im = in_imag[i];
+        tmp =        MUL_C(x_re + x_im, dct4_64_tab[i]);
+        in_real[i] = MUL_C(x_im, dct4_64_tab[i + 64]) + tmp;
+        in_imag[i] = MUL_C(x_re, dct4_64_tab[i + 32]) + tmp;
+    }
+
+    /* Step 3: FFT, but with output in bit reverse order */
+    fft_dif(in_real, in_imag);
+
+    /* Step 4: modulate + bitreverse reordering */
+    // 3*31+2=95 multiplications
+    // 3*31+2=95 additions
+    for (i = 0; i < 16; i++)
+    {
+    	real_t x_re, x_im, tmp;
+    	i_rev = bit_rev_tab[i];
+    	x_re = in_real[i_rev];
+    	x_im = in_imag[i_rev];
+
+        tmp =         MUL_C(x_re + x_im, dct4_64_tab[i + 3*32]);
+        out_real[i] = MUL_C(x_im, dct4_64_tab[i + 5*32]) + tmp;
+        out_imag[i] = MUL_C(x_re, dct4_64_tab[i + 4*32]) + tmp;
+    }
+    // i = 16, i_rev = 1 = rev(16);
+    out_imag[16] = MUL_C(in_imag[1] - in_real[1], dct4_64_tab[16 + 3*32]);
+    out_real[16] = MUL_C(in_real[1] + in_imag[1], dct4_64_tab[16 + 3*32]);
+    for (i = 17; i < 32; i++)
+    {
+    	real_t x_re, x_im, tmp;
+    	i_rev = bit_rev_tab[i];
+    	x_re = in_real[i_rev];
+    	x_im = in_imag[i_rev];
+        tmp =         MUL_C(x_re + x_im, dct4_64_tab[i + 3*32]);
+        out_real[i] = MUL_C(x_im, dct4_64_tab[i + 5*32]) + tmp;
+        out_imag[i] = MUL_C(x_re, dct4_64_tab[i + 4*32]) + tmp;
+    }
+
 }
 
 #endif
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_dct.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dct.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_dct.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dct.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_dct.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_dct.h,v 1.19 2007/11/01 12:33:34 menno Exp $
 **/
 
 #ifndef __SBR_DCT_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_dec.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dec.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_dec.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dec.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_dec.c,v 1.9 2006/06/17 20:43:57 dgp85 Exp $
+** $Id: sbr_dec.c,v 1.43 2007/11/01 12:33:34 menno Exp $
 **/
 
 
@@ -176,6 +179,72 @@
     }
 }
 
+void sbrReset(sbr_info *sbr)
+{
+    uint8_t j;
+    if (sbr->qmfa[0] != NULL)
+        memset(sbr->qmfa[0]->x, 0, 2 * sbr->qmfa[0]->channels * 10 * sizeof(real_t));
+    if (sbr->qmfa[1] != NULL)
+        memset(sbr->qmfa[1]->x, 0, 2 * sbr->qmfa[1]->channels * 10 * sizeof(real_t));
+    if (sbr->qmfs[0] != NULL)
+        memset(sbr->qmfs[0]->v, 0, 2 * sbr->qmfs[0]->channels * 20 * sizeof(real_t));
+    if (sbr->qmfs[1] != NULL)
+        memset(sbr->qmfs[1]->v, 0, 2 * sbr->qmfs[1]->channels * 20 * sizeof(real_t));
+
+    for (j = 0; j < 5; j++)
+    {
+        if (sbr->G_temp_prev[0][j] != NULL)
+            memset(sbr->G_temp_prev[0][j], 0, 64*sizeof(real_t));
+        if (sbr->G_temp_prev[1][j] != NULL)
+            memset(sbr->G_temp_prev[1][j], 0, 64*sizeof(real_t));
+        if (sbr->Q_temp_prev[0][j] != NULL)
+            memset(sbr->Q_temp_prev[0][j], 0, 64*sizeof(real_t));
+        if (sbr->Q_temp_prev[1][j] != NULL)
+            memset(sbr->Q_temp_prev[1][j], 0, 64*sizeof(real_t));
+    }
+
+    memset(sbr->Xsbr[0], 0, (sbr->numTimeSlotsRate+sbr->tHFGen)*64 * sizeof(qmf_t));
+    memset(sbr->Xsbr[1], 0, (sbr->numTimeSlotsRate+sbr->tHFGen)*64 * sizeof(qmf_t));
+    
+    sbr->GQ_ringbuf_index[0] = 0;
+    sbr->GQ_ringbuf_index[1] = 0;
+    sbr->header_count = 0;
+    sbr->Reset = 1;
+
+    sbr->L_E_prev[0] = 0;
+    sbr->L_E_prev[1] = 0;
+    sbr->bs_freq_scale = 2;
+    sbr->bs_alter_scale = 1;
+    sbr->bs_noise_bands = 2;
+    sbr->bs_limiter_bands = 2;
+    sbr->bs_limiter_gains = 2;
+    sbr->bs_interpol_freq = 1;
+    sbr->bs_smoothing_mode = 1;
+    sbr->bs_start_freq = 5;
+    sbr->bs_amp_res = 1;
+    sbr->bs_samplerate_mode = 1;
+    sbr->prevEnvIsShort[0] = -1;
+    sbr->prevEnvIsShort[1] = -1;
+    sbr->bsco = 0;
+    sbr->bsco_prev = 0;
+    sbr->M_prev = 0;
+    sbr->bs_start_freq_prev = -1;
+
+    sbr->f_prev[0] = 0;
+    sbr->f_prev[1] = 0;
+    for (j = 0; j < MAX_M; j++)
+    {
+        sbr->E_prev[0][j] = 0;
+        sbr->Q_prev[0][j] = 0;
+        sbr->E_prev[1][j] = 0;
+        sbr->Q_prev[1][j] = 0;
+        sbr->bs_add_harmonic_prev[0][j] = 0;
+        sbr->bs_add_harmonic_prev[1][j] = 0;
+    }
+    sbr->bs_add_harmonic_flag_prev[0] = 0;
+    sbr->bs_add_harmonic_flag_prev[1] = 0;
+}
+
 static uint8_t sbr_save_prev_data(sbr_info *sbr, uint8_t ch)
 {
     uint8_t i;
@@ -226,11 +295,12 @@
     }
 }
 
-static void sbr_process_channel(sbr_info *sbr, real_t *channel_buf, qmf_t X[MAX_NTSR][64],
-                                uint8_t ch, uint8_t dont_process,
-                                const uint8_t downSampledSBR)
+static uint8_t sbr_process_channel(sbr_info *sbr, real_t *channel_buf, qmf_t X[MAX_NTSR][64],
+                                   uint8_t ch, uint8_t dont_process,
+                                   const uint8_t downSampledSBR)
 {
     int16_t k, l;
+    uint8_t ret = 0;
 
 #ifdef SBR_LOW_POWER
     ALIGN real_t deg[64];
@@ -278,7 +348,7 @@
             ,ch);
 #endif
 
-#ifdef SBR_LOW_POWER
+#if 0 //def SBR_LOW_POWER
         for (l = sbr->t_E[ch][0]; l < sbr->t_E[ch][sbr->L_E[ch]]; l++)
         {
             for (k = 0; k < sbr->kx; k++)
@@ -290,12 +360,16 @@
 
 #if 1
         /* hf adjustment */
-        hf_adjustment(sbr, sbr->Xsbr[ch]
+        ret = hf_adjustment(sbr, sbr->Xsbr[ch]
 #ifdef SBR_LOW_POWER
             ,deg
 #endif
             ,ch);
 #endif
+        if (ret > 0)
+        {
+            dont_process = 1;
+        }
     }
 
     if ((sbr->just_seeked != 0) || dont_process)
@@ -367,6 +441,8 @@
 #endif
         }
     }
+
+    return ret;
 }
 
 uint8_t sbrDecodeCoupleFrame(sbr_info *sbr, real_t *left_chan, real_t *right_chan,
@@ -400,7 +476,7 @@
         sbr->just_seeked = 0;
     }
 
-    sbr_process_channel(sbr, left_chan, X, 0, dont_process, downSampledSBR);
+    sbr->ret += sbr_process_channel(sbr, left_chan, X, 0, dont_process, downSampledSBR);
     /* subband synthesis */
     if (downSampledSBR)
     {
@@ -409,7 +485,7 @@
         sbr_qmf_synthesis_64(sbr, sbr->qmfs[0], X, left_chan);
     }
 
-    sbr_process_channel(sbr, right_chan, X, 1, dont_process, downSampledSBR);
+    sbr->ret += sbr_process_channel(sbr, right_chan, X, 1, dont_process, downSampledSBR);
     /* subband synthesis */
     if (downSampledSBR)
     {
@@ -483,7 +559,7 @@
         sbr->just_seeked = 0;
     }
 
-    sbr_process_channel(sbr, channel, X, 0, dont_process, downSampledSBR);
+    sbr->ret += sbr_process_channel(sbr, channel, X, 0, dont_process, downSampledSBR);
     /* subband synthesis */
     if (downSampledSBR)
     {
@@ -526,8 +602,8 @@
     uint8_t l, k;
     uint8_t dont_process = 0;
     uint8_t ret = 0;
-    ALIGN qmf_t X_left[38][64] = {{{0}}};
-    ALIGN qmf_t X_right[38][64] = {{{0}}}; /* must set this to 0 */
+    ALIGN qmf_t X_left[38][64] = {{0}};
+    ALIGN qmf_t X_right[38][64] = {{0}}; /* must set this to 0 */
 
     if (sbr == NULL)
         return 20;
@@ -558,7 +634,7 @@
         sbr->qmfs[1] = qmfs_init((downSampledSBR)?32:64);
     }
 
-    sbr_process_channel(sbr, left_channel, X_left, 0, dont_process, downSampledSBR);
+    sbr->ret += sbr_process_channel(sbr, left_channel, X_left, 0, dont_process, downSampledSBR);
 
     /* copy some extra data for PS */
     for (l = 32; l < 38; l++)
@@ -574,7 +650,7 @@
 #ifdef DRM_PS
     if (sbr->Is_DRM_SBR)
     {
-        drm_ps_decode(sbr->drm_ps, (sbr->ret > 0), sbr->sample_rate, X_left, X_right);
+        drm_ps_decode(sbr->drm_ps, (sbr->ret > 0), X_left, X_right);
     } else {
 #endif
 #ifdef PS_DEC
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_dec.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dec.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_dec.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_dec.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_dec.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_dec.h,v 1.39 2007/11/01 12:33:34 menno Exp $
 **/
 
 #ifndef __SBR_DEC_H__
@@ -183,6 +186,7 @@
 #endif
 #if (defined(PS_DEC) || defined(DRM_PS))
     uint8_t ps_used;
+    uint8_t psResetFlag;
 #endif
 
     /* to get it compiling */
@@ -231,6 +235,7 @@
 #endif
                         );
 void sbrDecodeEnd(sbr_info *sbr);
+void sbrReset(sbr_info *sbr);
 
 uint8_t sbrDecodeCoupleFrame(sbr_info *sbr, real_t *left_chan, real_t *right_chan,
                              const uint8_t just_seeked, const uint8_t downSampledSBR);
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_e_nf.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_e_nf.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_e_nf.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_e_nf.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_e_nf.c,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_e_nf.c,v 1.21 2007/11/01 12:33:35 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_e_nf.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_e_nf.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_e_nf.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_e_nf.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_e_nf.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_e_nf.h,v 1.18 2007/11/01 12:33:35 menno Exp $
 **/
 
 #ifndef __SBR_E_NF_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_fbt.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_fbt.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_fbt.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_fbt.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_fbt.c,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_fbt.c,v 1.21 2007/11/01 12:33:35 menno Exp $
 **/
 
 /* Calculate frequency band tables */
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_fbt.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_fbt.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_fbt.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_fbt.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_fbt.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_fbt.h,v 1.18 2007/11/01 12:33:35 menno Exp $
 **/
 
 #ifndef __SBR_FBT_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_hfadj.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfadj.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_hfadj.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfadj.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_hfadj.c,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_hfadj.c,v 1.22 2007/11/01 12:33:35 menno Exp $
 **/
 
 /* High Frequency adjustment */
@@ -39,8 +42,8 @@
 
 
 /* static function declarations */
-static void estimate_current_envelope(sbr_info *sbr, sbr_hfadj_info *adj,
-                                      qmf_t Xsbr[MAX_NTSRHFG][64], uint8_t ch);
+static uint8_t estimate_current_envelope(sbr_info *sbr, sbr_hfadj_info *adj,
+                                         qmf_t Xsbr[MAX_NTSRHFG][64], uint8_t ch);
 static void calculate_gain(sbr_info *sbr, sbr_hfadj_info *adj, uint8_t ch);
 #ifdef SBR_LOW_POWER
 static void calc_gain_groups(sbr_info *sbr, sbr_hfadj_info *adj, real_t *deg, uint8_t ch);
@@ -49,13 +52,14 @@
 static void hf_assembly(sbr_info *sbr, sbr_hfadj_info *adj, qmf_t Xsbr[MAX_NTSRHFG][64], uint8_t ch);
 
 
-void hf_adjustment(sbr_info *sbr, qmf_t Xsbr[MAX_NTSRHFG][64]
+uint8_t hf_adjustment(sbr_info *sbr, qmf_t Xsbr[MAX_NTSRHFG][64]
 #ifdef SBR_LOW_POWER
-                   ,real_t *deg /* aliasing degree */
+                      ,real_t *deg /* aliasing degree */
 #endif
-                   ,uint8_t ch)
+                      ,uint8_t ch)
 {
     ALIGN sbr_hfadj_info adj = {{{0}}};
+    uint8_t ret = 0;
 
     if (sbr->bs_frame_class[ch] == FIXFIX)
     {
@@ -72,7 +76,9 @@
             sbr->l_A[ch] = sbr->L_E[ch] + 1 - sbr->bs_pointer[ch];
     }
 
-    estimate_current_envelope(sbr, &adj, Xsbr, ch);
+    ret = estimate_current_envelope(sbr, &adj, Xsbr, ch);
+    if (ret > 0)
+        return 1;
 
     calculate_gain(sbr, &adj, ch);
 
@@ -82,6 +88,8 @@
 #endif
 
     hf_assembly(sbr, &adj, Xsbr, ch);
+
+    return 0;
 }
 
 static uint8_t get_S_mapped(sbr_info *sbr, uint8_t ch, uint8_t l, uint8_t current_band)
@@ -125,8 +133,8 @@
     return 0;
 }
 
-static void estimate_current_envelope(sbr_info *sbr, sbr_hfadj_info *adj,
-                                      qmf_t Xsbr[MAX_NTSRHFG][64], uint8_t ch)
+static uint8_t estimate_current_envelope(sbr_info *sbr, sbr_hfadj_info *adj,
+                                         qmf_t Xsbr[MAX_NTSRHFG][64], uint8_t ch)
 {
     uint8_t m, l, j, k, k_l, k_h, p;
     real_t nrg, div;
@@ -142,6 +150,9 @@
 
             div = (real_t)(u_i - l_i);
 
+            if (div == 0)
+                div = 1;
+
             for (m = 0; m < sbr->M; m++)
             {
                 nrg = 0;
@@ -192,6 +203,9 @@
 
                     div = (real_t)((u_i - l_i)*(k_h - k_l));
 
+                    if (div == 0)
+                        div = 1;
+
                     for (i = l_i + sbr->tHFAdj; i < u_i + sbr->tHFAdj; i++)
                     {
                         for (j = k_l; j < k_h; j++)
@@ -225,6 +239,8 @@
             }
         }
     }
+
+    return 0;
 }
 
 #ifdef FIXED_POINT
@@ -1342,15 +1358,27 @@
 {
     uint8_t l, k, i;
     uint8_t grouping;
+    uint8_t S_mapped;
 
     for (l = 0; l < sbr->L_E[ch]; l++)
     {
+        uint8_t current_res_band = 0;
         i = 0;
         grouping = 0;
 
+        S_mapped = get_S_mapped(sbr, ch, l, current_res_band);
+
         for (k = sbr->kx; k < sbr->kx + sbr->M - 1; k++)
         {
-            if (deg[k + 1] && adj->S_mapped[l][k-sbr->kx] == 0)
+            if (k == sbr->f_table_res[sbr->f[ch][l]][current_res_band+1])
+            {
+                /* step to next resolution band */
+                current_res_band++;
+
+                S_mapped = get_S_mapped(sbr, ch, l, current_res_band);
+            }
+
+            if (deg[k + 1] && S_mapped == 0)
             {
                 if (grouping == 0)
                 {
@@ -1361,7 +1389,7 @@
             } else {
                 if (grouping)
                 {
-                    if (adj->S_mapped[l][k-sbr->kx])
+                    if (S_mapped)
                     {
                         sbr->f_group[l][i] = k;
                     } else {
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_hfadj.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfadj.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_hfadj.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfadj.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_hfadj.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_hfadj.h,v 1.19 2007/11/01 12:33:35 menno Exp $
 **/
 
 #ifndef __SBR_HFADJ_H__
@@ -40,11 +43,11 @@
 } sbr_hfadj_info;
 
 
-void hf_adjustment(sbr_info *sbr, qmf_t Xsbr[MAX_NTSRHFG][64]
+uint8_t hf_adjustment(sbr_info *sbr, qmf_t Xsbr[MAX_NTSRHFG][64]
 #ifdef SBR_LOW_POWER
-                   ,real_t *deg
+                      ,real_t *deg
 #endif
-                   ,uint8_t ch);
+                      ,uint8_t ch);
 
 
 #ifdef __cplusplus
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_hfgen.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfgen.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_hfgen.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfgen.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_hfgen.c,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_hfgen.c,v 1.26 2007/11/01 12:33:35 menno Exp $
 **/
 
 /* High Frequency generation */
@@ -36,7 +39,6 @@
 #include "sbr_hfgen.h"
 #include "sbr_fbt.h"
 
-
 /* static function declarations */
 #ifdef SBR_LOW_POWER
 static void calc_prediction_coef_lp(sbr_info *sbr, qmf_t Xlow[MAX_NTSRHFG][64],
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_hfgen.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfgen.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_hfgen.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_hfgen.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_hfgen.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_hfgen.h,v 1.20 2007/11/01 12:33:35 menno Exp $
 **/
 
 #ifndef __SBR_HFGEN_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_huff.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_huff.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_huff.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_huff.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_huff.c,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_huff.c,v 1.21 2007/11/01 12:33:35 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_huff.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_huff.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_huff.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_huff.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_huff.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_huff.h,v 1.21 2007/11/01 12:33:35 menno Exp $
 **/
 
 #ifndef __SBR_HUFF_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_noise.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_noise.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_noise.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_noise.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_noise.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_noise.h,v 1.17 2007/11/01 12:33:35 menno Exp $
 **/
 
 #ifndef __SBR_NOISE_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_qmf.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_qmf.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_qmf.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_qmf.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_qmf.c,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_qmf.c,v 1.32 2007/11/01 12:33:36 menno Exp $
 **/
 
 #include "common.h"
@@ -72,7 +75,7 @@
 #else
     ALIGN real_t y[32];
 #endif
-    uint16_t in = 0;
+    uint32_t in = 0;
     uint8_t l;
 
     /* qmf subsample l */
@@ -251,7 +254,7 @@
 {
     ALIGN real_t x[16];
     ALIGN real_t y[16];
-    int16_t n, k, out = 0;
+    int32_t n, k, out = 0;
     uint8_t l;
 
     /* qmf subsample l */
@@ -320,7 +323,7 @@
 {
     ALIGN real_t x[64];
     ALIGN real_t y[64];
-    int16_t n, k, out = 0;
+    int32_t n, k, out = 0;
     uint8_t l;
 
 
@@ -392,7 +395,7 @@
 #ifndef FIXED_POINT
     real_t scale = 1.f/64.f;
 #endif
-    int16_t n, k, out = 0;
+    int32_t n, k, out = 0;
     uint8_t l;
 
 
@@ -475,7 +478,7 @@
 #ifndef FIXED_POINT
     real_t scale = 1.f/64.f;
 #endif
-    int16_t n, k, out = 0;
+    int32_t n, k, out = 0;
     uint8_t l;
 
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_qmf_c.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_qmf_c.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_qmf_c.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_qmf_c.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_qmf_c.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_qmf_c.h,v 1.17 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SBR_QMF_C_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_qmf.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_qmf.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_qmf.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_qmf.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_qmf.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_qmf.h,v 1.25 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SBR_QMF_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_syntax.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_syntax.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_syntax.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_syntax.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_syntax.c,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_syntax.c,v 1.38 2007/11/01 12:33:36 menno Exp $
 **/
 
 #include "common.h"
@@ -46,6 +49,7 @@
 #include "analysis.h"
 
 /* static function declarations */
+/* static function declarations */
 static void sbr_header(bitfile *ld, sbr_info *sbr);
 static uint8_t calc_sbr_tables(sbr_info *sbr, uint8_t start_freq, uint8_t stop_freq,
                                uint8_t samplerate_mode, uint8_t freq_scale,
@@ -131,16 +135,23 @@
 }
 
 /* table 2 */
-uint8_t sbr_extension_data(bitfile *ld, sbr_info *sbr, uint16_t cnt)
+uint8_t sbr_extension_data(bitfile *ld, sbr_info *sbr, uint16_t cnt,
+                           uint8_t psResetFlag)
 {
     uint8_t result = 0;
     uint16_t num_align_bits = 0;
-    uint16_t num_sbr_bits = (uint16_t)faad_get_processed_bits(ld);
+    uint16_t num_sbr_bits1 = (uint16_t)faad_get_processed_bits(ld);
+    uint16_t num_sbr_bits2;
 
     uint8_t saved_start_freq, saved_samplerate_mode;
     uint8_t saved_stop_freq, saved_freq_scale;
     uint8_t saved_alter_scale, saved_xover_band;
 
+#if (defined(PS_DEC) || defined(DRM_PS))
+    if (psResetFlag)
+        sbr->psResetFlag = psResetFlag;
+#endif
+
 #ifdef DRM
     if (!sbr->Is_DRM_SBR)
 #endif
@@ -206,28 +217,40 @@
             {
                 calc_sbr_tables(sbr, saved_start_freq, saved_stop_freq,
                     saved_samplerate_mode, saved_freq_scale,
-                    saved_alter_scale, saved_xover_band);
+                    saved_alter_scale, saved_xover_band);          
             }
 
-            /* we should be able to safely set result to 0 now */
-            result = 0;
+            /* we should be able to safely set result to 0 now, */
+            /* but practise indicates this doesn't work well */
         }
     } else {
         result = 1;
     }
 
-#ifdef DRM
-    if (!sbr->Is_DRM_SBR)
-#endif
+    num_sbr_bits2 = (uint16_t)faad_get_processed_bits(ld) - num_sbr_bits1;
+
+    /* check if we read more bits then were available for sbr */
+    if (8*cnt < num_sbr_bits2)
     {
-        num_sbr_bits = (uint16_t)faad_get_processed_bits(ld) - num_sbr_bits;
+        faad_resetbits(ld, num_sbr_bits1 + 8*cnt);
+        num_sbr_bits2 = 8*cnt;
 
-        /* check if we read more bits then were available for sbr */
-        if (8*cnt < num_sbr_bits)
-            return 1;
+#ifdef PS_DEC
+        /* turn off PS for the unfortunate case that we randomly read some
+         * PS data that looks correct */
+        sbr->ps_used = 0;
+#endif
+
+        /* Make sure it doesn't decode SBR in this frame, or we'll get glitches */
+        return 1;
+    }
 
+#ifdef DRM
+    if (!sbr->Is_DRM_SBR)
+#endif
+    {       
         /* -4 does not apply, bs_extension_type is re-read in this function */
-        num_align_bits = 8*cnt /*- 4*/ - num_sbr_bits;
+        num_align_bits = 8*cnt /*- 4*/ - num_sbr_bits2;
 
         while (num_align_bits > 7)
         {
@@ -364,11 +387,14 @@
 #ifdef DRM
     /* bs_coupling, from sbr_channel_pair_base_element(bs_amp_res) */
     if (sbr->Is_DRM_SBR)
+    {
         faad_get1bit(ld);
+    }
 #endif
 
     if ((result = sbr_grid(ld, sbr, 0)) > 0)
         return result;
+
     sbr_dtdf(ld, sbr, 0);
     invf_mode(ld, sbr, 0);
     sbr_envelope(ld, sbr, 0);
@@ -431,7 +457,11 @@
                 } else {
                     /* to be safe make it 3, will switch to "default"
                      * in sbr_extension() */
+#ifdef DRM
+                    return 1;
+#else
                     sbr->bs_extension_id = 3;
+#endif
                 }
             }
 #endif
@@ -829,6 +859,10 @@
         {
             sbr->ps = ps_init(get_sr_index(sbr->sample_rate));
         }
+        if (sbr->psResetFlag)
+        {
+            sbr->ps->header_read = 0;
+        }
         ret = ps_data(sbr->ps, ld, &header);
 
         /* enable PS if and only if: a header has been decoded */
@@ -837,6 +871,11 @@
             sbr->ps_used = 1;
         }
 
+        if (header == 1)
+        {
+            sbr->psResetFlag = 0;
+        }
+
         return ret;
 #endif
 #ifdef DRM_PS
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_syntax.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_syntax.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_syntax.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_syntax.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_syntax.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_syntax.h,v 1.23 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SBR_SYNTAX_H__
@@ -55,7 +58,8 @@
 #define NOISE_FLOOR_OFFSET 6
 
 
-uint8_t sbr_extension_data(bitfile *ld, sbr_info *sbr, uint16_t cnt);
+uint8_t sbr_extension_data(bitfile *ld, sbr_info *sbr, uint16_t cnt,
+                           uint8_t resetFlag);
 
 #ifdef __cplusplus
 }
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_tf_grid.c xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_tf_grid.c
--- xine-lib-1.1.11.1/src/libfaad/sbr_tf_grid.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_tf_grid.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_tf_grid.c,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_tf_grid.c,v 1.19 2007/11/01 12:33:36 menno Exp $
 **/
 
 /* Time/Frequency grid */
diff -Nur xine-lib-1.1.11.1/src/libfaad/sbr_tf_grid.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_tf_grid.h
--- xine-lib-1.1.11.1/src/libfaad/sbr_tf_grid.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sbr_tf_grid.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sbr_tf_grid.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sbr_tf_grid.h,v 1.17 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SBR_TF_GRID_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/sine_win.h xine-lib-1.1.11.1-ubuntu/src/libfaad/sine_win.h
--- xine-lib-1.1.11.1/src/libfaad/sine_win.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/sine_win.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: sine_win.h,v 1.6 2005/10/29 23:57:07 tmmm Exp $
+** $Id: sine_win.h,v 1.19 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SINE_WIN_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/specrec.c xine-lib-1.1.11.1-ubuntu/src/libfaad/specrec.c
--- xine-lib-1.1.11.1/src/libfaad/specrec.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/specrec.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: specrec.c,v 1.10 2006/06/17 20:43:57 dgp85 Exp $
+** $Id: specrec.c,v 1.60 2007/11/01 12:33:36 menno Exp $
 **/
 
 /*
@@ -327,6 +330,11 @@
         }
 #endif
 
+        if (ics->max_sfb > ics->num_swb)
+        {
+            return 32;
+        }
+
         /* preparation of sect_sfb_offset for long blocks */
         /* also copy the last value! */
 #ifdef LD_DEC
@@ -348,6 +356,7 @@
             }
             ics->sect_sfb_offset[0][ics->num_swb] = hDecoder->frameLength;
             ics->swb_offset[ics->num_swb] = hDecoder->frameLength;
+            ics->swb_offset_max = hDecoder->frameLength;
         } else {
 #endif
             for (i = 0; i < ics->num_swb; i++)
@@ -357,6 +366,7 @@
             }
             ics->sect_sfb_offset[0][ics->num_swb] = hDecoder->frameLength;
             ics->swb_offset[ics->num_swb] = hDecoder->frameLength;
+            ics->swb_offset_max = hDecoder->frameLength;
 #ifdef LD_DEC
         }
 #endif
@@ -367,9 +377,15 @@
         ics->window_group_length[ics->num_window_groups-1] = 1;
         ics->num_swb = num_swb_128_window[sf_index];
 
+        if (ics->max_sfb > ics->num_swb)
+        {
+            return 32;
+        }
+
         for (i = 0; i < ics->num_swb; i++)
             ics->swb_offset[i] = swb_offset_128_window[sf_index][i];
         ics->swb_offset[ics->num_swb] = hDecoder->frameLength/8;
+        ics->swb_offset_max = hDecoder->frameLength/8;
 
         for (i = 0; i < ics->num_windows-1; i++) {
             if (bit_set(ics->scale_factor_grouping, 6-i) == 0)
@@ -405,7 +421,7 @@
         }
         return 0;
     default:
-        return 1;
+        return 32;
     }
 }
 
@@ -667,25 +683,46 @@
 static uint8_t allocate_single_channel(NeAACDecHandle hDecoder, uint8_t channel,
                                        uint8_t output_channels)
 {
-    uint8_t mul = 1;
+    int mul = 1;
 
 #ifdef MAIN_DEC
     /* MAIN object type prediction */
     if (hDecoder->object_type == MAIN)
     {
-            hDecoder->pred_stat[channel] = (pred_state*)realloc(hDecoder->pred_stat[channel], hDecoder->frameLength * sizeof(pred_state));
-            reset_all_predictors(hDecoder->pred_stat[channel], hDecoder->frameLength);
+        /* allocate the state only when needed */
+        if (hDecoder->pred_stat[channel] != NULL)
+        {
+            faad_free(hDecoder->pred_stat[channel]);
+            hDecoder->pred_stat[channel] = NULL;
+        }
+
+        hDecoder->pred_stat[channel] = (pred_state*)faad_malloc(hDecoder->frameLength * sizeof(pred_state));
+        reset_all_predictors(hDecoder->pred_stat[channel], hDecoder->frameLength);
     }
 #endif
 
 #ifdef LTP_DEC
     if (is_ltp_ot(hDecoder->object_type))
     {
-            hDecoder->lt_pred_stat[channel] = (int16_t*)realloc(hDecoder->lt_pred_stat[channel], hDecoder->frameLength*4 * sizeof(int16_t));
-            memset(hDecoder->lt_pred_stat[channel], 0, hDecoder->frameLength*4 * sizeof(int16_t));
+        /* allocate the state only when needed */
+        if (hDecoder->lt_pred_stat[channel] != NULL)
+        {
+            faad_free(hDecoder->lt_pred_stat[channel]);
+            hDecoder->lt_pred_stat[channel] = NULL;
+        }
+
+        hDecoder->lt_pred_stat[channel] = (int16_t*)faad_malloc(hDecoder->frameLength*4 * sizeof(int16_t));
+        memset(hDecoder->lt_pred_stat[channel], 0, hDecoder->frameLength*4 * sizeof(int16_t));
     }
 #endif
 
+    if (hDecoder->time_out[channel] != NULL)
+    {
+        faad_free(hDecoder->time_out[channel]);
+        hDecoder->time_out[channel] = NULL;
+    }
+
+    {
         mul = 1;
 #ifdef SBR_DEC
         hDecoder->sbr_alloced[hDecoder->fr_ch_ele] = 0;
@@ -696,28 +733,48 @@
             hDecoder->sbr_alloced[hDecoder->fr_ch_ele] = 1;
         }
 #endif
-        hDecoder->time_out[channel] = (real_t*)realloc(hDecoder->time_out[channel], mul*hDecoder->frameLength*sizeof(real_t));
+        hDecoder->time_out[channel] = (real_t*)faad_malloc(mul*hDecoder->frameLength*sizeof(real_t));
         memset(hDecoder->time_out[channel], 0, mul*hDecoder->frameLength*sizeof(real_t));
+    }
+
 #if (defined(PS_DEC) || defined(DRM_PS))
     if (output_channels == 2)
     {
-            hDecoder->time_out[channel+1] = (real_t*)realloc(hDecoder->time_out[channel+1], mul*hDecoder->frameLength*sizeof(real_t));
-            memset(hDecoder->time_out[channel+1], 0, mul*hDecoder->frameLength*sizeof(real_t));
+        if (hDecoder->time_out[channel+1] != NULL)
+        {
+            faad_free(hDecoder->time_out[channel+1]);
+            hDecoder->time_out[channel+1] = NULL;
+        }
+
+        hDecoder->time_out[channel+1] = (real_t*)faad_malloc(mul*hDecoder->frameLength*sizeof(real_t));
+        memset(hDecoder->time_out[channel+1], 0, mul*hDecoder->frameLength*sizeof(real_t));
     }
 #endif
 
-        hDecoder->fb_intermed[channel] = (real_t*)realloc(hDecoder->fb_intermed[channel], hDecoder->frameLength*sizeof(real_t));
-        memset(hDecoder->fb_intermed[channel], 0, hDecoder->frameLength*sizeof(real_t));
+    if (hDecoder->fb_intermed[channel] != NULL)
+    {
+        faad_free(hDecoder->fb_intermed[channel]);
+        hDecoder->fb_intermed[channel] = NULL;
+    }
+
+    hDecoder->fb_intermed[channel] = (real_t*)faad_malloc(hDecoder->frameLength*sizeof(real_t));
+    memset(hDecoder->fb_intermed[channel], 0, hDecoder->frameLength*sizeof(real_t));
 
 #ifdef SSR_DEC
     if (hDecoder->object_type == SSR)
     {
-            uint16_t k;
-            hDecoder->ssr_overlap[channel] = (real_t*)realloc(hDecoder->ssr_overlap[channel], 2*hDecoder->frameLength*sizeof(real_t));
+        if (hDecoder->ssr_overlap[channel] == NULL)
+        {
+            hDecoder->ssr_overlap[channel] = (real_t*)faad_malloc(2*hDecoder->frameLength*sizeof(real_t));
             memset(hDecoder->ssr_overlap[channel], 0, 2*hDecoder->frameLength*sizeof(real_t));
-            hDecoder->prev_fmd[channel] = (real_t*)realloc(hDecoder->prev_fmd[channel], 2*hDecoder->frameLength*sizeof(real_t));
+        }
+        if (hDecoder->prev_fmd[channel] == NULL)
+        {
+            uint16_t k;
+            hDecoder->prev_fmd[channel] = (real_t*)faad_malloc(2*hDecoder->frameLength*sizeof(real_t));
             for (k = 0; k < 2*hDecoder->frameLength; k++)
                 hDecoder->prev_fmd[channel][k] = REAL_CONST(-1);
+        }
     }
 #endif
 
@@ -727,7 +784,7 @@
 static uint8_t allocate_channel_pair(NeAACDecHandle hDecoder,
                                      uint8_t channel, uint8_t paired_channel)
 {
-    uint8_t mul = 1;
+    int mul = 1;
 
 #ifdef MAIN_DEC
     /* MAIN object type prediction */
@@ -832,7 +889,8 @@
 uint8_t reconstruct_single_channel(NeAACDecHandle hDecoder, ic_stream *ics,
                                    element *sce, int16_t *spec_data)
 {
-    uint8_t retval, output_channels;
+    uint8_t retval;
+    int output_channels;
     ALIGN real_t spec_coef[1024];
 
 #ifdef PROFILE
@@ -841,15 +899,38 @@
 
 
     /* always allocate 2 channels, PS can always "suddenly" turn up */
-#if (defined(PS_DEC) || defined(DRM_PS))
-    output_channels = hDecoder->ps_used[hDecoder->fr_ch_ele] ? 2 : 1;
+#if ( (defined(DRM) && defined(DRM_PS)) )
+    output_channels = 2;
+#elif defined(PS_DEC)
+    if (hDecoder->ps_used[hDecoder->fr_ch_ele])
+        output_channels = 2;
+    else
+        output_channels = 1;
 #else
     output_channels = 1;
 #endif
 
-    if (hDecoder->element_output_channels[hDecoder->fr_ch_ele] < output_channels)
+    if (hDecoder->element_output_channels[hDecoder->fr_ch_ele] == 0)
     {
+        /* element_output_channels not set yet */
         hDecoder->element_output_channels[hDecoder->fr_ch_ele] = output_channels;
+    } else if (hDecoder->element_output_channels[hDecoder->fr_ch_ele] != output_channels) {
+        /* element inconsistency */
+
+        /* this only happens if PS is actually found but not in the first frame
+         * this means that there is only 1 bitstream element!
+         */
+
+        /* reset the allocation */
+        hDecoder->element_alloced[hDecoder->fr_ch_ele] = 0;
+
+        hDecoder->element_output_channels[hDecoder->fr_ch_ele] = output_channels;
+
+        //return 21;
+    }
+
+    if (hDecoder->element_alloced[hDecoder->fr_ch_ele] == 0)
+    {
         retval = allocate_single_channel(hDecoder, sce->channel, output_channels);
         if (retval > 0)
             return retval;
@@ -870,7 +951,8 @@
 
 
     /* pns decoding */
-    pns_decode(ics, NULL, spec_coef, NULL, hDecoder->frameLength, 0, hDecoder->object_type);
+    pns_decode(ics, NULL, spec_coef, NULL, hDecoder->frameLength, 0, hDecoder->object_type,
+        &(hDecoder->__r1), &(hDecoder->__r2));
 
 #ifdef MAIN_DEC
     /* MAIN object type prediction */
@@ -954,8 +1036,8 @@
     if (((hDecoder->sbr_present_flag == 1) || (hDecoder->forceUpSampling == 1))
         && hDecoder->sbr_alloced[hDecoder->fr_ch_ele])
     {
-        uint8_t ele = hDecoder->fr_ch_ele;
-        uint8_t ch = sce->channel;
+        int ele = hDecoder->fr_ch_ele;
+        int ch = sce->channel;
 
         /* following case can happen when forceUpSampling == 1 */
         if (hDecoder->sbr[ele] == NULL)
@@ -970,9 +1052,9 @@
         }
 
         if (sce->ics1.window_sequence == EIGHT_SHORT_SEQUENCE)
-            hDecoder->sbr[ele]->maxAACLine = 8*sce->ics1.swb_offset[max(sce->ics1.max_sfb-1, 0)];
+            hDecoder->sbr[ele]->maxAACLine = 8*min(sce->ics1.swb_offset[max(sce->ics1.max_sfb-1, 0)], sce->ics1.swb_offset_max);
         else
-            hDecoder->sbr[ele]->maxAACLine = sce->ics1.swb_offset[max(sce->ics1.max_sfb-1, 0)];
+            hDecoder->sbr[ele]->maxAACLine = min(sce->ics1.swb_offset[max(sce->ics1.max_sfb-1, 0)], sce->ics1.swb_offset_max);
 
         /* check if any of the PS tools is used */
 #if (defined(PS_DEC) || defined(DRM_PS))
@@ -995,20 +1077,21 @@
     {
         return 23;
     }
+#endif
 
     /* copy L to R when no PS is used */
 #if (defined(PS_DEC) || defined(DRM_PS))
-    if ((hDecoder->ps_used[hDecoder->fr_ch_ele] == 0) && (output_channels == 2))
+    if ((hDecoder->ps_used[hDecoder->fr_ch_ele] == 0) &&
+        (hDecoder->element_output_channels[hDecoder->fr_ch_ele] == 2))
     {
-        uint8_t ele = hDecoder->fr_ch_ele;
-        uint8_t ch = sce->channel;
-        uint16_t frame_size = (hDecoder->sbr_alloced[ele]) ? 2 : 1;
+        int ele = hDecoder->fr_ch_ele;
+        int ch = sce->channel;
+        int frame_size = (hDecoder->sbr_alloced[ele]) ? 2 : 1;
         frame_size *= hDecoder->frameLength*sizeof(real_t);
 
         memcpy(hDecoder->time_out[ch+1], hDecoder->time_out[ch], frame_size);
     }
 #endif
-#endif
 
     return 0;
 }
@@ -1049,10 +1132,13 @@
     /* pns decoding */
     if (ics1->ms_mask_present)
     {
-        pns_decode(ics1, ics2, spec_coef1, spec_coef2, hDecoder->frameLength, 1, hDecoder->object_type);
+        pns_decode(ics1, ics2, spec_coef1, spec_coef2, hDecoder->frameLength, 1, hDecoder->object_type,
+            &(hDecoder->__r1), &(hDecoder->__r2));
     } else {
-        pns_decode(ics1, NULL, spec_coef1, NULL, hDecoder->frameLength, 0, hDecoder->object_type);
-        pns_decode(ics2, NULL, spec_coef2, NULL, hDecoder->frameLength, 0, hDecoder->object_type);
+        pns_decode(ics1, NULL, spec_coef1, NULL, hDecoder->frameLength, 0, hDecoder->object_type,
+            &(hDecoder->__r1), &(hDecoder->__r2));
+        pns_decode(ics2, NULL, spec_coef2, NULL, hDecoder->frameLength, 0, hDecoder->object_type,
+            &(hDecoder->__r1), &(hDecoder->__r2));
     }
 
     /* mid/side decoding */
@@ -1204,9 +1290,9 @@
     if (((hDecoder->sbr_present_flag == 1) || (hDecoder->forceUpSampling == 1))
         && hDecoder->sbr_alloced[hDecoder->fr_ch_ele])
     {
-        uint8_t ele = hDecoder->fr_ch_ele;
-        uint8_t ch0 = cpe->channel;
-        uint8_t ch1 = cpe->paired_channel;
+        int ele = hDecoder->fr_ch_ele;
+        int ch0 = cpe->channel;
+        int ch1 = cpe->paired_channel;
 
         /* following case can happen when forceUpSampling == 1 */
         if (hDecoder->sbr[ele] == NULL)
@@ -1221,9 +1307,9 @@
         }
 
         if (cpe->ics1.window_sequence == EIGHT_SHORT_SEQUENCE)
-            hDecoder->sbr[ele]->maxAACLine = 8*cpe->ics1.swb_offset[max(cpe->ics1.max_sfb-1, 0)];
+            hDecoder->sbr[ele]->maxAACLine = 8*min(cpe->ics1.swb_offset[max(cpe->ics1.max_sfb-1, 0)], cpe->ics1.swb_offset_max);
         else
-            hDecoder->sbr[ele]->maxAACLine = cpe->ics1.swb_offset[max(cpe->ics1.max_sfb-1, 0)];
+            hDecoder->sbr[ele]->maxAACLine = min(cpe->ics1.swb_offset[max(cpe->ics1.max_sfb-1, 0)], cpe->ics1.swb_offset_max);
 
         retval = sbrDecodeCoupleFrame(hDecoder->sbr[ele],
             hDecoder->time_out[ch0], hDecoder->time_out[ch1],
diff -Nur xine-lib-1.1.11.1/src/libfaad/specrec.h xine-lib-1.1.11.1-ubuntu/src/libfaad/specrec.h
--- xine-lib-1.1.11.1/src/libfaad/specrec.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/specrec.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: specrec.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: specrec.h,v 1.32 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SPECREC_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/ssr.c xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr.c
--- xine-lib-1.1.11.1/src/libfaad/ssr.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ssr.c,v 1.6 2005/10/29 23:57:07 tmmm Exp $
+** $Id: ssr.c,v 1.19 2007/11/01 12:33:36 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/ssr_fb.c xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_fb.c
--- xine-lib-1.1.11.1/src/libfaad/ssr_fb.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_fb.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ssr_fb.c,v 1.6 2005/10/29 23:57:07 tmmm Exp $
+** $Id: ssr_fb.c,v 1.17 2007/11/01 12:33:36 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/ssr_fb.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_fb.h
--- xine-lib-1.1.11.1/src/libfaad/ssr_fb.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_fb.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
-** FAAD - Freeware Advanced Audio Decoder
-** Copyright (C) 2002 M. Bakker
+** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
+** Copyright (C) 2003-2005 M. Bakker, Ahead Software AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -16,7 +16,16 @@
 ** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
-** $Id: ssr_fb.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** Any non-GPL usage of this software or parts of this software is strictly
+** forbidden.
+**
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
+** Commercial non-GPL licensing of this software is possible.
+** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+**
+** $Id: ssr_fb.h,v 1.16 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SSR_FB_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/ssr.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr.h
--- xine-lib-1.1.11.1/src/libfaad/ssr.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ssr.h,v 1.6 2005/10/29 23:57:07 tmmm Exp $
+** $Id: ssr.h,v 1.19 2007/11/01 12:33:36 menno Exp $
 **/
 
 #ifndef __SSR_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/ssr_ipqf.c xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_ipqf.c
--- xine-lib-1.1.11.1/src/libfaad/ssr_ipqf.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_ipqf.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: ssr_ipqf.c,v 1.6 2005/10/29 23:57:07 tmmm Exp $
+** $Id: ssr_ipqf.c,v 1.18 2007/11/01 12:33:39 menno Exp $
 **/
 
 #include "common.h"
diff -Nur xine-lib-1.1.11.1/src/libfaad/ssr_ipqf.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_ipqf.h
--- xine-lib-1.1.11.1/src/libfaad/ssr_ipqf.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_ipqf.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
-** FAAD - Freeware Advanced Audio Decoder
-** Copyright (C) 2002 M. Bakker
+** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
+** Copyright (C) 2003-2005 M. Bakker, Ahead Software AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -16,7 +16,16 @@
 ** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
-** $Id: ssr_ipqf.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** Any non-GPL usage of this software or parts of this software is strictly
+** forbidden.
+**
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
+** Commercial non-GPL licensing of this software is possible.
+** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+**
+** $Id: ssr_ipqf.h,v 1.17 2007/11/01 12:33:39 menno Exp $
 **/
 
 #ifndef __SSR_IPQF_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/ssr_win.h xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_win.h
--- xine-lib-1.1.11.1/src/libfaad/ssr_win.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/ssr_win.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
-** FAAD - Freeware Advanced Audio Decoder
-** Copyright (C) 2002 M. Bakker
+** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
+** Copyright (C) 2003-2005 M. Bakker, Ahead Software AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -16,7 +16,16 @@
 ** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
-** $Id: ssr_win.h,v 1.5 2005/10/29 23:57:07 tmmm Exp $
+** Any non-GPL usage of this software or parts of this software is strictly
+** forbidden.
+**
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
+** Commercial non-GPL licensing of this software is possible.
+** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+**
+** $Id: ssr_win.h,v 1.16 2007/11/01 12:33:39 menno Exp $
 **/
 
 #ifndef __SSR_WIN_H__
diff -Nur xine-lib-1.1.11.1/src/libfaad/structs.h xine-lib-1.1.11.1-ubuntu/src/libfaad/structs.h
--- xine-lib-1.1.11.1/src/libfaad/structs.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/structs.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,28 +1,31 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
-**
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
+**  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
 ** the Free Software Foundation; either version 2 of the License, or
 ** (at your option) any later version.
-**
+** 
 ** This program is distributed in the hope that it will be useful,
 ** but WITHOUT ANY WARRANTY; without even the implied warranty of
 ** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 ** GNU General Public License for more details.
-**
+** 
 ** You should have received a copy of the GNU General Public License
-** along with this program; if not, write to the Free Software
+** along with this program; if not, write to the Free Software 
 ** Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 **
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: structs.h,v 1.7 2005/10/29 23:57:07 tmmm Exp $
+** $Id: structs.h,v 1.46 2007/11/01 12:33:40 menno Exp $
 **/
 
 #ifndef __STRUCTS_H__
@@ -247,6 +250,7 @@
     uint8_t scale_factor_grouping;
     uint16_t sect_sfb_offset[8][15*8];
     uint16_t swb_offset[52];
+    uint16_t swb_offset_max;
 
     uint8_t sect_cb[8][15*8];
     uint16_t sect_start[8][15*8];
@@ -261,6 +265,7 @@
     uint8_t ms_used[MAX_WINDOW_GROUPS][MAX_SFB];
 
     uint8_t noise_used;
+    uint8_t is_used;
 
     uint8_t pulse_data_present;
     uint8_t tns_data_present;
@@ -447,6 +452,14 @@
     int16_t *lt_pred_stat[MAX_CHANNELS];
 #endif
 
+#ifdef DRM
+    uint8_t error_state;
+#endif
+
+    /* RNG states */
+    uint32_t __r1;
+    uint32_t __r2;
+
     /* Program Config Element */
     uint8_t pce_set;
     program_config pce;
@@ -463,6 +476,7 @@
     int64_t scalefac_cycles;
     int64_t requant_cycles;
 #endif
+	const unsigned char *cmes;
 } NeAACDecStruct, *NeAACDecHandle;
 
 
diff -Nur xine-lib-1.1.11.1/src/libfaad/syntax.c xine-lib-1.1.11.1-ubuntu/src/libfaad/syntax.c
--- xine-lib-1.1.11.1/src/libfaad/syntax.c	2008-01-23 06:11:52.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/syntax.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: syntax.c,v 1.10 2006/09/26 17:48:24 dgp85 Exp $
+** $Id: syntax.c,v 1.89 2007/11/01 12:33:40 menno Exp $
 **/
 
 /*
@@ -93,9 +96,11 @@
 static void adts_error_check(adts_header *adts, bitfile *ld);
 static uint8_t dynamic_range_info(bitfile *ld, drc_info *drc);
 static uint8_t excluded_channels(bitfile *ld, drc_info *drc);
-#ifdef SCALABLE_DEC
-static int8_t aac_scalable_main_header(NeAACDecHandle hDecoder, ic_stream *ics1, ic_stream *ics2,
-                                       bitfile *ld, uint8_t this_layer_stereo);
+static uint8_t side_info(NeAACDecHandle hDecoder, element *ele,
+                         bitfile *ld, ic_stream *ics, uint8_t scal_flag);
+#ifdef DRM
+static int8_t DRM_aac_scalable_main_header(NeAACDecHandle hDecoder, ic_stream *ics1, ic_stream *ics2,
+                                           bitfile *ld, uint8_t this_layer_stereo);
 #endif
 
 
@@ -323,7 +328,7 @@
     uint8_t channels = hDecoder->fr_channels;
     uint8_t tag = 0;
 
-    if (channels+1 >= MAX_CHANNELS)
+    if (channels+1 > MAX_CHANNELS)
     {
         hInfo->error = 12;
         return;
@@ -413,6 +418,7 @@
                     bitfile *ld, program_config *pce, drc_info *drc)
 {
     uint8_t id_syn_ele;
+    uint8_t ele_this_frame = 0;
 
     hDecoder->fr_channels = 0;
     hDecoder->fr_ch_ele = 0;
@@ -429,36 +435,55 @@
         {
             switch (id_syn_ele) {
             case ID_SCE:
+                ele_this_frame++;
                 if (hDecoder->first_syn_ele == 25) hDecoder->first_syn_ele = id_syn_ele;
                 decode_sce_lfe(hDecoder, hInfo, ld, id_syn_ele);
                 if (hInfo->error > 0)
                     return;
                 break;
             case ID_CPE:
+                ele_this_frame++;
                 if (hDecoder->first_syn_ele == 25) hDecoder->first_syn_ele = id_syn_ele;
                 decode_cpe(hDecoder, hInfo, ld, id_syn_ele);
                 if (hInfo->error > 0)
                     return;
                 break;
             case ID_LFE:
+#ifdef DRM
+                hInfo->error = 32;
+#else
+                ele_this_frame++;
                 hDecoder->has_lfe++;
                 decode_sce_lfe(hDecoder, hInfo, ld, id_syn_ele);
+#endif
                 if (hInfo->error > 0)
                     return;
                 break;
             case ID_CCE: /* not implemented yet, but skip the bits */
+#ifdef DRM
+                hInfo->error = 32;
+#else
+                ele_this_frame++;
 #ifdef COUPLING_DEC
                 hInfo->error = coupling_channel_element(hDecoder, ld);
 #else
                 hInfo->error = 6;
 #endif
+#endif
                 if (hInfo->error > 0)
                     return;
                 break;
             case ID_DSE:
+                ele_this_frame++;
                 data_stream_element(hDecoder, ld);
                 break;
             case ID_PCE:
+                if (ele_this_frame != 0)
+                {
+                    hInfo->error = 31;
+                    return;
+                }
+                ele_this_frame++;
                 /* 14496-4: 5.6.4.1.2.1.3: */
                 /* program_configuration_element()'s in access units shall be ignored */
                 program_config_element(pce, ld);
@@ -467,6 +492,7 @@
                 //hDecoder->pce_set = 1;
                 break;
             case ID_FIL:
+                ele_this_frame++;
                 /* one sbr_info describes a channel_element not a channel! */
                 /* if we encounter SBR data here: error */
                 /* SBR data will be read directly in the SCE/LFE/CPE element */
@@ -577,6 +603,10 @@
     if (retval > 0)
         return retval;
 
+    /* IS not allowed in single channel */
+    if (ics->is_used)
+        return 32;
+
 #ifdef SBR_DEC
     /* check if next bitstream element is a fill element */
     /* if so, read it now so SBR decoding can be done in case of a file with SBR */
@@ -627,6 +657,11 @@
 
         ics1->ms_mask_present = (uint8_t)faad_getbits(ld, 2
             DEBUGVAR(1,41,"channel_pair_element(): ms_mask_present"));
+        if (ics1->ms_mask_present == 3)
+        {
+            /* bitstream error */
+            return 32;
+        }
         if (ics1->ms_mask_present == 1)
         {
             uint8_t g, sfb;
@@ -730,14 +765,23 @@
                         uint8_t common_window)
 {
     uint8_t retval = 0;
+    uint8_t ics_reserved_bit;
 
-    /* ics->ics_reserved_bit = */ faad_get1bit(ld
+    ics_reserved_bit = faad_get1bit(ld
         DEBUGVAR(1,43,"ics_info(): ics_reserved_bit"));
+    if (ics_reserved_bit != 0)
+        return 32;
     ics->window_sequence = (uint8_t)faad_getbits(ld, 2
         DEBUGVAR(1,44,"ics_info(): window_sequence"));
     ics->window_shape = faad_get1bit(ld
         DEBUGVAR(1,45,"ics_info(): window_shape"));
 
+#ifdef LD_DEC
+    /* No block switching in LD */
+    if ((hDecoder->object_type == LD) && (ics->window_sequence != ONLY_LONG_SEQUENCE))
+        return 32;
+#endif
+
     if (ics->window_sequence == EIGHT_SHORT_SEQUENCE)
     {
         ics->max_sfb = (uint8_t)faad_getbits(ld, 4
@@ -753,6 +797,7 @@
     if ((retval = window_grouping_info(hDecoder, ics)) > 0)
         return retval;
 
+
     /* should be an error */
     /* check the range of max_sfb */
     if (ics->max_sfb > ics->num_swb)
@@ -922,6 +967,10 @@
         return result;
     }
 
+    /* IS not allowed in single channel */
+    if (ics->is_used)
+        return 32;
+
     for (c = 1; c < num_gain_element_lists; c++)
     {
         uint8_t cge;
@@ -1029,7 +1078,8 @@
             hDecoder->sbr_present_flag = 1;
 
             /* parse the SBR data */
-            hDecoder->sbr[sbr_ele]->ret = sbr_extension_data(ld, hDecoder->sbr[sbr_ele], count);
+            hDecoder->sbr[sbr_ele]->ret = sbr_extension_data(ld, hDecoder->sbr[sbr_ele], count,
+                hDecoder->postSeekResetFlag);
 
 #if 0
             if (hDecoder->sbr[sbr_ele]->ret > 0)
@@ -1049,10 +1099,14 @@
 #endif
         } else {
 #endif
+#ifndef DRM
             while (count > 0)
             {
                 count -= extension_payload(ld, drc, count);
             }
+#else
+            return 30;
+#endif
 #ifdef SBR_DEC
         }
 #endif
@@ -1157,10 +1211,10 @@
 }
 #endif
 
-#ifdef SCALABLE_DEC
+#ifdef DRM
 /* Table 4.4.13 ASME */
-void aac_scalable_main_element(NeAACDecHandle hDecoder, NeAACDecFrameInfo *hInfo,
-                               bitfile *ld, program_config *pce, drc_info *drc)
+void DRM_aac_scalable_main_element(NeAACDecHandle hDecoder, NeAACDecFrameInfo *hInfo,
+                                   bitfile *ld, program_config *pce, drc_info *drc)
 {
     uint8_t retval = 0;
     uint8_t channels = hDecoder->fr_channels = 0;
@@ -1175,7 +1229,7 @@
 
     hDecoder->fr_ch_ele = 0;
 
-    hInfo->error = aac_scalable_main_header(hDecoder, ics1, ics2, ld, this_layer_stereo);
+    hInfo->error = DRM_aac_scalable_main_header(hDecoder, ics1, ics2, ld, this_layer_stereo);
     if (hInfo->error > 0)
         return;
 
@@ -1189,22 +1243,77 @@
         hDecoder->element_id[0] = ID_SCE;
     }
 
-    for (ch = 0; ch < (this_layer_stereo ? 2 : 1); ch++)
+    if (this_layer_stereo)
     {
-        ic_stream *ics;
-        if (ch == 0)
-        {
-            ics = ics1;
-            spec_data = spec_data1;
-        } else {
-            ics = ics2;
-            spec_data = spec_data2;
-        }
+        cpe.channel        = 0;
+        cpe.paired_channel = 1;
+    }
+
+
+    /* Stereo2 / Mono1 */
+    ics1->tns_data_present = faad_get1bit(ld);
 
-        hInfo->error = individual_channel_stream(hDecoder, &cpe, ld, ics, 1, spec_data);
+#if defined(LTP_DEC)
+    ics1->ltp.data_present = faad_get1bit(ld);
+#elif defined (DRM)
+    if(faad_get1bit(ld)) {
+         hInfo->error = 26;
+         return;
+    }
+#else
+    faad_get1bit(ld);
+#endif    
+
+    hInfo->error = side_info(hDecoder, &cpe, ld, ics1, 1);
+    if (hInfo->error > 0)
+        return;
+    if (this_layer_stereo)
+    {
+        /* Stereo3 */
+        ics2->tns_data_present = faad_get1bit(ld);
+#ifdef LTP_DEC
+        ics1->ltp.data_present =
+#endif
+            faad_get1bit(ld);
+        hInfo->error = side_info(hDecoder, &cpe, ld, ics2, 1);
         if (hInfo->error > 0)
             return;
     }
+    /* Stereo4 / Mono2 */
+    if (ics1->tns_data_present)
+        tns_data(ics1, &(ics1->tns), ld);
+    if (this_layer_stereo)
+    {
+        /* Stereo5 */
+        if (ics2->tns_data_present)
+            tns_data(ics2, &(ics2->tns), ld);
+    }
+
+#ifdef DRM
+    /* CRC check */
+    if (hDecoder->object_type == DRM_ER_LC)
+    {
+        if ((hInfo->error = (uint8_t)faad_check_CRC(ld, (uint16_t)faad_get_processed_bits(ld) - 8)) > 0)
+            return;
+    }
+#endif
+
+    /* Stereo6 / Mono3 */
+    /* error resilient spectral data decoding */
+    if ((hInfo->error = reordered_spectral_data(hDecoder, ics1, ld, spec_data1)) > 0)
+    {
+        return;
+    }
+    if (this_layer_stereo)
+    {
+        /* Stereo7 */
+        /* error resilient spectral data decoding */
+        if ((hInfo->error = reordered_spectral_data(hDecoder, ics2, ld, spec_data2)) > 0)
+        {
+            return;
+        }
+    }
+
 
 #ifdef DRM
 #ifdef SBR_DEC
@@ -1244,6 +1353,7 @@
 
         /* Set SBR data */
         /* consider 8 bits from AAC-CRC */
+        /* SBR buffer size is original buffer size minus AAC buffer size */
         count = (uint16_t)bit2byte(buffer_size*8 - bitsconsumed);
         faad_initbits(&ld_sbr, revbuffer, count);
 
@@ -1252,7 +1362,7 @@
 
         faad_getbits(&ld_sbr, 8); /* Skip 8-bit CRC */
 
-        hDecoder->sbr[0]->ret = sbr_extension_data(&ld_sbr, hDecoder->sbr[0], count);
+        hDecoder->sbr[0]->ret = sbr_extension_data(&ld_sbr, hDecoder->sbr[0], count, hDecoder->postSeekResetFlag);
 #if (defined(PS_DEC) || defined(DRM_PS))
         if (hDecoder->sbr[0]->ps_used)
         {
@@ -1261,6 +1371,11 @@
         }
 #endif
 
+        if (ld_sbr.error)
+        {
+            hDecoder->sbr[0]->ret = 1;
+        }
+
         /* check CRC */
         /* no need to check it if there was already an error */
         if (hDecoder->sbr[0]->ret == 0)
@@ -1269,7 +1384,7 @@
         /* SBR data was corrupted, disable it until the next header */
         if (hDecoder->sbr[0]->ret != 0)
         {
-            hDecoder->sbr[0]->header_count = 0;  
+            hDecoder->sbr[0]->header_count = 0;
         }
 
         faad_endbits(&ld_sbr);
@@ -1308,15 +1423,18 @@
 }
 
 /* Table 4.4.15 */
-static int8_t aac_scalable_main_header(NeAACDecHandle hDecoder, ic_stream *ics1, ic_stream *ics2,
-                                       bitfile *ld, uint8_t this_layer_stereo)
+static int8_t DRM_aac_scalable_main_header(NeAACDecHandle hDecoder, ic_stream *ics1, ic_stream *ics2,
+                                           bitfile *ld, uint8_t this_layer_stereo)
 {
     uint8_t retval = 0;
     uint8_t ch;
     ic_stream *ics;
+    uint8_t ics_reserved_bit;
 
-    /* ics1->ics_reserved_bit = */ faad_get1bit(ld
+    ics_reserved_bit = faad_get1bit(ld
         DEBUGVAR(1,300,"aac_scalable_main_header(): ics_reserved_bits"));
+    if (ics_reserved_bit != 0)
+        return 32;
     ics1->window_sequence = (uint8_t)faad_getbits(ld, 2
         DEBUGVAR(1,301,"aac_scalable_main_header(): window_sequence"));
     ics1->window_shape = faad_get1bit(ld
@@ -1346,6 +1464,11 @@
     {
         ics1->ms_mask_present = (uint8_t)faad_getbits(ld, 2
             DEBUGVAR(1,306,"aac_scalable_main_header(): ms_mask_present"));
+        if (ics1->ms_mask_present == 3)
+        {
+            /* bitstream error */
+            return 32;
+        }
         if (ics1->ms_mask_present == 1)
         {
             uint8_t g, sfb;
@@ -1364,70 +1487,12 @@
         ics1->ms_mask_present = 0;
     }
 
-    if (0)
-    {
-        faad_get1bit(ld
-            DEBUGVAR(1,308,"aac_scalable_main_header(): tns_channel_mono_layer"));
-    }
-
-    for (ch = 0; ch < (this_layer_stereo ? 2 : 1); ch++)
-    {
-        if (ch == 0)
-            ics = ics1;
-        else
-            ics = ics2;
-
-        if ( 1 /*!tvq_layer_pesent || (tns_aac_tvq_en[ch] == 1)*/)
-        {
-            if ((ics->tns_data_present = faad_get1bit(ld
-                DEBUGVAR(1,309,"aac_scalable_main_header(): tns_data_present"))) & 1)
-            {
-#ifdef DRM
-                /* different order of data units in DRM */
-                if (hDecoder->object_type != DRM_ER_LC)
-#endif
-                {
-                    tns_data(ics, &(ics->tns), ld);
-                }
-            }
-        }
-#if 0
-        if (0 /*core_flag || tvq_layer_pesent*/)
-        {
-            if ((ch==0) || ((ch==1) && (core_stereo || tvq_stereo))
-                diff_control_data();
-            if (mono_stereo_flag)
-                diff_control_data_lr();
-        } else {
-#endif
-            if ((
-#ifdef LTP_DEC
-                ics->ltp.data_present =
-#endif
-                faad_get1bit(ld DEBUGVAR(1,310,"aac_scalable_main_header(): ltp.data_present"))) & 1)
-            {
-#ifdef LTP_DEC
-                if ((retval = ltp_data(hDecoder, ics, &(ics->ltp), ld)) > 0)
-                {
-                    return retval;
-                }
-#else
-                return 26;
-#endif
-            }
-#if 0
-        }
-#endif
-    }
-
     return 0;
 }
 #endif
 
-/* Table 4.4.24 */
-static uint8_t individual_channel_stream(NeAACDecHandle hDecoder, element *ele,
-                                         bitfile *ld, ic_stream *ics, uint8_t scal_flag,
-                                         int16_t *spec_data)
+static uint8_t side_info(NeAACDecHandle hDecoder, element *ele,
+                         bitfile *ld, ic_stream *ics, uint8_t scal_flag)
 {
     uint8_t result;
 
@@ -1513,6 +1578,21 @@
         if ((result = rvlc_decode_scale_factors(ics, ld)) > 0)
             return result;
     }
+#endif
+
+    return 0;
+}
+
+/* Table 4.4.24 */
+static uint8_t individual_channel_stream(NeAACDecHandle hDecoder, element *ele,
+                                         bitfile *ld, ic_stream *ics, uint8_t scal_flag,
+                                         int16_t *spec_data)
+{
+    uint8_t result;
+
+    result = side_info(hDecoder, ele, ld, ics, scal_flag);
+    if (result > 0)
+        return result;
 
     if (hDecoder->object_type >= ER_OBJECT_START) 
     {
@@ -1523,10 +1603,13 @@
 #ifdef DRM
     /* CRC check */
     if (hDecoder->object_type == DRM_ER_LC)
+    {
         if ((result = (uint8_t)faad_check_CRC(ld, (uint16_t)faad_get_processed_bits(ld) - 8)) > 0)
             return result;
+    }
 #endif
 
+#ifdef ERROR_RESILIENCE
     if (hDecoder->aacSpectralDataResilienceFlag)
     {
         /* error resilient spectral data decoding */
@@ -1594,7 +1677,7 @@
 
             /* if "faad_getbits" detects error and returns "0", "k" is never
                incremented and we cannot leave the while loop */
-            if ((ld->error != 0) || (ld->no_more_reading))
+            if (ld->error != 0)
                 return 14;
 
 #ifdef ERROR_RESILIENCE
@@ -1605,12 +1688,23 @@
             ics->sect_cb[g][i] = (uint8_t)faad_getbits(ld, sect_cb_bits
                 DEBUGVAR(1,71,"section_data(): sect_cb"));
 
+            if (ics->sect_cb[g][i] == 12)
+                return 32;
+
 #if 0
             printf("%d\n", ics->sect_cb[g][i]);
 #endif
 
+#ifndef DRM
             if (ics->sect_cb[g][i] == NOISE_HCB)
                 ics->noise_used = 1;
+#else
+            /* PNS not allowed in DRM */
+            if (ics->sect_cb[g][i] == NOISE_HCB)
+                return 29;
+#endif
+            if (ics->sect_cb[g][i] == INTENSITY_HCB2 || ics->sect_cb[g][i] == INTENSITY_HCB)
+                ics->is_used = 1;
 
 #ifdef ERROR_RESILIENCE
             if (hDecoder->aacSectionDataResilienceFlag)
@@ -1651,10 +1745,18 @@
             printf("%d\n", ics->sect_end[g][i]);
 #endif
 
-            if (k + sect_len >= 8*15)
-                return 15;
-            if (i >= 8*15)
-                return 15;
+            if (ics->window_sequence == EIGHT_SHORT_SEQUENCE)
+            {
+                if (k + sect_len > 8*15)
+                    return 15;
+                if (i >= 8*15)
+                    return 15;
+            } else {
+                if (k + sect_len > MAX_SFB)
+                    return 15;
+                if (i >= MAX_SFB)
+                    return 15;
+            }
 
             for (sfb = k; sfb < k + sect_len; sfb++)
             {
@@ -1675,6 +1777,13 @@
             i++;
         }
         ics->num_sec[g] = i;
+
+        /* the sum of all sect_len_incr elements for a given window
+         * group shall equal max_sfb */
+        if (k != ics->max_sfb)
+        {
+            return 32;
+        }
 #if 0
         printf("%d\n", ics->num_sec[g]);
 #endif
@@ -1735,6 +1844,7 @@
                 break;
             case NOISE_HCB: /* noise books */
 
+#ifndef DRM
                 /* decode noise energy */
                 if (noise_pcm_flag)
                 {
@@ -1750,6 +1860,10 @@
 #ifdef SF_PRINT
                 printf("%d\n", ics->scale_factors[g][sfb]);
 #endif
+#else
+                /* PNS not allowed in DRM */
+                return 29;
+#endif
 
                 break;
             default: /* spectral books */
@@ -2048,11 +2162,11 @@
         return n;
     case EXT_FILL_DATA:
         /* fill_nibble = */ faad_getbits(ld, 4
-            DEBUGVAR(1,136,"extension_payload(): fill_nibble")); /* must be '0000' */
+            DEBUGVAR(1,136,"extension_payload(): fill_nibble")); /* must be 0000 */
         for (i = 0; i < count-1; i++)
         {
             /* fill_byte[i] = */ faad_getbits(ld, 8
-                DEBUGVAR(1,88,"extension_payload(): fill_byte")); /* must be '10100101' */
+                DEBUGVAR(1,88,"extension_payload(): fill_byte")); /* must be 10100101 */
         }
         return count;
     case EXT_DATA_ELEMENT:
@@ -2127,7 +2241,7 @@
         n++;
         drc->num_bands += band_incr;
 
-        for (i = 0; i < drc->num_bands; i++);
+        for (i = 0; i < drc->num_bands; i++)
         {
             drc->band_top[i] = (uint8_t)faad_getbits(ld, 8
                 DEBUGVAR(1,97,"dynamic_range_info(): band_top"));
diff -Nur xine-lib-1.1.11.1/src/libfaad/syntax.h xine-lib-1.1.11.1-ubuntu/src/libfaad/syntax.h
--- xine-lib-1.1.11.1/src/libfaad/syntax.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/syntax.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: syntax.h,v 1.10 2005/10/29 23:57:07 tmmm Exp $
+** $Id: syntax.h,v 1.58 2007/11/01 12:33:40 menno Exp $
 **/
 
 #ifndef __SYNTAX_H__
@@ -114,9 +117,10 @@
                     bitfile *ld, program_config *pce, drc_info *drc);
 uint8_t reordered_spectral_data(NeAACDecHandle hDecoder, ic_stream *ics, bitfile *ld,
                                 int16_t *spectral_data);
-void aac_scalable_main_element(NeAACDecHandle hDecoder, NeAACDecFrameInfo *hInfo,
-                               bitfile *ld, program_config *pce, drc_info *drc);
-
+#ifdef DRM
+void DRM_aac_scalable_main_element(NeAACDecHandle hDecoder, NeAACDecFrameInfo *hInfo,
+                                   bitfile *ld, program_config *pce, drc_info *drc);
+#endif
 
 #ifdef __cplusplus
 }
diff -Nur xine-lib-1.1.11.1/src/libfaad/tns.c xine-lib-1.1.11.1-ubuntu/src/libfaad/tns.c
--- xine-lib-1.1.11.1/src/libfaad/tns.c	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/tns.c	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: tns.c,v 1.8 2005/10/29 23:57:07 tmmm Exp $
+** $Id: tns.c,v 1.40 2007/11/01 12:33:40 menno Exp $
 **/
 
 #include "common.h"
@@ -106,11 +109,11 @@
 
             start = min(bottom, max_tns_sfb(sr_index, object_type, (ics->window_sequence == EIGHT_SHORT_SEQUENCE)));
             start = min(start, ics->max_sfb);
-            start = ics->swb_offset[start];
+            start = min(ics->swb_offset[start], ics->swb_offset_max);
 
             end = min(top, max_tns_sfb(sr_index, object_type, (ics->window_sequence == EIGHT_SHORT_SEQUENCE)));
             end = min(end, ics->max_sfb);
-            end = ics->swb_offset[end];
+            end = min(ics->swb_offset[end], ics->swb_offset_max);
 
             size = end - start;
             if (size <= 0)
@@ -160,11 +163,11 @@
 
             start = min(bottom, max_tns_sfb(sr_index, object_type, (ics->window_sequence == EIGHT_SHORT_SEQUENCE)));
             start = min(start, ics->max_sfb);
-            start = ics->swb_offset[start];
+            start = min(ics->swb_offset[start], ics->swb_offset_max);
 
             end = min(top, max_tns_sfb(sr_index, object_type, (ics->window_sequence == EIGHT_SHORT_SEQUENCE)));
             end = min(end, ics->max_sfb);
-            end = ics->swb_offset[end];
+            end = min(ics->swb_offset[end], ics->swb_offset_max);
 
             size = end - start;
             if (size <= 0)
@@ -292,7 +295,7 @@
         y = *spectrum;
 
         for (j = 0; j < order; j++)
-            y += MUL_C(state[j], lpc[j+1]);
+            y += MUL_C(state[state_index+j], lpc[j+1]);
 
         /* double ringbuffer state */
         state_index--;
diff -Nur xine-lib-1.1.11.1/src/libfaad/tns.h xine-lib-1.1.11.1-ubuntu/src/libfaad/tns.h
--- xine-lib-1.1.11.1/src/libfaad/tns.h	2007-08-19 01:36:49.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libfaad/tns.h	2009-10-02 15:28:05.000000000 +0200
@@ -1,6 +1,6 @@
 /*
 ** FAAD2 - Freeware Advanced Audio (AAC) Decoder including SBR decoding
-** Copyright (C) 2003-2004 M. Bakker, Ahead Software AG, http://www.nero.com
+** Copyright (C) 2003-2005 M. Bakker, Nero AG, http://www.nero.com
 **  
 ** This program is free software; you can redistribute it and/or modify
 ** it under the terms of the GNU General Public License as published by
@@ -19,10 +19,13 @@
 ** Any non-GPL usage of this software or parts of this software is strictly
 ** forbidden.
 **
+** The "appropriate copyright message" mentioned in section 2c of the GPLv2
+** must read: "Code from FAAD2 is copyright (c) Nero AG, www.nero.com"
+**
 ** Commercial non-GPL licensing of this software is possible.
-** For more info contact Ahead Software through Mpeg4AAClicense@nero.com.
+** For more info contact Nero AG through Mpeg4AAClicense@nero.com.
 **
-** $Id: tns.h,v 1.8 2005/10/29 23:57:07 tmmm Exp $
+** $Id: tns.h,v 1.23 2007/11/01 12:33:41 menno Exp $
 **/
 
 #ifndef __TNS_H__
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/ffmpeg_config.h xine-lib-1.1.11.1-ubuntu/src/libffmpeg/ffmpeg_config.h
--- xine-lib-1.1.11.1/src/libffmpeg/ffmpeg_config.h	1970-01-01 01:00:00.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/ffmpeg_config.h	2009-10-02 15:28:05.000000000 +0200
@@ -0,0 +1,475 @@
+/* Automatically generated */
+#define CONFIG_AASC_DECODER 1
+#define ENABLE_AASC_DECODER 1
+#define CONFIG_ASV1_DECODER 1
+#define ENABLE_ASV1_DECODER 1
+#define CONFIG_ASV2_DECODER 1
+#define ENABLE_ASV2_DECODER 1
+#define CONFIG_AVS_DECODER 1
+#define ENABLE_AVS_DECODER 1
+#define CONFIG_CSCD_DECODER 1
+#define ENABLE_CSCD_DECODER 1
+#define CONFIG_CYUV_DECODER 1
+#define ENABLE_CYUV_DECODER 1
+#define CONFIG_DVVIDEO_DECODER 1
+#define ENABLE_DVVIDEO_DECODER 1
+#define CONFIG_EIGHTBPS_DECODER 1
+#define ENABLE_EIGHTBPS_DECODER 1
+#define CONFIG_FLIC_DECODER 1
+#define ENABLE_FLIC_DECODER 1
+#define CONFIG_FLV_DECODER 1
+#define ENABLE_FLV_DECODER 1
+#define CONFIG_FOURXM_DECODER 1
+#define ENABLE_FOURXM_DECODER 1
+#define CONFIG_FRAPS_DECODER 1
+#define ENABLE_FRAPS_DECODER 1
+#define CONFIG_HUFFYUV_DECODER 1
+#define ENABLE_HUFFYUV_DECODER 1
+#define CONFIG_IDCIN_DECODER 1
+#define ENABLE_IDCIN_DECODER 1
+#define CONFIG_INTERPLAY_VIDEO_DECODER 1
+#define ENABLE_INTERPLAY_VIDEO_DECODER 1
+#define CONFIG_KMVC_DECODER 1
+#define ENABLE_KMVC_DECODER 1
+#define CONFIG_LOCO_DECODER 1
+#define ENABLE_LOCO_DECODER 1
+#define CONFIG_MMVIDEO_DECODER 1
+#define ENABLE_MMVIDEO_DECODER 1
+#define CONFIG_NUV_DECODER 1
+#define ENABLE_NUV_DECODER 1
+#define CONFIG_QDRAW_DECODER 1
+#define ENABLE_QDRAW_DECODER 1
+#define CONFIG_QPEG_DECODER 1
+#define ENABLE_QPEG_DECODER 1
+#define CONFIG_ROQ_DECODER 1
+#define ENABLE_ROQ_DECODER 1
+#define CONFIG_RPZA_DECODER 1
+#define ENABLE_RPZA_DECODER 1
+#define CONFIG_SMACKER_DECODER 1
+#define ENABLE_SMACKER_DECODER 1
+#define CONFIG_SMC_DECODER 1
+#define ENABLE_SMC_DECODER 1
+#define CONFIG_SNOW_DECODER 1
+#define ENABLE_SNOW_DECODER 1
+#define CONFIG_TRUEMOTION1_DECODER 1
+#define ENABLE_TRUEMOTION1_DECODER 1
+#define CONFIG_TRUEMOTION2_DECODER 1
+#define ENABLE_TRUEMOTION2_DECODER 1
+#define CONFIG_TSCC_DECODER 1
+#define ENABLE_TSCC_DECODER 1
+#define CONFIG_ULTI_DECODER 1
+#define ENABLE_ULTI_DECODER 1
+#define CONFIG_VCR1_DECODER 1
+#define ENABLE_VCR1_DECODER 1
+#define CONFIG_VMDVIDEO_DECODER 1
+#define ENABLE_VMDVIDEO_DECODER 1
+#define CONFIG_WNV1_DECODER 1
+#define ENABLE_WNV1_DECODER 1
+#define CONFIG_XAN_WC3_DECODER 1
+#define ENABLE_XAN_WC3_DECODER 1
+#define CONFIG_XL_DECODER 1
+#define ENABLE_XL_DECODER 1
+#define CONFIG_ZMBV_DECODER 1
+#define ENABLE_ZMBV_DECODER 1
+#define CONFIG_ALAC_DECODER 1
+#define ENABLE_ALAC_DECODER 1
+#define CONFIG_AMR_NB_DECODER 1
+#define ENABLE_AMR_NB_DECODER 1
+#define CONFIG_AMR_WB_DECODER 1
+#define ENABLE_AMR_WB_DECODER 1
+#define CONFIG_LIBGSM_DECODER 1
+#define ENABLE_LIBGSM_DECODER 1
+#define CONFIG_MACE3_DECODER 1
+#define ENABLE_MACE3_DECODER 1
+#define CONFIG_MACE6_DECODER 1
+#define ENABLE_MACE6_DECODER 1
+#define CONFIG_SHORTEN_DECODER 1
+#define ENABLE_SHORTEN_DECODER 1
+#define CONFIG_SMACKAUD_DECODER 1
+#define ENABLE_SMACKAUD_DECODER 1
+#define CONFIG_TRUESPEECH_DECODER 1
+#define ENABLE_TRUESPEECH_DECODER 1
+#define CONFIG_TTA_DECODER 1
+#define ENABLE_TTA_DECODER 1
+#define CONFIG_VMDAUDIO_DECODER 1
+#define ENABLE_VMDAUDIO_DECODER 1
+#define CONFIG_PCM_ALAW_DECODER 1
+#define ENABLE_PCM_ALAW_DECODER 1
+#define CONFIG_PCM_MULAW_DECODER 1
+#define ENABLE_PCM_MULAW_DECODER 1
+#define CONFIG_PCM_S8_DECODER 1
+#define ENABLE_PCM_S8_DECODER 1
+#define CONFIG_PCM_S16BE_DECODER 1
+#define ENABLE_PCM_S16BE_DECODER 1
+#define CONFIG_PCM_S16LE_DECODER 1
+#define ENABLE_PCM_S16LE_DECODER 1
+#define CONFIG_PCM_S24BE_DECODER 1
+#define ENABLE_PCM_S24BE_DECODER 1
+#define CONFIG_PCM_S24DAUD_DECODER 1
+#define ENABLE_PCM_S24DAUD_DECODER 1
+#define CONFIG_PCM_S24LE_DECODER 1
+#define ENABLE_PCM_S24LE_DECODER 1
+#define CONFIG_PCM_S32BE_DECODER 1
+#define ENABLE_PCM_S32BE_DECODER 1
+#define CONFIG_PCM_S32LE_DECODER 1
+#define ENABLE_PCM_S32LE_DECODER 1
+#define CONFIG_PCM_U8_DECODER 1
+#define ENABLE_PCM_U8_DECODER 1
+#define CONFIG_PCM_U16BE_DECODER 1
+#define ENABLE_PCM_U16BE_DECODER 1
+#define CONFIG_PCM_U16LE_DECODER 1
+#define ENABLE_PCM_U16LE_DECODER 1
+#define CONFIG_PCM_U24BE_DECODER 1
+#define ENABLE_PCM_U24BE_DECODER 1
+#define CONFIG_PCM_U24LE_DECODER 1
+#define ENABLE_PCM_U24LE_DECODER 1
+#define CONFIG_PCM_U32BE_DECODER 1
+#define ENABLE_PCM_U32BE_DECODER 1
+#define CONFIG_PCM_U32LE_DECODER 1
+#define ENABLE_PCM_U32LE_DECODER 1
+#define CONFIG_INTERPLAY_DPCM_DECODER 1
+#define ENABLE_INTERPLAY_DPCM_DECODER 1
+#define CONFIG_ROQ_DPCM_DECODER 1
+#define ENABLE_ROQ_DPCM_DECODER 1
+#define CONFIG_SOL_DPCM_DECODER 1
+#define ENABLE_SOL_DPCM_DECODER 1
+#define CONFIG_VQA_DECODER 1
+#define ENABLE_VQA_DECODER 1
+#define CONFIG_XAN_DPCM_DECODER 1
+#define ENABLE_XAN_DPCM_DECODER 1
+#define CONFIG_ADPCM_4XM_DECODER 1
+#define ENABLE_ADPCM_4XM_DECODER 1
+#define CONFIG_ADPCM_CT_DECODER 1
+#define ENABLE_ADPCM_CT_DECODER 1
+#define CONFIG_ADPCM_EA_DECODER 1
+#define ENABLE_ADPCM_EA_DECODER 1
+#define CONFIG_ADPCM_IMA_DK3_DECODER 1
+#define ENABLE_ADPCM_IMA_DK3_DECODER 1
+#define CONFIG_ADPCM_IMA_DK4_DECODER 1
+#define ENABLE_ADPCM_IMA_DK4_DECODER 1
+#define CONFIG_ADPCM_IMA_QT_DECODER 1
+#define ENABLE_ADPCM_IMA_QT_DECODER 1
+#define CONFIG_ADPCM_IMA_SMJPEG_DECODER 1
+#define ENABLE_ADPCM_IMA_SMJPEG_DECODER 1
+#define CONFIG_ADPCM_IMA_WAV_DECODER 1
+#define ENABLE_ADPCM_IMA_WAV_DECODER 1
+#define CONFIG_ADPCM_IMA_WS_DECODER 1
+#define ENABLE_ADPCM_IMA_WS_DECODER 1
+#define CONFIG_ADPCM_MS_DECODER 1
+#define ENABLE_ADPCM_MS_DECODER 1
+#define CONFIG_ADPCM_SBPRO_2_DECODER 1
+#define ENABLE_ADPCM_SBPRO_2_DECODER 1
+#define CONFIG_ADPCM_SBPRO_3_DECODER 1
+#define ENABLE_ADPCM_SBPRO_3_DECODER 1
+#define CONFIG_ADPCM_SBPRO_4_DECODER 1
+#define ENABLE_ADPCM_SBPRO_4_DECODER 1
+#define CONFIG_ADPCM_XA_DECODER 1
+#define ENABLE_ADPCM_XA_DECODER 1
+#define CONFIG_ADPCM_YAMAHA_DECODER 1
+#define ENABLE_ADPCM_YAMAHA_DECODER 1
+#define CONFIG_CINEPAK_DECODER 1
+#define ENABLE_CINEPAK_DECODER 1
+#define CONFIG_FLASHSV_DECODER 1
+#define ENABLE_FLASHSV_DECODER 1
+#define CONFIG_H261_DECODER 1
+#define ENABLE_H261_DECODER 1
+#define CONFIG_H263_DECODER 1
+#define ENABLE_H263_DECODER 1
+#define CONFIG_H263I_DECODER 1
+#define ENABLE_H263I_DECODER 1
+#define CONFIG_H264_DECODER 1
+#define ENABLE_H264_DECODER 1
+#define CONFIG_INDEO2_DECODER 1
+#define ENABLE_INDEO2_DECODER 1
+#define CONFIG_INDEO3_DECODER 1
+#define ENABLE_INDEO3_DECODER 1
+#define CONFIG_MJPEG_DECODER 1
+#define ENABLE_MJPEG_DECODER 1
+#define CONFIG_MJPEGB_DECODER 1
+#define ENABLE_MJPEGB_DECODER 1
+#define CONFIG_MPEG1VIDEO_DECODER 1
+#define ENABLE_MPEG1VIDEO_DECODER 1
+#define CONFIG_MPEG2VIDEO_DECODER 1
+#define ENABLE_MPEG2VIDEO_DECODER 1
+#define CONFIG_MPEG4_DECODER 1
+#define ENABLE_MPEG4_DECODER 1
+#define CONFIG_MPEGVIDEO_DECODER 1
+#define ENABLE_MPEGVIDEO_DECODER 1
+#define CONFIG_MSMPEG4V1_DECODER 1
+#define ENABLE_MSMPEG4V1_DECODER 1
+#define CONFIG_MSMPEG4V2_DECODER 1
+#define ENABLE_MSMPEG4V2_DECODER 1
+#define CONFIG_MSMPEG4V3_DECODER 1
+#define ENABLE_MSMPEG4V3_DECODER 1
+#define CONFIG_MSRLE_DECODER 1
+#define ENABLE_MSRLE_DECODER 1
+#define CONFIG_MSVIDEO1_DECODER 1
+#define ENABLE_MSVIDEO1_DECODER 1
+#define CONFIG_QTRLE_DECODER 1
+#define ENABLE_QTRLE_DECODER 1
+#define CONFIG_RV10_DECODER 1
+#define ENABLE_RV10_DECODER 1
+#define CONFIG_RV20_DECODER 1
+#define ENABLE_RV20_DECODER 1
+#define CONFIG_SVQ1_DECODER 1
+#define ENABLE_SVQ1_DECODER 1
+#define CONFIG_SVQ3_DECODER 1
+#define ENABLE_SVQ3_DECODER 1
+#define CONFIG_VC1_DECODER 1
+#define ENABLE_VC1_DECODER 1
+#define CONFIG_VP3_DECODER 1
+#define ENABLE_VP3_DECODER 1
+#define CONFIG_VP5_DECODER 1
+#define ENABLE_VP5_DECODER 1
+#define CONFIG_VP6_DECODER 1
+#define ENABLE_VP6_DECODER 1
+#define CONFIG_VP6F_DECODER 1
+#define ENABLE_VP6F_DECODER 1
+#define CONFIG_WMV1_DECODER 1
+#define ENABLE_WMV1_DECODER 1
+#define CONFIG_WMV2_DECODER 1
+#define ENABLE_WMV2_DECODER 1
+#define CONFIG_WMV3_DECODER 1
+#define ENABLE_WMV3_DECODER 1
+#define CONFIG_COOK_DECODER 1
+#define ENABLE_COOK_DECODER 1
+#define CONFIG_DTS_DECODER 1
+#define ENABLE_DTS_DECODER 1
+#define CONFIG_FLAC_DECODER 1
+#define ENABLE_FLAC_DECODER 1
+#define CONFIG_MP2_DECODER 1
+#define ENABLE_MP2_DECODER 1
+#define CONFIG_MP3_DECODER 1
+#define ENABLE_MP3_DECODER 1
+#define CONFIG_QDM2_DECODER 1
+#define ENABLE_QDM2_DECODER 1
+#define CONFIG_RA_144_DECODER 1
+#define ENABLE_RA_144_DECODER 1
+#define CONFIG_RA_288_DECODER 1
+#define ENABLE_RA_288_DECODER 1
+#define CONFIG_WAVPACK_DECODER 1
+#define ENABLE_WAVPACK_DECODER 1
+#define CONFIG_WMAV1_DECODER 1
+#define ENABLE_WMAV1_DECODER 1
+#define CONFIG_WMAV2_DECODER 1
+#define ENABLE_WMAV2_DECODER 1
+#define CONFIG_ADPCM_SWF_DECODER 1
+#define ENABLE_ADPCM_SWF_DECODER 1
+#define ENABLE_BMP_DECODER 0
+#define ENABLE_CAVS_DECODER 0
+#define ENABLE_CLJR_DECODER 0
+#define ENABLE_DSICINVIDEO_DECODER 0
+#define ENABLE_FFV1_DECODER 0
+#define ENABLE_FFVHUFF_DECODER 0
+#define ENABLE_GIF_DECODER 0
+#define ENABLE_MDEC_DECODER 0
+#define ENABLE_MPEG_XVMC_DECODER 0
+#define ENABLE_MSZH_DECODER 0
+#define ENABLE_PNG_DECODER 0
+#define ENABLE_RAWVIDEO_DECODER 0
+#define ENABLE_SP5X_DECODER 0
+#define ENABLE_TARGA_DECODER 0
+#define ENABLE_TIERTEXSEQVIDEO_DECODER 0
+#define ENABLE_TIFF_DECODER 0
+#define ENABLE_VMNC_DECODER 0
+#define ENABLE_ZLIB_DECODER 0
+#define ENABLE_DSICINAUDIO_DECODER 0
+#define ENABLE_IMC_DECODER 0
+#define ENABLE_MP3ADU_DECODER 0
+#define ENABLE_MP3ON4_DECODER 0
+#define ENABLE_MPC7_DECODER 0
+#define ENABLE_SONIC_DECODER 0
+#define ENABLE_WS_SND1_DECODER 0
+#define ENABLE_ADPCM_ADX_DECODER 0
+#define ENABLE_ADPCM_G726_DECODER 0
+#define ENABLE_DVBSUB_DECODER 0
+#define ENABLE_DVDSUB_DECODER 0
+#define ENABLE_THEORA_DECODER 0
+#define ENABLE_AAC_DECODER 0
+#define ENABLE_MPEG4AAC_DECODER 0
+#define ENABLE_AC3_DECODER 0
+#define ENABLE_VORBIS_DECODER 0
+#define ENABLE_AASC_ENCODER 0
+#define ENABLE_ASV1_ENCODER 0
+#define ENABLE_ASV2_ENCODER 0
+#define ENABLE_AVS_ENCODER 0
+#define ENABLE_CSCD_ENCODER 0
+#define ENABLE_CYUV_ENCODER 0
+#define ENABLE_DVVIDEO_ENCODER 0
+#define ENABLE_EIGHTBPS_ENCODER 0
+#define ENABLE_FLIC_ENCODER 0
+#define ENABLE_FLV_ENCODER 0
+#define ENABLE_FOURXM_ENCODER 0
+#define ENABLE_FRAPS_ENCODER 0
+#define ENABLE_HUFFYUV_ENCODER 0
+#define ENABLE_IDCIN_ENCODER 0
+#define ENABLE_INTERPLAY_VIDEO_ENCODER 0
+#define ENABLE_KMVC_ENCODER 0
+#define ENABLE_LOCO_ENCODER 0
+#define ENABLE_MMVIDEO_ENCODER 0
+#define ENABLE_NUV_ENCODER 0
+#define ENABLE_QDRAW_ENCODER 0
+#define ENABLE_QPEG_ENCODER 0
+#define ENABLE_ROQ_ENCODER 0
+#define ENABLE_RPZA_ENCODER 0
+#define ENABLE_SMACKER_ENCODER 0
+#define ENABLE_SMC_ENCODER 0
+#define ENABLE_SNOW_ENCODER 0
+#define ENABLE_TRUEMOTION1_ENCODER 0
+#define ENABLE_TRUEMOTION2_ENCODER 0
+#define ENABLE_TSCC_ENCODER 0
+#define ENABLE_ULTI_ENCODER 0
+#define ENABLE_VCR1_ENCODER 0
+#define ENABLE_VMDVIDEO_ENCODER 0
+#define ENABLE_WNV1_ENCODER 0
+#define ENABLE_XAN_WC3_ENCODER 0
+#define ENABLE_XL_ENCODER 0
+#define ENABLE_ZMBV_ENCODER 0
+#define ENABLE_ALAC_ENCODER 0
+#define ENABLE_AMR_NB_ENCODER 0
+#define ENABLE_AMR_WB_ENCODER 0
+#define ENABLE_LIBGSM_ENCODER 0
+#define ENABLE_MACE3_ENCODER 0
+#define ENABLE_MACE6_ENCODER 0
+#define ENABLE_SHORTEN_ENCODER 0
+#define ENABLE_SMACKAUD_ENCODER 0
+#define ENABLE_TRUESPEECH_ENCODER 0
+#define ENABLE_TTA_ENCODER 0
+#define ENABLE_VMDAUDIO_ENCODER 0
+#define ENABLE_PCM_ALAW_ENCODER 0
+#define ENABLE_PCM_MULAW_ENCODER 0
+#define ENABLE_PCM_S8_ENCODER 0
+#define ENABLE_PCM_S16BE_ENCODER 0
+#define ENABLE_PCM_S16LE_ENCODER 0
+#define ENABLE_PCM_S24BE_ENCODER 0
+#define ENABLE_PCM_S24DAUD_ENCODER 0
+#define ENABLE_PCM_S24LE_ENCODER 0
+#define ENABLE_PCM_S32BE_ENCODER 0
+#define ENABLE_PCM_S32LE_ENCODER 0
+#define ENABLE_PCM_U8_ENCODER 0
+#define ENABLE_PCM_U16BE_ENCODER 0
+#define ENABLE_PCM_U16LE_ENCODER 0
+#define ENABLE_PCM_U24BE_ENCODER 0
+#define ENABLE_PCM_U24LE_ENCODER 0
+#define ENABLE_PCM_U32BE_ENCODER 0
+#define ENABLE_PCM_U32LE_ENCODER 0
+#define ENABLE_INTERPLAY_DPCM_ENCODER 0
+#define ENABLE_ROQ_DPCM_ENCODER 0
+#define ENABLE_SOL_DPCM_ENCODER 0
+#define ENABLE_VQA_ENCODER 0
+#define ENABLE_XAN_DPCM_ENCODER 0
+#define ENABLE_ADPCM_4XM_ENCODER 0
+#define ENABLE_ADPCM_CT_ENCODER 0
+#define ENABLE_ADPCM_EA_ENCODER 0
+#define ENABLE_ADPCM_IMA_DK3_ENCODER 0
+#define ENABLE_ADPCM_IMA_DK4_ENCODER 0
+#define ENABLE_ADPCM_IMA_QT_ENCODER 0
+#define ENABLE_ADPCM_IMA_SMJPEG_ENCODER 0
+#define ENABLE_ADPCM_IMA_WAV_ENCODER 0
+#define ENABLE_ADPCM_IMA_WS_ENCODER 0
+#define ENABLE_ADPCM_MS_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_2_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_3_ENCODER 0
+#define ENABLE_ADPCM_SBPRO_4_ENCODER 0
+#define ENABLE_ADPCM_XA_ENCODER 0
+#define ENABLE_ADPCM_YAMAHA_ENCODER 0
+#define ENABLE_CINEPAK_ENCODER 0
+#define ENABLE_FLASHSV_ENCODER 0
+#define ENABLE_H261_ENCODER 0
+#define ENABLE_H263_ENCODER 0
+#define ENABLE_H263I_ENCODER 0
+#define ENABLE_H264_ENCODER 0
+#define ENABLE_INDEO2_ENCODER 0
+#define ENABLE_INDEO3_ENCODER 0
+#define ENABLE_MJPEG_ENCODER 0
+#define ENABLE_MJPEGB_ENCODER 0
+#define ENABLE_MPEG1VIDEO_ENCODER 0
+#define ENABLE_MPEG2VIDEO_ENCODER 0
+#define ENABLE_MPEG4_ENCODER 0
+#define ENABLE_MPEGVIDEO_ENCODER 0
+#define ENABLE_MSMPEG4V1_ENCODER 0
+#define ENABLE_MSMPEG4V2_ENCODER 0
+#define ENABLE_MSMPEG4V3_ENCODER 0
+#define ENABLE_MSRLE_ENCODER 0
+#define ENABLE_MSVIDEO1_ENCODER 0
+#define ENABLE_QTRLE_ENCODER 0
+#define ENABLE_RV10_ENCODER 0
+#define ENABLE_RV20_ENCODER 0
+#define ENABLE_SVQ1_ENCODER 0
+#define ENABLE_SVQ3_ENCODER 0
+#define ENABLE_VC1_ENCODER 0
+#define ENABLE_VP3_ENCODER 0
+#define ENABLE_VP5_ENCODER 0
+#define ENABLE_VP6_ENCODER 0
+#define ENABLE_VP6F_ENCODER 0
+#define ENABLE_WMV1_ENCODER 0
+#define ENABLE_WMV2_ENCODER 0
+#define ENABLE_WMV3_ENCODER 0
+#define ENABLE_COOK_ENCODER 0
+#define ENABLE_DTS_ENCODER 0
+#define ENABLE_FLAC_ENCODER 0
+#define ENABLE_MP2_ENCODER 0
+#define ENABLE_MP3_ENCODER 0
+#define ENABLE_QDM2_ENCODER 0
+#define ENABLE_RA_144_ENCODER 0
+#define ENABLE_RA_288_ENCODER 0
+#define ENABLE_WAVPACK_ENCODER 0
+#define ENABLE_WMAV1_ENCODER 0
+#define ENABLE_WMAV2_ENCODER 0
+#define ENABLE_ADPCM_SWF_ENCODER 0
+#define ENABLE_BMP_ENCODER 0
+#define ENABLE_CAVS_ENCODER 0
+#define ENABLE_CLJR_ENCODER 0
+#define ENABLE_DSICINVIDEO_ENCODER 0
+#define ENABLE_FFV1_ENCODER 0
+#define ENABLE_FFVHUFF_ENCODER 0
+#define ENABLE_GIF_ENCODER 0
+#define ENABLE_MDEC_ENCODER 0
+#define ENABLE_MPEG_XVMC_ENCODER 0
+#define ENABLE_MSZH_ENCODER 0
+#define ENABLE_PNG_ENCODER 0
+#define ENABLE_RAWVIDEO_ENCODER 0
+#define ENABLE_SP5X_ENCODER 0
+#define ENABLE_TARGA_ENCODER 0
+#define ENABLE_TIERTEXSEQVIDEO_ENCODER 0
+#define ENABLE_TIFF_ENCODER 0
+#define ENABLE_VMNC_ENCODER 0
+#define ENABLE_ZLIB_ENCODER 0
+#define ENABLE_DSICINAUDIO_ENCODER 0
+#define ENABLE_IMC_ENCODER 0
+#define ENABLE_MP3ADU_ENCODER 0
+#define ENABLE_MP3ON4_ENCODER 0
+#define ENABLE_MPC7_ENCODER 0
+#define ENABLE_SONIC_ENCODER 0
+#define ENABLE_WS_SND1_ENCODER 0
+#define ENABLE_ADPCM_ADX_ENCODER 0
+#define ENABLE_ADPCM_G726_ENCODER 0
+#define ENABLE_DVBSUB_ENCODER 0
+#define ENABLE_DVDSUB_ENCODER 0
+#define ENABLE_THEORA_ENCODER 0
+#define ENABLE_AAC_ENCODER 0
+#define ENABLE_MPEG4AAC_ENCODER 0
+#define ENABLE_AC3_ENCODER 0
+#define ENABLE_VORBIS_ENCODER 0
+#define ENABLE_H263P_ENCODER 0
+#define ENABLE_JPEGLS_ENCODER 0
+#define ENABLE_LJPEG_ENCODER 0
+#define ENABLE_PAM_ENCODER 0
+#define ENABLE_PBM_ENCODER 0
+#define ENABLE_PGM_ENCODER 0
+#define ENABLE_PGMYUV_ENCODER 0
+#define ENABLE_PPM_ENCODER 0
+#define ENABLE_SONIC_LS_ENCODER 0
+#define ENABLE_AAC_PARSER 0
+#define ENABLE_AC3_PARSER 0
+#define ENABLE_CAVSVIDEO_PARSER 0
+#define ENABLE_DVBSUB_PARSER 0
+#define ENABLE_DVDSUB_PARSER 0
+#define ENABLE_H261_PARSER 0
+#define ENABLE_H263_PARSER 0
+#define ENABLE_H264_PARSER 0
+#define ENABLE_MJPEG_PARSER 0
+#define ENABLE_MPEG4VIDEO_PARSER 0
+#define ENABLE_MPEGAUDIO_PARSER 0
+#define ENABLE_MPEGVIDEO_PARSER 0
+#define ENABLE_PNM_PARSER 0
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/alpha/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/alpha/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/alpha/Makefile.in	2008-03-30 16:02:33.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/alpha/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/armv4l/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/armv4l/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/armv4l/Makefile.in	2008-03-30 16:02:33.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/armv4l/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -63,7 +63,7 @@
 am__objects_2 = libavcodec_armv4l_dummy.lo
 am_libavcodec_armv4l_la_OBJECTS = $(am__objects_1) $(am__objects_2)
 libavcodec_armv4l_la_OBJECTS = $(am_libavcodec_armv4l_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -485,8 +485,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -498,8 +498,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -509,12 +509,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/i386/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/i386/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/i386/Makefile.in	2008-03-30 16:02:33.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/i386/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -72,7 +72,7 @@
 am__objects_3 = libavcodec_mmx_dummy.lo
 am_libavcodec_mmx_la_OBJECTS = $(am__objects_2) $(am__objects_3)
 libavcodec_mmx_la_OBJECTS = $(am_libavcodec_mmx_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -525,8 +525,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -538,8 +538,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -549,12 +549,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/libpostproc/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/libpostproc/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/libpostproc/Makefile.in	2008-03-30 16:02:33.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/libpostproc/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -61,7 +61,7 @@
 libpostprocess_la_LIBADD =
 am_libpostprocess_la_OBJECTS = postprocess.lo
 libpostprocess_la_OBJECTS = $(am_libpostprocess_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -476,8 +476,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -489,8 +489,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -500,12 +500,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/Makefile.in	2008-03-30 16:02:33.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -82,7 +82,7 @@
 libavcodec_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(libavcodec_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -859,8 +859,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -885,8 +885,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -896,12 +896,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/mlib/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/mlib/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/mlib/Makefile.in	2008-03-30 16:02:34.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/mlib/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -65,7 +65,7 @@
 am__objects_3 = libavcodec_mlib_dummy.lo
 am_libavcodec_mlib_la_OBJECTS = $(am__objects_2) $(am__objects_3)
 libavcodec_mlib_la_OBJECTS = $(am_libavcodec_mlib_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -479,8 +479,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -492,8 +492,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -503,12 +503,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/ppc/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/ppc/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/ppc/Makefile.in	2008-03-30 16:02:34.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/ppc/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -62,7 +62,7 @@
 am__objects_1 = libavcodec_ppc_dummy.lo
 am_libavcodec_ppc_la_OBJECTS = $(am__objects_1)
 libavcodec_ppc_la_OBJECTS = $(am_libavcodec_ppc_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -495,8 +495,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -508,8 +508,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -519,12 +519,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavcodec/sparc/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/sparc/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavcodec/sparc/Makefile.in	2008-03-30 16:02:34.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavcodec/sparc/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -65,7 +65,7 @@
 am__objects_3 = libavcodec_sparc_dummy.lo
 am_libavcodec_sparc_la_OBJECTS = $(am__objects_2) $(am__objects_3)
 libavcodec_sparc_la_OBJECTS = $(am_libavcodec_sparc_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -479,8 +479,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -492,8 +492,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -503,12 +503,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/libavutil/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavutil/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/libavutil/Makefile.in	2008-03-30 16:02:34.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/libavutil/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -65,7 +65,7 @@
 libavutil_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(libavutil_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -513,8 +513,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -526,8 +526,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -537,12 +537,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libffmpeg/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libffmpeg/Makefile.in
--- xine-lib-1.1.11.1/src/libffmpeg/Makefile.in	2008-03-30 16:02:33.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libffmpeg/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -491,8 +491,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -517,8 +517,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -528,12 +528,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libmad/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libmad/Makefile.in
--- xine-lib-1.1.11.1/src/libmad/Makefile.in	2008-03-30 16:02:34.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libmad/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -92,7 +92,7 @@
 	$(xineplug_decode_mad_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_mad_la_LDFLAGS) $(LDFLAGS) -o $@
 @MAD_TRUE@am_xineplug_decode_mad_la_rpath = -rpath $(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -495,8 +495,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -504,8 +504,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -646,8 +646,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -659,8 +659,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -670,12 +670,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libmpeg2/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libmpeg2/Makefile.in
--- xine-lib-1.1.11.1/src/libmpeg2/Makefile.in	2008-03-30 16:02:35.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libmpeg2/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -94,7 +94,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_decode_mpeg2_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_mpeg2_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -481,8 +481,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -490,8 +490,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -688,8 +688,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -701,8 +701,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -712,12 +712,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libmusepack/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libmusepack/Makefile.in
--- xine-lib-1.1.11.1/src/libmusepack/Makefile.in	2008-03-30 16:02:35.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libmusepack/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -90,7 +90,7 @@
 	$(xineplug_decode_mpc_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_mpc_la_LDFLAGS) $(LDFLAGS) -o $@
 @MUSEPACK_TRUE@am_xineplug_decode_mpc_la_rpath = -rpath $(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -471,8 +471,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -480,8 +480,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -676,8 +676,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -702,8 +702,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -713,12 +713,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libmusepack/musepack/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libmusepack/musepack/Makefile.in
--- xine-lib-1.1.11.1/src/libmusepack/musepack/Makefile.in	2008-03-30 16:02:35.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libmusepack/musepack/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -412,8 +412,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -425,8 +425,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -436,12 +436,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libreal/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libreal/Makefile.in
--- xine-lib-1.1.11.1/src/libreal/Makefile.in	2008-03-30 16:02:35.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libreal/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -81,7 +81,7 @@
 	$(xineplug_decode_real_la_LDFLAGS) $(LDFLAGS) -o $@
 @ENABLE_REAL_TRUE@am_xineplug_decode_real_la_rpath = -rpath \
 @ENABLE_REAL_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -447,8 +447,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -456,8 +456,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -534,8 +534,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -547,8 +547,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -558,12 +558,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libspucc/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libspucc/Makefile.in
--- xine-lib-1.1.11.1/src/libspucc/Makefile.in	2008-03-30 16:02:35.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libspucc/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -78,7 +78,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_decode_spucc_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_spucc_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -444,8 +444,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -453,8 +453,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -523,8 +523,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -536,8 +536,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -547,12 +547,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libspucmml/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libspucmml/Makefile.in
--- xine-lib-1.1.11.1/src/libspucmml/Makefile.in	2008-03-30 16:02:35.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libspucmml/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -76,7 +76,7 @@
 	$(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_decode_spucmml_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_spucmml_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -440,8 +440,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -449,8 +449,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -511,8 +511,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -524,8 +524,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -535,12 +535,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libspudec/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libspudec/Makefile.in
--- xine-lib-1.1.11.1/src/libspudec/Makefile.in	2008-03-30 16:02:36.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libspudec/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -85,7 +85,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_decode_spu_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_spu_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -461,8 +461,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -470,8 +470,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -548,8 +548,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -561,8 +561,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -572,12 +572,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libspudvb/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libspudvb/Makefile.in
--- xine-lib-1.1.11.1/src/libspudvb/Makefile.in	2008-03-30 16:02:36.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libspudvb/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -76,7 +76,7 @@
 	$(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_decode_spudvb_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_decode_spudvb_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -440,8 +440,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -449,8 +449,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -511,8 +511,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -524,8 +524,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -535,12 +535,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libsputext/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libsputext/Makefile.in
--- xine-lib-1.1.11.1/src/libsputext/Makefile.in	2008-03-30 16:02:36.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libsputext/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -86,7 +86,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_dmx_sputext_la_CFLAGS) $(CFLAGS) $(AM_LDFLAGS) \
 	$(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -455,8 +455,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -464,8 +464,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -536,8 +536,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -549,8 +549,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -560,12 +560,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libw32dll/DirectShow/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libw32dll/DirectShow/Makefile.in
--- xine-lib-1.1.11.1/src/libw32dll/DirectShow/Makefile.in	2008-03-30 16:02:36.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libw32dll/DirectShow/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -64,7 +64,7 @@
 	DS_VideoDecoder.lo
 libds_filter_la_OBJECTS = $(am_libds_filter_la_OBJECTS)
 @HAVE_W32DLL_TRUE@am_libds_filter_la_rpath =
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -506,8 +506,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -519,8 +519,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -530,12 +530,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libw32dll/dmo/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libw32dll/dmo/Makefile.in
--- xine-lib-1.1.11.1/src/libw32dll/dmo/Makefile.in	2008-03-30 16:02:36.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libw32dll/dmo/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -63,7 +63,7 @@
 	dmo_guids.lo DMO_VideoDecoder.lo
 libdmo_filter_la_OBJECTS = $(am_libdmo_filter_la_OBJECTS)
 @HAVE_W32DLL_TRUE@am_libdmo_filter_la_rpath =
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -495,8 +495,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -508,8 +508,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -519,12 +519,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libw32dll/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libw32dll/Makefile.in
--- xine-lib-1.1.11.1/src/libw32dll/Makefile.in	2008-03-30 16:02:36.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libw32dll/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -91,7 +91,7 @@
 	$(LDFLAGS) -o $@
 @HAVE_W32DLL_TRUE@am_xineplug_decode_w32dll_la_rpath = -rpath \
 @HAVE_W32DLL_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -492,8 +492,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -501,8 +501,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -629,8 +629,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -655,8 +655,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -666,12 +666,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libw32dll/qtx/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libw32dll/qtx/Makefile.in
--- xine-lib-1.1.11.1/src/libw32dll/qtx/Makefile.in	2008-03-30 16:02:37.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libw32dll/qtx/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -488,8 +488,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -514,8 +514,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -525,12 +525,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libw32dll/qtx/qtxsdk/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libw32dll/qtx/qtxsdk/Makefile.in
--- xine-lib-1.1.11.1/src/libw32dll/qtx/qtxsdk/Makefile.in	2008-03-30 16:02:37.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libw32dll/qtx/qtxsdk/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -410,8 +410,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -423,8 +423,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -434,12 +434,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libw32dll/wine/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libw32dll/wine/Makefile.in
--- xine-lib-1.1.11.1/src/libw32dll/wine/Makefile.in	2008-03-30 16:02:37.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libw32dll/wine/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -64,7 +64,7 @@
 	registry.lo vfl.lo win32.lo stubs.lo wrapper.lo
 libwine_la_OBJECTS = $(am_libwine_la_OBJECTS)
 @HAVE_W32DLL_TRUE@am_libwine_la_rpath =
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 CPPASCOMPILE = $(CCAS) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
@@ -587,8 +587,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -600,8 +600,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -611,12 +611,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libxineadec/gsm610/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libxineadec/gsm610/Makefile.in
--- xine-lib-1.1.11.1/src/libxineadec/gsm610/Makefile.in	2008-03-30 16:02:37.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libxineadec/gsm610/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -68,7 +68,7 @@
 libgsm610_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(libgsm610_la_CFLAGS) \
 	$(CFLAGS) $(libgsm610_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -575,8 +575,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -588,8 +588,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -599,12 +599,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libxineadec/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libxineadec/Makefile.in
--- xine-lib-1.1.11.1/src/libxineadec/Makefile.in	2008-03-30 16:02:37.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libxineadec/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -119,7 +119,7 @@
 	$(LDFLAGS) -o $@
 @HAVE_VORBIS_TRUE@am_xineplug_decode_vorbis_la_rpath = -rpath \
 @HAVE_VORBIS_TRUE@	$(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -525,8 +525,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -534,8 +534,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -706,8 +706,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -732,8 +732,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -743,12 +743,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libxineadec/nosefart/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libxineadec/nosefart/Makefile.in
--- xine-lib-1.1.11.1/src/libxineadec/nosefart/Makefile.in	2008-03-30 16:02:38.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libxineadec/nosefart/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -69,7 +69,7 @@
 libnosefart_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(libnosefart_la_CFLAGS) \
 	$(CFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -593,8 +593,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -606,8 +606,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -617,12 +617,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/libxineadec/xine_speex_decoder.c xine-lib-1.1.11.1-ubuntu/src/libxineadec/xine_speex_decoder.c
--- xine-lib-1.1.11.1/src/libxineadec/xine_speex_decoder.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/libxineadec/xine_speex_decoder.c	2009-10-02 15:28:05.000000000 +0200
@@ -204,7 +204,7 @@
       if (!this->st) {
 	SpeexMode * spx_mode;
 	SpeexHeader * spx_header;
-	int modeID;
+	unsigned int modeID;
 	int bitrate;
 
 	speex_bits_init (&this->bits);
@@ -216,7 +216,12 @@
 	  return;
 	}
 
-	modeID = spx_header->mode;
+	modeID = (unsigned int)spx_header->mode;
+	if (modeID >= SPEEX_NB_MODES) {
+	  xprintf(this->stream->xine, XINE_VERBOSITY_DEBUG, LOG_MODULE ": invalid mode ID %u\n", modeID);
+	  return;
+	}
+	
 	spx_mode = (SpeexMode *) speex_mode_list[modeID];
 
 	if (spx_mode->bitstream_version != spx_header->mode_bitstream_version) {
diff -Nur xine-lib-1.1.11.1/src/libxinevdec/Makefile.in xine-lib-1.1.11.1-ubuntu/src/libxinevdec/Makefile.in
--- xine-lib-1.1.11.1/src/libxinevdec/Makefile.in	2008-03-30 16:02:38.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/libxinevdec/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -113,7 +113,7 @@
 xineplug_decode_yuv_la_DEPENDENCIES = $(XINE_LIB)
 am_xineplug_decode_yuv_la_OBJECTS = yuv.lo
 xineplug_decode_yuv_la_OBJECTS = $(am_xineplug_decode_yuv_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -510,8 +510,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -519,8 +519,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -610,8 +610,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -623,8 +623,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -634,12 +634,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/Makefile.in xine-lib-1.1.11.1-ubuntu/src/Makefile.in
--- xine-lib-1.1.11.1/src/Makefile.in	2008-03-30 16:02:28.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -516,8 +516,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -542,8 +542,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -553,12 +553,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/audio/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/audio/Makefile.in
--- xine-lib-1.1.11.1/src/post/audio/Makefile.in	2008-03-30 16:02:38.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/audio/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -83,7 +83,7 @@
 	$(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_post_audio_filters_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_post_audio_filters_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -451,8 +451,8 @@
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -460,8 +460,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
 	done
 
 clean-xinepostLTLIBRARIES:
@@ -570,8 +570,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -583,8 +583,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -594,12 +594,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/deinterlace/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/deinterlace/Makefile.in
--- xine-lib-1.1.11.1/src/post/deinterlace/Makefile.in	2008-03-30 16:02:38.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/deinterlace/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -82,7 +82,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_post_tvtime_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_post_tvtime_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -466,8 +466,8 @@
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -475,8 +475,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
 	done
 
 clean-xinepostLTLIBRARIES:
@@ -639,8 +639,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -665,8 +665,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -676,12 +676,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/deinterlace/plugins/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/deinterlace/plugins/Makefile.in
--- xine-lib-1.1.11.1/src/post/deinterlace/plugins/Makefile.in	2008-03-30 16:02:39.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/deinterlace/plugins/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -76,7 +76,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(libdeinterlaceplugins_la_CFLAGS) $(CFLAGS) \
 	$(libdeinterlaceplugins_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -610,8 +610,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -623,8 +623,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -634,12 +634,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/goom/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/goom/Makefile.in
--- xine-lib-1.1.11.1/src/post/goom/Makefile.in	2008-03-30 16:02:39.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/goom/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -105,7 +105,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_post_goom_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_post_goom_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -493,8 +493,8 @@
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -502,8 +502,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
 	done
 
 clean-xinepostLTLIBRARIES:
@@ -756,8 +756,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -769,8 +769,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -780,12 +780,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/Makefile.in
--- xine-lib-1.1.11.1/src/post/Makefile.in	2008-03-30 16:02:38.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -490,8 +490,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -516,8 +516,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -527,12 +527,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/mosaico/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/mosaico/Makefile.in
--- xine-lib-1.1.11.1/src/post/mosaico/Makefile.in	2008-03-30 16:02:39.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/mosaico/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -86,7 +86,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_post_switch_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_post_switch_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -456,8 +456,8 @@
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -465,8 +465,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
 	done
 
 clean-xinepostLTLIBRARIES:
@@ -537,8 +537,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -550,8 +550,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -561,12 +561,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/planar/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/planar/Makefile.in
--- xine-lib-1.1.11.1/src/post/planar/Makefile.in	2008-03-30 16:02:39.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/planar/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -84,7 +84,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_post_planar_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_post_planar_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -463,8 +463,8 @@
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -472,8 +472,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
 	done
 
 clean-xinepostLTLIBRARIES:
@@ -614,8 +614,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -627,8 +627,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -638,12 +638,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/post/visualizations/Makefile.in xine-lib-1.1.11.1-ubuntu/src/post/visualizations/Makefile.in
--- xine-lib-1.1.11.1/src/post/visualizations/Makefile.in	2008-03-30 16:02:39.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/post/visualizations/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -81,7 +81,7 @@
 	$(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=link $(CCLD) \
 	$(xineplug_post_visualizations_la_CFLAGS) $(CFLAGS) \
 	$(xineplug_post_visualizations_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -450,8 +450,8 @@
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xinepostdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xinepostLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xinepostdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -459,8 +459,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xinepost_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xinepostdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xinepostdir)/$$p"; \
 	done
 
 clean-xinepostLTLIBRARIES:
@@ -553,8 +553,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -566,8 +566,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -577,12 +577,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/video_out/libdha/bin/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/bin/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/libdha/bin/Makefile.in	2008-03-30 16:02:40.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/bin/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/src/video_out/libdha/kernelhelper/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/kernelhelper/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/libdha/kernelhelper/Makefile.in	2008-03-30 16:02:41.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/kernelhelper/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -60,7 +60,7 @@
 am_test_OBJECTS = test.$(OBJEXT)
 test_OBJECTS = $(am_test_OBJECTS)
 test_LDADD = $(LDADD)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -466,8 +466,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -479,8 +479,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -490,12 +490,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/video_out/libdha/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/libdha/Makefile.in	2008-03-30 16:02:40.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -69,7 +69,7 @@
 am_test_OBJECTS = test.$(OBJEXT)
 test_OBJECTS = $(am_test_OBJECTS)
 test_DEPENDENCIES = $(top_builddir)/src/video_out/libdha/libdha.la
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -579,8 +579,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -605,8 +605,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -616,12 +616,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/video_out/libdha/oth/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/oth/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/libdha/oth/Makefile.in	2008-03-30 16:02:41.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/oth/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/src/video_out/libdha/sysdep/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/sysdep/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/libdha/sysdep/Makefile.in	2008-03-30 16:02:41.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/libdha/sysdep/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -443,8 +443,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -456,8 +456,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -467,12 +467,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/video_out/macosx/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/macosx/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/macosx/Makefile.in	2008-03-30 16:02:41.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/macosx/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -77,7 +77,7 @@
 	$(OBJCFLAGS) $(libxineMacOSXVideo_la_LDFLAGS) $(LDFLAGS) -o $@
 @HAVE_MACOSX_VIDEO_TRUE@am_libxineMacOSXVideo_la_rpath = -rpath \
 @HAVE_MACOSX_VIDEO_TRUE@	$(libdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 OBJCCOMPILE = $(OBJC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
@@ -458,8 +458,8 @@
 	@list='$(lib_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(libdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(libdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(libdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(libdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -467,8 +467,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(lib_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(libdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(libdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(libdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(libdir)/$$p"; \
 	done
 
 clean-libLTLIBRARIES:
@@ -540,8 +540,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -553,8 +553,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -564,12 +564,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/video_out/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/Makefile.in	2008-03-30 16:02:40.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -380,7 +380,7 @@
 	$(LDFLAGS) -o $@
 @HAVE_X11_TRUE@@HAVE_XXMC_TRUE@am_xineplug_vo_out_xxmc_la_rpath =  \
 @HAVE_X11_TRUE@@HAVE_XXMC_TRUE@	-rpath $(xineplugdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -934,8 +934,8 @@
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(xineplugdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(xineplugLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(xineplugdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -943,8 +943,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(xineplug_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(xineplugdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(xineplugdir)/$$p"; \
 	done
 
 clean-xineplugLTLIBRARIES:
@@ -1544,8 +1544,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -1570,8 +1570,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -1581,12 +1581,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/video_out/vidix/drivers/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/vidix/drivers/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/vidix/drivers/Makefile.in	2008-03-30 16:02:41.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/vidix/drivers/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -150,7 +150,7 @@
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(unichrome_vid_la_LDFLAGS) $(LDFLAGS) -o $@
 @HAVE_VIDIX_TRUE@am_unichrome_vid_la_rpath = -rpath $(vidixdir)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -569,8 +569,8 @@
 	@list='$(vidix_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(vidixLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(vidixdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(vidixLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(vidixdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(vidixLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(vidixdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(vidixLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(vidixdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -578,8 +578,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(vidix_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(vidixdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(vidixdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(vidixdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(vidixdir)/$$p"; \
 	done
 
 clean-vidixLTLIBRARIES:
@@ -681,8 +681,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -694,8 +694,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -705,12 +705,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/video_out/vidix/Makefile.in xine-lib-1.1.11.1-ubuntu/src/video_out/vidix/Makefile.in
--- xine-lib-1.1.11.1/src/video_out/vidix/Makefile.in	2008-03-30 16:02:41.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/video_out/vidix/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -64,7 +64,7 @@
 am_libvidix_la_OBJECTS = vidixlib.lo
 libvidix_la_OBJECTS = $(am_libvidix_la_OBJECTS)
 @HAVE_VIDIX_TRUE@am_libvidix_la_rpath =
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -561,8 +561,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -587,8 +587,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -598,12 +598,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/xine-engine/info_helper.c xine-lib-1.1.11.1-ubuntu/src/xine-engine/info_helper.c
--- xine-lib-1.1.11.1/src/xine-engine/info_helper.c	2008-03-28 15:24:50.000000000 +0100
+++ xine-lib-1.1.11.1-ubuntu/src/xine-engine/info_helper.c	2009-10-02 15:28:05.000000000 +0200
@@ -131,7 +131,7 @@
  * at the end of the string
  */
 static void meta_info_chomp(char *str) {
-  int i, len;
+  ssize_t i, len;
 
   len = strlen(str);
   if (!len)
diff -Nur xine-lib-1.1.11.1/src/xine-engine/Makefile.in xine-lib-1.1.11.1-ubuntu/src/xine-engine/Makefile.in
--- xine-lib-1.1.11.1/src/xine-engine/Makefile.in	2008-03-30 16:02:42.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/xine-engine/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -79,7 +79,7 @@
 libxine_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) \
 	$(LIBTOOLFLAGS) --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(libxine_la_LDFLAGS) $(LDFLAGS) -o $@
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
@@ -476,8 +476,8 @@
 	@list='$(lib_LTLIBRARIES)'; for p in $$list; do \
 	  if test -f $$p; then \
 	    f=$(am__strip_dir) \
-	    echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(libdir)/$$f'"; \
-	    $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(libdir)/$$f"; \
+	    echo " $(LIBTOOL) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) '$$p' '$(DESTDIR)$(libdir)/$$f'"; \
+	    $(LIBTOOL) --mode=install $(libLTLIBRARIES_INSTALL) $(INSTALL_STRIP_FLAG) "$$p" "$(DESTDIR)$(libdir)/$$f"; \
 	  else :; fi; \
 	done
 
@@ -485,8 +485,8 @@
 	@$(NORMAL_UNINSTALL)
 	@list='$(lib_LTLIBRARIES)'; for p in $$list; do \
 	  p=$(am__strip_dir) \
-	  echo " $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f '$(DESTDIR)$(libdir)/$$p'"; \
-	  $(LIBTOOL) $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) --mode=uninstall rm -f "$(DESTDIR)$(libdir)/$$p"; \
+	  echo " $(LIBTOOL) --mode=uninstall rm -f '$(DESTDIR)$(libdir)/$$p'"; \
+	  $(LIBTOOL) --mode=uninstall rm -f "$(DESTDIR)$(libdir)/$$p"; \
 	done
 
 clean-libLTLIBRARIES:
@@ -583,8 +583,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -596,8 +596,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -607,12 +607,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/src/xine-utils/Makefile.in xine-lib-1.1.11.1-ubuntu/src/xine-utils/Makefile.in
--- xine-lib-1.1.11.1/src/xine-utils/Makefile.in	2008-03-30 16:02:42.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/src/xine-utils/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -70,7 +70,7 @@
 	xine_mutex.lo xmllexer.lo xine_buffer.lo xmlparser.lo array.lo \
 	sorted_array.lo pool.lo ring_buffer.lo
 libxineutils_la_OBJECTS = $(am_libxineutils_la_OBJECTS)
-DEFAULT_INCLUDES = -I.@am__isrc@ -I$(top_builddir)/include
+DEFAULT_INCLUDES = -I. -I$(top_builddir)/include@am__isrc@
 depcomp = $(SHELL) $(top_srcdir)/depcomp
 am__depfiles_maybe = depfiles
 CPPASCOMPILE = $(CCAS) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) \
@@ -580,8 +580,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -593,8 +593,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -604,12 +604,13 @@
 CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
diff -Nur xine-lib-1.1.11.1/win32/include/Makefile.in xine-lib-1.1.11.1-ubuntu/win32/include/Makefile.in
--- xine-lib-1.1.11.1/win32/include/Makefile.in	2008-03-30 16:02:42.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/win32/include/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
diff -Nur xine-lib-1.1.11.1/win32/Makefile.in xine-lib-1.1.11.1-ubuntu/win32/Makefile.in
--- xine-lib-1.1.11.1/win32/Makefile.in	2008-03-30 16:02:42.000000000 +0200
+++ xine-lib-1.1.11.1-ubuntu/win32/Makefile.in	2009-10-02 15:28:05.000000000 +0200
@@ -1,8 +1,8 @@
-# Makefile.in generated by automake 1.10.1 from Makefile.am.
+# Makefile.in generated by automake 1.10 from Makefile.am.
 # @configure_input@
 
 # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,
-# 2003, 2004, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.
+# 2003, 2004, 2005, 2006  Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -499,8 +499,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonemtpy = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	mkid -fID $$unique
 tags: TAGS
 
@@ -525,8 +525,8 @@
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	if test -z "$(ETAGS_ARGS)$$tags$$unique"; then :; else \
 	  test -n "$$unique" || unique=$$empty_fix; \
 	  $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
@@ -536,12 +536,13 @@
 CTAGS: ctags-recursive $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \
 		$(TAGS_FILES) $(LISP)
 	tags=; \
+	here=`pwd`; \
 	list='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \
 	unique=`for i in $$list; do \
 	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
 	  done | \
-	  $(AWK) '{ files[$$0] = 1; nonempty = 1; } \
-	      END { if (nonempty) { for (i in files) print i; }; }'`; \
+	  $(AWK) '    { files[$$0] = 1; } \
+	       END { for (i in files) print i; }'`; \
 	test -z "$(CTAGS_ARGS)$$tags$$unique" \
 	  || $(CTAGS) $(CTAGSFLAGS) $(AM_CTAGSFLAGS) $(CTAGS_ARGS) \
 	     $$tags $$unique
